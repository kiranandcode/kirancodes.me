(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))c(f);new MutationObserver(f=>{for(const y of f)if(y.type==="childList")for(const e of y.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&c(e)}).observe(document,{childList:!0,subtree:!0});function a(f){const y={};return f.integrity&&(y.integrity=f.integrity),f.referrerPolicy&&(y.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?y.credentials="include":f.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function c(f){if(f.ep)return;f.ep=!0;const y=a(f);fetch(f.href,y)}})();const eL=!1;var Gb=Array.isArray,_M=Array.prototype.indexOf,Tx=Array.from,J0=Object.defineProperty,Va=Object.getOwnPropertyDescriptor,tL=Object.getOwnPropertyDescriptors,bM=Object.prototype,vM=Array.prototype,Cx=Object.getPrototypeOf,jw=Object.isExtensible;function eh(i){return typeof i=="function"}const sm=()=>{};function xM(i){return typeof i?.then=="function"}function wM(i){return i()}function Q0(i){for(var n=0;n<i.length;n++)i[n]()}function rL(){var i,n,a=new Promise((c,f)=>{i=c,n=f});return{promise:a,resolve:i,reject:n}}function EM(i,n){if(Array.isArray(i))return i;if(!(Symbol.iterator in i))return Array.from(i);const a=[];for(const c of i)if(a.push(c),a.length===n)break;return a}const ls=2,kx=4,$b=8,pc=16,Ka=32,fc=64,Px=128,ao=256,Mb=512,qn=1024,$s=2048,Hl=4096,Co=8192,hc=16384,Lx=32768,mc=65536,Nw=1<<17,AM=1<<18,Fp=1<<19,iL=1<<20,ex=1<<21,Zb=1<<22,ac=1<<23,aa=Symbol("$state"),nL=Symbol("legacy props"),RM=Symbol(""),Ip=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Dx(i){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function SM(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function TM(i){throw new Error("https://svelte.dev/e/effect_in_teardown")}function CM(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function kM(i){throw new Error("https://svelte.dev/e/effect_orphan")}function PM(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function LM(i){throw new Error("https://svelte.dev/e/props_invalid_value")}function DM(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function IM(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function BM(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function MM(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Hb=1,Xb=2,sL=4,zM=8,OM=16,VM=1,UM=2,oL=4,jM=8,NM=16,FM=1,qM=2,on=Symbol(),KM="http://www.w3.org/1999/xhtml",GM="http://www.w3.org/2000/svg",$M="@attach";function ZM(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function HM(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let XM=!1;function aL(i){return i===this.v}function lL(i,n){return i!=i?n==n:i!==n||i!==null&&typeof i=="object"||typeof i=="function"}function uL(i){return!lL(i,this.v)}let qp=!1,WM=!1;function YM(){qp=!0}let Ai=null;function Gl(i){Ai=i}function yc(i){return cL().get(i)}function gc(i,n){return cL().set(i,n),n}function Gn(i,n=!1,a){Ai={p:Ai,c:null,e:null,s:i,x:null,l:qp&&!n?{s:null,u:null,$:[]}:null}}function $n(i){var n=Ai,a=n.e;if(a!==null){n.e=null;for(var c of a)RL(c)}return i!==void 0&&(n.x=i),Ai=n.p,i??{}}function Kp(){return!qp||Ai!==null&&Ai.l===null}function cL(i){return Ai===null&&Dx(),Ai.c??=new Map(JM(Ai)||void 0)}function JM(i){let n=i.p;for(;n!==null;){const a=n.c;if(a!==null)return a;n=n.p}return null}let nc=[];function dL(){var i=nc;nc=[],Q0(i)}function qa(i){if(nc.length===0&&!Mp){var n=nc;queueMicrotask(()=>{n===nc&&dL()})}nc.push(i)}function QM(){for(;nc.length>0;)dL()}const ez=new WeakMap;function pL(i){var n=Or;if(n===null)return Fr.f|=ac,i;if((n.f&Lx)===0){if((n.f&Px)===0)throw!n.parent&&i instanceof Error&&fL(i),i;n.b.error(i)}else Vp(i,n)}function Vp(i,n){for(;n!==null;){if((n.f&Px)!==0)try{n.b.error(i);return}catch(a){i=a}n=n.parent}throw i instanceof Error&&fL(i),i}function fL(i){const n=ez.get(i);n&&(J0(i,"message",{value:n.message}),J0(i,"stack",{value:n.stack}))}const wy=new Set;let Zi=null,So=null,tx=new Set,ia=[],Wb=null,rx=!1,Mp=!1;class sa{current=new Map;#t=new Map;#e=new Set;#n=0;#r=null;#a=[];#o=[];#s=[];#i=[];#l=[];#c=[];skipped_effects=new Set;process(n){ia=[],this.apply();for(const y of n)this.#d(y);if(this.#n===0){var a=So;this.#p();var c=this.#o,f=this.#s;this.#o=[],this.#s=[],this.#i=[],Zi=null,So=a,Fw(c),Fw(f),this.#r?.resolve()}else this.#u(this.#o),this.#u(this.#s),this.#u(this.#i);So=null;for(const y of this.#a)tm(y);this.#a=[]}#d(n){n.f^=qn;for(var a=n.first;a!==null;){var c=a.f,f=(c&(Ka|fc))!==0,y=f&&(c&qn)!==0,e=y||(c&Co)!==0||this.skipped_effects.has(a);if(!e&&a.fn!==null){f?a.f^=qn:(c&kx)!==0?this.#s.push(a):(c&qn)===0&&((c&Zb)!==0&&a.b?.is_pending()?this.#a.push(a):Qb(a)&&((a.f&pc)!==0&&this.#i.push(a),tm(a)));var l=a.first;if(l!==null){a=l;continue}}var _=a.parent;for(a=a.next;a===null&&_!==null;)a=_.next,_=_.parent}}#u(n){for(const a of n)((a.f&$s)!==0?this.#l:this.#c).push(a),as(a,qn);n.length=0}capture(n,a){this.#t.has(n)||this.#t.set(n,a),this.current.set(n,n.v),So?.set(n,n.v)}activate(){Zi=this}deactivate(){Zi=null,So=null}flush(){if(ia.length>0){if(this.activate(),hL(),Zi!==null&&Zi!==this)return}else this.#n===0&&this.#p();this.deactivate();for(const n of tx)if(tx.delete(n),n(),Zi!==null)break}#p(){for(const n of this.#e)n();if(this.#e.clear(),wy.size>1){this.#t.clear();let n=!0;for(const a of wy){if(a===this){n=!1;continue}const c=[];for(const[y,e]of this.current){if(a.current.has(y))if(n&&e!==a.current.get(y))a.current.set(y,e);else continue;c.push(y)}if(c.length===0)continue;const f=[...a.current.keys()].filter(y=>!this.current.has(y));if(f.length>0){for(const y of c)mL(y,f);if(ia.length>0){Zi=a,a.apply();for(const y of ia)a.#d(y);ia=[],a.deactivate()}}}Zi=null}wy.delete(this)}increment(){this.#n+=1}decrement(){this.#n-=1;for(const n of this.#l)as(n,$s),uc(n);for(const n of this.#c)as(n,Hl),uc(n);this.flush()}add_callback(n){this.#e.add(n)}settled(){return(this.#r??=rL()).promise}static ensure(){if(Zi===null){const n=Zi=new sa;wy.add(Zi),Mp||sa.enqueue(()=>{Zi===n&&n.flush()})}return Zi}static enqueue(n){qa(n)}apply(){}}function tz(i){var n=Mp;Mp=!0;try{for(var a;;){if(QM(),ia.length===0&&(Zi?.flush(),ia.length===0))return Wb=null,a;hL()}}finally{Mp=n}}function hL(){var i=zp;rx=!0;try{var n=0;for(Gw(!0);ia.length>0;){var a=sa.ensure();if(n++>1e3){var c,f;rz()}a.process(ia),ql.clear()}}finally{rx=!1,Gw(i),Wb=null}}function rz(){try{PM()}catch(i){Vp(i,Wb)}}let ic=null;function Fw(i){var n=i.length;if(n!==0){for(var a=0;a<n;){var c=i[a++];if((c.f&(hc|Co))===0&&Qb(c)&&(ic=[],tm(c),c.deps===null&&c.first===null&&c.nodes_start===null&&(c.teardown===null&&c.ac===null?PL(c):c.fn=null),ic?.length>0)){ql.clear();for(const f of ic)tm(f);ic=[]}}ic=null}}function mL(i,n){if(i.reactions!==null)for(const a of i.reactions){const c=a.f;(c&ls)!==0?mL(a,n):(c&(Zb|pc))!==0&&yL(a,n)&&(as(a,$s),uc(a))}}function yL(i,n){if(i.deps!==null){for(const a of i.deps)if(n.includes(a)||(a.f&ls)!==0&&yL(a,n))return!0}return!1}function uc(i){for(var n=Wb=i;n.parent!==null;){n=n.parent;var a=n.f;if(rx&&n===Or&&(a&pc)!==0)return;if((a&(fc|Ka))!==0){if((a&qn)===0)return;n.f^=qn}}ia.push(n)}function iz(i){let n=0,a=Lo(0),c;return()=>{yz()&&(Ie(a),zx(()=>(n===0&&(c=us(()=>i(()=>Kl(a)))),n+=1,()=>{qa(()=>{n-=1,n===0&&(c?.(),c=void 0,Kl(a))})})))}}var nz=mc|Fp|Px;function sz(i,n,a){new oz(i,n,a)}class oz{parent;#t=!1;#e;#n=null;#r;#a;#o;#s=null;#i=null;#l=null;#c=null;#d=0;#u=0;#p=!1;#f=null;#g=()=>{this.#f&&Ua(this.#f,this.#d)};#_=iz(()=>(this.#f=Lo(this.#d),()=>{this.#f=null}));constructor(n,a,c){this.#e=n,this.#r=a,this.#a=c,this.parent=Or.b,this.#t=!!this.#r.pending,this.#o=Ga(()=>{Or.b=this;{try{this.#s=En(()=>c(this.#e))}catch(f){this.error(f)}this.#u>0?this.#m():this.#t=!1}},nz)}#b(){try{this.#s=En(()=>this.#a(this.#e))}catch(n){this.error(n)}this.#t=!1}#v(){const n=this.#r.pending;n&&(this.#i=En(()=>n(this.#e)),sa.enqueue(()=>{this.#s=this.#h(()=>(sa.ensure(),En(()=>this.#a(this.#e)))),this.#u>0?this.#m():(Po(this.#i,()=>{this.#i=null}),this.#t=!1)}))}is_pending(){return this.#t||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#r.pending}#h(n){var a=Or,c=Fr,f=Ai;Kn(this.#o),An(this.#o),Gl(this.#o.ctx);try{return n()}catch(y){return pL(y),null}finally{Kn(a),An(c),Gl(f)}}#m(){const n=this.#r.pending;this.#s!==null&&(this.#c=document.createDocumentFragment(),az(this.#s,this.#c)),this.#i===null&&(this.#i=En(()=>n(this.#e)))}#y(n){if(!this.has_pending_snippet()){this.parent&&this.parent.#y(n);return}this.#u+=n,this.#u===0&&(this.#t=!1,this.#i&&Po(this.#i,()=>{this.#i=null}),this.#c&&(this.#e.before(this.#c),this.#c=null),qa(()=>{sa.ensure().flush()}))}update_pending_count(n){this.#y(n),this.#d+=n,tx.add(this.#g)}get_effect_pending(){return this.#_(),Ie(this.#f)}error(n){var a=this.#r.onerror;let c=this.#r.failed;if(this.#p||!a&&!c)throw n;this.#s&&(Dn(this.#s),this.#s=null),this.#i&&(Dn(this.#i),this.#i=null),this.#l&&(Dn(this.#l),this.#l=null);var f=!1,y=!1;const e=()=>{if(f){HM();return}f=!0,y&&MM(),sa.ensure(),this.#d=0,this.#l!==null&&Po(this.#l,()=>{this.#l=null}),this.#t=this.has_pending_snippet(),this.#s=this.#h(()=>(this.#p=!1,En(()=>this.#a(this.#e)))),this.#u>0?this.#m():this.#t=!1};var l=Fr;try{An(null),y=!0,a?.(n,e),y=!1}catch(_){Vp(_,this.#o&&this.#o.parent)}finally{An(l)}c&&qa(()=>{this.#l=this.#h(()=>{this.#p=!0;try{return En(()=>{c(this.#e,()=>n,()=>e)})}catch(_){return Vp(_,this.#o.parent),null}finally{this.#p=!1}})})}}function az(i,n){for(var a=i.nodes_start,c=i.nodes_end;a!==null;){var f=a===c?null:am(a);n.append(a),a=f}}function gL(i,n,a){const c=Kp()?om:Qh;if(n.length===0){a(i.map(c));return}var f=Zi,y=Or,e=lz();Promise.all(n.map(l=>uz(l))).then(l=>{e();try{a([...i.map(c),...l])}catch(_){(y.f&hc)===0&&Vp(_,y)}f?.deactivate(),ix()}).catch(l=>{Vp(l,y)})}function lz(){var i=Or,n=Fr,a=Ai,c=Zi;return function(){Kn(i),An(n),Gl(a),c?.activate()}}function ix(){Kn(null),An(null),Gl(null)}function om(i){var n=ls|$s,a=Fr!==null&&(Fr.f&ls)!==0?Fr:null;return Or===null||a!==null&&(a.f&ao)!==0?n|=ao:Or.f|=Fp,{ctx:Ai,deps:null,effects:null,equals:aL,f:n,fn:i,reactions:null,rv:0,v:on,wv:0,parent:a??Or,ac:null}}function uz(i,n){let a=Or;a===null&&SM();var c=a.b,f=void 0,y=Lo(on),e=!Fr,l=new Map;return _z(()=>{var _=rL();f=_.promise;try{Promise.resolve(i()).then(_.resolve,_.reject).then(ix)}catch(I){_.reject(I),ix()}var w=Zi,R=c.is_pending();e&&(c.update_pending_count(1),R||(w.increment(),l.get(w)?.reject(Ip),l.delete(w),l.set(w,_)));const C=(I,L=void 0)=>{if(R||w.activate(),L)L!==Ip&&(y.f|=ac,Ua(y,L));else{(y.f&ac)!==0&&(y.f^=ac),Ua(y,I);for(const[O,q]of l){if(l.delete(O),O===w)break;q.reject(Ip)}}e&&(c.update_pending_count(-1),R||w.decrement())};_.promise.then(C,I=>C(null,I||"unknown"))}),Yb(()=>{for(const _ of l.values())_.reject(Ip)}),new Promise(_=>{function w(R){function C(){R===f?_(y):w(f)}R.then(C,C)}w(f)})}function Xr(i){const n=om(i);return IL(n),n}function Qh(i){const n=om(i);return n.equals=uL,n}function _L(i){var n=i.effects;if(n!==null){i.effects=null;for(var a=0;a<n.length;a+=1)Dn(n[a])}}function cz(i){for(var n=i.parent;n!==null;){if((n.f&ls)===0)return n;n=n.parent}return null}function Ix(i){var n,a=Or;Kn(cz(i));try{_L(i),n=OL(i)}finally{Kn(a)}return n}function bL(i){var n=Ix(i);if(i.equals(n)||(i.v=n,i.wv=ML()),!_c)if(So!==null)So.set(i,i.v);else{var a=(Fl||(i.f&ao)!==0)&&i.deps!==null?Hl:qn;as(i,a)}}const ql=new Map;function Lo(i,n){var a={f:0,v:i,reactions:null,equals:aL,rv:0,wv:0};return a}function ti(i,n){const a=Lo(i);return IL(a),a}function Nl(i,n=!1,a=!0){const c=Lo(i);return n||(c.equals=uL),qp&&a&&Ai!==null&&Ai.l!==null&&(Ai.l.s??=[]).push(c),c}function dr(i,n,a=!1){Fr!==null&&(!To||(Fr.f&Nw)!==0)&&Kp()&&(Fr.f&(ls|pc|Zb|Nw))!==0&&!ja?.includes(i)&&BM();let c=a?Oa(n):n;return Ua(i,c)}function Ua(i,n){if(!i.equals(n)){var a=i.v;_c?ql.set(i,n):ql.set(i,a),i.v=n;var c=sa.ensure();c.capture(i,a),(i.f&ls)!==0&&((i.f&$s)!==0&&Ix(i),as(i,(i.f&ao)===0?qn:Hl)),i.wv=ML(),vL(i,$s),Kp()&&Or!==null&&(Or.f&qn)!==0&&(Or.f&(Ka|fc))===0&&(so===null?vz([i]):so.push(i))}return n}function qw(i,n=1){var a=Ie(i),c=n===1?a++:a--;return dr(i,a),c}function Kl(i){dr(i,i.v+1)}function vL(i,n){var a=i.reactions;if(a!==null)for(var c=Kp(),f=a.length,y=0;y<f;y++){var e=a[y],l=e.f;if(!(!c&&e===Or)){var _=(l&$s)===0;_&&as(e,n),(l&ls)!==0?vL(e,Hl):_&&((l&pc)!==0&&ic!==null&&ic.push(e),uc(e))}}}function Oa(i){if(typeof i!="object"||i===null||aa in i)return i;const n=Cx(i);if(n!==bM&&n!==vM)return i;var a=new Map,c=Gb(i),f=ti(0),y=Na,e=l=>{if(Na===y)return l();var _=Fr,w=Na;An(null),Zw(y);var R=l();return An(_),Zw(w),R};return c&&a.set("length",ti(i.length)),new Proxy(i,{defineProperty(l,_,w){(!("value"in w)||w.configurable===!1||w.enumerable===!1||w.writable===!1)&&DM();var R=a.get(_);return R===void 0?R=e(()=>{var C=ti(w.value);return a.set(_,C),C}):dr(R,w.value,!0),!0},deleteProperty(l,_){var w=a.get(_);if(w===void 0){if(_ in l){const R=e(()=>ti(on));a.set(_,R),Kl(f)}}else dr(w,on),Kl(f);return!0},get(l,_,w){if(_===aa)return i;var R=a.get(_),C=_ in l;if(R===void 0&&(!C||Va(l,_)?.writable)&&(R=e(()=>{var L=Oa(C?l[_]:on),O=ti(L);return O}),a.set(_,R)),R!==void 0){var I=Ie(R);return I===on?void 0:I}return Reflect.get(l,_,w)},getOwnPropertyDescriptor(l,_){var w=Reflect.getOwnPropertyDescriptor(l,_);if(w&&"value"in w){var R=a.get(_);R&&(w.value=Ie(R))}else if(w===void 0){var C=a.get(_),I=C?.v;if(C!==void 0&&I!==on)return{enumerable:!0,configurable:!0,value:I,writable:!0}}return w},has(l,_){if(_===aa)return!0;var w=a.get(_),R=w!==void 0&&w.v!==on||Reflect.has(l,_);if(w!==void 0||Or!==null&&(!R||Va(l,_)?.writable)){w===void 0&&(w=e(()=>{var I=R?Oa(l[_]):on,L=ti(I);return L}),a.set(_,w));var C=Ie(w);if(C===on)return!1}return R},set(l,_,w,R){var C=a.get(_),I=_ in l;if(c&&_==="length")for(var L=w;L<C.v;L+=1){var O=a.get(L+"");O!==void 0?dr(O,on):L in l&&(O=e(()=>ti(on)),a.set(L+"",O))}if(C===void 0)(!I||Va(l,_)?.writable)&&(C=e(()=>ti(void 0)),dr(C,Oa(w)),a.set(_,C));else{I=C.v!==on;var q=e(()=>Oa(w));dr(C,q)}var G=Reflect.getOwnPropertyDescriptor(l,_);if(G?.set&&G.set.call(R,w),!I){if(c&&typeof _=="string"){var j=a.get("length"),ne=Number(_);Number.isInteger(ne)&&ne>=j.v&&dr(j,ne+1)}Kl(f)}return!0},ownKeys(l){Ie(f);var _=Reflect.ownKeys(l).filter(C=>{var I=a.get(C);return I===void 0||I.v!==on});for(var[w,R]of a)R.v!==on&&!(w in l)&&_.push(w);return _},setPrototypeOf(){IM()}})}function Kw(i){try{if(i!==null&&typeof i=="object"&&aa in i)return i[aa]}catch{}return i}function dz(i,n){return Object.is(Kw(i),Kw(n))}var nx,xL,wL,EL;function pz(){if(nx===void 0){nx=window,xL=/Firefox/.test(navigator.userAgent);var i=Element.prototype,n=Node.prototype,a=Text.prototype;wL=Va(n,"firstChild").get,EL=Va(n,"nextSibling").get,jw(i)&&(i.__click=void 0,i.__className=void 0,i.__attributes=null,i.__style=void 0,i.__e=void 0),jw(a)&&(a.__t=void 0)}}function Xl(i=""){return document.createTextNode(i)}function oa(i){return wL.call(i)}function am(i){return EL.call(i)}function ni(i,n){return oa(i)}function Hr(i,n=!1){{var a=oa(i);return a instanceof Comment&&a.data===""?am(a):a}}function yn(i,n=1,a=!1){let c=i;for(;n--;)c=am(c);return c}function fz(i){i.textContent=""}function Bx(){return!1}function hz(i,n){if(n){const a=document.body;i.autofocus=!0,qa(()=>{document.activeElement===a&&i.focus()})}}function Mx(i){var n=Fr,a=Or;An(null),Kn(null);try{return i()}finally{An(n),Kn(a)}}function AL(i){Or===null&&Fr===null&&kM(),Fr!==null&&(Fr.f&ao)!==0&&Or===null&&CM(),_c&&TM()}function mz(i,n){var a=n.last;a===null?n.last=n.first=i:(a.next=i,i.prev=a,n.last=i)}function ua(i,n,a,c=!0){var f=Or;f!==null&&(f.f&Co)!==0&&(i|=Co);var y={ctx:Ai,deps:null,nodes_start:null,nodes_end:null,f:i|$s,first:null,fn:n,last:null,next:null,parent:f,b:f&&f.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(a)try{tm(y),y.f|=Lx}catch(_){throw Dn(y),_}else n!==null&&uc(y);if(c){var e=y;if(a&&e.deps===null&&e.teardown===null&&e.nodes_start===null&&e.first===e.last&&(e.f&Fp)===0&&(e=e.first),e!==null&&(e.parent=f,f!==null&&mz(e,f),Fr!==null&&(Fr.f&ls)!==0&&(i&fc)===0)){var l=Fr;(l.effects??=[]).push(e)}}return y}function yz(){return Fr!==null&&!To}function Yb(i){const n=ua($b,null,!1);return as(n,qn),n.teardown=i,n}function bi(i){AL();var n=Or.f,a=!Fr&&(n&Ka)!==0&&(n&Lx)===0;if(a){var c=Ai;(c.e??=[]).push(i)}else return RL(i)}function RL(i){return ua(kx|iL,i,!1)}function SL(i){return AL(),ua($b|iL,i,!0)}function gz(i){sa.ensure();const n=ua(fc|Fp,i,!0);return(a={})=>new Promise(c=>{a.outro?Po(n,()=>{Dn(n),c(void 0)}):(Dn(n),c(void 0))})}function Jb(i){return ua(kx,i,!1)}function _z(i){return ua(Zb|Fp,i,!0)}function zx(i,n=0){return ua($b|n,i,!0)}function ko(i,n=[],a=[]){gL(n,a,c=>{ua($b,()=>i(...c.map(Ie)),!0)})}function Ga(i,n=0){var a=ua(pc|n,i,!0);return a}function En(i,n=!0){return ua(Ka|Fp,i,!0,n)}function TL(i){var n=i.teardown;if(n!==null){const a=_c,c=Fr;$w(!0),An(null);try{n.call(null)}finally{$w(a),An(c)}}}function CL(i,n=!1){var a=i.first;for(i.first=i.last=null;a!==null;){const f=a.ac;f!==null&&Mx(()=>{f.abort(Ip)});var c=a.next;(a.f&fc)!==0?a.parent=null:Dn(a,n),a=c}}function bz(i){for(var n=i.first;n!==null;){var a=n.next;(n.f&Ka)===0&&Dn(n),n=a}}function Dn(i,n=!0){var a=!1;(n||(i.f&AM)!==0)&&i.nodes_start!==null&&i.nodes_end!==null&&(kL(i.nodes_start,i.nodes_end),a=!0),CL(i,n&&!a),zb(i,0),as(i,hc);var c=i.transitions;if(c!==null)for(const y of c)y.stop();TL(i);var f=i.parent;f!==null&&f.first!==null&&PL(i),i.next=i.prev=i.teardown=i.ctx=i.deps=i.fn=i.nodes_start=i.nodes_end=i.ac=null}function kL(i,n){for(;i!==null;){var a=i===n?null:am(i);i.remove(),i=a}}function PL(i){var n=i.parent,a=i.prev,c=i.next;a!==null&&(a.next=c),c!==null&&(c.prev=a),n!==null&&(n.first===i&&(n.first=c),n.last===i&&(n.last=a))}function Po(i,n){var a=[];Ox(i,a,!0),LL(a,()=>{Dn(i),n&&n()})}function LL(i,n){var a=i.length;if(a>0){var c=()=>--a||n();for(var f of i)f.out(c)}else n()}function Ox(i,n,a){if((i.f&Co)===0){if(i.f^=Co,i.transitions!==null)for(const e of i.transitions)(e.is_global||a)&&n.push(e);for(var c=i.first;c!==null;){var f=c.next,y=(c.f&mc)!==0||(c.f&Ka)!==0;Ox(c,n,y?a:!1),c=f}}}function Up(i){DL(i,!0)}function DL(i,n){if((i.f&Co)!==0){i.f^=Co,(i.f&qn)===0&&(as(i,$s),uc(i));for(var a=i.first;a!==null;){var c=a.next,f=(a.f&mc)!==0||(a.f&Ka)!==0;DL(a,f?n:!1),a=c}if(i.transitions!==null)for(const y of i.transitions)(y.is_global||n)&&y.in()}}let zp=!1;function Gw(i){zp=i}let _c=!1;function $w(i){_c=i}let Fr=null,To=!1;function An(i){Fr=i}let Or=null;function Kn(i){Or=i}let ja=null;function IL(i){Fr!==null&&(ja===null?ja=[i]:ja.push(i))}let os=null,Fs=0,so=null;function vz(i){so=i}let BL=1,em=0,Na=em;function Zw(i){Na=i}let Fl=!1;function ML(){return++BL}function Qb(i){var n=i.f;if((n&$s)!==0)return!0;if((n&Hl)!==0){var a=i.deps,c=(n&ao)!==0;if(a!==null){var f,y,e=(n&Mb)!==0,l=c&&Or!==null&&!Fl,_=a.length;if((e||l)&&(Or===null||(Or.f&hc)===0)){var w=i,R=w.parent;for(f=0;f<_;f++)y=a[f],(e||!y?.reactions?.includes(w))&&(y.reactions??=[]).push(w);e&&(w.f^=Mb),l&&R!==null&&(R.f&ao)===0&&(w.f^=ao)}for(f=0;f<_;f++)if(y=a[f],Qb(y)&&bL(y),y.wv>i.wv)return!0}(!c||Or!==null&&!Fl)&&as(i,qn)}return!1}function zL(i,n,a=!0){var c=i.reactions;if(c!==null&&!ja?.includes(i))for(var f=0;f<c.length;f++){var y=c[f];(y.f&ls)!==0?zL(y,n,!1):n===y&&(a?as(y,$s):(y.f&qn)!==0&&as(y,Hl),uc(y))}}function OL(i){var n=os,a=Fs,c=so,f=Fr,y=Fl,e=ja,l=Ai,_=To,w=Na,R=i.f;os=null,Fs=0,so=null,Fl=(R&ao)!==0&&(To||!zp||Fr===null),Fr=(R&(Ka|fc))===0?i:null,ja=null,Gl(i.ctx),To=!1,Na=++em,i.ac!==null&&(Mx(()=>{i.ac.abort(Ip)}),i.ac=null);try{i.f|=ex;var C=i.fn,I=C(),L=i.deps;if(os!==null){var O;if(zb(i,Fs),L!==null&&Fs>0)for(L.length=Fs+os.length,O=0;O<os.length;O++)L[Fs+O]=os[O];else i.deps=L=os;if(!Fl||(R&ls)!==0&&i.reactions!==null)for(O=Fs;O<L.length;O++)(L[O].reactions??=[]).push(i)}else L!==null&&Fs<L.length&&(zb(i,Fs),L.length=Fs);if(Kp()&&so!==null&&!To&&L!==null&&(i.f&(ls|Hl|$s))===0)for(O=0;O<so.length;O++)zL(so[O],i);return f!==null&&f!==i&&(em++,so!==null&&(c===null?c=so:c.push(...so))),(i.f&ac)!==0&&(i.f^=ac),I}catch(q){return pL(q)}finally{i.f^=ex,os=n,Fs=a,so=c,Fr=f,Fl=y,ja=e,Gl(l),To=_,Na=w}}function xz(i,n){let a=n.reactions;if(a!==null){var c=_M.call(a,i);if(c!==-1){var f=a.length-1;f===0?a=n.reactions=null:(a[c]=a[f],a.pop())}}a===null&&(n.f&ls)!==0&&(os===null||!os.includes(n))&&(as(n,Hl),(n.f&(ao|Mb))===0&&(n.f^=Mb),_L(n),zb(n,0))}function zb(i,n){var a=i.deps;if(a!==null)for(var c=n;c<a.length;c++)xz(i,a[c])}function tm(i){var n=i.f;if((n&hc)===0){as(i,qn);var a=Or,c=zp;Or=i,zp=!0;try{(n&pc)!==0?bz(i):CL(i),TL(i);var f=OL(i);i.teardown=typeof f=="function"?f:null,i.wv=BL;var y;eL&&WM&&(i.f&$s)!==0&&i.deps}finally{zp=c,Or=a}}}function Ie(i){var n=i.f,a=(n&ls)!==0;if(Fr!==null&&!To){var c=Or!==null&&(Or.f&hc)!==0;if(!c&&!ja?.includes(i)){var f=Fr.deps;if((Fr.f&ex)!==0)i.rv<em&&(i.rv=em,os===null&&f!==null&&f[Fs]===i?Fs++:os===null?os=[i]:(!Fl||!os.includes(i))&&os.push(i));else{(Fr.deps??=[]).push(i);var y=i.reactions;y===null?i.reactions=[Fr]:y.includes(Fr)||y.push(Fr)}}}else if(a&&i.deps===null&&i.effects===null){var e=i,l=e.parent;l!==null&&(l.f&ao)===0&&(e.f^=ao)}if(_c){if(ql.has(i))return ql.get(i);if(a){e=i;var _=e.v;return((e.f&qn)===0&&e.reactions!==null||VL(e))&&(_=Ix(e)),ql.set(e,_),_}}else if(a){if(e=i,So?.has(e))return So.get(e);Qb(e)&&bL(e)}if(So?.has(i))return So.get(i);if((i.f&ac)!==0)throw i.v;return i.v}function VL(i){if(i.v===on)return!0;if(i.deps===null)return!1;for(const n of i.deps)if(ql.has(n)||(n.f&ls)!==0&&VL(n))return!0;return!1}function us(i){var n=To;try{return To=!0,i()}finally{To=n}}const wz=-7169;function as(i,n){i.f=i.f&wz|n}function qs(i){if(!(typeof i!="object"||!i||i instanceof EventTarget)){if(aa in i)sx(i);else if(!Array.isArray(i))for(let n in i){const a=i[n];typeof a=="object"&&a&&aa in a&&sx(a)}}}function sx(i,n=new Set){if(typeof i=="object"&&i!==null&&!(i instanceof EventTarget)&&!n.has(i)){n.add(i),i instanceof Date&&i.getTime();for(let c in i)try{sx(i[c],n)}catch{}const a=Cx(i);if(a!==Object.prototype&&a!==Array.prototype&&a!==Map.prototype&&a!==Set.prototype&&a!==Date.prototype){const c=tL(a);for(let f in c){const y=c[f].get;if(y)try{y.call(i)}catch{}}}}}function Ez(i){return i.endsWith("capture")&&i!=="gotpointercapture"&&i!=="lostpointercapture"}const Az=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function Rz(i){return Az.includes(i)}const Sz={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function Tz(i){return i=i.toLowerCase(),Sz[i]??i}const Cz=["touchstart","touchmove"];function kz(i){return Cz.includes(i)}const UL=new Set,ox=new Set;function jL(i,n,a,c={}){function f(y){if(c.capture||Zh.call(n,y),!y.cancelBubble)return Mx(()=>a?.call(this,y))}return i.startsWith("pointer")||i.startsWith("touch")||i==="wheel"?qa(()=>{n.addEventListener(i,f,c)}):n.addEventListener(i,f,c),f}function cc(i,n,a,c,f){var y={capture:c,passive:f},e=jL(i,n,a,y);(n===document.body||n===window||n===document||n instanceof HTMLMediaElement)&&Yb(()=>{n.removeEventListener(i,e,y)})}function Vx(i){for(var n=0;n<i.length;n++)UL.add(i[n]);for(var a of ox)a(i)}let Hw=null;function Zh(i){var n=this,a=n.ownerDocument,c=i.type,f=i.composedPath?.()||[],y=f[0]||i.target;Hw=i;var e=0,l=Hw===i&&i.__root;if(l){var _=f.indexOf(l);if(_!==-1&&(n===document||n===window)){i.__root=n;return}var w=f.indexOf(n);if(w===-1)return;_<=w&&(e=_)}if(y=f[e]||i.target,y!==n){J0(i,"currentTarget",{configurable:!0,get(){return y||a}});var R=Fr,C=Or;An(null),Kn(null);try{for(var I,L=[];y!==null;){var O=y.assignedSlot||y.parentNode||y.host||null;try{var q=y["__"+c];if(q!=null&&(!y.disabled||i.target===y))if(Gb(q)){var[G,...j]=q;G.apply(y,[i,...j])}else q.call(y,i)}catch(ne){I?L.push(ne):I=ne}if(i.cancelBubble||O===n||O===null)break;y=O}if(I){for(let ne of L)queueMicrotask(()=>{throw ne});throw I}}finally{i.__root=n,delete i.currentTarget,An(R),Kn(C)}}}function Ux(i){var n=document.createElement("template");return n.innerHTML=i.replaceAll("<!>","<!---->"),n.content}function dc(i,n){var a=Or;a.nodes_start===null&&(a.nodes_start=i,a.nodes_end=n)}function cs(i,n){var a=(n&FM)!==0,c=(n&qM)!==0,f,y=!i.startsWith("<!>");return()=>{f===void 0&&(f=Ux(y?i:"<!>"+i),a||(f=oa(f)));var e=c||xL?document.importNode(f,!0):f.cloneNode(!0);if(a){var l=oa(e),_=e.lastChild;dc(l,_)}else dc(e,e);return e}}function Pz(i,n,a="svg"){var c=!i.startsWith("<!>"),f=`<${a}>${c?i:"<!>"+i}</${a}>`,y;return()=>{if(!y){var e=Ux(f),l=oa(e);y=oa(l)}var _=y.cloneNode(!0);return dc(_,_),_}}function Lz(i,n){return Pz(i,n,"svg")}function Dz(i=""){{var n=Xl(i+"");return dc(n,n),n}}function yi(){var i=document.createDocumentFragment(),n=document.createComment(""),a=Xl();return i.append(n,a),dc(n,a),i}function wr(i,n){i!==null&&i.before(n)}function lc(i,n){var a=n==null?"":typeof n=="object"?n+"":n;a!==(i.__t??=i.nodeValue)&&(i.__t=a,i.nodeValue=a+"")}function Iz(i,n){return Bz(i,n)}const Rd=new Map;function Bz(i,{target:n,anchor:a,props:c={},events:f,context:y,intro:e=!0}){pz();var l=new Set,_=C=>{for(var I=0;I<C.length;I++){var L=C[I];if(!l.has(L)){l.add(L);var O=kz(L);n.addEventListener(L,Zh,{passive:O});var q=Rd.get(L);q===void 0?(document.addEventListener(L,Zh,{passive:O}),Rd.set(L,1)):Rd.set(L,q+1)}}};_(Tx(UL)),ox.add(_);var w=void 0,R=gz(()=>{var C=a??n.appendChild(Xl());return sz(C,{pending:()=>{}},I=>{if(y){Gn({});var L=Ai;L.c=y}f&&(c.$$events=f),w=i(I,c)||{},y&&$n()}),()=>{for(var I of l){n.removeEventListener(I,Zh);var L=Rd.get(I);--L===0?(document.removeEventListener(I,Zh),Rd.delete(I)):Rd.set(I,L)}ox.delete(_),C!==a&&C.parentNode?.removeChild(C)}});return Mz.set(w,R),w}let Mz=new WeakMap;const y0=0,Ey=1,g0=2;function zz(i,n,a,c,f){var y=i,e=Kp(),l=Ai,_=on,w,R,C,I=e?Lo(void 0):Nl(void 0,!1,!1),L=e?Lo(void 0):Nl(void 0,!1,!1),O=!1;function q(j,ne){O=!0,ne&&(Kn(G),An(G),Gl(l));try{j===Ey&&c&&(R?Up(R):R=En(()=>c(y,I))),j===g0&&f&&(C?Up(C):C=En(()=>f(y,L))),j!==y0&&w&&Po(w,()=>w=null),j!==Ey&&R&&Po(R,()=>R=null),j!==g0&&C&&Po(C,()=>C=null)}finally{ne&&(Gl(null),An(null),Kn(null),Mp||tz())}}var G=Ga(()=>{if(_!==(_=n())){if(xM(_)){var j=_;O=!1,j.then(ne=>{j===_&&(Ua(I,ne),q(Ey,!0))},ne=>{if(j===_&&(Ua(L,ne),q(g0,!0),!f))throw L.v}),qa(()=>{O||q(y0,!0)})}else Ua(I,_),q(Ey,!1);return()=>_=on}})}function wn(i,n,a=!1){var c=i,f=null,y=null,e=on,l=a?mc:0,_=!1;const w=(L,O=!0)=>{_=!0,I(O,L)};var R=null;function C(){R!==null&&(R.lastChild.remove(),c.before(R),R=null);var L=e?f:y,O=e?y:f;L&&Up(L),O&&Po(O,()=>{e?y=null:f=null})}const I=(L,O)=>{if(e!==(e=L)){var q=Bx(),G=c;if(q&&(R=document.createDocumentFragment(),R.append(G=Xl())),e?f??=O&&En(()=>O(G)):y??=O&&En(()=>O(G)),q){var j=Zi,ne=e?f:y,he=e?y:f;ne&&j.skipped_effects.delete(ne),he&&j.skipped_effects.add(he),j.add_callback(C)}else C()}};Ga(()=>{_=!1,n(w),_||I(null,null)},l)}function sc(i,n){return n}function Oz(i,n,a){for(var c=i.items,f=[],y=n.length,e=0;e<y;e++)Ox(n[e].e,f,!0);var l=y>0&&f.length===0&&a!==null;if(l){var _=a.parentNode;fz(_),_.append(a),c.clear(),ta(i,n[0].prev,n[y-1].next)}LL(f,()=>{for(var w=0;w<y;w++){var R=n[w];l||(c.delete(R.k),ta(i,R.prev,R.next)),Dn(R.e,!l)}})}function oc(i,n,a,c,f,y=null){var e=i,l={flags:n,items:new Map,first:null},_=(n&sL)!==0;if(_){var w=i;e=w.appendChild(Xl())}var R=null,C=!1,I=new Map,L=Qh(()=>{var j=a();return Gb(j)?j:j==null?[]:Tx(j)}),O,q;function G(){Vz(q,O,l,I,e,f,n,c,a),y!==null&&(O.length===0?R?Up(R):R=En(()=>y(e)):R!==null&&Po(R,()=>{R=null}))}Ga(()=>{q??=Or,O=Ie(L);var j=O.length;if(!(C&&j===0)){C=j===0;var ne,he,Q,Be;if(Bx()){var we=new Set,ze=Zi;for(he=0;he<j;he+=1){Q=O[he],Be=c(Q,he);var et=l.items.get(Be)??I.get(Be);et?(n&(Hb|Xb))!==0&&NL(et,Q,he,n):(ne=FL(null,l,null,null,Q,Be,he,f,n,a,!0),I.set(Be,ne)),we.add(Be)}for(const[gt,st]of l.items)we.has(gt)||ze.skipped_effects.add(st.e);ze.add_callback(G)}else G();Ie(L)}})}function Vz(i,n,a,c,f,y,e,l,_){var w=(e&zM)!==0,R=(e&(Hb|Xb))!==0,C=n.length,I=a.items,L=a.first,O=L,q,G=null,j,ne=[],he=[],Q,Be,we,ze;if(w)for(ze=0;ze<C;ze+=1)Q=n[ze],Be=l(Q,ze),we=I.get(Be),we!==void 0&&(we.a?.measure(),(j??=new Set).add(we));for(ze=0;ze<C;ze+=1){if(Q=n[ze],Be=l(Q,ze),we=I.get(Be),we===void 0){var et=c.get(Be);if(et!==void 0){c.delete(Be),I.set(Be,et);var gt=G?G.next:O;ta(a,G,et),ta(a,et,gt),_0(et,gt,f),G=et}else{var st=O?O.e.nodes_start:f;G=FL(st,a,G,G===null?a.first:G.next,Q,Be,ze,y,e,_)}I.set(Be,G),ne=[],he=[],O=G.next;continue}if(R&&NL(we,Q,ze,e),(we.e.f&Co)!==0&&(Up(we.e),w&&(we.a?.unfix(),(j??=new Set).delete(we))),we!==O){if(q!==void 0&&q.has(we)){if(ne.length<he.length){var nt=he[0],rt;G=nt.prev;var ee=ne[0],Le=ne[ne.length-1];for(rt=0;rt<ne.length;rt+=1)_0(ne[rt],nt,f);for(rt=0;rt<he.length;rt+=1)q.delete(he[rt]);ta(a,ee.prev,Le.next),ta(a,G,ee),ta(a,Le,nt),O=nt,G=Le,ze-=1,ne=[],he=[]}else q.delete(we),_0(we,O,f),ta(a,we.prev,we.next),ta(a,we,G===null?a.first:G.next),ta(a,G,we),G=we;continue}for(ne=[],he=[];O!==null&&O.k!==Be;)(O.e.f&Co)===0&&(q??=new Set).add(O),he.push(O),O=O.next;if(O===null)continue;we=O}ne.push(we),G=we,O=we.next}if(O!==null||q!==void 0){for(var de=q===void 0?[]:Tx(q);O!==null;)(O.e.f&Co)===0&&de.push(O),O=O.next;var me=de.length;if(me>0){var tt=(e&sL)!==0&&C===0?f:null;if(w){for(ze=0;ze<me;ze+=1)de[ze].a?.measure();for(ze=0;ze<me;ze+=1)de[ze].a?.fix()}Oz(a,de,tt)}}w&&qa(()=>{if(j!==void 0)for(we of j)we.a?.apply()}),i.first=a.first&&a.first.e,i.last=G&&G.e;for(var yt of c.values())Dn(yt.e);c.clear()}function NL(i,n,a,c){(c&Hb)!==0&&Ua(i.v,n),(c&Xb)!==0?Ua(i.i,a):i.i=a}function FL(i,n,a,c,f,y,e,l,_,w,R){var C=(_&Hb)!==0,I=(_&OM)===0,L=C?I?Nl(f,!1,!1):Lo(f):f,O=(_&Xb)===0?e:Lo(e),q={i:O,v:L,k:y,a:null,e:null,prev:a,next:c};try{if(i===null){var G=document.createDocumentFragment();G.append(i=Xl())}return q.e=En(()=>l(i,L,O,w),XM),q.e.prev=a&&a.e,q.e.next=c&&c.e,a===null?R||(n.first=q):(a.next=q,a.e.next=q.e),c!==null&&(c.prev=q,c.e.prev=q.e),q}finally{}}function _0(i,n,a){for(var c=i.next?i.next.e.nodes_start:a,f=n?n.e.nodes_start:a,y=i.e.nodes_start;y!==null&&y!==c;){var e=am(y);f.before(y),y=e}}function ta(i,n,a){n===null?i.first=a:(n.next=a,n.e.next=a&&a.e),a!==null&&(a.prev=n,a.e.prev=n&&n.e)}function Uz(i,n,a=!1,c=!1,f=!1){var y=i,e="";ko(()=>{var l=Or;if(e!==(e=n()??"")&&(l.nodes_start!==null&&(kL(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),e!=="")){var _=e+"";a?_=`<svg>${_}</svg>`:c&&(_=`<math>${_}</math>`);var w=Ux(_);if((a||c)&&(w=oa(w)),dc(oa(w),w.lastChild),a||c)for(;oa(w);)y.before(oa(w));else y.before(w)}})}function qL(i,n,a,c,f){var y=n.$$slots?.[a],e=!1;y===!0&&(y=n.children,e=!0),y===void 0||y(i,e?()=>c:c)}function rm(i,n,...a){var c=i,f=sm,y;Ga(()=>{f!==(f=n())&&(y&&(Dn(y),y=null),y=En(()=>f(c,...a)))},mc)}function Xw(i,n,a){var c=i,f,y,e=null,l=null;function _(){y&&(Po(y),y=null),e&&(e.lastChild.remove(),c.before(e),e=null),y=l,l=null}Ga(()=>{if(f!==(f=n())){var w=Bx();if(f){var R=c;w&&(e=document.createDocumentFragment(),e.append(R=Xl()),y&&Zi.skipped_effects.add(y)),l=En(()=>a(R,f))}w?Zi.add_callback(_):_()}},mc)}function Hh(i,n,a,c,f,y){var e,l,_=null,w=i,R;Ga(()=>{const C=n()||null;var I=a||C==="svg"?GM:null;C!==e&&(R&&(C===null?Po(R,()=>{R=null,l=null}):C===l?Up(R):Dn(R)),C&&C!==l&&(R=En(()=>{if(_=I?document.createElementNS(I,C):document.createElement(C),dc(_,_),c){var L=_.appendChild(Xl());c(_,L)}Or.nodes_end=_,w.before(_)})),e=C,e&&(l=e))},mc)}function ax(i,n,a){Jb(()=>{var c=us(()=>n(i,a?.())||{});if(a&&c?.update){var f=!1,y={};zx(()=>{var e=a();qs(e),f&&lL(y,e)&&(y=e,c.update(e))}),f=!0}if(c?.destroy)return()=>c.destroy()})}function KL(i,n){var a=void 0,c;Ga(()=>{a!==(a=n())&&(c&&(Dn(c),c=null),a&&(c=En(()=>{Jb(()=>a(i))})))})}function GL(i){var n,a,c="";if(typeof i=="string"||typeof i=="number")c+=i;else if(typeof i=="object")if(Array.isArray(i)){var f=i.length;for(n=0;n<f;n++)i[n]&&(a=GL(i[n]))&&(c&&(c+=" "),c+=a)}else for(a in i)i[a]&&(c&&(c+=" "),c+=a);return c}function jz(){for(var i,n,a=0,c="",f=arguments.length;a<f;a++)(i=arguments[a])&&(n=GL(i))&&(c&&(c+=" "),c+=n);return c}function $L(i){return typeof i=="object"?jz(i):i??""}const Ww=[...` 	
\r\f \v\uFEFF`];function Nz(i,n,a){var c=i==null?"":""+i;if(n&&(c=c?c+" "+n:n),a){for(var f in a)if(a[f])c=c?c+" "+f:f;else if(c.length)for(var y=f.length,e=0;(e=c.indexOf(f,e))>=0;){var l=e+y;(e===0||Ww.includes(c[e-1]))&&(l===c.length||Ww.includes(c[l]))?c=(e===0?"":c.substring(0,e))+c.substring(l+1):e=l}}return c===""?null:c}function Yw(i,n=!1){var a=n?" !important;":";",c="";for(var f in i){var y=i[f];y!=null&&y!==""&&(c+=" "+f+": "+y+a)}return c}function b0(i){return i[0]!=="-"||i[1]!=="-"?i.toLowerCase():i}function Fz(i,n){if(n){var a="",c,f;if(Array.isArray(n)?(c=n[0],f=n[1]):c=n,i){i=String(i).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var y=!1,e=0,l=!1,_=[];c&&_.push(...Object.keys(c).map(b0)),f&&_.push(...Object.keys(f).map(b0));var w=0,R=-1;const q=i.length;for(var C=0;C<q;C++){var I=i[C];if(l?I==="/"&&i[C-1]==="*"&&(l=!1):y?y===I&&(y=!1):I==="/"&&i[C+1]==="*"?l=!0:I==='"'||I==="'"?y=I:I==="("?e++:I===")"&&e--,!l&&y===!1&&e===0){if(I===":"&&R===-1)R=C;else if(I===";"||C===q-1){if(R!==-1){var L=b0(i.substring(w,R).trim());if(!_.includes(L)){I!==";"&&C++;var O=i.substring(w,C).trim();a+=" "+O+";"}}w=C+1,R=-1}}}}return c&&(a+=Yw(c)),f&&(a+=Yw(f,!0)),a=a.trim(),a===""?null:a}return i==null?null:String(i)}function ZL(i,n,a,c,f,y){var e=i.__className;if(e!==a||e===void 0){var l=Nz(a,c,y);l==null?i.removeAttribute("class"):n?i.className=l:i.setAttribute("class",l),i.__className=a}else if(y&&f!==y)for(var _ in y){var w=!!y[_];(f==null||w!==!!f[_])&&i.classList.toggle(_,w)}return y}function v0(i,n={},a,c){for(var f in a){var y=a[f];n[f]!==y&&(a[f]==null?i.style.removeProperty(f):i.style.setProperty(f,y,c))}}function HL(i,n,a,c){var f=i.__style;if(f!==n){var y=Fz(n,c);y==null?i.removeAttribute("style"):i.style.cssText=y,i.__style=n}else c&&(Array.isArray(c)?(v0(i,a?.[0],c[0]),v0(i,a?.[1],c[1],"important")):v0(i,a,c));return c}function lx(i,n,a=!1){if(i.multiple){if(n==null)return;if(!Gb(n))return ZM();for(var c of i.options)c.selected=n.includes(Jw(c));return}for(c of i.options){var f=Jw(c);if(dz(f,n)){c.selected=!0;return}}(!a||n!==void 0)&&(i.selectedIndex=-1)}function qz(i){var n=new MutationObserver(()=>{lx(i,i.__value)});n.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Yb(()=>{n.disconnect()})}function Jw(i){return"__value"in i?i.__value:i.value}const th=Symbol("class"),rh=Symbol("style"),XL=Symbol("is custom element"),WL=Symbol("is html");function Kz(i,n){n?i.hasAttribute("selected")||i.setAttribute("selected",""):i.removeAttribute("selected")}function $l(i,n,a,c){var f=YL(i);f[n]!==(f[n]=a)&&(n==="loading"&&(i[RM]=a),a==null?i.removeAttribute(n):typeof a!="string"&&jx(i).includes(n)?i[n]=a:i.setAttribute(n,a))}function Gz(i,n,a){var c=Fr,f=Or;An(null),Kn(null);try{n!=="style"&&(ux.has(i.getAttribute("is")||i.nodeName)||!customElements||customElements.get(i.getAttribute("is")||i.tagName.toLowerCase())?jx(i).includes(n):a&&typeof a=="object")?i[n]=a:$l(i,n,a==null?a:String(a))}finally{An(c),Kn(f)}}function $z(i,n,a,c,f=!1,y=!1){var e=YL(i),l=e[XL],_=!e[WL],w=n||{},R=i.tagName==="OPTION";for(var C in n)C in a||(a[C]=null);a.class?a.class=$L(a.class):a[th]&&(a.class=null),a[rh]&&(a.style??=null);var I=jx(i);for(const Q in a){let Be=a[Q];if(R&&Q==="value"&&Be==null){i.value=i.__value="",w[Q]=Be;continue}if(Q==="class"){var L=i.namespaceURI==="http://www.w3.org/1999/xhtml";ZL(i,L,Be,c,n?.[th],a[th]),w[Q]=Be,w[th]=a[th];continue}if(Q==="style"){HL(i,Be,n?.[rh],a[rh]),w[Q]=Be,w[rh]=a[rh];continue}var O=w[Q];if(!(Be===O&&!(Be===void 0&&i.hasAttribute(Q)))){w[Q]=Be;var q=Q[0]+Q[1];if(q!=="$$")if(q==="on"){const we={},ze="$$"+Q;let et=Q.slice(2);var G=Rz(et);if(Ez(et)&&(et=et.slice(0,-7),we.capture=!0),!G&&O){if(Be!=null)continue;i.removeEventListener(et,w[ze],we),w[ze]=null}if(Be!=null)if(G)i[`__${et}`]=Be,Vx([et]);else{let gt=function(st){w[Q].call(this,st)};var he=gt;w[ze]=jL(et,i,gt,we)}else G&&(i[`__${et}`]=void 0)}else if(Q==="style")$l(i,Q,Be);else if(Q==="autofocus")hz(i,!!Be);else if(!l&&(Q==="__value"||Q==="value"&&Be!=null))i.value=i.__value=Be;else if(Q==="selected"&&R)Kz(i,Be);else{var j=Q;_||(j=Tz(j));var ne=j==="defaultValue"||j==="defaultChecked";if(Be==null&&!l&&!ne)if(e[Q]=null,j==="value"||j==="checked"){let we=i;const ze=n===void 0;if(j==="value"){let et=we.defaultValue;we.removeAttribute(j),we.defaultValue=et,we.value=we.__value=ze?et:null}else{let et=we.defaultChecked;we.removeAttribute(j),we.defaultChecked=et,we.checked=ze?et:!1}}else i.removeAttribute(Q);else ne||I.includes(j)&&(l||typeof Be!="string")?(i[j]=Be,j in e&&(e[j]=on)):typeof Be!="function"&&$l(i,j,Be)}}}return w}function Bp(i,n,a=[],c=[],f,y=!1,e=!1){gL(a,c,l=>{var _=void 0,w={},R=i.nodeName==="SELECT",C=!1;if(Ga(()=>{var L=n(...l.map(Ie)),O=$z(i,_,L,f,y,e);C&&R&&"value"in L&&lx(i,L.value);for(let G of Object.getOwnPropertySymbols(w))L[G]||Dn(w[G]);for(let G of Object.getOwnPropertySymbols(L)){var q=L[G];G.description===$M&&(!_||q!==_[G])&&(w[G]&&Dn(w[G]),w[G]=En(()=>KL(i,()=>q))),O[G]=q}_=O}),R){var I=i;Jb(()=>{lx(I,_.value,!0),qz(I)})}C=!0})}function YL(i){return i.__attributes??={[XL]:i.nodeName.includes("-"),[WL]:i.namespaceURI===KM}}var ux=new Map;function jx(i){var n=i.getAttribute("is")||i.nodeName,a=ux.get(n);if(a)return a;ux.set(n,a=[]);for(var c,f=i,y=Element.prototype;y!==f;){c=tL(f);for(var e in c)c[e].set&&a.push(e);f=Cx(f)}return a}function ev(i,n,a){var c=Va(i,n);c&&c.set&&(i[n]=a,Yb(()=>{i[n]=null}))}function Qw(i,n){return i===n||i?.[aa]===n}function JL(i={},n,a,c){return Jb(()=>{var f,y;return zx(()=>{f=y,y=[],us(()=>{i!==a(...y)&&(n(i,...y),f&&Qw(a(...f),i)&&n(null,...f))})}),()=>{qa(()=>{y&&Qw(a(...y),i)&&n(null,...y)})}}),i}function Ob(i){return function(...n){var a=n[0];return a.preventDefault(),i?.apply(this,n)}}function lm(i=!1){const n=Ai,a=n.l.u;if(!a)return;let c=()=>qs(n.s);if(i){let f=0,y={};const e=om(()=>{let l=!1;const _=n.s;for(const w in _)_[w]!==y[w]&&(y[w]=_[w],l=!0);return l&&f++,f});c=()=>Ie(e)}a.b.length&&SL(()=>{eE(n,c),Q0(a.b)}),bi(()=>{const f=us(()=>a.m.map(wM));return()=>{for(const y of f)typeof y=="function"&&y()}}),a.a.length&&bi(()=>{eE(n,c),Q0(a.a)})}function eE(i,n){if(i.l.s)for(const a of i.l.s)Ie(a);n()}let Ay=!1;function Zz(i){var n=Ay;try{return Ay=!1,[i(),Ay]}finally{Ay=n}}const Hz={get(i,n){if(!i.exclude.includes(n))return i.props[n]},set(i,n){return!1},getOwnPropertyDescriptor(i,n){if(!i.exclude.includes(n)&&n in i.props)return{enumerable:!0,configurable:!0,value:i.props[n]}},has(i,n){return i.exclude.includes(n)?!1:n in i.props},ownKeys(i){return Reflect.ownKeys(i.props).filter(n=>!i.exclude.includes(n))}};function QL(i,n,a){return new Proxy({props:i,exclude:n},Hz)}const Xz={get(i,n){if(!i.exclude.includes(n))return Ie(i.version),n in i.special?i.special[n]():i.props[n]},set(i,n,a){if(!(n in i.special)){var c=Or;try{Kn(i.parent_effect),i.special[n]=Ct({get[n](){return i.props[n]}},n,oL)}finally{Kn(c)}}return i.special[n](a),qw(i.version),!0},getOwnPropertyDescriptor(i,n){if(!i.exclude.includes(n)&&n in i.props)return{enumerable:!0,configurable:!0,value:i.props[n]}},deleteProperty(i,n){return i.exclude.includes(n)||(i.exclude.push(n),qw(i.version)),!0},has(i,n){return i.exclude.includes(n)?!1:n in i.props},ownKeys(i){return Reflect.ownKeys(i.props).filter(n=>!i.exclude.includes(n))}};function cx(i,n){return new Proxy({props:i,exclude:n,special:{},version:Lo(0),parent_effect:Or},Xz)}const Wz={get(i,n){let a=i.props.length;for(;a--;){let c=i.props[a];if(eh(c)&&(c=c()),typeof c=="object"&&c!==null&&n in c)return c[n]}},set(i,n,a){let c=i.props.length;for(;c--;){let f=i.props[c];eh(f)&&(f=f());const y=Va(f,n);if(y&&y.set)return y.set(a),!0}return!1},getOwnPropertyDescriptor(i,n){let a=i.props.length;for(;a--;){let c=i.props[a];if(eh(c)&&(c=c()),typeof c=="object"&&c!==null&&n in c){const f=Va(c,n);return f&&!f.configurable&&(f.configurable=!0),f}}},has(i,n){if(n===aa||n===nL)return!1;for(let a of i.props)if(eh(a)&&(a=a()),a!=null&&n in a)return!0;return!1},ownKeys(i){const n=[];for(let a of i.props)if(eh(a)&&(a=a()),!!a){for(const c in a)n.includes(c)||n.push(c);for(const c of Object.getOwnPropertySymbols(a))n.includes(c)||n.push(c)}return n}};function dx(...i){return new Proxy({props:i},Wz)}function Ct(i,n,a,c){var f=!qp||(a&UM)!==0,y=(a&jM)!==0,e=(a&NM)!==0,l=c,_=!0,w=()=>(_&&(_=!1,l=e?us(c):c),l),R;if(y){var C=aa in i||nL in i;R=Va(i,n)?.set??(C&&n in i?he=>i[n]=he:void 0)}var I,L=!1;y?[I,L]=Zz(()=>i[n]):I=i[n],I===void 0&&c!==void 0&&(I=w(),R&&(f&&LM(),R(I)));var O;if(f?O=()=>{var he=i[n];return he===void 0?w():(_=!0,he)}:O=()=>{var he=i[n];return he!==void 0&&(l=void 0),he===void 0?l:he},f&&(a&oL)===0)return O;if(R){var q=i.$$legacy;return(function(he,Q){return arguments.length>0?((!f||!Q||q||L)&&R(Q?O():he),he):O()})}var G=!1,j=((a&VM)!==0?om:Qh)(()=>(G=!1,O()));y&&Ie(j);var ne=Or;return(function(he,Q){if(arguments.length>0){const Be=Q?Ie(j):f&&y?Oa(he):he;return dr(j,Be),G=!0,l!==void 0&&(l=Be),he}return _c&&G||(ne.f&hc)!==0?j.v:Ie(j)})}function px(i){Ai===null&&Dx(),qp&&Ai.l!==null?Yz(Ai).m.push(i):bi(()=>{const n=us(i);if(typeof n=="function")return n})}function jp(i){Ai===null&&Dx(),px(()=>()=>us(i))}function Yz(i){var n=i.l;return n.u??={a:[],b:[],m:[]}}const Jz="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Jz);YM();var Qz=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],e3=["difference","intersection","symmetricDifference","union"],tE=!1;class Vb extends Set{#t=new Map;#e=ti(0);#n=ti(0);#r=Na||-1;constructor(n){if(super(),n){for(var a of n)super.add(a);this.#n.v=super.size}tE||this.#o()}#a(n){return Na===this.#r?ti(n):Lo(n)}#o(){tE=!0;var n=Vb.prototype,a=Set.prototype;for(const c of Qz)n[c]=function(...f){return Ie(this.#e),a[c].apply(this,f)};for(const c of e3)n[c]=function(...f){Ie(this.#e);var y=a[c].apply(this,f);return new Vb(y)}}has(n){var a=super.has(n),c=this.#t,f=c.get(n);if(f===void 0){if(!a)return Ie(this.#e),!1;f=this.#a(!0),c.set(n,f)}return Ie(f),a}add(n){return super.has(n)||(super.add(n),dr(this.#n,super.size),Kl(this.#e)),this}delete(n){var a=super.delete(n),c=this.#t,f=c.get(n);return f!==void 0&&(c.delete(n),dr(f,!1)),a&&(dr(this.#n,super.size),Kl(this.#e)),a}clear(){if(super.size!==0){super.clear();var n=this.#t;for(var a of n.values())dr(a,!1);n.clear(),dr(this.#n,0),Kl(this.#e)}}keys(){return this.values()}values(){return Ie(this.#e),super.values()}entries(){return Ie(this.#e),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return Ie(this.#n)}}class Ub{#t=ti();get value(){return Ie(this.#t)}set value(n){dr(this.#t,n,!0)}constructor(n){this.value=n}}class t3{#t=ti();get map(){return Ie(this.#t)}set map(n){dr(this.#t,n,!0)}#e=ti(!1);get loaded(){return Ie(this.#e)}set loaded(n){dr(this.#e,n,!0)}loadedImages=new Vb;#n=ti(0);get minzoom(){return Ie(this.#n)}set minzoom(n){dr(this.#n,n,!0)}#r=ti(24);get maxzoom(){return Ie(this.#r)}set maxzoom(n){dr(this.#r,n,!0)}layerInfo=new Map;eventTracker=new WeakMap;_eventTopMost(n){let a=this.eventTracker.get(n.originalEvent);if(a!==void 0)return a;let f=n.target.queryRenderedFeatures(n.point).find(y=>this.layerInfo.get(y.layer.id)?.interactive)?.layer.id;return this.eventTracker.set(n.originalEvent,f),f}eventTopMost;markerClickManager=new p3;constructor(){this.eventTopMost=this._eventTopMost.bind(this)}}function r3(){return yc(l3)}function i3(i){gc(rD,i)}function n3(){return yc(rD)}function s3(){return yc(iD)}function eD(i){gc(iD,i)}function o3(i){gc(nD,i)}function a3(){return yc(nD)}const tD=Symbol.for("svelte-maplibre"),rD=Symbol.for("svelte-maplibre.popup-target"),l3=Symbol.for("svelte-maplibre.layer"),iD=Symbol.for("svelte-maplibre.layer-event"),nD=Symbol.for("svelte-maplibre.lng-lat");function Gp(){return yc(tD)}function u3(){return gc(tD,new t3)}function c3(){const i=new Ub(void 0),n=new Ub(void 0);return i3(i),eD(n),{marker:i,layerEvent:n}}function d3(i){return"layerType"in i&&i.layerType==="deckgl"}class p3{_handlers=new Set;add(n){this._handlers.add(n)}remove(n){this._handlers.delete(n)}handleClick(n){for(const a of this._handlers)a(n)}}function sD(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function oD(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var n=i.default;if(typeof n=="function"){var a=function c(){var f=!1;try{f=this instanceof c}catch{}return f?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};a.prototype=n.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(i).forEach(function(c){var f=Object.getOwnPropertyDescriptor(i,c);Object.defineProperty(a,c,f.get?f:{enumerable:!0,get:function(){return i[c]}})}),a}var Lb={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.9.0/LICENSE.txt
 */var f3=Lb.exports,rE;function h3(){return rE||(rE=1,(function(i,n){(function(a,c){i.exports=c()})(f3,(function(){var a={},c={};function f(e,l,_){if(c[e]=_,e==="index"){var w="var sharedModule = {}; ("+c.shared+")(sharedModule); ("+c.worker+")(sharedModule);",R={};return c.shared(R),c.index(a,R),typeof window<"u"&&a.setWorkerUrl(window.URL.createObjectURL(new Blob([w],{type:"text/javascript"}))),a}}f("shared",["exports"],(function(e){function l(o,r,s,d){return new(s||(s=Promise))((function(h,b){function x(D){try{S(d.next(D))}catch(M){b(M)}}function A(D){try{S(d.throw(D))}catch(M){b(M)}}function S(D){var M;D.done?h(D.value):(M=D.value,M instanceof s?M:new s((function(F){F(M)}))).then(x,A)}S((d=d.apply(o,r||[])).next())}))}function _(o,r){this.x=o,this.y=r}function w(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var R,C;typeof SuppressedError=="function"&&SuppressedError,_.prototype={clone(){return new _(this.x,this.y)},add(o){return this.clone()._add(o)},sub(o){return this.clone()._sub(o)},multByPoint(o){return this.clone()._multByPoint(o)},divByPoint(o){return this.clone()._divByPoint(o)},mult(o){return this.clone()._mult(o)},div(o){return this.clone()._div(o)},rotate(o){return this.clone()._rotate(o)},rotateAround(o,r){return this.clone()._rotateAround(o,r)},matMult(o){return this.clone()._matMult(o)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(o){return this.x===o.x&&this.y===o.y},dist(o){return Math.sqrt(this.distSqr(o))},distSqr(o){const r=o.x-this.x,s=o.y-this.y;return r*r+s*s},angle(){return Math.atan2(this.y,this.x)},angleTo(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith(o){return this.angleWithSep(o.x,o.y)},angleWithSep(o,r){return Math.atan2(this.x*r-this.y*o,this.x*o+this.y*r)},_matMult(o){const r=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=r,this},_add(o){return this.x+=o.x,this.y+=o.y,this},_sub(o){return this.x-=o.x,this.y-=o.y,this},_mult(o){return this.x*=o,this.y*=o,this},_div(o){return this.x/=o,this.y/=o,this},_multByPoint(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint(o){return this.x/=o.x,this.y/=o.y,this},_unit(){return this._div(this.mag()),this},_perp(){const o=this.y;return this.y=this.x,this.x=-o,this},_rotate(o){const r=Math.cos(o),s=Math.sin(o),d=s*this.x+r*this.y;return this.x=r*this.x-s*this.y,this.y=d,this},_rotateAround(o,r){const s=Math.cos(o),d=Math.sin(o),h=r.y+d*(this.x-r.x)+s*(this.y-r.y);return this.x=r.x+s*(this.x-r.x)-d*(this.y-r.y),this.y=h,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:_},_.convert=function(o){if(o instanceof _)return o;if(Array.isArray(o))return new _(+o[0],+o[1]);if(o.x!==void 0&&o.y!==void 0)return new _(+o.x,+o.y);throw new Error("Expected [x, y] or {x, y} point format")};var I=(function(){if(C)return R;function o(r,s,d,h){this.cx=3*r,this.bx=3*(d-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(h-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=d,this.p2y=h}return C=1,R=o,o.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,s){if(s===void 0&&(s=1e-6),r<0)return 0;if(r>1)return 1;for(var d=r,h=0;h<8;h++){var b=this.sampleCurveX(d)-r;if(Math.abs(b)<s)return d;var x=this.sampleCurveDerivativeX(d);if(Math.abs(x)<1e-6)break;d-=b/x}var A=0,S=1;for(d=r,h=0;h<20&&(b=this.sampleCurveX(d),!(Math.abs(b-r)<s));h++)r>b?A=d:S=d,d=.5*(S-A)+A;return d},solve:function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))}},R})(),L=w(I);let O,q;function G(){return O==null&&(O=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),O}function j(){if(q==null&&(q=!1,G())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let d=0;d<25;d++){const h=4*d;r.fillStyle=`rgb(${h},${h+1},${h+2})`,r.fillRect(d%5,Math.floor(d/5),1,1)}const s=r.getImageData(0,0,5,5).data;for(let d=0;d<100;d++)if(d%4!=3&&s[d]!==d){q=!0;break}}}return q||!1}var ne=1e-6,he=typeof Float32Array<"u"?Float32Array:Array;function Q(){var o=new he(9);return he!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function Be(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function we(){var o=new he(3);return he!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function ze(o){var r=o[0],s=o[1],d=o[2];return Math.sqrt(r*r+s*s+d*d)}function et(o,r,s){var d=new he(3);return d[0]=o,d[1]=r,d[2]=s,d}function gt(o,r,s){return o[0]=r[0]+s[0],o[1]=r[1]+s[1],o[2]=r[2]+s[2],o}function st(o,r,s){return o[0]=r[0]*s,o[1]=r[1]*s,o[2]=r[2]*s,o}function nt(o,r,s){var d=r[0],h=r[1],b=r[2],x=s[0],A=s[1],S=s[2];return o[0]=h*S-b*A,o[1]=b*x-d*S,o[2]=d*A-h*x,o}var rt,ee=ze;function Le(o,r,s){var d=r[0],h=r[1],b=r[2],x=r[3];return o[0]=s[0]*d+s[4]*h+s[8]*b+s[12]*x,o[1]=s[1]*d+s[5]*h+s[9]*b+s[13]*x,o[2]=s[2]*d+s[6]*h+s[10]*b+s[14]*x,o[3]=s[3]*d+s[7]*h+s[11]*b+s[15]*x,o}function de(){var o=new he(4);return he!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function me(o,r,s,d){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",b=Math.PI/360;r*=b,d*=b,s*=b;var x=Math.sin(r),A=Math.cos(r),S=Math.sin(s),D=Math.cos(s),M=Math.sin(d),F=Math.cos(d);switch(h){case"xyz":o[0]=x*D*F+A*S*M,o[1]=A*S*F-x*D*M,o[2]=A*D*M+x*S*F,o[3]=A*D*F-x*S*M;break;case"xzy":o[0]=x*D*F-A*S*M,o[1]=A*S*F-x*D*M,o[2]=A*D*M+x*S*F,o[3]=A*D*F+x*S*M;break;case"yxz":o[0]=x*D*F+A*S*M,o[1]=A*S*F-x*D*M,o[2]=A*D*M-x*S*F,o[3]=A*D*F+x*S*M;break;case"yzx":o[0]=x*D*F+A*S*M,o[1]=A*S*F+x*D*M,o[2]=A*D*M-x*S*F,o[3]=A*D*F-x*S*M;break;case"zxy":o[0]=x*D*F-A*S*M,o[1]=A*S*F+x*D*M,o[2]=A*D*M+x*S*F,o[3]=A*D*F-x*S*M;break;case"zyx":o[0]=x*D*F-A*S*M,o[1]=A*S*F+x*D*M,o[2]=A*D*M-x*S*F,o[3]=A*D*F+x*S*M;break;default:throw new Error("Unknown angle order "+h)}return o}function tt(){var o=new he(2);return he!=Float32Array&&(o[0]=0,o[1]=0),o}function yt(o,r){var s=new he(2);return s[0]=o,s[1]=r,s}we(),rt=new he(4),he!=Float32Array&&(rt[0]=0,rt[1]=0,rt[2]=0,rt[3]=0),we(),et(1,0,0),et(0,1,0),de(),de(),Q(),tt();const lt=8192;function ge(o,r,s){return r*(lt/(o.tileSize*Math.pow(2,s-o.tileID.overscaledZ)))}function Gt(o,r){return(o%r+r)%r}function Ut(o,r,s){return o*(1-s)+r*s}function Ce(o){if(o<=0)return 0;if(o>=1)return 1;const r=o*o,s=r*o;return 4*(o<.5?s:3*(o-r)+s-.75)}function ar(o,r,s,d){const h=new L(o,r,s,d);return b=>h.solve(b)}const kt=ar(.25,.1,.25,1);function er(o,r,s){return Math.min(s,Math.max(r,o))}function Ur(o,r,s){const d=s-r,h=((o-r)%d+d)%d+r;return h===r?s:h}function or(o,...r){for(const s of r)for(const d in s)o[d]=s[d];return o}let Sr=1;function Ar(o,r,s){const d={};for(const h in o)d[h]=r.call(this,o[h],h,o);return d}function Nr(o,r,s){const d={};for(const h in o)r.call(this,o[h],h,o)&&(d[h]=o[h]);return d}function rr(o){return Array.isArray(o)?o.map(rr):typeof o=="object"&&o?Ar(o,rr):o}const gr={};function ir(o){gr[o]||(typeof console<"u"&&console.warn(o),gr[o]=!0)}function qr(o,r,s){return(s.y-o.y)*(r.x-o.x)>(r.y-o.y)*(s.x-o.x)}function Vt(o){return typeof WorkerGlobalScope<"u"&&o!==void 0&&o instanceof WorkerGlobalScope}let Pr=null;function St(o){if(Pr==null){const r=o.navigator?o.navigator.userAgent:null;Pr=!!o.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return Pr}function Qt(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const nr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Tr(o,r,s,d,h){return l(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const b=new VideoFrame(o,{timestamp:0});try{const x=b?.format;if(!x||!x.startsWith("BGR")&&!x.startsWith("RGB"))throw new Error(`Unrecognized format ${x}`);const A=x.startsWith("BGR"),S=new Uint8ClampedArray(d*h*4);if(yield b.copyTo(S,(function(D,M,F,Z,H){const Y=4*Math.max(-M,0),ie=(Math.max(0,F)-F)*Z*4+Y,ae=4*Z,ye=Math.max(0,M),qe=Math.max(0,F);return{rect:{x:ye,y:qe,width:Math.min(D.width,M+Z)-ye,height:Math.min(D.height,F+H)-qe},layout:[{offset:ie,stride:ae}]}})(o,r,s,d,h)),A)for(let D=0;D<S.length;D+=4){const M=S[D];S[D]=S[D+2],S[D+2]=M}return S}finally{b.close()}}))}let $r,bt;function pi(o,r,s,d){return o.addEventListener(r,s,d),{unsubscribe:()=>{o.removeEventListener(r,s,d)}}}function Ii(o){return o*Math.PI/180}function Oe(o){return o/Math.PI*180}const vt={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Nt={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},ve="AbortError";function W(){return new Error(ve)}const J={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function se(o){return J.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))]}const _e="global-dispatcher";class Re extends Error{constructor(r,s,d,h){super(`AJAXError: ${s} (${r}): ${d}`),this.status=r,this.statusText=s,this.url=d,this.body=h}}const je=()=>Vt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ge=function(o,r){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){const d=se(o.url);if(d)return d(o,r);if(Vt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,targetMapId:_e},r)}if(!(/^file:/.test(s=o.url)||/^file:/.test(je())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(d,h){return l(this,void 0,void 0,(function*(){const b=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,cache:d.cache,referrer:je(),signal:h.signal});let x,A;d.type!=="json"||b.headers.has("Accept")||b.headers.set("Accept","application/json");try{x=yield fetch(b)}catch(D){throw new Re(0,D.message,d.url,new Blob)}if(!x.ok){const D=yield x.blob();throw new Re(x.status,x.statusText,d.url,D)}A=d.type==="arrayBuffer"||d.type==="image"?x.arrayBuffer():d.type==="json"?x.json():x.text();const S=yield A;if(h.signal.aborted)throw W();return{data:S,cacheControl:x.headers.get("Cache-Control"),expires:x.headers.get("Expires")}}))})(o,r);if(Vt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:o,mustQueue:!0,targetMapId:_e},r)}var s;return(function(d,h){return new Promise(((b,x)=>{var A;const S=new XMLHttpRequest;S.open(d.method||"GET",d.url,!0),d.type!=="arrayBuffer"&&d.type!=="image"||(S.responseType="arraybuffer");for(const D in d.headers)S.setRequestHeader(D,d.headers[D]);d.type==="json"&&(S.responseType="text",!((A=d.headers)===null||A===void 0)&&A.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=d.credentials==="include",S.onerror=()=>{x(new Error(S.statusText))},S.onload=()=>{if(!h.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let D=S.response;if(d.type==="json")try{D=JSON.parse(S.response)}catch(M){return void x(M)}b({data:D,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const D=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});x(new Re(S.status,S.statusText,d.url,D))}},h.signal.addEventListener("abort",(()=>{S.abort(),x(W())})),S.send(d.body)}))})(o,r)};function Ne(o){if(!o||o.indexOf("://")<=0||o.indexOf("data:image/")===0||o.indexOf("blob:")===0)return!0;const r=new URL(o),s=window.location;return r.protocol===s.protocol&&r.host===s.host}function Ye(o,r,s){s[o]&&s[o].indexOf(r)!==-1||(s[o]=s[o]||[],s[o].push(r))}function ht(o,r,s){if(s&&s[o]){const d=s[o].indexOf(r);d!==-1&&s[o].splice(d,1)}}class Ze{constructor(r,s={}){or(this,s),this.type=r}}class Mt extends Ze{constructor(r,s={}){super("error",or({error:r},s))}}class Ft{on(r,s){return this._listeners=this._listeners||{},Ye(r,s,this._listeners),{unsubscribe:()=>{this.off(r,s)}}}off(r,s){return ht(r,s,this._listeners),ht(r,s,this._oneTimeListeners),this}once(r,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Ye(r,s,this._oneTimeListeners),this):new Promise((d=>this.once(r,d)))}fire(r,s){typeof r=="string"&&(r=new Ze(r,s||{}));const d=r.type;if(this.listens(d)){r.target=this;const h=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const A of h)A.call(this,r);const b=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const A of b)ht(d,A,this._oneTimeListeners),A.call(this,r);const x=this._eventedParent;x&&(or(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(r))}else r instanceof Mt&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,s){return this._eventedParent=r,this._eventedParentData=s,this}}var Ke={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const hr=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Cr(o,r){const s={};for(const d in o)d!=="ref"&&(s[d]=o[d]);return hr.forEach((d=>{d in r&&(s[d]=r[d])})),s}function Ot(o,r){if(Array.isArray(o)){if(!Array.isArray(r)||o.length!==r.length)return!1;for(let s=0;s<o.length;s++)if(!Ot(o[s],r[s]))return!1;return!0}if(typeof o=="object"&&o!==null&&r!==null){if(typeof r!="object"||Object.keys(o).length!==Object.keys(r).length)return!1;for(const s in o)if(!Ot(o[s],r[s]))return!1;return!0}return o===r}function mr(o,r){o.push(r)}function ai(o,r,s){mr(s,{command:"addSource",args:[o,r[o]]})}function li(o,r,s){mr(r,{command:"removeSource",args:[o]}),s[o]=!0}function Wr(o,r,s,d){li(o,s,d),ai(o,r,s)}function fi(o,r,s){let d;for(d in o[s])if(Object.prototype.hasOwnProperty.call(o[s],d)&&d!=="data"&&!Ot(o[s][d],r[s][d]))return!1;for(d in r[s])if(Object.prototype.hasOwnProperty.call(r[s],d)&&d!=="data"&&!Ot(o[s][d],r[s][d]))return!1;return!0}function jr(o,r,s,d,h,b){o=o||{},r=r||{};for(const x in o)Object.prototype.hasOwnProperty.call(o,x)&&(Ot(o[x],r[x])||s.push({command:b,args:[d,x,r[x],h]}));for(const x in r)Object.prototype.hasOwnProperty.call(r,x)&&!Object.prototype.hasOwnProperty.call(o,x)&&(Ot(o[x],r[x])||s.push({command:b,args:[d,x,r[x],h]}))}function ei(o){return o.id}function Lr(o,r){return o[r.id]=r,o}class dt{constructor(r,s,d,h){this.message=(r?`${r}: `:"")+d,h&&(this.identifier=h),s!=null&&s.__line__&&(this.line=s.__line__)}}function Bi(o,...r){for(const s of r)for(const d in s)o[d]=s[d];return o}class Ci extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}class ki{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[d,h]of s)this.bindings[d]=h}concat(r){return new ki(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const at={kind:"null"},At={kind:"number"},yr={kind:"string"},lr={kind:"boolean"},Ni={kind:"color"},an={kind:"projectionDefinition"},Hi={kind:"object"},ur={kind:"value"},Zn={kind:"collator"},Hn={kind:"formatted"},Bn={kind:"padding"},ds={kind:"colorArray"},Xi={kind:"numberArray"},Mn={kind:"resolvedImage"},ui={kind:"variableAnchorOffsetCollection"};function Mi(o,r){return{kind:"array",itemType:o,N:r}}function Zr(o){if(o.kind==="array"){const r=Zr(o.itemType);return typeof o.N=="number"?`array<${r}, ${o.N}>`:o.itemType.kind==="value"?"array":`array<${r}>`}return o.kind}const ps=[at,At,yr,lr,Ni,an,Hn,Hi,Mi(ur),Bn,Xi,ds,Mn,ui];function zn(o,r){if(r.kind==="error")return null;if(o.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!zn(o.itemType,r.itemType))&&(typeof o.N!="number"||o.N===r.N))return null}else{if(o.kind===r.kind)return null;if(o.kind==="value"){for(const s of ps)if(!zn(s,r))return null}}return`Expected ${Zr(o)} but found ${Zr(r)} instead.`}function Zs(o,r){return r.some((s=>s.kind===o.kind))}function Te(o,r){return r.some((s=>s==="null"?o===null:s==="array"?Array.isArray(o):s==="object"?o&&!Array.isArray(o)&&typeof o=="object":s===typeof o))}function U(o,r){return o.kind==="array"&&r.kind==="array"?o.itemType.kind===r.itemType.kind&&typeof o.N=="number":o.kind===r.kind}const te=.96422,oe=.82521,ke=4/29,De=6/29,Et=3*De*De,ft=De*De*De,$t=Math.PI/180,Wt=180/Math.PI;function vr(o){return(o%=360)<0&&(o+=360),o}function zi([o,r,s,d]){let h,b;const x=Bt((.2225045*(o=Rn(o))+.7168786*(r=Rn(r))+.0606169*(s=Rn(s)))/1);o===r&&r===s?h=b=x:(h=Bt((.4360747*o+.3850649*r+.1430804*s)/te),b=Bt((.0139322*o+.0971045*r+.7141733*s)/oe));const A=116*x-16;return[A<0?0:A,500*(h-x),200*(x-b),d]}function Rn(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Bt(o){return o>ft?Math.pow(o,1/3):o/Et+ke}function P([o,r,s,d]){let h=(o+16)/116,b=isNaN(r)?h:h+r/500,x=isNaN(s)?h:h-s/200;return h=1*Ve(h),b=te*Ve(b),x=oe*Ve(x),[B(3.1338561*b-1.6168667*h-.4906146*x),B(-.9787684*b+1.9161415*h+.033454*x),B(.0719453*b-.2289914*h+1.4052427*x),d]}function B(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function Ve(o){return o>De?o*o*o:Et*(o-ke)}const ut=Object.hasOwn||function(o,r){return Object.prototype.hasOwnProperty.call(o,r)};function _r(o,r){return ut(o,r)?o[r]:void 0}function Do(o){return parseInt(o.padEnd(2,o),16)/255}function Ql(o,r){return ln(r?o/100:o,0,1)}function ln(o,r,s){return Math.min(Math.max(r,o),s)}function kr(o){return!o.some(Number.isNaN)}const Io={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function un(o,r,s){return o+s*(r-o)}function Hs(o,r,s){return o.map(((d,h)=>un(d,r[h],s)))}class Rr{constructor(r,s,d,h=1,b=!0){this.r=r,this.g=s,this.b=d,this.a=h,b||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[r,s,d,h]))}static parse(r){if(r instanceof Rr)return r;if(typeof r!="string")return;const s=(function(d){if((d=d.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=_r(Io,d);if(h){const[x,A,S]=h;return[x/255,A/255,S/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const x=d.length<6?1:2;let A=1;return[Do(d.slice(A,A+=x)),Do(d.slice(A,A+=x)),Do(d.slice(A,A+=x)),Do(d.slice(A,A+x)||"ff")]}if(d.startsWith("rgb")){const x=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(x){const[A,S,D,M,F,Z,H,Y,ie,ae,ye,qe]=x,Se=[M||" ",H||" ",ae].join("");if(Se==="  "||Se==="  /"||Se===",,"||Se===",,,"){const Me=[D,Z,ie].join(""),We=Me==="%%%"?100:Me===""?255:0;if(We){const ot=[ln(+S/We,0,1),ln(+F/We,0,1),ln(+Y/We,0,1),ye?Ql(+ye,qe):1];if(kr(ot))return ot}}return}}const b=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[x,A,S,D,M,F,Z,H,Y]=b,ie=[S||" ",M||" ",Z].join("");if(ie==="  "||ie==="  /"||ie===",,"||ie===",,,"){const ae=[+A,ln(+D,0,100),ln(+F,0,100),H?Ql(+H,Y):1];if(kr(ae))return(function([ye,qe,Se,Me]){function We(ot){const mt=(ot+ye/30)%12,Dt=qe*Math.min(Se,1-Se);return Se-Dt*Math.max(-1,Math.min(mt-3,9-mt,1))}return ye=vr(ye),qe/=100,Se/=100,[We(0),We(8),We(4),Me]})(ae)}}})(r);return s?new Rr(...s,!1):void 0}get rgb(){const{r,g:s,b:d,a:h}=this,b=h||1/0;return this.overwriteGetter("rgb",[r/b,s/b,d/b,h])}get hcl(){return this.overwriteGetter("hcl",(function(r){const[s,d,h,b]=zi(r),x=Math.sqrt(d*d+h*h);return[Math.round(1e4*x)?vr(Math.atan2(h,d)*Wt):NaN,x,s,b]})(this.rgb))}get lab(){return this.overwriteGetter("lab",zi(this.rgb))}overwriteGetter(r,s){return Object.defineProperty(this,r,{value:s}),s}toString(){const[r,s,d,h]=this.rgb;return`rgba(${[r,s,d].map((b=>Math.round(255*b))).join(",")},${h})`}static interpolate(r,s,d,h="rgb"){switch(h){case"rgb":{const[b,x,A,S]=Hs(r.rgb,s.rgb,d);return new Rr(b,x,A,S,!1)}case"hcl":{const[b,x,A,S]=r.hcl,[D,M,F,Z]=s.hcl;let H,Y;if(isNaN(b)||isNaN(D))isNaN(b)?isNaN(D)?H=NaN:(H=D,A!==1&&A!==0||(Y=M)):(H=b,F!==1&&F!==0||(Y=x));else{let Se=D-b;D>b&&Se>180?Se-=360:D<b&&b-D>180&&(Se+=360),H=b+d*Se}const[ie,ae,ye,qe]=(function([Se,Me,We,ot]){return Se=isNaN(Se)?0:Se*$t,P([We,Math.cos(Se)*Me,Math.sin(Se)*Me,ot])})([H,Y??un(x,M,d),un(A,F,d),un(S,Z,d)]);return new Rr(ie,ae,ye,qe,!1)}case"lab":{const[b,x,A,S]=P(Hs(r.lab,s.lab,d));return new Rr(b,x,A,S,!1)}}}}Rr.black=new Rr(0,0,0,1),Rr.white=new Rr(1,1,1,1),Rr.transparent=new Rr(0,0,0,0),Rr.red=new Rr(1,0,0,1);class ca{constructor(r,s,d){this.sensitivity=r?s?"variant":"case":s?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const $e=["bottom","center","top"];class Za{constructor(r,s,d,h,b,x){this.text=r,this.image=s,this.scale=d,this.fontStack=h,this.textColor=b,this.verticalAlign=x}}class On{constructor(r){this.sections=r}static fromString(r){return new On([new Za(r,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((r=>r.text.length!==0||r.image&&r.image.name.length!==0))}static factory(r){return r instanceof On?r:On.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map((r=>r.text)).join("")}}class cn{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof cn)return r;if(typeof r=="number")return new cn([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const s of r)if(typeof s!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new cn(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,s,d){return new cn(Hs(r.values,s.values,d))}}class Wi{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Wi)return r;if(typeof r=="number")return new Wi([r]);if(Array.isArray(r)){for(const s of r)if(typeof s!="number")return;return new Wi(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,s,d){return new Wi(Hs(r.values,s.values,d))}}class dn{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof dn)return r;if(typeof r=="string"){const d=Rr.parse(r);return d?new dn([d]):void 0}if(!Array.isArray(r))return;const s=[];for(const d of r){if(typeof d!="string")return;const h=Rr.parse(d);if(!h)return;s.push(h)}return new dn(s)}toString(){return JSON.stringify(this.values)}static interpolate(r,s,d,h="rgb"){const b=[];if(r.values.length!=s.values.length)throw new Error(`colorArray: Arrays have mismatched length (${r.values.length} vs. ${s.values.length}), cannot interpolate.`);for(let x=0;x<r.values.length;x++)b.push(Rr.interpolate(r.values[x],s.values[x],d,h));return new dn(b)}}class hi extends Error{constructor(r){super(r),this.name="RuntimeError"}toJSON(){return this.message}}const Ha=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Sn{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Sn)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let s=0;s<r.length;s+=2){const d=r[s],h=r[s+1];if(typeof d!="string"||!Ha.has(d)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new Sn(r)}}toString(){return JSON.stringify(this.values)}static interpolate(r,s,d){const h=r.values,b=s.values;if(h.length!==b.length)throw new hi(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${s.toString()}`);const x=[];for(let A=0;A<h.length;A+=2){if(h[A]!==b[A])throw new hi(`Cannot interpolate values containing mismatched anchors. from[${A}]: ${h[A]}, to[${A}]: ${b[A]}`);x.push(h[A]);const[S,D]=h[A+1],[M,F]=b[A+1];x.push([un(S,M,d),un(D,F,d)])}return new Sn(x)}}class Xn{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Xn({name:r,available:!1}):null}}class Vn{constructor(r,s,d){this.from=r,this.to=s,this.transition=d}static interpolate(r,s,d){return new Vn(r,s,d)}static parse(r){return r instanceof Vn?r:Array.isArray(r)&&r.length===3&&typeof r[0]=="string"&&typeof r[1]=="string"&&typeof r[2]=="number"?new Vn(r[0],r[1],r[2]):typeof r=="object"&&typeof r.from=="string"&&typeof r.to=="string"&&typeof r.transition=="number"?new Vn(r.from,r.to,r.transition):typeof r=="string"?new Vn(r,r,1):void 0}}function eu(o,r,s,d){return typeof o=="number"&&o>=0&&o<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[o,r,s,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[o,r,s,d]:[o,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ri(o){if(o===null||typeof o=="string"||typeof o=="boolean"||typeof o=="number"||o instanceof Vn||o instanceof Rr||o instanceof ca||o instanceof On||o instanceof cn||o instanceof Wi||o instanceof dn||o instanceof Sn||o instanceof Xn)return!0;if(Array.isArray(o)){for(const r of o)if(!ri(r))return!1;return!0}if(typeof o=="object"){for(const r in o)if(!ri(o[r]))return!1;return!0}return!1}function Ri(o){if(o===null)return at;if(typeof o=="string")return yr;if(typeof o=="boolean")return lr;if(typeof o=="number")return At;if(o instanceof Rr)return Ni;if(o instanceof Vn)return an;if(o instanceof ca)return Zn;if(o instanceof On)return Hn;if(o instanceof cn)return Bn;if(o instanceof Wi)return Xi;if(o instanceof dn)return ds;if(o instanceof Sn)return ui;if(o instanceof Xn)return Mn;if(Array.isArray(o)){const r=o.length;let s;for(const d of o){const h=Ri(d);if(s){if(s===h)continue;s=ur;break}s=h}return Mi(s||ur,r)}return Hi}function Br(o){const r=typeof o;return o===null?"":r==="string"||r==="number"||r==="boolean"?String(o):o instanceof Rr||o instanceof Vn||o instanceof On||o instanceof cn||o instanceof Wi||o instanceof dn||o instanceof Sn||o instanceof Xn?o.toString():JSON.stringify(o)}class pr{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!ri(r[1]))return s.error("invalid value");const d=r[1];let h=Ri(d);const b=s.expectedType;return h.kind!=="array"||h.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(h=b),new pr(h,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Xa={string:yr,number:At,boolean:lr,object:Hi};class xr{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let d,h=1;const b=r[0];if(b==="array"){let A,S;if(r.length>2){const D=r[1];if(typeof D!="string"||!(D in Xa)||D==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);A=Xa[D],h++}else A=ur;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);S=r[2],h++}d=Mi(A,S)}else{if(!Xa[b])throw new Error(`Types doesn't contain name = ${b}`);d=Xa[b]}const x=[];for(;h<r.length;h++){const A=s.parse(r[h],h,ur);if(!A)return null;x.push(A)}return new xr(d,x)}evaluate(r){for(let s=0;s<this.args.length;s++){const d=this.args[s].evaluate(r);if(!zn(this.type,Ri(d)))return d;if(s===this.args.length-1)throw new hi(`Expected value to be of type ${Zr(this.type)}, but found ${Zr(Ri(d))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}}const xc={"to-boolean":lr,"to-color":Ni,"to-number":At,"to-string":yr};class gn{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const d=r[0];if(!xc[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if((d==="to-boolean"||d==="to-string")&&r.length!==2)return s.error("Expected one argument.");const h=xc[d],b=[];for(let x=1;x<r.length;x++){const A=s.parse(r[x],x,ur);if(!A)return null;b.push(A)}return new gn(h,b)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let s,d;for(const h of this.args){if(s=h.evaluate(r),d=null,s instanceof Rr)return s;if(typeof s=="string"){const b=r.parseColor(s);if(b)return b}else if(Array.isArray(s)&&(d=s.length<3||s.length>4?`Invalid rgba value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:eu(s[0],s[1],s[2],s[3]),!d))return new Rr(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new hi(d||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const d of this.args){s=d.evaluate(r);const h=cn.parse(s);if(h)return h}throw new hi(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"numberArray":{let s;for(const d of this.args){s=d.evaluate(r);const h=Wi.parse(s);if(h)return h}throw new hi(`Could not parse numberArray from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"colorArray":{let s;for(const d of this.args){s=d.evaluate(r);const h=dn.parse(s);if(h)return h}throw new hi(`Could not parse colorArray from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const d of this.args){s=d.evaluate(r);const h=Sn.parse(s);if(h)return h}throw new hi(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const d of this.args){if(s=d.evaluate(r),s===null)return 0;const h=Number(s);if(!isNaN(h))return h}throw new hi(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return On.fromString(Br(this.args[0].evaluate(r)));case"resolvedImage":return Xn.fromString(Br(this.args[0].evaluate(r)));case"projectionDefinition":return this.args[0].evaluate(r);default:return Br(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}}const Xp=["Unknown","Point","LineString","Polygon"];class tu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Xp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let s=this._parseColorCache.get(r);return s||(s=Rr.parse(r),this._parseColorCache.set(r,s)),s}}class ru{constructor(r,s,d=[],h,b=new ki,x=[]){this.registry=r,this.path=d,this.key=d.map((A=>`[${A}]`)).join(""),this.scope=b,this.errors=x,this.expectedType=h,this._isConstant=s}parse(r,s,d,h,b={}){return s?this.concat(s,d,h)._parse(r,b):this._parse(r,b)}_parse(r,s){function d(h,b,x){return x==="assert"?new xr(b,[h]):x==="coerce"?new gn(b,[h]):h}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=r[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[h];if(b){let x=b.parse(r,this);if(!x)return null;if(this.expectedType){const A=this.expectedType,S=x.type;if(A.kind!=="string"&&A.kind!=="number"&&A.kind!=="boolean"&&A.kind!=="object"&&A.kind!=="array"||S.kind!=="value"){if(A.kind==="projectionDefinition"&&["string","array"].includes(S.kind)||["color","formatted","resolvedImage"].includes(A.kind)&&["value","string"].includes(S.kind)||["padding","numberArray"].includes(A.kind)&&["value","number","array"].includes(S.kind)||A.kind==="colorArray"&&["value","string","array"].includes(S.kind)||A.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(S.kind))x=d(x,A,s.typeAnnotation||"coerce");else if(this.checkSubtype(A,S))return null}else x=d(x,A,s.typeAnnotation||"assert")}if(!(x instanceof pr)&&x.type.kind!=="resolvedImage"&&this._isConstant(x)){const A=new tu;try{x=new pr(x.type,x.evaluate(A))}catch(S){return this.error(S.message),null}}return x}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,s,d){const h=typeof r=="number"?this.path.concat(r):this.path,b=d?this.scope.concat(d):this.scope;return new ru(this.registry,this._isConstant,h,s||null,b,this.errors)}error(r,...s){const d=`${this.key}${s.map((h=>`[${h}]`)).join("")}`;this.errors.push(new Ci(d,r))}checkSubtype(r,s){const d=zn(r,s);return d&&this.error(d),d}}class Wa{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const d=[];for(let b=1;b<r.length-1;b+=2){const x=r[b];if(typeof x!="string")return s.error(`Expected string, but found ${typeof x} instead.`,b);if(/[^a-zA-Z0-9_]/.test(x))return s.error("Variable names must contain only alphanumeric characters or '_'.",b);const A=s.parse(r[b+1],b+1);if(!A)return null;d.push([x,A])}const h=s.parse(r[r.length-1],r.length-1,s.expectedType,d);return h?new Wa(d,h):null}outputDefined(){return this.result.outputDefined()}}class iu{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const d=r[1];return s.scope.has(d)?new iu(d,s.scope.get(d)):s.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class Wp{constructor(r,s,d){this.type=r,this.index=s,this.input=d}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const d=s.parse(r[1],1,At),h=s.parse(r[2],2,Mi(s.expectedType||ur));return d&&h?new Wp(h.type.itemType,d,h):null}evaluate(r){const s=this.index.evaluate(r),d=this.input.evaluate(r);if(s<0)throw new hi(`Array index out of bounds: ${s} < 0.`);if(s>=d.length)throw new hi(`Array index out of bounds: ${s} > ${d.length-1}.`);if(s!==Math.floor(s))throw new hi(`Array index must be an integer, but found ${s} instead.`);return d[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class wc{constructor(r,s){this.type=lr,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const d=s.parse(r[1],1,ur),h=s.parse(r[2],2,ur);return d&&h?Zs(d.type,[lr,yr,At,at,ur])?new wc(d,h):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(d.type)} instead`):null}evaluate(r){const s=this.needle.evaluate(r),d=this.haystack.evaluate(r);if(!d)return!1;if(!Te(s,["boolean","string","number","null"]))throw new hi(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(Ri(s))} instead.`);if(!Te(d,["string","array"]))throw new hi(`Expected second argument to be of type array or string, but found ${Zr(Ri(d))} instead.`);return d.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class nu{constructor(r,s,d){this.type=At,this.needle=r,this.haystack=s,this.fromIndex=d}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 2 or 3 arguments, but found ${r.length-1} instead.`);const d=s.parse(r[1],1,ur),h=s.parse(r[2],2,ur);if(!d||!h)return null;if(!Zs(d.type,[lr,yr,At,at,ur]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(d.type)} instead`);if(r.length===4){const b=s.parse(r[3],3,At);return b?new nu(d,h,b):null}return new nu(d,h)}evaluate(r){const s=this.needle.evaluate(r),d=this.haystack.evaluate(r);if(!Te(s,["boolean","string","number","null"]))throw new hi(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(Ri(s))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(r)),Te(d,["string"])){const b=d.indexOf(s,h);return b===-1?-1:[...d.slice(0,b)].length}if(Te(d,["array"]))return d.indexOf(s,h);throw new hi(`Expected second argument to be of type array or string, but found ${Zr(Ri(d))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Xs{constructor(r,s,d,h,b,x){this.inputType=r,this.type=s,this.input=d,this.cases=h,this.outputs=b,this.otherwise=x}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return s.error("Expected an even number of arguments.");let d,h;s.expectedType&&s.expectedType.kind!=="value"&&(h=s.expectedType);const b={},x=[];for(let D=2;D<r.length-1;D+=2){let M=r[D];const F=r[D+1];Array.isArray(M)||(M=[M]);const Z=s.concat(D);if(M.length===0)return Z.error("Expected at least one branch label.");for(const Y of M){if(typeof Y!="number"&&typeof Y!="string")return Z.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return Z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return Z.error("Numeric branch labels must be integer values.");if(d){if(Z.checkSubtype(d,Ri(Y)))return null}else d=Ri(Y);if(b[String(Y)]!==void 0)return Z.error("Branch labels must be unique.");b[String(Y)]=x.length}const H=s.parse(F,D,h);if(!H)return null;h=h||H.type,x.push(H)}const A=s.parse(r[1],1,ur);if(!A)return null;const S=s.parse(r[r.length-1],r.length-1,h);return S?A.type.kind!=="value"&&s.concat(1).checkSubtype(d,A.type)?null:new Xs(d,h,A,b,x,S):null}evaluate(r){const s=this.input.evaluate(r);return(Ri(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))&&this.otherwise.outputDefined()}}class Yi{constructor(r,s,d){this.type=r,this.branches=s,this.otherwise=d}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return s.error("Expected an odd number of arguments.");let d;s.expectedType&&s.expectedType.kind!=="value"&&(d=s.expectedType);const h=[];for(let x=1;x<r.length-1;x+=2){const A=s.parse(r[x],x,lr);if(!A)return null;const S=s.parse(r[x+1],x+1,d);if(!S)return null;h.push([A,S]),d=d||S.type}const b=s.parse(r[r.length-1],r.length-1,d);if(!b)return null;if(!d)throw new Error("Can't infer output type");return new Yi(d,h,b)}evaluate(r){for(const[s,d]of this.branches)if(s.evaluate(r))return d.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,d]of this.branches)r(s),r(d);r(this.otherwise)}outputDefined(){return this.branches.every((([r,s])=>s.outputDefined()))&&this.otherwise.outputDefined()}}class da{constructor(r,s,d,h){this.type=r,this.input=s,this.beginIndex=d,this.endIndex=h}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 2 or 3 arguments, but found ${r.length-1} instead.`);const d=s.parse(r[1],1,ur),h=s.parse(r[2],2,At);if(!d||!h)return null;if(!Zs(d.type,[Mi(ur),yr,ur]))return s.error(`Expected first argument to be of type array or string, but found ${Zr(d.type)} instead`);if(r.length===4){const b=s.parse(r[3],3,At);return b?new da(d.type,d,h,b):null}return new da(d.type,d,h)}evaluate(r){const s=this.input.evaluate(r),d=this.beginIndex.evaluate(r);let h;if(this.endIndex&&(h=this.endIndex.evaluate(r)),Te(s,["string"]))return[...s].slice(d,h).join("");if(Te(s,["array"]))return s.slice(d,h);throw new hi(`Expected first argument to be of type array or string, but found ${Zr(Ri(s))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function su(o,r){const s=o.length-1;let d,h,b=0,x=s,A=0;for(;b<=x;)if(A=Math.floor((b+x)/2),d=o[A],h=o[A+1],d<=r){if(A===s||r<h)return A;b=A+1}else{if(!(d>r))throw new hi("Input is not a number.");x=A-1}return 0}class Bo{constructor(r,s,d){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[h,b]of d)this.labels.push(h),this.outputs.push(b)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");const d=s.parse(r[1],1,At);if(!d)return null;const h=[];let b=null;s.expectedType&&s.expectedType.kind!=="value"&&(b=s.expectedType);for(let x=1;x<r.length;x+=2){const A=x===1?-1/0:r[x],S=r[x+1],D=x,M=x+1;if(typeof A!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(h.length&&h[h.length-1][0]>=A)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const F=s.parse(S,M,b);if(!F)return null;b=b||F.type,h.push([A,F])}return new Bo(b,d,h)}evaluate(r){const s=this.labels,d=this.outputs;if(s.length===1)return d[0].evaluate(r);const h=this.input.evaluate(r);if(h<=s[0])return d[0].evaluate(r);const b=s.length;return h>=s[b-1]?d[b-1].evaluate(r):d[su(s,h)].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}}function Ji(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Ec,Ac,hm=(function(){if(Ac)return Ec;function o(r,s,d,h){this.cx=3*r,this.bx=3*(d-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(h-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=s,this.p2x=d,this.p2y=h}return Ac=1,Ec=o,o.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,s){if(s===void 0&&(s=1e-6),r<0)return 0;if(r>1)return 1;for(var d=r,h=0;h<8;h++){var b=this.sampleCurveX(d)-r;if(Math.abs(b)<s)return d;var x=this.sampleCurveDerivativeX(d);if(Math.abs(x)<1e-6)break;d-=b/x}var A=0,S=1;for(d=r,h=0;h<20&&(b=this.sampleCurveX(d),!(Math.abs(b-r)<s));h++)r>b?A=d:S=d,d=.5*(S-A)+A;return d},solve:function(r,s){return this.sampleCurveY(this.solveCurveX(r,s))}},Ec})(),cv=Ji(hm);class qi{constructor(r,s,d,h,b){this.type=r,this.operator=s,this.interpolation=d,this.input=h,this.labels=[],this.outputs=[];for(const[x,A]of b)this.labels.push(x),this.outputs.push(A)}static interpolationFactor(r,s,d,h){let b=0;if(r.name==="exponential")b=Ya(s,r.base,d,h);else if(r.name==="linear")b=Ya(s,1,d,h);else if(r.name==="cubic-bezier"){const x=r.controlPoints;b=new cv(x[0],x[1],x[2],x[3]).solve(Ya(s,1,d,h))}return b}static parse(r,s){let[d,h,b,...x]=r;if(!Array.isArray(h)||h.length===0)return s.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const D=h[1];if(typeof D!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:D}}else{if(h[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const D=h.slice(1);if(D.length!==4||D.some((M=>typeof M!="number"||M<0||M>1)))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:D}}}if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(b=s.parse(b,2,At),!b)return null;const A=[];let S=null;d!=="interpolate-hcl"&&d!=="interpolate-lab"||s.expectedType==ds?s.expectedType&&s.expectedType.kind!=="value"&&(S=s.expectedType):S=Ni;for(let D=0;D<x.length;D+=2){const M=x[D],F=x[D+1],Z=D+3,H=D+4;if(typeof M!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Z);if(A.length&&A[A.length-1][0]>=M)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Z);const Y=s.parse(F,H,S);if(!Y)return null;S=S||Y.type,A.push([M,Y])}return U(S,At)||U(S,an)||U(S,Ni)||U(S,Bn)||U(S,Xi)||U(S,ds)||U(S,ui)||U(S,Mi(At))?new qi(S,d,h,b,A):s.error(`Type ${Zr(S)} is not interpolatable.`)}evaluate(r){const s=this.labels,d=this.outputs;if(s.length===1)return d[0].evaluate(r);const h=this.input.evaluate(r);if(h<=s[0])return d[0].evaluate(r);const b=s.length;if(h>=s[b-1])return d[b-1].evaluate(r);const x=su(s,h),A=qi.interpolationFactor(this.interpolation,h,s[x],s[x+1]),S=d[x].evaluate(r),D=d[x+1].evaluate(r);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return un(S,D,A);case"color":return Rr.interpolate(S,D,A);case"padding":return cn.interpolate(S,D,A);case"colorArray":return dn.interpolate(S,D,A);case"numberArray":return Wi.interpolate(S,D,A);case"variableAnchorOffsetCollection":return Sn.interpolate(S,D,A);case"array":return Hs(S,D,A);case"projectionDefinition":return Vn.interpolate(S,D,A)}case"interpolate-hcl":switch(this.type.kind){case"color":return Rr.interpolate(S,D,A,"hcl");case"colorArray":return dn.interpolate(S,D,A,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Rr.interpolate(S,D,A,"lab");case"colorArray":return dn.interpolate(S,D,A,"lab")}}}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}}function Ya(o,r,s,d){const h=d-s,b=o-s;return h===0?0:r===1?b/h:(Math.pow(r,b)-1)/(Math.pow(r,h)-1)}const fs={color:Rr.interpolate,number:un,padding:cn.interpolate,numberArray:Wi.interpolate,colorArray:dn.interpolate,variableAnchorOffsetCollection:Sn.interpolate,array:Hs};class Rc{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let d=null;const h=s.expectedType;h&&h.kind!=="value"&&(d=h);const b=[];for(const A of r.slice(1)){const S=s.parse(A,1+b.length,d,void 0,{typeAnnotation:"omit"});if(!S)return null;d=d||S.type,b.push(S)}if(!d)throw new Error("No output type");const x=h&&b.some((A=>zn(h,A.type)));return new Rc(x?ur:d,b)}evaluate(r){let s,d=null,h=0;for(const b of this.args)if(h++,d=b.evaluate(r),d&&d instanceof Xn&&!d.available&&(s||(s=d.name),d=null,h===this.args.length&&(d=s)),d!==null)break;return d}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}}function Yp(o,r){return o==="=="||o==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function ou(o,r,s,d){return d.compare(r,s)===0}function lo(o,r,s){const d=o!=="=="&&o!=="!=";return class aD{constructor(b,x,A){this.type=lr,this.lhs=b,this.rhs=x,this.collator=A,this.hasUntypedArgument=b.type.kind==="value"||x.type.kind==="value"}static parse(b,x){if(b.length!==3&&b.length!==4)return x.error("Expected two or three arguments.");const A=b[0];let S=x.parse(b[1],1,ur);if(!S)return null;if(!Yp(A,S.type))return x.concat(1).error(`"${A}" comparisons are not supported for type '${Zr(S.type)}'.`);let D=x.parse(b[2],2,ur);if(!D)return null;if(!Yp(A,D.type))return x.concat(2).error(`"${A}" comparisons are not supported for type '${Zr(D.type)}'.`);if(S.type.kind!==D.type.kind&&S.type.kind!=="value"&&D.type.kind!=="value")return x.error(`Cannot compare types '${Zr(S.type)}' and '${Zr(D.type)}'.`);d&&(S.type.kind==="value"&&D.type.kind!=="value"?S=new xr(D.type,[S]):S.type.kind!=="value"&&D.type.kind==="value"&&(D=new xr(S.type,[D])));let M=null;if(b.length===4){if(S.type.kind!=="string"&&D.type.kind!=="string"&&S.type.kind!=="value"&&D.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(M=x.parse(b[3],3,Zn),!M)return null}return new aD(S,D,M)}evaluate(b){const x=this.lhs.evaluate(b),A=this.rhs.evaluate(b);if(d&&this.hasUntypedArgument){const S=Ri(x),D=Ri(A);if(S.kind!==D.kind||S.kind!=="string"&&S.kind!=="number")throw new hi(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${S.kind}, ${D.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const S=Ri(x),D=Ri(A);if(S.kind!=="string"||D.kind!=="string")return r(b,x,A)}return this.collator?s(b,x,A,this.collator.evaluate(b)):r(b,x,A)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const Ss=lo("==",(function(o,r,s){return r===s}),ou),mm=lo("!=",(function(o,r,s){return r!==s}),(function(o,r,s,d){return!ou(0,r,s,d)})),Sc=lo("<",(function(o,r,s){return r<s}),(function(o,r,s,d){return d.compare(r,s)<0})),dv=lo(">",(function(o,r,s){return r>s}),(function(o,r,s,d){return d.compare(r,s)>0})),Jp=lo("<=",(function(o,r,s){return r<=s}),(function(o,r,s,d){return d.compare(r,s)<=0})),pv=lo(">=",(function(o,r,s){return r>=s}),(function(o,r,s,d){return d.compare(r,s)>=0}));class Tc{constructor(r,s,d){this.type=Zn,this.locale=d,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const d=r[1];if(typeof d!="object"||Array.isArray(d))return s.error("Collator options argument must be an object.");const h=s.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,lr);if(!h)return null;const b=s.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,lr);if(!b)return null;let x=null;return d.locale&&(x=s.parse(d.locale,1,yr),!x)?null:new Tc(h,b,x)}evaluate(r){return new ca(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class Qp{constructor(r,s,d,h,b){this.type=yr,this.number=r,this.locale=s,this.currency=d,this.minFractionDigits=h,this.maxFractionDigits=b}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const d=s.parse(r[1],1,At);if(!d)return null;const h=r[2];if(typeof h!="object"||Array.isArray(h))return s.error("NumberFormat options argument must be an object.");let b=null;if(h.locale&&(b=s.parse(h.locale,1,yr),!b))return null;let x=null;if(h.currency&&(x=s.parse(h.currency,1,yr),!x))return null;let A=null;if(h["min-fraction-digits"]&&(A=s.parse(h["min-fraction-digits"],1,At),!A))return null;let S=null;return h["max-fraction-digits"]&&(S=s.parse(h["max-fraction-digits"],1,At),!S)?null:new Qp(d,b,x,A,S)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class Cc{constructor(r){this.type=Hn,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const d=r[1];if(!Array.isArray(d)&&typeof d=="object")return s.error("First argument must be an image or text section.");const h=[];let b=!1;for(let x=1;x<=r.length-1;++x){const A=r[x];if(b&&typeof A=="object"&&!Array.isArray(A)){b=!1;let S=null;if(A["font-scale"]&&(S=s.parse(A["font-scale"],1,At),!S))return null;let D=null;if(A["text-font"]&&(D=s.parse(A["text-font"],1,Mi(yr)),!D))return null;let M=null;if(A["text-color"]&&(M=s.parse(A["text-color"],1,Ni),!M))return null;let F=null;if(A["vertical-align"]){if(typeof A["vertical-align"]=="string"&&!$e.includes(A["vertical-align"]))return s.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${A["vertical-align"]}' instead.`);if(F=s.parse(A["vertical-align"],1,yr),!F)return null}const Z=h[h.length-1];Z.scale=S,Z.font=D,Z.textColor=M,Z.verticalAlign=F}else{const S=s.parse(r[x],1,ur);if(!S)return null;const D=S.type.kind;if(D!=="string"&&D!=="value"&&D!=="null"&&D!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,h.push({content:S,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Cc(h)}evaluate(r){return new On(this.sections.map((s=>{const d=s.content.evaluate(r);return Ri(d)===Mn?new Za("",d,null,null,null,s.verticalAlign?s.verticalAlign.evaluate(r):null):new Za(Br(d),null,s.scale?s.scale.evaluate(r):null,s.font?s.font.evaluate(r).join(","):null,s.textColor?s.textColor.evaluate(r):null,s.verticalAlign?s.verticalAlign.evaluate(r):null)})))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor),s.verticalAlign&&r(s.verticalAlign)}outputDefined(){return!1}}class Ja{constructor(r){this.type=Mn,this.input=r}static parse(r,s){if(r.length!==2)return s.error("Expected two arguments.");const d=s.parse(r[1],1,yr);return d?new Ja(d):s.error("No image name provided.")}evaluate(r){const s=this.input.evaluate(r),d=Xn.fromString(s);return d&&r.availableImages&&(d.available=r.availableImages.indexOf(s)>-1),d}eachChild(r){r(this.input)}outputDefined(){return!1}}class ef{constructor(r){this.type=At,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const d=s.parse(r[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Zr(d.type)} instead.`):new ef(d):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new hi(`Expected value to be of type string or array, but found ${Zr(Ri(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const Ts=8192;function ym(o,r){const s=(180+o[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,h=Math.pow(2,r.z);return[Math.round(s*h*Ts),Math.round(d*h*Ts)]}function tf(o,r){const s=Math.pow(2,r.z);return[(h=(o[0]/Ts+r.x)/s,360*h-180),(d=(o[1]/Ts+r.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90)];var d,h}function Qa(o,r){o[0]=Math.min(o[0],r[0]),o[1]=Math.min(o[1],r[1]),o[2]=Math.max(o[2],r[0]),o[3]=Math.max(o[3],r[1])}function au(o,r){return!(o[0]<=r[0]||o[2]>=r[2]||o[1]<=r[1]||o[3]>=r[3])}function fv(o,r,s){const d=o[0]-r[0],h=o[1]-r[1],b=o[0]-s[0],x=o[1]-s[1];return d*x-b*h==0&&d*b<=0&&h*x<=0}function kc(o,r,s,d){return(h=[d[0]-s[0],d[1]-s[1]])[0]*(b=[r[0]-o[0],r[1]-o[1]])[1]-h[1]*b[0]!=0&&!(!bm(o,r,s,d)||!bm(s,d,o,r));var h,b}function hv(o,r,s){for(const d of s)for(let h=0;h<d.length-1;++h)if(kc(o,r,d[h],d[h+1]))return!0;return!1}function el(o,r,s=!1){let d=!1;for(const A of r)for(let S=0;S<A.length-1;S++){if(fv(o,A[S],A[S+1]))return s;(b=A[S])[1]>(h=o)[1]!=(x=A[S+1])[1]>h[1]&&h[0]<(x[0]-b[0])*(h[1]-b[1])/(x[1]-b[1])+b[0]&&(d=!d)}var h,b,x;return d}function gm(o,r){for(const s of r)if(el(o,s))return!0;return!1}function rf(o,r){for(const s of o)if(!el(s,r))return!1;for(let s=0;s<o.length-1;++s)if(hv(o[s],o[s+1],r))return!1;return!0}function _m(o,r){for(const s of r)if(rf(o,s))return!0;return!1}function bm(o,r,s,d){const h=d[0]-s[0],b=d[1]-s[1],x=(o[0]-s[0])*b-h*(o[1]-s[1]),A=(r[0]-s[0])*b-h*(r[1]-s[1]);return x>0&&A<0||x<0&&A>0}function nf(o,r,s){const d=[];for(let h=0;h<o.length;h++){const b=[];for(let x=0;x<o[h].length;x++){const A=ym(o[h][x],s);Qa(r,A),b.push(A)}d.push(b)}return d}function vm(o,r,s){const d=[];for(let h=0;h<o.length;h++){const b=nf(o[h],r,s);d.push(b)}return d}function xm(o,r,s,d){if(o[0]<s[0]||o[0]>s[2]){const h=.5*d;let b=o[0]-s[0]>h?-d:s[0]-o[0]>h?d:0;b===0&&(b=o[0]-s[2]>h?-d:s[2]-o[0]>h?d:0),o[0]+=b}Qa(r,o)}function lu(o,r,s,d){const h=Math.pow(2,d.z)*Ts,b=[d.x*Ts,d.y*Ts],x=[];for(const A of o)for(const S of A){const D=[S.x+b[0],S.y+b[1]];xm(D,r,s,h),x.push(D)}return x}function wm(o,r,s,d){const h=Math.pow(2,d.z)*Ts,b=[d.x*Ts,d.y*Ts],x=[];for(const S of o){const D=[];for(const M of S){const F=[M.x+b[0],M.y+b[1]];Qa(r,F),D.push(F)}x.push(D)}if(r[2]-r[0]<=h/2){(A=r)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const S of x)for(const D of S)xm(D,r,s,h)}var A;return x}class pa{constructor(r,s){this.type=lr,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(ri(r[1])){const d=r[1];if(d.type==="FeatureCollection"){const h=[];for(const b of d.features){const{type:x,coordinates:A}=b.geometry;x==="Polygon"&&h.push(A),x==="MultiPolygon"&&h.push(...A)}if(h.length)return new pa(d,{type:"MultiPolygon",coordinates:h})}else if(d.type==="Feature"){const h=d.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new pa(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new pa(d,d)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return(function(s,d){const h=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(d.type==="Polygon"){const A=nf(d.coordinates,b,x),S=lu(s.geometry(),h,b,x);if(!au(h,b))return!1;for(const D of S)if(!el(D,A))return!1}if(d.type==="MultiPolygon"){const A=vm(d.coordinates,b,x),S=lu(s.geometry(),h,b,x);if(!au(h,b))return!1;for(const D of S)if(!gm(D,A))return!1}return!0})(r,this.geometries);if(r.geometryType()==="LineString")return(function(s,d){const h=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],x=s.canonicalID();if(d.type==="Polygon"){const A=nf(d.coordinates,b,x),S=wm(s.geometry(),h,b,x);if(!au(h,b))return!1;for(const D of S)if(!rf(D,A))return!1}if(d.type==="MultiPolygon"){const A=vm(d.coordinates,b,x),S=wm(s.geometry(),h,b,x);if(!au(h,b))return!1;for(const D of S)if(!_m(D,A))return!1}return!0})(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Em=class{constructor(o=[],r=(s,d)=>s<d?-1:s>d?1:0){if(this.data=o,this.length=this.data.length,this.compare=r,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:r,compare:s}=this,d=r[o];for(;o>0;){const h=o-1>>1,b=r[h];if(s(d,b)>=0)break;r[o]=b,o=h}r[o]=d}_down(o){const{data:r,compare:s}=this,d=this.length>>1,h=r[o];for(;o<d;){let b=1+(o<<1);const x=b+1;if(x<this.length&&s(r[x],r[b])<0&&(b=x),s(r[b],h)>=0)break;r[o]=r[b],o=b}r[o]=h}};function Am(o,r,s=0,d=o.length-1,h=Rm){for(;d>s;){if(d-s>600){const S=d-s+1,D=r-s+1,M=Math.log(S),F=.5*Math.exp(2*M/3),Z=.5*Math.sqrt(M*F*(S-F)/S)*(D-S/2<0?-1:1);Am(o,r,Math.max(s,Math.floor(r-D*F/S+Z)),Math.min(d,Math.floor(r+(S-D)*F/S+Z)),h)}const b=o[r];let x=s,A=d;for(fa(o,s,r),h(o[d],b)>0&&fa(o,s,d);x<A;){for(fa(o,x,A),x++,A--;h(o[x],b)<0;)x++;for(;h(o[A],b)>0;)A--}h(o[s],b)===0?fa(o,s,A):(A++,fa(o,A,d)),A<=r&&(s=A+1),r<=A&&(d=A-1)}}function fa(o,r,s){const d=o[r];o[r]=o[s],o[s]=d}function Rm(o,r){return o<r?-1:o>r?1:0}function Pc(o,r){if(o.length<=1)return[o];const s=[];let d,h;for(const b of o){const x=Sm(b);x!==0&&(b.area=Math.abs(x),h===void 0&&(h=x<0),h===x<0?(d&&s.push(d),d=[b]):d.push(b))}if(d&&s.push(d),r>1)for(let b=0;b<s.length;b++)s[b].length<=r||(Am(s[b],r,1,s[b].length-1,mv),s[b]=s[b].slice(0,r));return s}function mv(o,r){return r.area-o.area}function Sm(o){let r=0;for(let s,d,h=0,b=o.length,x=b-1;h<b;x=h++)s=o[h],d=o[x],r+=(d.x-s.x)*(s.y+d.y);return r}const sf=1/298.257223563,Tm=sf*(2-sf),Cm=Math.PI/180;class of{constructor(r){const s=6378.137*Cm*1e3,d=Math.cos(r*Cm),h=1/(1-Tm*(1-d*d)),b=Math.sqrt(h);this.kx=s*b*d,this.ky=s*b*h*(1-Tm)}distance(r,s){const d=this.wrap(r[0]-s[0])*this.kx,h=(r[1]-s[1])*this.ky;return Math.sqrt(d*d+h*h)}pointOnLine(r,s){let d,h,b,x,A=1/0;for(let S=0;S<r.length-1;S++){let D=r[S][0],M=r[S][1],F=this.wrap(r[S+1][0]-D)*this.kx,Z=(r[S+1][1]-M)*this.ky,H=0;F===0&&Z===0||(H=(this.wrap(s[0]-D)*this.kx*F+(s[1]-M)*this.ky*Z)/(F*F+Z*Z),H>1?(D=r[S+1][0],M=r[S+1][1]):H>0&&(D+=F/this.kx*H,M+=Z/this.ky*H)),F=this.wrap(s[0]-D)*this.kx,Z=(s[1]-M)*this.ky;const Y=F*F+Z*Z;Y<A&&(A=Y,d=D,h=M,b=S,x=H)}return{point:[d,h],index:b,t:Math.max(0,Math.min(1,x))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function af(o,r){return r[0]-o[0]}function Lc(o){return o[1]-o[0]+1}function uo(o,r){return o[1]>=o[0]&&o[1]<r}function lf(o,r){if(o[0]>o[1])return[null,null];const s=Lc(o);if(r){if(s===2)return[o,null];const h=Math.floor(s/2);return[[o[0],o[0]+h],[o[0]+h,o[1]]]}if(s===1)return[o,null];const d=Math.floor(s/2)-1;return[[o[0],o[0]+d],[o[0]+d+1,o[1]]]}function uf(o,r){if(!uo(r,o.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let d=r[0];d<=r[1];++d)Qa(s,o[d]);return s}function Kr(o){const r=[1/0,1/0,-1/0,-1/0];for(const s of o)for(const d of s)Qa(r,d);return r}function km(o){return o[0]!==-1/0&&o[1]!==-1/0&&o[2]!==1/0&&o[3]!==1/0}function cf(o,r,s){if(!km(o)||!km(r))return NaN;let d=0,h=0;return o[2]<r[0]&&(d=r[0]-o[2]),o[0]>r[2]&&(d=o[0]-r[2]),o[1]>r[3]&&(h=o[1]-r[3]),o[3]<r[1]&&(h=r[1]-o[3]),s.distance([0,0],[d,h])}function ha(o,r,s){const d=s.pointOnLine(r,o);return s.distance(o,d.point)}function df(o,r,s,d,h){const b=Math.min(ha(o,[s,d],h),ha(r,[s,d],h)),x=Math.min(ha(s,[o,r],h),ha(d,[o,r],h));return Math.min(b,x)}function yv(o,r,s,d,h){if(!uo(r,o.length)||!uo(d,s.length))return 1/0;let b=1/0;for(let x=r[0];x<r[1];++x){const A=o[x],S=o[x+1];for(let D=d[0];D<d[1];++D){const M=s[D],F=s[D+1];if(kc(A,S,M,F))return 0;b=Math.min(b,df(A,S,M,F,h))}}return b}function gv(o,r,s,d,h){if(!uo(r,o.length)||!uo(d,s.length))return NaN;let b=1/0;for(let x=r[0];x<=r[1];++x)for(let A=d[0];A<=d[1];++A)if(b=Math.min(b,h.distance(o[x],s[A])),b===0)return b;return b}function _v(o,r,s){if(el(o,r,!0))return 0;let d=1/0;for(const h of r){const b=h[0],x=h[h.length-1];if(b!==x&&(d=Math.min(d,ha(o,[x,b],s)),d===0))return d;const A=s.pointOnLine(h,o);if(d=Math.min(d,s.distance(o,A.point)),d===0)return d}return d}function bv(o,r,s,d){if(!uo(r,o.length))return NaN;for(let b=r[0];b<=r[1];++b)if(el(o[b],s,!0))return 0;let h=1/0;for(let b=r[0];b<r[1];++b){const x=o[b],A=o[b+1];for(const S of s)for(let D=0,M=S.length,F=M-1;D<M;F=D++){const Z=S[F],H=S[D];if(kc(x,A,Z,H))return 0;h=Math.min(h,df(x,A,Z,H,d))}}return h}function Pm(o,r){for(const s of o)for(const d of s)if(el(d,r,!0))return!0;return!1}function vv(o,r,s,d=1/0){const h=Kr(o),b=Kr(r);if(d!==1/0&&cf(h,b,s)>=d)return d;if(au(h,b)){if(Pm(o,r))return 0}else if(Pm(r,o))return 0;let x=1/0;for(const A of o)for(let S=0,D=A.length,M=D-1;S<D;M=S++){const F=A[M],Z=A[S];for(const H of r)for(let Y=0,ie=H.length,ae=ie-1;Y<ie;ae=Y++){const ye=H[ae],qe=H[Y];if(kc(F,Z,ye,qe))return 0;x=Math.min(x,df(F,Z,ye,qe,s))}}return x}function Lm(o,r,s,d,h,b){if(!b)return;const x=cf(uf(d,b),h,s);x<r&&o.push([x,b,[0,0]])}function Dc(o,r,s,d,h,b,x){if(!b||!x)return;const A=cf(uf(d,b),uf(h,x),s);A<r&&o.push([A,b,x])}function Ic(o,r,s,d,h=1/0){let b=Math.min(d.distance(o[0],s[0][0]),h);if(b===0)return b;const x=new Em([[0,[0,o.length-1],[0,0]]],af),A=Kr(s);for(;x.length>0;){const S=x.pop();if(S[0]>=b)continue;const D=S[1],M=r?50:100;if(Lc(D)<=M){if(!uo(D,o.length))return NaN;if(r){const F=bv(o,D,s,d);if(isNaN(F)||F===0)return F;b=Math.min(b,F)}else for(let F=D[0];F<=D[1];++F){const Z=_v(o[F],s,d);if(b=Math.min(b,Z),b===0)return 0}}else{const F=lf(D,r);Lm(x,b,d,o,A,F[0]),Lm(x,b,d,o,A,F[1])}}return b}function Bc(o,r,s,d,h,b=1/0){let x=Math.min(b,h.distance(o[0],s[0]));if(x===0)return x;const A=new Em([[0,[0,o.length-1],[0,s.length-1]]],af);for(;A.length>0;){const S=A.pop();if(S[0]>=x)continue;const D=S[1],M=S[2],F=r?50:100,Z=d?50:100;if(Lc(D)<=F&&Lc(M)<=Z){if(!uo(D,o.length)&&uo(M,s.length))return NaN;let H;if(r&&d)H=yv(o,D,s,M,h),x=Math.min(x,H);else if(r&&!d){const Y=o.slice(D[0],D[1]+1);for(let ie=M[0];ie<=M[1];++ie)if(H=ha(s[ie],Y,h),x=Math.min(x,H),x===0)return x}else if(!r&&d){const Y=s.slice(M[0],M[1]+1);for(let ie=D[0];ie<=D[1];++ie)if(H=ha(o[ie],Y,h),x=Math.min(x,H),x===0)return x}else H=gv(o,D,s,M,h),x=Math.min(x,H)}else{const H=lf(D,r),Y=lf(M,d);Dc(A,x,h,o,s,H[0],Y[0]),Dc(A,x,h,o,s,H[0],Y[1]),Dc(A,x,h,o,s,H[1],Y[0]),Dc(A,x,h,o,s,H[1],Y[1])}}return x}function pf(o){return o.type==="MultiPolygon"?o.coordinates.map((r=>({type:"Polygon",coordinates:r}))):o.type==="MultiLineString"?o.coordinates.map((r=>({type:"LineString",coordinates:r}))):o.type==="MultiPoint"?o.coordinates.map((r=>({type:"Point",coordinates:r}))):[o]}class ma{constructor(r,s){this.type=At,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(ri(r[1])){const d=r[1];if(d.type==="FeatureCollection")return new ma(d,d.features.map((h=>pf(h.geometry))).flat());if(d.type==="Feature")return new ma(d,pf(d.geometry));if("type"in d&&"coordinates"in d)return new ma(d,pf(d))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return(function(s,d){const h=s.geometry(),b=h.flat().map((S=>tf([S.x,S.y],s.canonical)));if(h.length===0)return NaN;const x=new of(b[0][1]);let A=1/0;for(const S of d){switch(S.type){case"Point":A=Math.min(A,Bc(b,!1,[S.coordinates],!1,x,A));break;case"LineString":A=Math.min(A,Bc(b,!1,S.coordinates,!0,x,A));break;case"Polygon":A=Math.min(A,Ic(b,!1,S.coordinates,x,A))}if(A===0)return A}return A})(r,this.geometries);if(r.geometryType()==="LineString")return(function(s,d){const h=s.geometry(),b=h.flat().map((S=>tf([S.x,S.y],s.canonical)));if(h.length===0)return NaN;const x=new of(b[0][1]);let A=1/0;for(const S of d){switch(S.type){case"Point":A=Math.min(A,Bc(b,!0,[S.coordinates],!1,x,A));break;case"LineString":A=Math.min(A,Bc(b,!0,S.coordinates,!0,x,A));break;case"Polygon":A=Math.min(A,Ic(b,!0,S.coordinates,x,A))}if(A===0)return A}return A})(r,this.geometries);if(r.geometryType()==="Polygon")return(function(s,d){const h=s.geometry();if(h.length===0||h[0].length===0)return NaN;const b=Pc(h,0).map((S=>S.map((D=>D.map((M=>tf([M.x,M.y],s.canonical))))))),x=new of(b[0][0][0][1]);let A=1/0;for(const S of d)for(const D of b){switch(S.type){case"Point":A=Math.min(A,Ic([S.coordinates],!1,D,x,A));break;case"LineString":A=Math.min(A,Ic(S.coordinates,!0,D,x,A));break;case"Polygon":A=Math.min(A,vv(D,S.coordinates,x,A))}if(A===0)return A}return A})(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class uu{constructor(r){this.type=ur,this.key=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const d=r[1];return d==null?s.error("Global state property must be defined."):typeof d!="string"?s.error(`Global state property must be string, but found ${typeof r[1]} instead.`):new uu(d)}evaluate(r){var s;const d=(s=r.globals)===null||s===void 0?void 0:s.globalState;return d&&Object.keys(d).length!==0?_r(d,this.key):null}eachChild(){}outputDefined(){return!1}}const tl={"==":Ss,"!=":mm,">":dv,"<":Sc,">=":pv,"<=":Jp,array:xr,at:Wp,boolean:xr,case:Yi,coalesce:Rc,collator:Tc,format:Cc,image:Ja,in:wc,"index-of":nu,interpolate:qi,"interpolate-hcl":qi,"interpolate-lab":qi,length:ef,let:Wa,literal:pr,match:Xs,number:xr,"number-format":Qp,object:xr,slice:da,step:Bo,string:xr,"to-boolean":gn,"to-color":gn,"to-number":gn,"to-string":gn,var:iu,within:pa,distance:ma,"global-state":uu};class hs{constructor(r,s,d,h){this.name=r,this.type=s,this._evaluate=d,this.args=h}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,s){const d=r[0],h=hs.definitions[d];if(!h)return s.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(h)?h[0]:h.type,x=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,A=x.filter((([D])=>!Array.isArray(D)||D.length===r.length-1));let S=null;for(const[D,M]of A){S=new ru(s.registry,Mc,s.path,null,s.scope);const F=[];let Z=!1;for(let H=1;H<r.length;H++){const Y=r[H],ie=Array.isArray(D)?D[H-1]:D.type,ae=S.parse(Y,1+F.length,ie);if(!ae){Z=!0;break}F.push(ae)}if(!Z)if(Array.isArray(D)&&D.length!==F.length)S.error(`Expected ${D.length} arguments, but found ${F.length} instead.`);else{for(let H=0;H<F.length;H++){const Y=Array.isArray(D)?D[H]:D.type,ie=F[H];S.concat(H+1).checkSubtype(Y,ie.type)}if(S.errors.length===0)return new hs(d,b,M,F)}}if(A.length===1)s.errors.push(...S.errors);else{const D=(A.length?A:x).map((([F])=>{return Z=F,Array.isArray(Z)?`(${Z.map(Zr).join(", ")})`:`(${Zr(Z.type)}...)`;var Z})).join(" | "),M=[];for(let F=1;F<r.length;F++){const Z=s.parse(r[F],1+M.length);if(!Z)return null;M.push(Zr(Z.type))}s.error(`Expected arguments of type ${D}, but found (${M.join(", ")}) instead.`)}return null}static register(r,s){hs.definitions=s;for(const d in s)r[d]=hs}}function Dm(o,[r,s,d,h]){r=r.evaluate(o),s=s.evaluate(o),d=d.evaluate(o);const b=h?h.evaluate(o):1,x=eu(r,s,d,b);if(x)throw new hi(x);return new Rr(r/255,s/255,d/255,b,!1)}function Im(o,r){return o in r}function ff(o,r){const s=r[o];return s===void 0?null:s}function ya(o){return{type:o}}function Mc(o){if(o instanceof iu)return Mc(o.boundExpression);if(o instanceof hs&&o.name==="error"||o instanceof Tc||o instanceof pa||o instanceof ma||o instanceof uu)return!1;const r=o instanceof gn||o instanceof xr;let s=!0;return o.eachChild((d=>{s=r?s&&Mc(d):s&&d instanceof pr})),!!s&&zc(o)&&Oc(o,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function zc(o){if(o instanceof hs&&(o.name==="get"&&o.args.length===1||o.name==="feature-state"||o.name==="has"&&o.args.length===1||o.name==="properties"||o.name==="geometry-type"||o.name==="id"||/^filter-/.test(o.name))||o instanceof pa||o instanceof ma)return!1;let r=!0;return o.eachChild((s=>{r&&!zc(s)&&(r=!1)})),r}function cu(o){if(o instanceof hs&&o.name==="feature-state")return!1;let r=!0;return o.eachChild((s=>{r&&!cu(s)&&(r=!1)})),r}function Oc(o,r){if(o instanceof hs&&r.indexOf(o.name)>=0)return!1;let s=!0;return o.eachChild((d=>{s&&!Oc(d,r)&&(s=!1)})),s}function Bm(o){return{result:"success",value:o}}function rl(o){return{result:"error",value:o}}function il(o){return o["property-type"]==="data-driven"||o["property-type"]==="cross-faded-data-driven"}function Mm(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function du(o){return!!o.expression&&o.expression.interpolated}function Dr(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":o===null?"null":typeof o}function Vc(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&Ri(o)===Hi}function xv(o){return o}function hf(o,r){const s=o.stops&&typeof o.stops[0][0]=="object",d=s||!(s||o.property!==void 0),h=o.type||(du(r)?"exponential":"interval"),b=(function(M){switch(M.type){case"color":return Rr.parse;case"padding":return cn.parse;case"numberArray":return Wi.parse;case"colorArray":return dn.parse;default:return null}})(r);if(b&&((o=Bi({},o)).stops&&(o.stops=o.stops.map((M=>[M[0],b(M[1])]))),o.default=b(o.default?o.default:r.default)),o.colorSpace&&(x=o.colorSpace)!=="rgb"&&x!=="hcl"&&x!=="lab")throw new Error(`Unknown color space: "${o.colorSpace}"`);var x;const A=(function(M){switch(M){case"exponential":return mf;case"interval":return Uc;case"categorical":return wv;case"identity":return Ev;default:throw new Error(`Unknown function type "${M}"`)}})(h);let S,D;if(h==="categorical"){S=Object.create(null);for(const M of o.stops)S[M[0]]=M[1];D=typeof o.stops[0][0]}if(s){const M={},F=[];for(let Y=0;Y<o.stops.length;Y++){const ie=o.stops[Y],ae=ie[0].zoom;M[ae]===void 0&&(M[ae]={zoom:ae,type:o.type,property:o.property,default:o.default,stops:[]},F.push(ae)),M[ae].stops.push([ie[0].value,ie[1]])}const Z=[];for(const Y of F)Z.push([M[Y].zoom,hf(M[Y],r)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:qi.interpolationFactor.bind(void 0,H),zoomStops:Z.map((Y=>Y[0])),evaluate:({zoom:Y},ie)=>mf({stops:Z,base:o.base},r,Y).evaluate(Y,ie)}}if(d){const M=h==="exponential"?{name:"exponential",base:o.base!==void 0?o.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:qi.interpolationFactor.bind(void 0,M),zoomStops:o.stops.map((F=>F[0])),evaluate:({zoom:F})=>A(o,r,F,S,D)}}return{kind:"source",evaluate(M,F){const Z=F&&F.properties?F.properties[o.property]:void 0;return Z===void 0?pu(o.default,r.default):A(o,r,Z,S,D)}}}function pu(o,r,s){return o!==void 0?o:r!==void 0?r:s!==void 0?s:void 0}function wv(o,r,s,d,h){return pu(typeof s===h?d[s]:void 0,o.default,r.default)}function Uc(o,r,s){if(Dr(s)!=="number")return pu(o.default,r.default);const d=o.stops.length;if(d===1||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[d-1][0])return o.stops[d-1][1];const h=su(o.stops.map((b=>b[0])),s);return o.stops[h][1]}function mf(o,r,s){const d=o.base!==void 0?o.base:1;if(Dr(s)!=="number")return pu(o.default,r.default);const h=o.stops.length;if(h===1||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[h-1][0])return o.stops[h-1][1];const b=su(o.stops.map((M=>M[0])),s),x=(function(M,F,Z,H){const Y=H-Z,ie=M-Z;return Y===0?0:F===1?ie/Y:(Math.pow(F,ie)-1)/(Math.pow(F,Y)-1)})(s,d,o.stops[b][0],o.stops[b+1][0]),A=o.stops[b][1],S=o.stops[b+1][1],D=fs[r.type]||xv;return typeof A.evaluate=="function"?{evaluate(...M){const F=A.evaluate.apply(void 0,M),Z=S.evaluate.apply(void 0,M);if(F!==void 0&&Z!==void 0)return D(F,Z,x,o.colorSpace)}}:D(A,S,x,o.colorSpace)}function Ev(o,r,s){switch(r.type){case"color":s=Rr.parse(s);break;case"formatted":s=On.fromString(s.toString());break;case"resolvedImage":s=Xn.fromString(s.toString());break;case"padding":s=cn.parse(s);break;case"colorArray":s=dn.parse(s);break;case"numberArray":s=Wi.parse(s);break;default:Dr(s)===r.type||r.type==="enum"&&r.values[s]||(s=void 0)}return pu(s,o.default,r.default)}hs.register(tl,{error:[{kind:"error"},[yr],(o,[r])=>{throw new hi(r.evaluate(o))}],typeof:[yr,[ur],(o,[r])=>Zr(Ri(r.evaluate(o)))],"to-rgba":[Mi(At,4),[Ni],(o,[r])=>{const[s,d,h,b]=r.evaluate(o).rgb;return[255*s,255*d,255*h,b]}],rgb:[Ni,[At,At,At],Dm],rgba:[Ni,[At,At,At,At],Dm],has:{type:lr,overloads:[[[yr],(o,[r])=>Im(r.evaluate(o),o.properties())],[[yr,Hi],(o,[r,s])=>Im(r.evaluate(o),s.evaluate(o))]]},get:{type:ur,overloads:[[[yr],(o,[r])=>ff(r.evaluate(o),o.properties())],[[yr,Hi],(o,[r,s])=>ff(r.evaluate(o),s.evaluate(o))]]},"feature-state":[ur,[yr],(o,[r])=>ff(r.evaluate(o),o.featureState||{})],properties:[Hi,[],o=>o.properties()],"geometry-type":[yr,[],o=>o.geometryType()],id:[ur,[],o=>o.id()],zoom:[At,[],o=>o.globals.zoom],"heatmap-density":[At,[],o=>o.globals.heatmapDensity||0],elevation:[At,[],o=>o.globals.elevation||0],"line-progress":[At,[],o=>o.globals.lineProgress||0],accumulated:[ur,[],o=>o.globals.accumulated===void 0?null:o.globals.accumulated],"+":[At,ya(At),(o,r)=>{let s=0;for(const d of r)s+=d.evaluate(o);return s}],"*":[At,ya(At),(o,r)=>{let s=1;for(const d of r)s*=d.evaluate(o);return s}],"-":{type:At,overloads:[[[At,At],(o,[r,s])=>r.evaluate(o)-s.evaluate(o)],[[At],(o,[r])=>-r.evaluate(o)]]},"/":[At,[At,At],(o,[r,s])=>r.evaluate(o)/s.evaluate(o)],"%":[At,[At,At],(o,[r,s])=>r.evaluate(o)%s.evaluate(o)],ln2:[At,[],()=>Math.LN2],pi:[At,[],()=>Math.PI],e:[At,[],()=>Math.E],"^":[At,[At,At],(o,[r,s])=>Math.pow(r.evaluate(o),s.evaluate(o))],sqrt:[At,[At],(o,[r])=>Math.sqrt(r.evaluate(o))],log10:[At,[At],(o,[r])=>Math.log(r.evaluate(o))/Math.LN10],ln:[At,[At],(o,[r])=>Math.log(r.evaluate(o))],log2:[At,[At],(o,[r])=>Math.log(r.evaluate(o))/Math.LN2],sin:[At,[At],(o,[r])=>Math.sin(r.evaluate(o))],cos:[At,[At],(o,[r])=>Math.cos(r.evaluate(o))],tan:[At,[At],(o,[r])=>Math.tan(r.evaluate(o))],asin:[At,[At],(o,[r])=>Math.asin(r.evaluate(o))],acos:[At,[At],(o,[r])=>Math.acos(r.evaluate(o))],atan:[At,[At],(o,[r])=>Math.atan(r.evaluate(o))],min:[At,ya(At),(o,r)=>Math.min(...r.map((s=>s.evaluate(o))))],max:[At,ya(At),(o,r)=>Math.max(...r.map((s=>s.evaluate(o))))],abs:[At,[At],(o,[r])=>Math.abs(r.evaluate(o))],round:[At,[At],(o,[r])=>{const s=r.evaluate(o);return s<0?-Math.round(-s):Math.round(s)}],floor:[At,[At],(o,[r])=>Math.floor(r.evaluate(o))],ceil:[At,[At],(o,[r])=>Math.ceil(r.evaluate(o))],"filter-==":[lr,[yr,ur],(o,[r,s])=>o.properties()[r.value]===s.value],"filter-id-==":[lr,[ur],(o,[r])=>o.id()===r.value],"filter-type-==":[lr,[yr],(o,[r])=>o.geometryType()===r.value],"filter-<":[lr,[yr,ur],(o,[r,s])=>{const d=o.properties()[r.value],h=s.value;return typeof d==typeof h&&d<h}],"filter-id-<":[lr,[ur],(o,[r])=>{const s=o.id(),d=r.value;return typeof s==typeof d&&s<d}],"filter->":[lr,[yr,ur],(o,[r,s])=>{const d=o.properties()[r.value],h=s.value;return typeof d==typeof h&&d>h}],"filter-id->":[lr,[ur],(o,[r])=>{const s=o.id(),d=r.value;return typeof s==typeof d&&s>d}],"filter-<=":[lr,[yr,ur],(o,[r,s])=>{const d=o.properties()[r.value],h=s.value;return typeof d==typeof h&&d<=h}],"filter-id-<=":[lr,[ur],(o,[r])=>{const s=o.id(),d=r.value;return typeof s==typeof d&&s<=d}],"filter->=":[lr,[yr,ur],(o,[r,s])=>{const d=o.properties()[r.value],h=s.value;return typeof d==typeof h&&d>=h}],"filter-id->=":[lr,[ur],(o,[r])=>{const s=o.id(),d=r.value;return typeof s==typeof d&&s>=d}],"filter-has":[lr,[ur],(o,[r])=>r.value in o.properties()],"filter-has-id":[lr,[],o=>o.id()!==null&&o.id()!==void 0],"filter-type-in":[lr,[Mi(yr)],(o,[r])=>r.value.indexOf(o.geometryType())>=0],"filter-id-in":[lr,[Mi(ur)],(o,[r])=>r.value.indexOf(o.id())>=0],"filter-in-small":[lr,[yr,Mi(ur)],(o,[r,s])=>s.value.indexOf(o.properties()[r.value])>=0],"filter-in-large":[lr,[yr,Mi(ur)],(o,[r,s])=>(function(d,h,b,x){for(;b<=x;){const A=b+x>>1;if(h[A]===d)return!0;h[A]>d?x=A-1:b=A+1}return!1})(o.properties()[r.value],s.value,0,s.value.length-1)],all:{type:lr,overloads:[[[lr,lr],(o,[r,s])=>r.evaluate(o)&&s.evaluate(o)],[ya(lr),(o,r)=>{for(const s of r)if(!s.evaluate(o))return!1;return!0}]]},any:{type:lr,overloads:[[[lr,lr],(o,[r,s])=>r.evaluate(o)||s.evaluate(o)],[ya(lr),(o,r)=>{for(const s of r)if(s.evaluate(o))return!0;return!1}]]},"!":[lr,[lr],(o,[r])=>!r.evaluate(o)],"is-supported-script":[lr,[yr],(o,[r])=>{const s=o.globals&&o.globals.isSupportedScript;return!s||s(r.evaluate(o))}],upcase:[yr,[yr],(o,[r])=>r.evaluate(o).toUpperCase()],downcase:[yr,[yr],(o,[r])=>r.evaluate(o).toLowerCase()],concat:[yr,ya(ur),(o,r)=>r.map((s=>Br(s.evaluate(o)))).join("")],"resolved-locale":[yr,[Zn],(o,[r])=>r.evaluate(o).resolvedLocale()]});class yf{constructor(r,s,d){this.expression=r,this._warningHistory={},this._evaluator=new tu,this._defaultValue=s?(function(h){if(h.type==="color"&&Vc(h.default))return new Rr(0,0,0,0);switch(h.type){case"color":return Rr.parse(h.default)||null;case"padding":return cn.parse(h.default)||null;case"numberArray":return Wi.parse(h.default)||null;case"colorArray":return dn.parse(h.default)||null;case"variableAnchorOffsetCollection":return Sn.parse(h.default)||null;case"projectionDefinition":return Vn.parse(h.default)||null;default:return h.default===void 0?null:h.default}})(s):null,this._enumValues=s&&s.type==="enum"?s.values:null,this._globalState=d}evaluateWithoutErrorHandling(r,s,d,h,b,x){return this._globalState&&(r=ga(r,this._globalState)),this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=d,this._evaluator.canonical=h,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(r,s,d,h,b,x){this._globalState&&(r=ga(r,this._globalState)),this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=d||null,this._evaluator.canonical=h,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=x||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new hi(`Expected value to be one of ${Object.keys(this._enumValues).map((S=>JSON.stringify(S))).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function jc(o){return Array.isArray(o)&&o.length>0&&typeof o[0]=="string"&&o[0]in tl}function Nc(o,r,s){const d=new ru(tl,Mc,[],r?(function(b){const x={color:Ni,string:yr,number:At,enum:yr,boolean:lr,formatted:Hn,padding:Bn,numberArray:Xi,colorArray:ds,projectionDefinition:an,resolvedImage:Mn,variableAnchorOffsetCollection:ui};return b.type==="array"?Mi(x[b.value]||ur,b.length):x[b.type]})(r):void 0),h=d.parse(o,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?Bm(new yf(h,r,s)):rl(d.errors)}class Fc{constructor(r,s,d){this.kind=r,this._styleExpression=s,this.isStateDependent=r!=="constant"&&!cu(s.expression),this.globalStateRefs=fu(s.expression),this._globalState=d}evaluateWithoutErrorHandling(r,s,d,h,b,x){return this._globalState&&(r=ga(r,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(r,s,d,h,b,x)}evaluate(r,s,d,h,b,x){return this._globalState&&(r=ga(r,this._globalState)),this._styleExpression.evaluate(r,s,d,h,b,x)}}class qc{constructor(r,s,d,h,b){this.kind=r,this.zoomStops=d,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!cu(s.expression),this.globalStateRefs=fu(s.expression),this.interpolationType=h,this._globalState=b}evaluateWithoutErrorHandling(r,s,d,h,b,x){return this._globalState&&(r=ga(r,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(r,s,d,h,b,x)}evaluate(r,s,d,h,b,x){return this._globalState&&(r=ga(r,this._globalState)),this._styleExpression.evaluate(r,s,d,h,b,x)}interpolationFactor(r,s,d){return this.interpolationType?qi.interpolationFactor(this.interpolationType,r,s,d):0}}function gf(o,r,s){const d=Nc(o,r,s);if(d.result==="error")return d;const h=d.value.expression,b=zc(h);if(!b&&!il(r))return rl([new Ci("","data expressions not supported")]);const x=Oc(h,["zoom"]);if(!x&&!Mm(r))return rl([new Ci("","zoom expressions not supported")]);const A=Gc(h);return A||x?A instanceof Ci?rl([A]):A instanceof qi&&!du(r)?rl([new Ci("",'"interpolate" expressions cannot be used with this property')]):Bm(A?new qc(b?"camera":"composite",d.value,A.labels,A instanceof qi?A.interpolation:void 0,s):new Fc(b?"constant":"source",d.value,s)):rl([new Ci("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Kc{constructor(r,s){this._parameters=r,this._specification=s,Bi(this,hf(this._parameters,this._specification))}static deserialize(r){return new Kc(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function Gc(o){let r=null;if(o instanceof Wa)r=Gc(o.result);else if(o instanceof Rc){for(const s of o.args)if(r=Gc(s),r)break}else(o instanceof Bo||o instanceof qi)&&o.input instanceof hs&&o.input.name==="zoom"&&(r=o);return r instanceof Ci||o.eachChild((s=>{const d=Gc(s);d instanceof Ci?r=d:!r&&d?r=new Ci("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&d&&r!==d&&(r=new Ci("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}function fu(o,r=new Set){return o instanceof uu&&r.add(o.key),o.eachChild((s=>{fu(s,r)})),r}function ga(o,r){const{zoom:s,heatmapDensity:d,elevation:h,lineProgress:b,isSupportedScript:x,accumulated:A}=o??{};return{zoom:s,heatmapDensity:d,elevation:h,lineProgress:b,isSupportedScript:x,accumulated:A,globalState:r}}function $c(o){if(o===!0||o===!1)return!0;if(!Array.isArray(o)||o.length===0)return!1;switch(o[0]){case"has":return o.length>=2&&o[1]!=="$id"&&o[1]!=="$type";case"in":return o.length>=3&&(typeof o[1]!="string"||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return o.length!==3||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const r of o.slice(1))if(!$c(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const Av={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hu(o,r){if(o==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};$c(o)||(o=mu(o));const s=Nc(o,Av,r);if(s.result==="error")throw new Error(s.value.map((d=>`${d.key}: ${d.message}`)).join(", "));return{filter:(d,h,b)=>s.value.evaluate(d,h,{},b),needGeometry:zm(o),getGlobalStateRefs:()=>fu(s.value.expression)}}function Rv(o,r){return o<r?-1:o>r?1:0}function zm(o){if(!Array.isArray(o))return!1;if(o[0]==="within"||o[0]==="distance")return!0;for(let r=1;r<o.length;r++)if(zm(o[r]))return!0;return!1}function mu(o){if(!o)return!0;const r=o[0];return o.length<=1?r!=="any":r==="=="?Zc(o[1],o[2],"=="):r==="!="?nl(Zc(o[1],o[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Zc(o[1],o[2],r):r==="any"?(s=o.slice(1),["any"].concat(s.map(mu))):r==="all"?["all"].concat(o.slice(1).map(mu)):r==="none"?["all"].concat(o.slice(1).map(mu).map(nl)):r==="in"?Hc(o[1],o.slice(2)):r==="!in"?nl(Hc(o[1],o.slice(2))):r==="has"?Xc(o[1]):r!=="!has"||nl(Xc(o[1]));var s}function Zc(o,r,s){switch(o){case"$type":return[`filter-type-${s}`,r];case"$id":return[`filter-id-${s}`,r];default:return[`filter-${s}`,o,r]}}function Hc(o,r){if(r.length===0)return!1;switch(o){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some((s=>typeof s!=typeof r[0]))?["filter-in-large",o,["literal",r.sort(Rv)]]:["filter-in-small",o,["literal",r]]}}function Xc(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function nl(o){return["!",o]}function yu(o){const r=typeof o;if(r==="number"||r==="boolean"||r==="string"||o==null)return JSON.stringify(o);if(Array.isArray(o)){let h="[";for(const b of o)h+=`${yu(b)},`;return`${h}]`}const s=Object.keys(o).sort();let d="{";for(let h=0;h<s.length;h++)d+=`${JSON.stringify(s[h])}:${yu(o[s[h]])},`;return`${d}}`}function Wc(o){let r="";for(const s of hr)r+=`/${yu(o[s])}`;return r}function Om(o){const r=o.value;return r?[new dt(o.key,r,"constants have been deprecated as of v8")]:[]}function Pi(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function _a(o){if(Array.isArray(o))return o.map(_a);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const r={};for(const s in o)r[s]=_a(o[s]);return r}return Pi(o)}function ms(o){const r=o.key,s=o.value,d=o.valueSpec||{},h=o.objectElementValidators||{},b=o.style,x=o.styleSpec,A=o.validateSpec;let S=[];const D=Dr(s);if(D!=="object")return[new dt(r,s,`object expected, ${D} found`)];for(const M in s){const F=M.split(".")[0],Z=_r(d,F)||d["*"];let H;if(_r(h,F))H=h[F];else if(_r(d,F))H=A;else if(h["*"])H=h["*"];else{if(!d["*"]){S.push(new dt(r,s[M],`unknown property "${M}"`));continue}H=A}S=S.concat(H({key:(r&&`${r}.`)+M,value:s[M],valueSpec:Z,style:b,styleSpec:x,object:s,objectKey:M,validateSpec:A},s))}for(const M in d)h[M]||d[M].required&&d[M].default===void 0&&s[M]===void 0&&S.push(new dt(r,s,`missing required property "${M}"`));return S}function _f(o){const r=o.value,s=o.valueSpec,d=o.style,h=o.styleSpec,b=o.key,x=o.arrayElementValidator||o.validateSpec;if(Dr(r)!=="array")return[new dt(b,r,`array expected, ${Dr(r)} found`)];if(s.length&&r.length!==s.length)return[new dt(b,r,`array length ${s.length} expected, length ${r.length} found`)];if(s["min-length"]&&r.length<s["min-length"])return[new dt(b,r,`array length at least ${s["min-length"]} expected, length ${r.length} found`)];let A={type:s.value,values:s.values};h.$version<7&&(A.function=s.function),Dr(s.value)==="object"&&(A=s.value);let S=[];for(let D=0;D<r.length;D++)S=S.concat(x({array:r,arrayIndex:D,value:r[D],valueSpec:A,validateSpec:o.validateSpec,style:d,styleSpec:h,key:`${b}[${D}]`}));return S}function Yc(o){const r=o.key,s=o.value,d=o.valueSpec;let h=Dr(s);return h==="number"&&s!=s&&(h="NaN"),h!=="number"?[new dt(r,s,`number expected, ${h} found`)]:"minimum"in d&&s<d.minimum?[new dt(r,s,`${s} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&s>d.maximum?[new dt(r,s,`${s} is greater than the maximum value ${d.maximum}`)]:[]}function bf(o){const r=o.valueSpec,s=Pi(o.value.type);let d,h,b,x={};const A=s!=="categorical"&&o.value.property===void 0,S=!A,D=Dr(o.value.stops)==="array"&&Dr(o.value.stops[0])==="array"&&Dr(o.value.stops[0][0])==="object",M=ms({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(H){if(s==="identity")return[new dt(H.key,H.value,'identity function may not have a "stops" property')];let Y=[];const ie=H.value;return Y=Y.concat(_f({key:H.key,value:ie,valueSpec:H.valueSpec,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:F})),Dr(ie)==="array"&&ie.length===0&&Y.push(new dt(H.key,ie,"array must have at least one stop")),Y},default:function(H){return H.validateSpec({key:H.key,value:H.value,valueSpec:r,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec})}}});return s==="identity"&&A&&M.push(new dt(o.key,o.value,'missing required property "property"')),s==="identity"||o.value.stops||M.push(new dt(o.key,o.value,'missing required property "stops"')),s==="exponential"&&o.valueSpec.expression&&!du(o.valueSpec)&&M.push(new dt(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(S&&!il(o.valueSpec)?M.push(new dt(o.key,o.value,"property functions not supported")):A&&!Mm(o.valueSpec)&&M.push(new dt(o.key,o.value,"zoom functions not supported"))),s!=="categorical"&&!D||o.value.property!==void 0||M.push(new dt(o.key,o.value,'"property" property is required')),M;function F(H){let Y=[];const ie=H.value,ae=H.key;if(Dr(ie)!=="array")return[new dt(ae,ie,`array expected, ${Dr(ie)} found`)];if(ie.length!==2)return[new dt(ae,ie,`array length 2 expected, length ${ie.length} found`)];if(D){if(Dr(ie[0])!=="object")return[new dt(ae,ie,`object expected, ${Dr(ie[0])} found`)];if(ie[0].zoom===void 0)return[new dt(ae,ie,"object stop key must have zoom")];if(ie[0].value===void 0)return[new dt(ae,ie,"object stop key must have value")];if(b&&b>Pi(ie[0].zoom))return[new dt(ae,ie[0].zoom,"stop zoom values must appear in ascending order")];Pi(ie[0].zoom)!==b&&(b=Pi(ie[0].zoom),h=void 0,x={}),Y=Y.concat(ms({key:`${ae}[0]`,value:ie[0],valueSpec:{zoom:{}},validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:Yc,value:Z}}))}else Y=Y.concat(Z({key:`${ae}[0]`,value:ie[0],validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec},ie));return jc(_a(ie[1]))?Y.concat([new dt(`${ae}[1]`,ie[1],"expressions are not allowed in function stops.")]):Y.concat(H.validateSpec({key:`${ae}[1]`,value:ie[1],valueSpec:r,validateSpec:H.validateSpec,style:H.style,styleSpec:H.styleSpec}))}function Z(H,Y){const ie=Dr(H.value),ae=Pi(H.value),ye=H.value!==null?H.value:Y;if(d){if(ie!==d)return[new dt(H.key,ye,`${ie} stop domain type must match previous stop domain type ${d}`)]}else d=ie;if(ie!=="number"&&ie!=="string"&&ie!=="boolean")return[new dt(H.key,ye,"stop domain value must be a number, string, or boolean")];if(ie!=="number"&&s!=="categorical"){let qe=`number expected, ${ie} found`;return il(r)&&s===void 0&&(qe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new dt(H.key,ye,qe)]}return s!=="categorical"||ie!=="number"||isFinite(ae)&&Math.floor(ae)===ae?s!=="categorical"&&ie==="number"&&h!==void 0&&ae<h?[new dt(H.key,ye,"stop domain values must appear in ascending order")]:(h=ae,s==="categorical"&&ae in x?[new dt(H.key,ye,"stop domain values must be unique")]:(x[ae]=!0,[])):[new dt(H.key,ye,`integer expected, found ${ae}`)]}}function ba(o){const r=(o.expressionContext==="property"?gf:Nc)(_a(o.value),o.valueSpec);if(r.result==="error")return r.value.map((d=>new dt(`${o.key}${d.key}`,o.value,d.message)));const s=r.value.expression||r.value._styleExpression.expression;if(o.expressionContext==="property"&&o.propertyKey==="text-font"&&!s.outputDefined())return[new dt(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if(o.expressionContext==="property"&&o.propertyType==="layout"&&!cu(s))return[new dt(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if(o.expressionContext==="filter"&&!cu(s))return[new dt(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&o.expressionContext.indexOf("cluster")===0){if(!Oc(s,["zoom","feature-state"]))return[new dt(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(o.expressionContext==="cluster-initial"&&!zc(s))return[new dt(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function sl(o){const r=o.key,s=o.value,d=Dr(s);return d!=="string"?[new dt(r,s,`color expected, ${d} found`)]:Rr.parse(String(s))?[]:[new dt(r,s,`color expected, "${s}" found`)]}function gu(o){const r=o.key,s=o.value,d=o.valueSpec,h=[];return Array.isArray(d.values)?d.values.indexOf(Pi(s))===-1&&h.push(new dt(r,s,`expected one of [${d.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(d.values).indexOf(Pi(s))===-1&&h.push(new dt(r,s,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(s)} found`)),h}function Jc(o){return $c(_a(o.value))?ba(Bi({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vf(o)}function vf(o){const r=o.value,s=o.key;if(Dr(r)!=="array")return[new dt(s,r,`array expected, ${Dr(r)} found`)];const d=o.styleSpec;let h,b=[];if(r.length<1)return[new dt(s,r,"filter array must have at least 1 element")];switch(b=b.concat(gu({key:`${s}[0]`,value:r[0],valueSpec:d.filter_operator,style:o.style,styleSpec:o.styleSpec})),Pi(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Pi(r[1])==="$type"&&b.push(new dt(s,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&b.push(new dt(s,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(h=Dr(r[1]),h!=="string"&&b.push(new dt(`${s}[1]`,r[1],`string expected, ${h} found`)));for(let x=2;x<r.length;x++)h=Dr(r[x]),Pi(r[1])==="$type"?b=b.concat(gu({key:`${s}[${x}]`,value:r[x],valueSpec:d.geometry_type,style:o.style,styleSpec:o.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&b.push(new dt(`${s}[${x}]`,r[x],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let x=1;x<r.length;x++)b=b.concat(vf({key:`${s}[${x}]`,value:r[x],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":h=Dr(r[1]),r.length!==2?b.push(new dt(s,r,`filter array for "${r[0]}" operator must have 2 elements`)):h!=="string"&&b.push(new dt(`${s}[1]`,r[1],`string expected, ${h} found`))}return b}function Vm(o,r){const s=o.key,d=o.validateSpec,h=o.style,b=o.styleSpec,x=o.value,A=o.objectKey,S=b[`${r}_${o.layerType}`];if(!S)return[];const D=A.match(/^(.*)-transition$/);if(r==="paint"&&D&&S[D[1]]&&S[D[1]].transition)return d({key:s,value:x,valueSpec:b.transition,style:h,styleSpec:b});const M=o.valueSpec||S[A];if(!M)return[new dt(s,x,`unknown property "${A}"`)];let F;if(Dr(x)==="string"&&il(M)&&!M.tokens&&(F=/^{([^}]+)}$/.exec(x)))return[new dt(s,x,`"${A}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const Z=[];return o.layerType==="symbol"&&(A==="text-field"&&h&&!h.glyphs&&Z.push(new dt(s,x,'use of "text-field" requires a style "glyphs" property')),A==="text-font"&&Vc(_a(x))&&Pi(x.type)==="identity"&&Z.push(new dt(s,x,'"text-font" does not support identity functions'))),Z.concat(d({key:o.key,value:x,valueSpec:M,style:h,styleSpec:b,expressionContext:"property",propertyType:r,propertyKey:A}))}function xf(o){return Vm(o,"paint")}function wf(o){return Vm(o,"layout")}function ol(o){let r=[];const s=o.value,d=o.key,h=o.style,b=o.styleSpec;if(Dr(s)!=="object")return[new dt(d,s,`object expected, ${Dr(s)} found`)];s.type||s.ref||r.push(new dt(d,s,'either "type" or "ref" is required'));let x=Pi(s.type);const A=Pi(s.ref);if(s.id){const S=Pi(s.id);for(let D=0;D<o.arrayIndex;D++){const M=h.layers[D];Pi(M.id)===S&&r.push(new dt(d,s.id,`duplicate layer id "${s.id}", previously used at line ${M.id.__line__}`))}}if("ref"in s){let S;["type","source","source-layer","filter","layout"].forEach((D=>{D in s&&r.push(new dt(d,s[D],`"${D}" is prohibited for ref layers`))})),h.layers.forEach((D=>{Pi(D.id)===A&&(S=D)})),S?S.ref?r.push(new dt(d,s.ref,"ref cannot reference another ref layer")):x=Pi(S.type):r.push(new dt(d,s.ref,`ref layer "${A}" not found`))}else if(x!=="background")if(s.source){const S=h.sources&&h.sources[s.source],D=S&&Pi(S.type);S?D==="vector"&&x==="raster"?r.push(new dt(d,s.source,`layer "${s.id}" requires a raster source`)):D!=="raster-dem"&&x==="hillshade"||D!=="raster-dem"&&x==="color-relief"?r.push(new dt(d,s.source,`layer "${s.id}" requires a raster-dem source`)):D==="raster"&&x!=="raster"?r.push(new dt(d,s.source,`layer "${s.id}" requires a vector source`)):D!=="vector"||s["source-layer"]?D==="raster-dem"&&x!=="hillshade"&&x!=="color-relief"?r.push(new dt(d,s.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):x!=="line"||!s.paint||!s.paint["line-gradient"]||D==="geojson"&&S.lineMetrics||r.push(new dt(d,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new dt(d,s,`layer "${s.id}" must specify a "source-layer"`)):r.push(new dt(d,s.source,`source "${s.source}" not found`))}else r.push(new dt(d,s,'missing required property "source"'));return r=r.concat(ms({key:d,value:s,valueSpec:b.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${d}.type`,value:s.type,valueSpec:b.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:s,objectKey:"type"}),filter:Jc,layout:S=>ms({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":D=>wf(Bi({layerType:x},D))}}),paint:S=>ms({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":D=>xf(Bi({layerType:x},D))}})}})),r}function va(o){const r=o.value,s=o.key,d=Dr(r);return d!=="string"?[new dt(s,r,`string expected, ${d} found`)]:[]}const Um={promoteId:function({key:o,value:r}){if(Dr(r)==="string")return va({key:o,value:r});{const s=[];for(const d in r)s.push(...va({key:`${o}.${d}`,value:r[d]}));return s}}};function jm(o){const r=o.value,s=o.key,d=o.styleSpec,h=o.style,b=o.validateSpec;if(!r.type)return[new dt(s,r,'"type" is required')];const x=Pi(r.type);let A;switch(x){case"vector":case"raster":return A=ms({key:s,value:r,valueSpec:d[`source_${x.replace("-","_")}`],style:o.style,styleSpec:d,objectElementValidators:Um,validateSpec:b}),A;case"raster-dem":return A=(function(S){var D;const M=(D=S.sourceName)!==null&&D!==void 0?D:"",F=S.value,Z=S.styleSpec,H=Z.source_raster_dem,Y=S.style;let ie=[];const ae=Dr(F);if(F===void 0)return ie;if(ae!=="object")return ie.push(new dt("source_raster_dem",F,`object expected, ${ae} found`)),ie;const ye=Pi(F.encoding)==="custom",qe=["redFactor","greenFactor","blueFactor","baseShift"],Se=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const Me in F)!ye&&qe.includes(Me)?ie.push(new dt(Me,F[Me],`In "${M}": "${Me}" is only valid when "encoding" is set to "custom". ${Se} encoding found`)):H[Me]?ie=ie.concat(S.validateSpec({key:Me,value:F[Me],valueSpec:H[Me],validateSpec:S.validateSpec,style:Y,styleSpec:Z})):ie.push(new dt(Me,F[Me],`unknown property "${Me}"`));return ie})({sourceName:s,value:r,style:o.style,styleSpec:d,validateSpec:b}),A;case"geojson":if(A=ms({key:s,value:r,valueSpec:d.source_geojson,style:h,styleSpec:d,validateSpec:b,objectElementValidators:Um}),r.cluster)for(const S in r.clusterProperties){const[D,M]=r.clusterProperties[S],F=typeof D=="string"?[D,["accumulated"],["get",S]]:D;A.push(...ba({key:`${s}.${S}.map`,value:M,expressionContext:"cluster-map"})),A.push(...ba({key:`${s}.${S}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return A;case"video":return ms({key:s,value:r,valueSpec:d.source_video,style:h,validateSpec:b,styleSpec:d});case"image":return ms({key:s,value:r,valueSpec:d.source_image,style:h,validateSpec:b,styleSpec:d});case"canvas":return[new dt(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return gu({key:`${s}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Nm(o){const r=o.value,s=o.styleSpec,d=s.light,h=o.style;let b=[];const x=Dr(r);if(r===void 0)return b;if(x!=="object")return b=b.concat([new dt("light",r,`object expected, ${x} found`)]),b;for(const A in r){const S=A.match(/^(.*)-transition$/);b=b.concat(S&&d[S[1]]&&d[S[1]].transition?o.validateSpec({key:A,value:r[A],valueSpec:s.transition,validateSpec:o.validateSpec,style:h,styleSpec:s}):d[A]?o.validateSpec({key:A,value:r[A],valueSpec:d[A],validateSpec:o.validateSpec,style:h,styleSpec:s}):[new dt(A,r[A],`unknown property "${A}"`)])}return b}function Fm(o){const r=o.value,s=o.styleSpec,d=s.sky,h=o.style,b=Dr(r);if(r===void 0)return[];if(b!=="object")return[new dt("sky",r,`object expected, ${b} found`)];let x=[];for(const A in r)x=x.concat(d[A]?o.validateSpec({key:A,value:r[A],valueSpec:d[A],style:h,styleSpec:s}):[new dt(A,r[A],`unknown property "${A}"`)]);return x}function qm(o){const r=o.value,s=o.styleSpec,d=s.terrain,h=o.style;let b=[];const x=Dr(r);if(r===void 0)return b;if(x!=="object")return b=b.concat([new dt("terrain",r,`object expected, ${x} found`)]),b;for(const A in r)b=b.concat(d[A]?o.validateSpec({key:A,value:r[A],valueSpec:d[A],validateSpec:o.validateSpec,style:h,styleSpec:s}):[new dt(A,r[A],`unknown property "${A}"`)]);return b}function al(o){let r=[];const s=o.value,d=o.key;if(Array.isArray(s)){const h=[],b=[];for(const x in s)s[x].id&&h.includes(s[x].id)&&r.push(new dt(d,s,`all the sprites' ids must be unique, but ${s[x].id} is duplicated`)),h.push(s[x].id),s[x].url&&b.includes(s[x].url)&&r.push(new dt(d,s,`all the sprites' URLs must be unique, but ${s[x].url} is duplicated`)),b.push(s[x].url),r=r.concat(ms({key:`${d}[${x}]`,value:s[x],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return r}return va({key:d,value:s})}function ll(o){return r=o.value,r&&r.constructor===Object?[]:[new dt(o.key,o.value,`object expected, ${Dr(o.value)} found`)];var r}const Un={"*":()=>[],array:_f,boolean:function(o){const r=o.value,s=o.key,d=Dr(r);return d!=="boolean"?[new dt(s,r,`boolean expected, ${d} found`)]:[]},number:Yc,color:sl,constants:Om,enum:gu,filter:Jc,function:bf,layer:ol,object:ms,source:jm,light:Nm,sky:Fm,terrain:qm,projection:function(o){const r=o.value,s=o.styleSpec,d=s.projection,h=o.style,b=Dr(r);if(r===void 0)return[];if(b!=="object")return[new dt("projection",r,`object expected, ${b} found`)];let x=[];for(const A in r)x=x.concat(d[A]?o.validateSpec({key:A,value:r[A],valueSpec:d[A],style:h,styleSpec:s}):[new dt(A,r[A],`unknown property "${A}"`)]);return x},projectionDefinition:function(o){const r=o.key;let s=o.value;s=s instanceof String?s.valueOf():s;const d=Dr(s);return d!=="array"||(function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"})(s)||(function(h){return!!["interpolate","step","literal"].includes(h[0])})(s)?["array","string"].includes(d)?[]:[new dt(r,s,`projection expected, invalid type "${d}" found`)]:[new dt(r,s,`projection expected, invalid array ${JSON.stringify(s)} found`)]},string:va,formatted:function(o){return va(o).length===0?[]:ba(o)},resolvedImage:function(o){return va(o).length===0?[]:ba(o)},padding:function(o){const r=o.key,s=o.value;if(Dr(s)==="array"){if(s.length<1||s.length>4)return[new dt(r,s,`padding requires 1 to 4 values; ${s.length} values found`)];const d={type:"number"};let h=[];for(let b=0;b<s.length;b++)h=h.concat(o.validateSpec({key:`${r}[${b}]`,value:s[b],validateSpec:o.validateSpec,valueSpec:d}));return h}return Yc({key:r,value:s,valueSpec:{}})},numberArray:function(o){const r=o.key,s=o.value;if(Dr(s)==="array"){const d={type:"number"};if(s.length<1)return[new dt(r,s,"array length at least 1 expected, length 0 found")];let h=[];for(let b=0;b<s.length;b++)h=h.concat(o.validateSpec({key:`${r}[${b}]`,value:s[b],validateSpec:o.validateSpec,valueSpec:d}));return h}return Yc({key:r,value:s,valueSpec:{}})},colorArray:function(o){const r=o.key,s=o.value;if(Dr(s)==="array"){if(s.length<1)return[new dt(r,s,"array length at least 1 expected, length 0 found")];let d=[];for(let h=0;h<s.length;h++)d=d.concat(sl({key:`${r}[${h}]`,value:s[h]}));return d}return sl({key:r,value:s})},variableAnchorOffsetCollection:function(o){const r=o.key,s=o.value,d=Dr(s),h=o.styleSpec;if(d!=="array"||s.length<1||s.length%2!=0)return[new dt(r,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let x=0;x<s.length;x+=2)b=b.concat(gu({key:`${r}[${x}]`,value:s[x],valueSpec:h.layout_symbol["text-anchor"]})),b=b.concat(_f({key:`${r}[${x+1}]`,value:s[x+1],valueSpec:{length:2,value:"number"},validateSpec:o.validateSpec,style:o.style,styleSpec:h}));return b},sprite:al,state:ll};function Mo(o){const r=o.value,s=o.valueSpec,d=o.styleSpec;return o.validateSpec=Mo,s.expression&&Vc(Pi(r))?bf(o):s.expression&&jc(_a(r))?ba(o):s.type&&Un[s.type]?Un[s.type](o):ms(Bi({},o,{valueSpec:s.type?d[s.type]:s}))}function Ef(o){const r=o.value,s=o.key,d=va(o);return d.length||(r.indexOf("{fontstack}")===-1&&d.push(new dt(s,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&d.push(new dt(s,r,'"glyphs" url must include a "{range}" token'))),d}function ys(o,r=Ke){let s=[];return s=s.concat(Mo({key:"",value:o,valueSpec:r.$root,styleSpec:r,style:o,validateSpec:Mo,objectElementValidators:{glyphs:Ef,"*":()=>[]}})),o.constants&&(s=s.concat(Om({key:"constants",value:o.constants}))),ul(s)}function Cs(o){return function(r){return o(Object.assign({},r,{validateSpec:Mo}))}}function ul(o){return[].concat(o).sort(((r,s)=>r.line-s.line))}function gs(o){return function(...r){return ul(o.apply(this,r))}}ys.source=gs(Cs(jm)),ys.sprite=gs(Cs(al)),ys.glyphs=gs(Cs(Ef)),ys.light=gs(Cs(Nm)),ys.sky=gs(Cs(Fm)),ys.terrain=gs(Cs(qm)),ys.state=gs(Cs(ll)),ys.layer=gs(Cs(ol)),ys.filter=gs(Cs(Jc)),ys.paintProperty=gs(Cs(xf)),ys.layoutProperty=gs(Cs(wf));const zo=ys,Sv=zo.light,Af=zo.sky,Tv=zo.paintProperty,_u=zo.layoutProperty;function Km(o,r){let s=!1;if(r&&r.length)for(const d of r)o.fire(new Mt(new Error(d.message))),s=!0;return s}class bu{constructor(r,s,d){const h=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const x=new Int32Array(this.arrayBuffer);r=x[0],this.d=(s=x[1])+2*(d=x[2]);for(let S=0;S<this.d*this.d;S++){const D=x[3+S],M=x[3+S+1];h.push(D===M?null:x.subarray(D,M))}const A=x[3+h.length+1];this.keys=x.subarray(x[3+h.length],A),this.bboxes=x.subarray(A),this.insert=this._insertReadonly}else{this.d=s+2*d;for(let x=0;x<this.d*this.d;x++)h.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=r,this.padding=d,this.scale=s/r,this.uid=0;const b=d/s*r;this.min=-b,this.max=r+b}insert(r,s,d,h,b){this._forEachCell(s,d,h,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(s),this.bboxes.push(d),this.bboxes.push(h),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,s,d,h,b,x){this.cells[b].push(x)}query(r,s,d,h,b){const x=this.min,A=this.max;if(r<=x&&s<=x&&A<=d&&A<=h&&!b)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(r,s,d,h,this._queryCell,S,{},b),S}}_queryCell(r,s,d,h,b,x,A,S){const D=this.cells[b];if(D!==null){const M=this.keys,F=this.bboxes;for(let Z=0;Z<D.length;Z++){const H=D[Z];if(A[H]===void 0){const Y=4*H;(S?S(F[Y+0],F[Y+1],F[Y+2],F[Y+3]):r<=F[Y+2]&&s<=F[Y+3]&&d>=F[Y+0]&&h>=F[Y+1])?(A[H]=!0,x.push(M[H])):A[H]=!1}}}}_forEachCell(r,s,d,h,b,x,A,S){const D=this._convertToCellCoord(r),M=this._convertToCellCoord(s),F=this._convertToCellCoord(d),Z=this._convertToCellCoord(h);for(let H=D;H<=F;H++)for(let Y=M;Y<=Z;Y++){const ie=this.d*Y+H;if((!S||S(this._convertFromCellCoord(H),this._convertFromCellCoord(Y),this._convertFromCellCoord(H+1),this._convertFromCellCoord(Y+1)))&&b.call(this,r,s,d,h,ie,x,A,S))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,s=3+this.cells.length+1+1;let d=0;for(let x=0;x<this.cells.length;x++)d+=this.cells[x].length;const h=new Int32Array(s+d+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let b=s;for(let x=0;x<r.length;x++){const A=r[x];h[3+x]=b,h.set(A,b),b+=A.length}return h[3+r.length]=b,h.set(this.keys,b),b+=this.keys.length,h[3+r.length+1]=b,h.set(this.bboxes,b),b+=this.bboxes.length,h.buffer}static serialize(r,s){const d=r.toArrayBuffer();return s&&s.push(d),{buffer:d}}static deserialize(r){return new bu(r.buffer)}}const co={};function It(o,r,s={}){if(co[o])throw new Error(`${o} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:o,writeable:!1}),co[o]={klass:r,omit:s.omit||[],shallow:s.shallow||[]}}It("Object",Object),It("Set",Set),It("TransferableGridIndex",bu),It("Color",Rr),It("Error",Error),It("AJAXError",Re),It("ResolvedImage",Xn),It("StylePropertyFunction",Kc),It("StyleExpression",yf,{omit:["_evaluator"]}),It("ZoomDependentExpression",qc),It("ZoomConstantExpression",Fc),It("CompoundExpression",hs,{omit:["_evaluate"]});for(const o in tl)tl[o]._classRegistryKey||It(`Expression_${o}`,tl[o]);function Gm(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&o.constructor.name==="ArrayBuffer")}function Rf(o){return o.$name||o.constructor._classRegistryKey}function vu(o){return!(function(r){if(r===null||typeof r!="object")return!1;const s=Rf(r);return!(!s||s==="Object")})(o)&&(o==null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||o instanceof Error||Gm(o)||Qt(o)||ArrayBuffer.isView(o)||o instanceof ImageData)}function xu(o,r){if(vu(o))return(Gm(o)||Qt(o))&&r&&r.push(o),ArrayBuffer.isView(o)&&r&&r.push(o.buffer),o instanceof ImageData&&r&&r.push(o.data.buffer),o;if(Array.isArray(o)){const b=[];for(const x of o)b.push(xu(x,r));return b}if(typeof o!="object")throw new Error("can't serialize object of type "+typeof o);const s=Rf(o);if(!s)throw new Error(`can't serialize object of unregistered class ${o.constructor.name}`);if(!co[s])throw new Error(`${s} is not registered.`);const{klass:d}=co[s],h=d.serialize?d.serialize(o,r):{};if(d.serialize){if(r&&h===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in o){if(!o.hasOwnProperty(b)||co[s].omit.indexOf(b)>=0)continue;const x=o[b];h[b]=co[s].shallow.indexOf(b)>=0?x:xu(x,r)}o instanceof Error&&(h.message=o.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(h.$name=s),h}function xa(o){if(vu(o))return o;if(Array.isArray(o))return o.map(xa);if(typeof o!="object")throw new Error("can't deserialize object of type "+typeof o);const r=Rf(o)||"Object";if(!co[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:s}=co[r];if(!s)throw new Error(`can't deserialize unregistered class ${r}`);if(s.deserialize)return s.deserialize(o);const d=Object.create(s.prototype);for(const h of Object.keys(o)){if(h==="$name")continue;const b=o[h];d[h]=co[r].shallow.indexOf(h)>=0?b:xa(b)}return d}class cl{constructor(){this.first=!0}update(r,s){const d=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=s),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=d,!0))}}const Ir={"Latin-1 Supplement":o=>o>=128&&o<=255,"Hangul Jamo":o=>o>=4352&&o<=4607,Khmer:o=>o>=6016&&o<=6143,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Kanbun:o=>o>=12688&&o<=12703,"CJK Strokes":o=>o>=12736&&o<=12783,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Hangul Syllables":o=>o>=44032&&o<=55215,"Private Use Area":o=>o>=57344&&o<=63743,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function Qc(o){for(const r of o)if(td(r.charCodeAt(0)))return!0;return!1}function $m(o){for(const r of o)if(!Zm(r.charCodeAt(0)))return!1;return!0}function ed(o){const r=o.map((s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}})).filter((s=>s));return new RegExp(r.join("|"),"u")}const Sf=ed(["Arab","Dupl","Mong","Ougr","Syrc"]);function Zm(o){return!Sf.test(String.fromCodePoint(o))}const Hm=ed(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function td(o){return!(o!==746&&o!==747&&(o<4352||!(Ir["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||Ir["CJK Compatibility"](o)||Ir["CJK Strokes"](o)||!(!Ir["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||o===12336)||Ir["Enclosed CJK Letters and Months"](o)||Ir["Ideographic Description Characters"](o)||Ir.Kanbun(o)||Ir.Katakana(o)&&o!==12540||!(!Ir["Halfwidth and Fullwidth Forms"](o)||o===65288||o===65289||o===65293||o>=65306&&o<=65310||o===65339||o===65341||o===65343||o>=65371&&o<=65503||o===65507||o>=65512&&o<=65519)||!(!Ir["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||Ir["Vertical Forms"](o)||Ir["Yijing Hexagram Symbols"](o)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(o))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(o))||Hm.test(String.fromCodePoint(o)))))}function Xm(o){return!(td(o)||(function(r){return!!(Ir["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||Ir["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||Ir["Letterlike Symbols"](r)||Ir["Number Forms"](r)||Ir["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||Ir["Control Pictures"](r)&&r!==9251||Ir["Optical Character Recognition"](r)||Ir["Enclosed Alphanumerics"](r)||Ir["Geometric Shapes"](r)||Ir["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Ir["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Ir["CJK Symbols and Punctuation"](r)||Ir.Katakana(r)||Ir["Private Use Area"](r)||Ir["CJK Compatibility Forms"](r)||Ir["Small Form Variants"](r)||Ir["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)})(o))}const Wm=ed(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Ym(o){return Wm.test(String.fromCodePoint(o))}function Jm(o,r){return!(!r&&Ym(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||Ir.Khmer(o))}function Qm(o){for(const r of o)if(Ym(r.charCodeAt(0)))return!0;return!1}const Oo=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(o){this.pluginStatus=o.pluginStatus,this.pluginURL=o.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(o){if(Oo.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=o.applyArabicShaping,this.processBidirectionalText=o.processBidirectionalText,this.processStyledBidirectionalText=o.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(o,r){return l(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(o.pluginStatus!=="loading")return this.setState(o),o;const s=o.pluginURL,d=new Promise((b=>{this.loadScriptResolve=b}));r(s);const h=new Promise((b=>setTimeout((()=>b()),this.TIMEOUT)));if(yield Promise.race([d,h]),this.isParsed()){const b={pluginStatus:"loaded",pluginURL:s};return this.setState(b),b}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${s}`)}))}};class ci{constructor(r,s){this.isSupportedScript=ey,this.zoom=r,s?(this.now=s.now||0,this.fadeDuration=s.fadeDuration||0,this.zoomHistory=s.zoomHistory||new cl,this.transition=s.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new cl,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,s=r-Math.floor(r),d=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*s}}}function ey(o){return(function(r,s){for(const d of r)if(!Jm(d.charCodeAt(0),s))return!1;return!0})(o,Oo.getRTLTextPluginStatus()==="loaded")}class wu{constructor(r,s,d){this.property=r,this.value=s,this.expression=(function(h,b,x){if(Vc(h))return new Kc(h,b);if(jc(h)){const A=gf(h,b,x);if(A.result==="error")throw new Error(A.value.map((S=>`${S.key}: ${S.message}`)).join(", "));return A.value}{let A=h;return b.type==="color"&&typeof h=="string"?A=Rr.parse(h):b.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?b.type!=="numberArray"||typeof h!="number"&&!Array.isArray(h)?b.type!=="colorArray"||typeof h!="string"&&!Array.isArray(h)?b.type==="variableAnchorOffsetCollection"&&Array.isArray(h)?A=Sn.parse(h):b.type==="projectionDefinition"&&typeof h=="string"&&(A=Vn.parse(h)):A=dn.parse(h):A=Wi.parse(h):A=cn.parse(h),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>A}}})(s===void 0?r.specification.default:s,r.specification,d)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(r,s,d){return this.property.possiblyEvaluate(this,r,s,d)}}class rd{constructor(r,s){this.property=r,this.value=new wu(r,void 0,s)}transitioned(r,s){return new Eu(this.property,this.value,s,or({},r.transition,this.transition),r.now)}untransitioned(){return new Eu(this.property,this.value,null,{},0)}}class Tf{constructor(r,s){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues),this._globalState=s}getValue(r){return rr(this._values[r].value.value)}setValue(r,s){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new rd(this._values[r].property,this._globalState)),this._values[r].value=new wu(this._values[r].property,s===null?void 0:rr(s),this._globalState)}getTransition(r){return rr(this._values[r].transition)}setTransition(r,s){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new rd(this._values[r].property,this._globalState)),this._values[r].transition=rr(s)||void 0}serialize(){const r={};for(const s of Object.keys(this._values)){const d=this.getValue(s);d!==void 0&&(r[s]=d);const h=this.getTransition(s);h!==void 0&&(r[`${s}-transition`]=h)}return r}transitioned(r,s){const d=new ty(this._properties);for(const h of Object.keys(this._values))d._values[h]=this._values[h].transitioned(r,s._values[h]);return d}untransitioned(){const r=new ty(this._properties);for(const s of Object.keys(this._values))r._values[s]=this._values[s].untransitioned();return r}}class Eu{constructor(r,s,d,h,b){this.property=r,this.value=s,this.begin=b+h.delay||0,this.end=this.begin+h.duration||0,r.specification.transition&&(h.delay||h.duration)&&(this.prior=d)}possiblyEvaluate(r,s,d){const h=r.now||0,b=this.value.possiblyEvaluate(r,s,d),x=this.prior;if(x){if(h>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(h<this.begin)return x.possiblyEvaluate(r,s,d);{const A=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(r,s,d),b,Ce(A))}}return b}}class ty{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,s,d){const h=new id(this._properties);for(const b of Object.keys(this._values))h._values[b]=this._values[b].possiblyEvaluate(r,s,d);return h}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Cf{constructor(r,s){this._properties=r,this._values=Object.create(r.defaultPropertyValues),this._globalState=s}hasValue(r){return this._values[r].value!==void 0}getValue(r){return rr(this._values[r].value)}setValue(r,s){this._values[r]=new wu(this._values[r].property,s===null?void 0:rr(s),this._globalState)}serialize(){const r={};for(const s of Object.keys(this._values)){const d=this.getValue(s);d!==void 0&&(r[s]=d)}return r}possiblyEvaluate(r,s,d){const h=new id(this._properties);for(const b of Object.keys(this._values))h._values[b]=this._values[b].possiblyEvaluate(r,s,d);return h}}class Ws{constructor(r,s,d){this.property=r,this.value=s,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,s,d,h){return this.property.evaluate(this.value,this.parameters,r,s,d,h)}}class id{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class qt{constructor(r){this.specification=r}possiblyEvaluate(r,s){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(s)}interpolate(r,s,d){const h=fs[this.specification.type];return h?h(r,s,d):r}}class tr{constructor(r,s){this.specification=r,this.overrides=s}possiblyEvaluate(r,s,d,h){return new Ws(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(s,null,{},d,h)}:r.expression,s)}interpolate(r,s,d){if(r.value.kind!=="constant"||s.value.kind!=="constant")return r;if(r.value.value===void 0||s.value.value===void 0)return new Ws(this,{kind:"constant",value:void 0},r.parameters);const h=fs[this.specification.type];if(h){const b=h(r.value.value,s.value.value,d);return new Ws(this,{kind:"constant",value:b},r.parameters)}return r}evaluate(r,s,d,h,b,x){return r.kind==="constant"?r.value:r.evaluate(s,d,h,b,x)}}class dl extends tr{possiblyEvaluate(r,s,d,h){if(r.value===void 0)return new Ws(this,{kind:"constant",value:void 0},s);if(r.expression.kind==="constant"){const b=r.expression.evaluate(s,null,{},d,h),x=r.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,A=this._calculate(x,x,x,s);return new Ws(this,{kind:"constant",value:A},s)}if(r.expression.kind==="camera"){const b=this._calculate(r.expression.evaluate({zoom:s.zoom-1}),r.expression.evaluate({zoom:s.zoom}),r.expression.evaluate({zoom:s.zoom+1}),s);return new Ws(this,{kind:"constant",value:b},s)}return new Ws(this,r.expression,s)}evaluate(r,s,d,h,b,x){if(r.kind==="source"){const A=r.evaluate(s,d,h,b,x);return this._calculate(A,A,A,s)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(s.zoom)-1},d,h),r.evaluate({zoom:Math.floor(s.zoom)},d,h),r.evaluate({zoom:Math.floor(s.zoom)+1},d,h),s):r.value}_calculate(r,s,d,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:d,to:s}}interpolate(r){return r}}class ry{constructor(r){this.specification=r}possiblyEvaluate(r,s,d,h){if(r.value!==void 0){if(r.expression.kind==="constant"){const b=r.expression.evaluate(s,null,{},d,h);return this._calculate(b,b,b,s)}return this._calculate(r.expression.evaluate(new ci(Math.floor(s.zoom-1),s)),r.expression.evaluate(new ci(Math.floor(s.zoom),s)),r.expression.evaluate(new ci(Math.floor(s.zoom+1),s)),s)}}_calculate(r,s,d,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:r,to:s}:{from:d,to:s}}interpolate(r){return r}}class nd{constructor(r){this.specification=r}possiblyEvaluate(r,s,d,h){return!!r.expression.evaluate(s,null,{},d,h)}interpolate(){return!1}}class Tn{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in r){const d=r[s];d.specification.overridable&&this.overridableProperties.push(s);const h=this.defaultPropertyValues[s]=new wu(d,void 0,void 0),b=this.defaultTransitionablePropertyValues[s]=new rd(d,void 0);this.defaultTransitioningPropertyValues[s]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=h.possiblyEvaluate({})}}}It("DataDrivenProperty",tr),It("DataConstantProperty",qt),It("CrossFadedDataDrivenProperty",dl),It("CrossFadedProperty",ry),It("ColorRampProperty",nd);const iy="-transition";class ks extends Ft{constructor(r,s,d){if(super(),this.id=r.id,this.type=r.type,this._globalState=d,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter,this._featureFilter=hu(r.filter,d)),s.layout&&(this._unevaluatedLayout=new Cf(s.layout,d)),s.paint)){this._transitionablePaint=new Tf(s.paint,d);for(const h in r.paint)this.setPaintProperty(h,r.paint[h],{validate:!1});for(const h in r.layout)this.setLayoutProperty(h,r.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new id(s.paint)}}setFilter(r){this.filter=r,this._featureFilter=hu(r,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}getLayoutAffectingGlobalStateRefs(){const r=new Set;if(this._unevaluatedLayout)for(const s in this._unevaluatedLayout._values){const d=this._unevaluatedLayout._values[s];for(const h of d.getGlobalStateRefs())r.add(h)}for(const s of this._featureFilter.getGlobalStateRefs())r.add(s);return r}getPaintAffectingGlobalStateRefs(){var r;const s=new globalThis.Map;if(this._transitionablePaint)for(const d in this._transitionablePaint._values){const h=this._transitionablePaint._values[d].value;for(const b of h.getGlobalStateRefs()){const x=(r=s.get(b))!==null&&r!==void 0?r:[];x.push({name:d,value:h.value}),s.set(b,x)}}return s}setLayoutProperty(r,s,d={}){s!=null&&this._validate(_u,`layers.${this.id}.layout.${r}`,r,s,d)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,s):this.visibility=s)}getPaintProperty(r){return r.endsWith(iy)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,s,d={}){if(s!=null&&this._validate(Tv,`layers.${this.id}.paint.${r}`,r,s,d))return!1;if(r.endsWith(iy))return this._transitionablePaint.setTransition(r.slice(0,-11),s||void 0),!1;{const h=this._transitionablePaint._values[r],b=h.property.specification["property-type"]==="cross-faded-data-driven",x=h.value.isDataDriven(),A=h.value;this._transitionablePaint.setValue(r,s),this._handleSpecialPaintPropertyUpdate(r);const S=this._transitionablePaint._values[r].value;return S.isDataDriven()||x||b||this._handleOverridablePaintPropertyUpdate(r,A,S)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,s,d){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,s){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Nr(r,((s,d)=>!(s===void 0||d==="layout"&&!Object.keys(s).length||d==="paint"&&!Object.keys(s).length)))}_validate(r,s,d,h,b={}){return(!b||b.validate!==!1)&&Km(this,r.call(zo,{key:s,layerType:this.type,objectKey:d,value:h,styleSpec:Ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const s=this.paint.get(r);if(s instanceof Ws&&il(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}let wa;var Cv={get paint(){return wa=wa||new Tn({"raster-opacity":new qt(Ke.paint_raster["raster-opacity"]),"raster-hue-rotate":new qt(Ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new qt(Ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new qt(Ke.paint_raster["raster-brightness-max"]),"raster-saturation":new qt(Ke.paint_raster["raster-saturation"]),"raster-contrast":new qt(Ke.paint_raster["raster-contrast"]),"raster-resampling":new qt(Ke.paint_raster["raster-resampling"]),"raster-fade-duration":new qt(Ke.paint_raster["raster-fade-duration"])})}};class kv extends ks{constructor(r,s){super(r,Cv,s)}}const Pv={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class pl{constructor(r,s){this._structArray=r,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class vi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,s){return r._trim(),s&&(r.isTransferred=!0,s.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const s=Object.create(this.prototype);return s.arrayBuffer=r.arrayBuffer,s.length=r.length,s.capacity=r.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Li(o,r=1){let s=0,d=0;return{members:o.map((h=>{const b=Pv[h.type].BYTES_PER_ELEMENT,x=s=Vo(s,Math.max(r,b)),A=h.components||1;return d=Math.max(d,b),s+=b*A,{name:h.name,type:h.type,components:A,offset:x}})),size:Vo(s,Math.max(d,r)),alignment:r}}function Vo(o,r){return Math.ceil(o/r)*r}class fl extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s){const d=this.length;return this.resize(d+1),this.emplace(d,r,s)}emplace(r,s,d){const h=2*r;return this.int16[h+0]=s,this.int16[h+1]=d,r}}fl.prototype.bytesPerElement=4,It("StructArrayLayout2i4",fl);class hl extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d){const h=this.length;return this.resize(h+1),this.emplace(h,r,s,d)}emplace(r,s,d,h){const b=3*r;return this.int16[b+0]=s,this.int16[b+1]=d,this.int16[b+2]=h,r}}hl.prototype.bytesPerElement=6,It("StructArrayLayout3i6",hl);class sd extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,h){const b=this.length;return this.resize(b+1),this.emplace(b,r,s,d,h)}emplace(r,s,d,h,b){const x=4*r;return this.int16[x+0]=s,this.int16[x+1]=d,this.int16[x+2]=h,this.int16[x+3]=b,r}}sd.prototype.bytesPerElement=8,It("StructArrayLayout4i8",sd);class Au extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,r,s,d,h,b,x)}emplace(r,s,d,h,b,x,A){const S=6*r;return this.int16[S+0]=s,this.int16[S+1]=d,this.int16[S+2]=h,this.int16[S+3]=b,this.int16[S+4]=x,this.int16[S+5]=A,r}}Au.prototype.bytesPerElement=12,It("StructArrayLayout2i4i12",Au);class kf extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,r,s,d,h,b,x)}emplace(r,s,d,h,b,x,A){const S=4*r,D=8*r;return this.int16[S+0]=s,this.int16[S+1]=d,this.uint8[D+4]=h,this.uint8[D+5]=b,this.uint8[D+6]=x,this.uint8[D+7]=A,r}}kf.prototype.bytesPerElement=8,It("StructArrayLayout2i4ub8",kf);class Uo extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s){const d=this.length;return this.resize(d+1),this.emplace(d,r,s)}emplace(r,s,d){const h=2*r;return this.float32[h+0]=s,this.float32[h+1]=d,r}}Uo.prototype.bytesPerElement=8,It("StructArrayLayout2f8",Uo);class Ea extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b,x,A,S,D,M){const F=this.length;return this.resize(F+1),this.emplace(F,r,s,d,h,b,x,A,S,D,M)}emplace(r,s,d,h,b,x,A,S,D,M,F){const Z=10*r;return this.uint16[Z+0]=s,this.uint16[Z+1]=d,this.uint16[Z+2]=h,this.uint16[Z+3]=b,this.uint16[Z+4]=x,this.uint16[Z+5]=A,this.uint16[Z+6]=S,this.uint16[Z+7]=D,this.uint16[Z+8]=M,this.uint16[Z+9]=F,r}}Ea.prototype.bytesPerElement=20,It("StructArrayLayout10ui20",Ea);class Pf extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b,x,A,S){const D=this.length;return this.resize(D+1),this.emplace(D,r,s,d,h,b,x,A,S)}emplace(r,s,d,h,b,x,A,S,D){const M=8*r;return this.uint16[M+0]=s,this.uint16[M+1]=d,this.uint16[M+2]=h,this.uint16[M+3]=b,this.uint16[M+4]=x,this.uint16[M+5]=A,this.uint16[M+6]=S,this.uint16[M+7]=D,r}}Pf.prototype.bytesPerElement=16,It("StructArrayLayout8ui16",Pf);class od extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b,x,A,S,D,M,F,Z){const H=this.length;return this.resize(H+1),this.emplace(H,r,s,d,h,b,x,A,S,D,M,F,Z)}emplace(r,s,d,h,b,x,A,S,D,M,F,Z,H){const Y=12*r;return this.int16[Y+0]=s,this.int16[Y+1]=d,this.int16[Y+2]=h,this.int16[Y+3]=b,this.uint16[Y+4]=x,this.uint16[Y+5]=A,this.uint16[Y+6]=S,this.uint16[Y+7]=D,this.int16[Y+8]=M,this.int16[Y+9]=F,this.int16[Y+10]=Z,this.int16[Y+11]=H,r}}od.prototype.bytesPerElement=24,It("StructArrayLayout4i4ui4i24",od);class Aa extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,d){const h=this.length;return this.resize(h+1),this.emplace(h,r,s,d)}emplace(r,s,d,h){const b=3*r;return this.float32[b+0]=s,this.float32[b+1]=d,this.float32[b+2]=h,r}}Aa.prototype.bytesPerElement=12,It("StructArrayLayout3f12",Aa);class Lf extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint32[1*r+0]=s,r}}Lf.prototype.bytesPerElement=4,It("StructArrayLayout1ul4",Lf);class Df extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b,x,A,S,D){const M=this.length;return this.resize(M+1),this.emplace(M,r,s,d,h,b,x,A,S,D)}emplace(r,s,d,h,b,x,A,S,D,M){const F=10*r,Z=5*r;return this.int16[F+0]=s,this.int16[F+1]=d,this.int16[F+2]=h,this.int16[F+3]=b,this.int16[F+4]=x,this.int16[F+5]=A,this.uint32[Z+3]=S,this.uint16[F+8]=D,this.uint16[F+9]=M,r}}Df.prototype.bytesPerElement=20,It("StructArrayLayout6i1ul2ui20",Df);class ad extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,r,s,d,h,b,x)}emplace(r,s,d,h,b,x,A){const S=6*r;return this.int16[S+0]=s,this.int16[S+1]=d,this.int16[S+2]=h,this.int16[S+3]=b,this.int16[S+4]=x,this.int16[S+5]=A,r}}ad.prototype.bytesPerElement=12,It("StructArrayLayout2i2i2i12",ad);class If extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,d,h,b)}emplace(r,s,d,h,b,x){const A=4*r,S=8*r;return this.float32[A+0]=s,this.float32[A+1]=d,this.float32[A+2]=h,this.int16[S+6]=b,this.int16[S+7]=x,r}}If.prototype.bytesPerElement=16,It("StructArrayLayout2f1f2i16",If);class g extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,r,s,d,h,b,x)}emplace(r,s,d,h,b,x,A){const S=16*r,D=4*r,M=8*r;return this.uint8[S+0]=s,this.uint8[S+1]=d,this.float32[D+1]=h,this.float32[D+2]=b,this.int16[M+6]=x,this.int16[M+7]=A,r}}g.prototype.bytesPerElement=16,It("StructArrayLayout2ub2f2i16",g);class t extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d){const h=this.length;return this.resize(h+1),this.emplace(h,r,s,d)}emplace(r,s,d,h){const b=3*r;return this.uint16[b+0]=s,this.uint16[b+1]=d,this.uint16[b+2]=h,r}}t.prototype.bytesPerElement=6,It("StructArrayLayout3ui6",t);class u extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b,x,A,S,D,M,F,Z,H,Y,ie,ae,ye){const qe=this.length;return this.resize(qe+1),this.emplace(qe,r,s,d,h,b,x,A,S,D,M,F,Z,H,Y,ie,ae,ye)}emplace(r,s,d,h,b,x,A,S,D,M,F,Z,H,Y,ie,ae,ye,qe){const Se=24*r,Me=12*r,We=48*r;return this.int16[Se+0]=s,this.int16[Se+1]=d,this.uint16[Se+2]=h,this.uint16[Se+3]=b,this.uint32[Me+2]=x,this.uint32[Me+3]=A,this.uint32[Me+4]=S,this.uint16[Se+10]=D,this.uint16[Se+11]=M,this.uint16[Se+12]=F,this.float32[Me+7]=Z,this.float32[Me+8]=H,this.uint8[We+36]=Y,this.uint8[We+37]=ie,this.uint8[We+38]=ae,this.uint32[Me+10]=ye,this.int16[Se+22]=qe,r}}u.prototype.bytesPerElement=48,It("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",u);class p extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,d,h,b,x,A,S,D,M,F,Z,H,Y,ie,ae,ye,qe,Se,Me,We,ot,mt,Dt,Rt,Pt,Zt,Tt){const Lt=this.length;return this.resize(Lt+1),this.emplace(Lt,r,s,d,h,b,x,A,S,D,M,F,Z,H,Y,ie,ae,ye,qe,Se,Me,We,ot,mt,Dt,Rt,Pt,Zt,Tt)}emplace(r,s,d,h,b,x,A,S,D,M,F,Z,H,Y,ie,ae,ye,qe,Se,Me,We,ot,mt,Dt,Rt,Pt,Zt,Tt,Lt){const ct=32*r,sr=16*r;return this.int16[ct+0]=s,this.int16[ct+1]=d,this.int16[ct+2]=h,this.int16[ct+3]=b,this.int16[ct+4]=x,this.int16[ct+5]=A,this.int16[ct+6]=S,this.int16[ct+7]=D,this.uint16[ct+8]=M,this.uint16[ct+9]=F,this.uint16[ct+10]=Z,this.uint16[ct+11]=H,this.uint16[ct+12]=Y,this.uint16[ct+13]=ie,this.uint16[ct+14]=ae,this.uint16[ct+15]=ye,this.uint16[ct+16]=qe,this.uint16[ct+17]=Se,this.uint16[ct+18]=Me,this.uint16[ct+19]=We,this.uint16[ct+20]=ot,this.uint16[ct+21]=mt,this.uint16[ct+22]=Dt,this.uint32[sr+12]=Rt,this.float32[sr+13]=Pt,this.float32[sr+14]=Zt,this.uint16[ct+30]=Tt,this.uint16[ct+31]=Lt,r}}p.prototype.bytesPerElement=64,It("StructArrayLayout8i15ui1ul2f2ui64",p);class m extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.float32[1*r+0]=s,r}}m.prototype.bytesPerElement=4,It("StructArrayLayout1f4",m);class v extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,d){const h=this.length;return this.resize(h+1),this.emplace(h,r,s,d)}emplace(r,s,d,h){const b=3*r;return this.uint16[6*r+0]=s,this.float32[b+1]=d,this.float32[b+2]=h,r}}v.prototype.bytesPerElement=12,It("StructArrayLayout1ui2f12",v);class E extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,d){const h=this.length;return this.resize(h+1),this.emplace(h,r,s,d)}emplace(r,s,d,h){const b=4*r;return this.uint32[2*r+0]=s,this.uint16[b+2]=d,this.uint16[b+3]=h,r}}E.prototype.bytesPerElement=8,It("StructArrayLayout1ul2ui8",E);class T extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s){const d=this.length;return this.resize(d+1),this.emplace(d,r,s)}emplace(r,s,d){const h=2*r;return this.uint16[h+0]=s,this.uint16[h+1]=d,r}}T.prototype.bytesPerElement=4,It("StructArrayLayout2ui4",T);class k extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint16[1*r+0]=s,r}}k.prototype.bytesPerElement=2,It("StructArrayLayout1ui2",k);class V extends vi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,d,h){const b=this.length;return this.resize(b+1),this.emplace(b,r,s,d,h)}emplace(r,s,d,h,b){const x=4*r;return this.float32[x+0]=s,this.float32[x+1]=d,this.float32[x+2]=h,this.float32[x+3]=b,r}}V.prototype.bytesPerElement=16,It("StructArrayLayout4f16",V);class N extends pl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new _(this.anchorPointX,this.anchorPointY)}}N.prototype.size=20;class $ extends Df{get(r){return new N(this,r)}}It("CollisionBoxArray",$);class K extends pl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}K.prototype.size=48;class X extends u{get(r){return new K(this,r)}}It("PlacedSymbolArray",X);class re extends pl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}re.prototype.size=64;class le extends p{get(r){return new re(this,r)}}It("SymbolInstanceArray",le);class ue extends m{getoffsetX(r){return this.float32[1*r+0]}}It("GlyphOffsetArray",ue);class ce extends hl{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}It("SymbolLineVertexArray",ce);class be extends pl{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}be.prototype.size=12;class Ee extends v{get(r){return new be(this,r)}}It("TextAnchorOffsetArray",Ee);class xe extends pl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}xe.prototype.size=8;class Pe extends E{get(r){return new xe(this,r)}}It("FeatureIndexArray",Pe);class Ue extends fl{}class Ae extends fl{}class Fe extends fl{}class it extends Au{}class Xe extends kf{}class Je extends Uo{}class Qe extends Ea{}class xt extends Pf{}class wt extends od{}class pt extends Aa{}class jt extends Lf{}class fr extends ad{}class Yr extends g{}class Jr extends t{}class ii extends T{}const xi=Li([{name:"a_pos",components:2,type:"Int16"}],4),{members:di}=xi;class Vr{constructor(r=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=r}prepareSegment(r,s,d,h){const b=this.segments[this.segments.length-1];return r>Vr.MAX_VERTEX_ARRAY_LENGTH&&ir(`Max vertices per segment is ${Vr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Vr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!b||b.vertexLength+r>Vr.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==h?this.createNewSegment(s,d,h):b}createNewSegment(r,s,d){const h={vertexOffset:r.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0,vaos:{}};return d!==void 0&&(h.sortKey=d),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(r,s,d){return this.prepareSegment(0,r,s,d)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const r of this.segments)for(const s in r.vaos)r.vaos[s].destroy()}static simpleSegment(r,s,d,h){return new Vr([{vertexOffset:r,primitiveOffset:s,vertexLength:d,primitiveLength:h,vaos:{},sortKey:0}])}}function gi(o,r){return 256*(o=er(Math.floor(o),0,255))+er(Math.floor(r),0,255)}Vr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,It("SegmentVector",Vr);const pn=Li([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Oi=Li([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var Vi,Cn,jo,Ps={exports:{}},No={exports:{}},Ra={exports:{}},ld=(function(){if(jo)return Ps.exports;jo=1;var o=(Vi||(Vi=1,No.exports=function(s,d){var h,b,x,A,S,D,M,F;for(b=s.length-(h=3&s.length),x=d,S=3432918353,D=461845907,F=0;F<b;)M=255&s.charCodeAt(F)|(255&s.charCodeAt(++F))<<8|(255&s.charCodeAt(++F))<<16|(255&s.charCodeAt(++F))<<24,++F,x=27492+(65535&(A=5*(65535&(x=(x^=M=(65535&(M=(M=(65535&M)*S+(((M>>>16)*S&65535)<<16)&4294967295)<<15|M>>>17))*D+(((M>>>16)*D&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(M=0,h){case 3:M^=(255&s.charCodeAt(F+2))<<16;case 2:M^=(255&s.charCodeAt(F+1))<<8;case 1:x^=M=(65535&(M=(M=(65535&(M^=255&s.charCodeAt(F)))*S+(((M>>>16)*S&65535)<<16)&4294967295)<<15|M>>>17))*D+(((M>>>16)*D&65535)<<16)&4294967295}return x^=s.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),No.exports),r=(Cn||(Cn=1,Ra.exports=function(s,d){for(var h,b=s.length,x=d^b,A=0;b>=4;)h=1540483477*(65535&(h=255&s.charCodeAt(A)|(255&s.charCodeAt(++A))<<8|(255&s.charCodeAt(++A))<<16|(255&s.charCodeAt(++A))<<24))+((1540483477*(h>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),b-=4,++A;switch(b){case 3:x^=(255&s.charCodeAt(A+2))<<16;case 2:x^=(255&s.charCodeAt(A+1))<<8;case 1:x=1540483477*(65535&(x^=255&s.charCodeAt(A)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),Ra.exports);return Ps.exports=o,Ps.exports.murmur3=o,Ps.exports.murmur2=r,Ps.exports})(),ml=w(ld);class po{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,s,d,h){this.ids.push(Wn(r)),this.positions.push(s,d,h)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=Wn(r);let d=0,h=this.ids.length-1;for(;d<h;){const x=d+h>>1;this.ids[x]>=s?h=x:d=x+1}const b=[];for(;this.ids[d]===s;)b.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return b}static serialize(r,s){const d=new Float64Array(r.ids),h=new Uint32Array(r.positions);return Ys(d,h,0,d.length-1),s&&s.push(d.buffer,h.buffer),{ids:d,positions:h}}static deserialize(r){const s=new po;return s.ids=r.ids,s.positions=r.positions,s.indexed=!0,s}}function Wn(o){const r=+o;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:ml(String(o))}function Ys(o,r,s,d){for(;s<d;){const h=o[s+d>>1];let b=s-1,x=d+1;for(;;){do b++;while(o[b]<h);do x--;while(o[x]>h);if(b>=x)break;Js(o,b,x),Js(r,3*b,3*x),Js(r,3*b+1,3*x+1),Js(r,3*b+2,3*x+2)}x-s<d-x?(Ys(o,r,s,x),s=x+1):(Ys(o,r,x+1,d),d=x)}}function Js(o,r,s){const d=o[r];o[r]=o[s],o[s]=d}It("FeaturePositionMap",po);class Yn{constructor(r,s){this.gl=r.gl,this.location=s}}class Di extends Yn{constructor(r,s){super(r,s),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class Ki extends Yn{constructor(r,s){super(r,s),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class Jn extends Yn{constructor(r,s){super(r,s),this.current=Rr.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const Qi=new Float32Array(16);function Bf(o){return[gi(255*o.r,255*o.g),gi(255*o.b,255*o.a)]}class Ru{constructor(r,s,d){this.value=r,this.uniformNames=s.map((h=>`u_${h}`)),this.type=d}setUniform(r,s,d){r.set(d.constantOr(this.value))}getBinding(r,s,d){return this.type==="color"?new Jn(r,s):new Di(r,s)}}class Sa{constructor(r,s){this.uniformNames=s.map((d=>`u_${d}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=r.tlbr}setConstantDashPositions(r,s){this.dashTo=[0,r.y,r.height,r.width],this.dashFrom=[0,s.y,s.height,s.width]}setUniform(r,s,d,h){let b=null;h==="u_pattern_to"?b=this.patternTo:h==="u_pattern_from"?b=this.patternFrom:h==="u_dasharray_to"?b=this.dashTo:h==="u_dasharray_from"?b=this.dashFrom:h==="u_pixel_ratio_to"?b=this.pixelRatioTo:h==="u_pixel_ratio_from"&&(b=this.pixelRatioFrom),b!==null&&r.set(b)}getBinding(r,s,d){return d.substr(0,9)==="u_pattern"||d.substr(0,12)==="u_dasharray_"?new Ki(r,s):new Di(r,s)}}class fo{constructor(r,s,d,h){this.expression=r,this.type=d,this.maxValue=0,this.paintVertexAttributes=s.map((b=>({name:`a_${b}`,type:"Float32",components:d==="color"?2:1,offset:0}))),this.paintVertexArray=new h}populatePaintArray(r,s,d){const h=this.paintVertexArray.length,b=this.expression.evaluate(new ci(0,d),s,{},d.canonical,[],d.formattedSection);this.paintVertexArray.resize(r),this._setPaintValue(h,r,b)}updatePaintArray(r,s,d,h,b){const x=this.expression.evaluate(new ci(0,b),d,h);this._setPaintValue(r,s,x)}_setPaintValue(r,s,d){if(this.type==="color"){const h=Bf(d);for(let b=r;b<s;b++)this.paintVertexArray.emplace(b,h[0],h[1])}else{for(let h=r;h<s;h++)this.paintVertexArray.emplace(h,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ls{constructor(r,s,d,h,b,x){this.expression=r,this.uniformNames=s.map((A=>`u_${A}_t`)),this.type=d,this.useIntegerZoom=h,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=s.map((A=>({name:`a_${A}`,type:"Float32",components:d==="color"?4:2,offset:0}))),this.paintVertexArray=new x}populatePaintArray(r,s,d){const h=this.expression.evaluate(new ci(this.zoom,d),s,{},d.canonical,[],d.formattedSection),b=this.expression.evaluate(new ci(this.zoom+1,d),s,{},d.canonical,[],d.formattedSection),x=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(x,r,h,b)}updatePaintArray(r,s,d,h,b){const x=this.expression.evaluate(new ci(this.zoom,b),d,h),A=this.expression.evaluate(new ci(this.zoom+1,b),d,h);this._setPaintValue(r,s,x,A)}_setPaintValue(r,s,d,h){if(this.type==="color"){const b=Bf(d),x=Bf(h);for(let A=r;A<s;A++)this.paintVertexArray.emplace(A,b[0],b[1],x[0],x[1])}else{for(let b=r;b<s;b++)this.paintVertexArray.emplace(b,d,h);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(h))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,s){const d=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,h=er(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);r.set(h)}getBinding(r,s,d){return new Di(r,s)}}class Fo{constructor(r,s,d,h,b,x){this.expression=r,this.type=s,this.useIntegerZoom=d,this.zoom=h,this.layerId=x,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(r,s,d){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(h,r,this.getPositionIds(s),d)}updatePaintArray(r,s,d,h,b){this._setPaintValues(r,s,this.getPositionIds(d),b)}_setPaintValues(r,s,d,h){const b=this.getPositions(h);if(!b||!d)return;const x=b[d.min],A=b[d.mid],S=b[d.max];if(x&&A&&S)for(let D=r;D<s;D++)this.emplace(this.zoomInPaintVertexArray,D,A,x),this.emplace(this.zoomOutPaintVertexArray,D,A,S)}upload(r){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const s=this.getVertexAttributes();this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,s,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,s,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class qo extends Fo{getPositions(r){return r.imagePositions}getPositionIds(r){return r.patterns&&r.patterns[this.layerId]}getVertexAttributes(){return pn.members}emplace(r,s,d,h){r.emplace(s,d.tlbr[0],d.tlbr[1],d.tlbr[2],d.tlbr[3],h.tlbr[0],h.tlbr[1],h.tlbr[2],h.tlbr[3],d.pixelRatio,h.pixelRatio)}}class Mf extends Fo{getPositions(r){return r.dashPositions}getPositionIds(r){return r.dashes&&r.dashes[this.layerId]}getVertexAttributes(){return Oi.members}emplace(r,s,d,h){r.emplace(s,0,d.y,d.height,d.width,0,h.y,h.height,h.width)}}class zf{constructor(r,s,d){this.binders={},this._buffers=[];const h=[];for(const b in r.paint._values){if(!d(b))continue;const x=r.paint.get(b);if(!(x instanceof Ws&&il(x.property.specification)))continue;const A=Of(b,r.type),S=x.value,D=x.property.specification.type,M=x.property.useIntegerZoom,F=x.property.specification["property-type"],Z=F==="cross-faded"||F==="cross-faded-data-driven";if(S.kind==="constant")this.binders[b]=Z?new Sa(S.value,A):new Ru(S.value,A,D),h.push(`/u_${b}`);else if(S.kind==="source"||Z){const H=Vf(b,D,"source");this.binders[b]=Z?b==="line-dasharray"?new Mf(S,D,M,s,H,r.id):new qo(S,D,M,s,H,r.id):new fo(S,A,D,H),h.push(`/a_${b}`)}else{const H=Vf(b,D,"composite");this.binders[b]=new Ls(S,A,D,M,s,H),h.push(`/z_${b}`)}}this.cacheKey=h.sort().join("")}getMaxValue(r){const s=this.binders[r];return s instanceof fo||s instanceof Ls?s.maxValue:0}populatePaintArrays(r,s,d){for(const h in this.binders){const b=this.binders[h];(b instanceof fo||b instanceof Ls||b instanceof Fo)&&b.populatePaintArray(r,s,d)}}setConstantPatternPositions(r,s){for(const d in this.binders){const h=this.binders[d];h instanceof Sa&&h.setConstantPatternPositions(r,s)}}setConstantDashPositions(r,s){for(const d in this.binders){const h=this.binders[d];h instanceof Sa&&h.setConstantDashPositions(r,s)}}updatePaintArrays(r,s,d,h,b){let x=!1;for(const A in r){const S=s.getPositions(A);for(const D of S){const M=d.feature(D.index);for(const F in this.binders){const Z=this.binders[F];if((Z instanceof fo||Z instanceof Ls||Z instanceof Fo)&&Z.expression.isStateDependent===!0){const H=h.paint.get(F);Z.expression=H.value,Z.updatePaintArray(D.start,D.end,M,r[A],b),x=!0}}}}return x}defines(){const r=[];for(const s in this.binders){const d=this.binders[s];(d instanceof Ru||d instanceof Sa)&&r.push(...d.uniformNames.map((h=>`#define HAS_UNIFORM_${h}`)))}return r}getBinderAttributes(){const r=[];for(const s in this.binders){const d=this.binders[s];if(d instanceof fo||d instanceof Ls)for(let h=0;h<d.paintVertexAttributes.length;h++)r.push(d.paintVertexAttributes[h].name);else if(d instanceof Fo){const h=d.getVertexAttributes();for(const b of h)r.push(b.name)}}return r}getBinderUniforms(){const r=[];for(const s in this.binders){const d=this.binders[s];if(d instanceof Ru||d instanceof Sa||d instanceof Ls)for(const h of d.uniformNames)r.push(h)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,s){const d=[];for(const h in this.binders){const b=this.binders[h];if(b instanceof Ru||b instanceof Sa||b instanceof Ls){for(const x of b.uniformNames)if(s[x]){const A=b.getBinding(r,s[x],x);d.push({name:x,property:h,binding:A})}}}return d}setUniforms(r,s,d,h){for(const{name:b,property:x,binding:A}of s)this.binders[x].setUniform(A,h,d.get(x),b)}updatePaintBuffers(r){this._buffers=[];for(const s in this.binders){const d=this.binders[s];if(r&&d instanceof Fo){const h=r.fromScale===2?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(d instanceof fo||d instanceof Ls)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(r){for(const s in this.binders){const d=this.binders[s];(d instanceof fo||d instanceof Ls||d instanceof Fo)&&d.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const s=this.binders[r];(s instanceof fo||s instanceof Ls||s instanceof Fo)&&s.destroy()}}}class Ko{constructor(r,s,d=()=>!0){this.programConfigurations={};for(const h of r)this.programConfigurations[h.id]=new zf(h,s,d);this.needsUpload=!1,this._featureMap=new po,this._bufferOffset=0}populatePaintArrays(r,s,d,h){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(r,s,h);s.id!==void 0&&this._featureMap.add(s.id,d,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,s,d,h){for(const b of d)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(r,this._featureMap,s,b,h)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function Of(o,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${r}-`,"").replace(/-/g,"_")]}function Vf(o,r,s){const d={color:{source:Uo,composite:V},number:{source:m,composite:Uo}},h=(function(b){return{"line-pattern":{source:Qe,composite:Qe},"fill-pattern":{source:Qe,composite:Qe},"fill-extrusion-pattern":{source:Qe,composite:Qe},"line-dasharray":{source:xt,composite:xt}}[b]})(o);return h&&h[s]||d[r][s]}It("ConstantBinder",Ru),It("CrossFadedConstantBinder",Sa),It("SourceExpressionBinder",fo),It("CrossFadedPatternBinder",qo),It("CrossFadedDasharrayBinder",Mf),It("CompositeExpressionBinder",Ls),It("ProgramConfiguration",zf,{omit:["_buffers"]}),It("ProgramConfigurationSet",Ko);const Su=Math.pow(2,14)-1,o1=-Su-1;function Tu(o){const r=lt/o.extent,s=o.loadGeometry();for(let d=0;d<s.length;d++){const h=s[d];for(let b=0;b<h.length;b++){const x=h[b],A=Math.round(x.x*r),S=Math.round(x.y*r);x.x=er(A,o1,Su),x.y=er(S,o1,Su),(A<x.x||A>x.x+1||S<x.y||S>x.y+1)&&ir("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function Cu(o,r){return{type:o.type,id:o.id,properties:o.properties,geometry:r?Tu(o):[]}}const a1=-32768;function EI(o,r,s,d,h){o.emplaceBack(a1+8*r+d,a1+8*s+h)}class Lv{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=r.index,this.hasDependencies=!1,this.layoutVertexArray=new Ae,this.indexArray=new Jr,this.segments=new Vr,this.programConfigurations=new Ko(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(r,s,d){const h=this.layers[0],b=[];let x=null,A=!1,S=h.type==="heatmap";if(h.type==="circle"){const M=h;x=M.layout.get("circle-sort-key"),A=!x.isConstant(),S=S||M.paint.get("circle-pitch-alignment")==="map"}const D=S?s.subdivisionGranularity.circle:1;for(const{feature:M,id:F,index:Z,sourceLayerIndex:H}of r){const Y=this.layers[0]._featureFilter.needGeometry,ie=Cu(M,Y);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),ie,d))continue;const ae=A?x.evaluate(ie,{},d):void 0,ye={id:F,properties:M.properties,type:M.type,sourceLayerIndex:H,index:Z,geometry:Y?ie.geometry:Tu(M),patterns:{},sortKey:ae};b.push(ye)}A&&b.sort(((M,F)=>M.sortKey-F.sortKey));for(const M of b){const{geometry:F,index:Z,sourceLayerIndex:H}=M,Y=r[Z].feature;this.addFeature(M,F,Z,d,D),s.featureIndex.insert(Y,F,Z,H,this.index)}}update(r,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,{imagePositions:d})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,di),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,s,d,h,b=1){let x;switch(b){case 1:x=[0,7];break;case 3:x=[0,2,5,7];break;case 5:x=[0,1,3,4,6,7];break;case 7:x=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${b}; valid values are 1, 3, 5, 7.`)}const A=x.length;for(const S of s)for(const D of S){const M=D.x,F=D.y;if(M<0||M>=lt||F<0||F>=lt)continue;const Z=this.segments.prepareSegment(A*A,this.layoutVertexArray,this.indexArray,r.sortKey),H=Z.vertexLength;for(let Y=0;Y<A;Y++)for(let ie=0;ie<A;ie++)EI(this.layoutVertexArray,M,F,x[ie],x[Y]);for(let Y=0;Y<A-1;Y++)for(let ie=0;ie<A-1;ie++){const ae=H+Y*A+ie,ye=H+(Y+1)*A+ie;this.indexArray.emplaceBack(ae,ye+1,ae+1),this.indexArray.emplaceBack(ae,ye,ye+1)}Z.vertexLength+=A*A,Z.primitiveLength+=(A-1)*(A-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,{imagePositions:{},canonical:h})}}function l1(o,r){for(let s=0;s<o.length;s++)if(ud(r,o[s]))return!0;for(let s=0;s<r.length;s++)if(ud(o,r[s]))return!0;return!!Dv(o,r)}function ny(o,r,s){return!!ud(o,r)||!!Iv(r,o,s)}function u1(o,r){if(o.length===1)return d1(r,o[0]);for(let s=0;s<r.length;s++){const d=r[s];for(let h=0;h<d.length;h++)if(ud(o,d[h]))return!0}for(let s=0;s<o.length;s++)if(d1(r,o[s]))return!0;for(let s=0;s<r.length;s++)if(Dv(o,r[s]))return!0;return!1}function AI(o,r,s){if(o.length>1){if(Dv(o,r))return!0;for(let d=0;d<r.length;d++)if(Iv(r[d],o,s))return!0}for(let d=0;d<o.length;d++)if(Iv(o[d],r,s))return!0;return!1}function Dv(o,r){if(o.length===0||r.length===0)return!1;for(let s=0;s<o.length-1;s++){const d=o[s],h=o[s+1];for(let b=0;b<r.length-1;b++)if(RI(d,h,r[b],r[b+1]))return!0}return!1}function RI(o,r,s,d){return qr(o,s,d)!==qr(r,s,d)&&qr(o,r,s)!==qr(o,r,d)}function Iv(o,r,s){const d=s*s;if(r.length===1)return o.distSqr(r[0])<d;for(let h=1;h<r.length;h++)if(c1(o,r[h-1],r[h])<d)return!0;return!1}function c1(o,r,s){const d=r.distSqr(s);if(d===0)return o.distSqr(r);const h=((o.x-r.x)*(s.x-r.x)+(o.y-r.y)*(s.y-r.y))/d;return o.distSqr(h<0?r:h>1?s:s.sub(r)._mult(h)._add(r))}function d1(o,r){let s,d,h,b=!1;for(let x=0;x<o.length;x++){s=o[x];for(let A=0,S=s.length-1;A<s.length;S=A++)d=s[A],h=s[S],d.y>r.y!=h.y>r.y&&r.x<(h.x-d.x)*(r.y-d.y)/(h.y-d.y)+d.x&&(b=!b)}return b}function ud(o,r){let s=!1;for(let d=0,h=o.length-1;d<o.length;h=d++){const b=o[d],x=o[h];b.y>r.y!=x.y>r.y&&r.x<(x.x-b.x)*(r.y-b.y)/(x.y-b.y)+b.x&&(s=!s)}return s}function SI(o,r,s){const d=s[0],h=s[2];if(o.x<d.x&&r.x<d.x||o.x>h.x&&r.x>h.x||o.y<d.y&&r.y<d.y||o.y>h.y&&r.y>h.y)return!1;const b=qr(o,r,s[0]);return b!==qr(o,r,s[1])||b!==qr(o,r,s[2])||b!==qr(o,r,s[3])}function cd(o,r,s){const d=r.paint.get(o).value;return d.kind==="constant"?d.value:s.programConfigurations.get(r.id).getMaxValue(o)}function sy(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function oy(o,r,s,d,h){if(!r[0]&&!r[1])return o;const b=_.convert(r)._mult(h);s==="viewport"&&b._rotate(-d);const x=[];for(let A=0;A<o.length;A++)x.push(o[A].sub(b));return x}function TI({queryGeometry:o,size:r},s){return ny(o,s,r)}function CI({queryGeometry:o,size:r,transform:s,unwrappedTileID:d,getElevation:h},b){return ny(o,b,r*(s.projectTileCoordinates(b.x,b.y,d,h).signedDistanceFromCamera/s.cameraToCenterDistance))}function kI({queryGeometry:o,size:r,transform:s,unwrappedTileID:d,getElevation:h},b){const x=s.projectTileCoordinates(b.x,b.y,d,h).signedDistanceFromCamera,A=r*(s.cameraToCenterDistance/x);return ny(o,Bv(b,s,d,h),A)}function PI({queryGeometry:o,size:r,transform:s,unwrappedTileID:d,getElevation:h},b){return ny(o,Bv(b,s,d,h),r)}function p1({queryGeometry:o,size:r,transform:s,unwrappedTileID:d,getElevation:h,pitchAlignment:b="map",pitchScale:x="map"},A){const S=b==="map"?x==="map"?TI:CI:x==="map"?kI:PI,D={queryGeometry:o,size:r,transform:s,unwrappedTileID:d,getElevation:h};for(const M of A)for(const F of M)if(S(D,F))return!0;return!1}function Bv(o,r,s,d){const h=r.projectTileCoordinates(o.x,o.y,s,d).point;return new _((.5*h.x+.5)*r.width,(.5*-h.y+.5)*r.height)}let f1,h1;It("CircleBucket",Lv,{omit:["layers"]});var LI={get paint(){return h1=h1||new Tn({"circle-radius":new tr(Ke.paint_circle["circle-radius"]),"circle-color":new tr(Ke.paint_circle["circle-color"]),"circle-blur":new tr(Ke.paint_circle["circle-blur"]),"circle-opacity":new tr(Ke.paint_circle["circle-opacity"]),"circle-translate":new qt(Ke.paint_circle["circle-translate"]),"circle-translate-anchor":new qt(Ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new qt(Ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new qt(Ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new tr(Ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new tr(Ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new tr(Ke.paint_circle["circle-stroke-opacity"])})},get layout(){return f1=f1||new Tn({"circle-sort-key":new tr(Ke.layout_circle["circle-sort-key"])})}};class DI extends ks{constructor(r,s){super(r,LI,s)}createBucket(r){return new Lv(r)}queryRadius(r){const s=r;return cd("circle-radius",this,s)+cd("circle-stroke-width",this,s)+sy(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:d,geometry:h,transform:b,pixelsToTileUnits:x,unwrappedTileID:A,getElevation:S}){const D=oy(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-b.bearingInRadians,x),M=this.paint.get("circle-radius").evaluate(s,d)+this.paint.get("circle-stroke-width").evaluate(s,d),F=this.paint.get("circle-pitch-scale"),Z=this.paint.get("circle-pitch-alignment");let H,Y;return Z==="map"?(H=D,Y=M*x):(H=(function(ie,ae,ye,qe){return ie.map((Se=>Bv(Se,ae,ye,qe)))})(D,b,A,S),Y=M),p1({queryGeometry:H,size:Y,transform:b,unwrappedTileID:A,getElevation:S,pitchAlignment:Z,pitchScale:F},h)}}class m1 extends Lv{}let y1;It("HeatmapBucket",m1,{omit:["layers"]});var II={get paint(){return y1=y1||new Tn({"heatmap-radius":new tr(Ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new tr(Ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new qt(Ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new nd(Ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new qt(Ke.paint_heatmap["heatmap-opacity"])})}};function Mv(o,{width:r,height:s},d,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==r*s*d)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${r*s*d}`)}else h=new Uint8Array(r*s*d);return o.width=r,o.height=s,o.data=h,o}function g1(o,{width:r,height:s},d){if(r===o.width&&s===o.height)return;const h=Mv({},{width:r,height:s},d);zv(o,h,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,r),height:Math.min(o.height,s)},d),o.width=r,o.height=s,o.data=h.data}function zv(o,r,s,d,h,b){if(h.width===0||h.height===0)return r;if(h.width>o.width||h.height>o.height||s.x>o.width-h.width||s.y>o.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>r.width||h.height>r.height||d.x>r.width-h.width||d.y>r.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const x=o.data,A=r.data;if(x===A)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<h.height;S++){const D=((s.y+S)*o.width+s.x)*b,M=((d.y+S)*r.width+d.x)*b;for(let F=0;F<h.width*b;F++)A[M+F]=x[D+F]}return r}class Uf{constructor(r,s){Mv(this,r,1,s)}resize(r){g1(this,r,1)}clone(){return new Uf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,d,h,b){zv(r,s,d,h,b,1)}}class Qn{constructor(r,s){Mv(this,r,4,s)}resize(r){g1(this,r,4)}replace(r,s){s?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Qn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,d,h,b){zv(r,s,d,h,b,4)}setPixel(r,s,d){const h=4*(r*this.width+s);this.data[h+0]=Math.round(255*d.r/d.a),this.data[h+1]=Math.round(255*d.g/d.a),this.data[h+2]=Math.round(255*d.b/d.a),this.data[h+3]=Math.round(255*d.a)}}function _1(o){const r={},s=o.resolution||256,d=o.clips?o.clips.length:1,h=o.image||new Qn({width:s,height:d});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const b=(x,A,S)=>{r[o.evaluationKey]=S;const D=o.expression.evaluate(r);h.setPixel(x/4/s,A/4,D)};if(o.clips)for(let x=0,A=0;x<d;++x,A+=4*s)for(let S=0,D=0;S<s;S++,D+=4){const M=S/(s-1),{start:F,end:Z}=o.clips[x];b(A,D,F*(1-M)+Z*M)}else for(let x=0,A=0;x<s;x++,A+=4)b(0,A,x/(s-1));return h}It("AlphaImage",Uf),It("RGBAImage",Qn);const Ov="big-fb";class BI extends ks{createBucket(r){return new m1(r)}constructor(r,s){super(r,II,s),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Ov)&&this.heatmapFbos.delete(Ov)}queryRadius(r){return cd("heatmap-radius",this,r)}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:d,geometry:h,transform:b,pixelsToTileUnits:x,unwrappedTileID:A,getElevation:S}){return p1({queryGeometry:r,size:this.paint.get("heatmap-radius").evaluate(s,d)*x,transform:b,unwrappedTileID:A,getElevation:S},h)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let b1;var MI={get paint(){return b1=b1||new Tn({"hillshade-illumination-direction":new qt(Ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new qt(Ke.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new qt(Ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new qt(Ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new qt(Ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new qt(Ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new qt(Ke.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new qt(Ke.paint_hillshade["hillshade-method"])})}};class zI extends ks{constructor(r,s){super(r,MI,s),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let r=this.paint.get("hillshade-illumination-direction").values,s=this.paint.get("hillshade-illumination-altitude").values,d=this.paint.get("hillshade-highlight-color").values,h=this.paint.get("hillshade-shadow-color").values;const b=Math.max(r.length,s.length,d.length,h.length);r=r.concat(Array(b-r.length).fill(r.at(-1))),s=s.concat(Array(b-s.length).fill(s.at(-1))),d=d.concat(Array(b-d.length).fill(d.at(-1))),h=h.concat(Array(b-h.length).fill(h.at(-1)));const x=s.map(Ii);return{directionRadians:r.map(Ii),altitudeRadians:x,shadowColor:h,highlightColor:d}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let v1;var OI={get paint(){return v1=v1||new Tn({"color-relief-opacity":new qt(Ke["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new nd(Ke["paint_color-relief"]["color-relief-color"])})}};class Vv{constructor(r,s,d,h){this.context=r,this.format=d,this.texture=r.gl.createTexture(),this.update(s,h)}update(r,s,d){const{width:h,height:b}=r,x=!(this.size&&this.size[0]===h&&this.size[1]===b||d),{context:A}=this,{gl:S}=A;if(this.useMipmap=!!(s&&s.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!s||s.premultiply!==!1)),x)this.size=[h,b],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||Qt(r)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,r):S.texImage2D(S.TEXTURE_2D,0,this.format,h,b,0,this.format,S.UNSIGNED_BYTE,r.data);else{const{x:D,y:M}=d||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||Qt(r)?S.texSubImage2D(S.TEXTURE_2D,0,D,M,S.RGBA,S.UNSIGNED_BYTE,r):S.texSubImage2D(S.TEXTURE_2D,0,D,M,h,b,S.RGBA,S.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D),A.pixelStoreUnpackFlipY.setDefault(),A.pixelStoreUnpack.setDefault(),A.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(r,s,d){const{context:h}=this,{gl:b}=h;b.bindTexture(b.TEXTURE_2D,this.texture),d!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(d=b.LINEAR),r!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,r),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,d||r),this.filter=r),s!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,s),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class x1{constructor(r,s,d,h=1,b=1,x=1,A=0){if(this.uid=r,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(d&&!["mapbox","terrarium","custom"].includes(d))return void ir(`"${d}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const S=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),d){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=b,this.blueFactor=x,this.baseShift=A;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let D=0;D<S;D++)this.data[this._idx(-1,D)]=this.data[this._idx(0,D)],this.data[this._idx(S,D)]=this.data[this._idx(S-1,D)],this.data[this._idx(D,-1)]=this.data[this._idx(D,0)],this.data[this._idx(D,S)]=this.data[this._idx(D,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let D=0;D<S;D++)for(let M=0;M<S;M++){const F=this.get(D,M);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(r,s){const d=new Uint8Array(this.data.buffer),h=4*this._idx(r,s);return this.unpack(d[h],d[h+1],d[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,s){if(r<-1||r>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(r+1)}unpack(r,s,d){return r*this.redFactor+s*this.greenFactor+d*this.blueFactor-this.baseShift}pack(r){return w1(r,this.getUnpackVector())}getPixels(){return new Qn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,s,d){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let h=s*this.dim,b=s*this.dim+this.dim,x=d*this.dim,A=d*this.dim+this.dim;switch(s){case-1:h=b-1;break;case 1:b=h+1}switch(d){case-1:x=A-1;break;case 1:A=x+1}const S=-s*this.dim,D=-d*this.dim;for(let M=x;M<A;M++)for(let F=h;F<b;F++)this.data[this._idx(F,M)]=r.data[this._idx(F+S,M+D)]}}function w1(o,r){const s=r[0],d=r[1],h=r[2],b=r[3],x=Math.min(s,d,h),A=Math.round((o+b)/x);return{r:Math.floor(A*x/s)%256,g:Math.floor(A*x/d)%256,b:Math.floor(A*x/h)%256}}It("DEMData",x1);class VI extends ks{constructor(r,s){super(r,OI,s)}_createColorRamp(r){const s={elevationStops:[],colorStops:[]},d=this._transitionablePaint._values["color-relief-color"].value.expression;if(d instanceof Fc&&d._styleExpression.expression instanceof qi){this.colorRampExpression=d;const x=d._styleExpression.expression;s.elevationStops=x.labels,s.colorStops=[];for(const A of s.elevationStops)s.colorStops.push(x.evaluate({globals:{elevation:A}}))}if(s.elevationStops.length<1&&(s.elevationStops=[0],s.colorStops=[Rr.transparent]),s.elevationStops.length<2&&(s.elevationStops.push(s.elevationStops[0]+1),s.colorStops.push(s.colorStops[0])),s.elevationStops.length<=r)return s;const h={elevationStops:[],colorStops:[]},b=(s.elevationStops.length-1)/(r-1);for(let x=0;x<s.elevationStops.length-.5;x+=b)h.elevationStops.push(s.elevationStops[Math.round(x)]),h.colorStops.push(s.colorStops[Math.round(x)]);return ir(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),h}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(r,s,d){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const h=this._createColorRamp(s),b=new Qn({width:h.colorStops.length,height:1}),x=new Qn({width:h.colorStops.length,height:1});for(let A=0;A<h.elevationStops.length;A++){const S=w1(h.elevationStops[A],d);x.setPixel(0,A,new Rr(S.r/255,S.g/255,S.b/255,1)),b.setPixel(0,A,h.colorStops[A])}return this.colorRampTextures={elevationTexture:new Vv(r,x,r.gl.RGBA),colorTexture:new Vv(r,b,r.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const UI=Li([{name:"a_pos",components:2,type:"Int16"}],4),{members:jI}=UI;function ay(o,r,s){const d=s.patternDependencies;let h=!1;for(const b of r){const x=b.paint.get(`${o}-pattern`);x.isConstant()||(h=!0);const A=x.constantOr(null);A&&(h=!0,d[A.to]=!0,d[A.from]=!0)}return h}function Uv(o,r,s,d,h){const{zoom:b}=d,x=h.patternDependencies;for(const A of r){const S=A.paint.get(`${o}-pattern`).value;if(S.kind!=="constant"){let D=S.evaluate({zoom:b-1},s,{},h.availableImages),M=S.evaluate({zoom:b},s,{},h.availableImages),F=S.evaluate({zoom:b+1},s,{},h.availableImages);D=D&&D.name?D.name:D,M=M&&M.name?M.name:M,F=F&&F.name?F.name:F,x[D]=!0,x[M]=!0,x[F]=!0,s.patterns[A.id]={min:D,mid:M,max:F}}}return s}function E1(o,r,s,d,h){let b;if(h===(function(x,A,S,D){let M=0;for(let F=A,Z=S-D;F<S;F+=D)M+=(x[Z]-x[F])*(x[F+1]+x[Z+1]),Z=F;return M})(o,r,s,d)>0)for(let x=r;x<s;x+=d)b=T1(x/d|0,o[x],o[x+1],b);else for(let x=s-d;x>=r;x-=d)b=T1(x/d|0,o[x],o[x+1],b);return b&&dd(b,b.next)&&(qf(b),b=b.next),b}function ku(o,r){if(!o)return o;r||(r=o);let s,d=o;do if(s=!1,d.steiner||!dd(d,d.next)&&Ui(d.prev,d,d.next)!==0)d=d.next;else{if(qf(d),d=r=d.prev,d===d.next)break;s=!0}while(s||d!==r);return r}function jf(o,r,s,d,h,b,x){if(!o)return;!x&&b&&(function(S,D,M,F){let Z=S;do Z.z===0&&(Z.z=jv(Z.x,Z.y,D,M,F)),Z.prevZ=Z.prev,Z.nextZ=Z.next,Z=Z.next;while(Z!==S);Z.prevZ.nextZ=null,Z.prevZ=null,(function(H){let Y,ie=1;do{let ae,ye=H;H=null;let qe=null;for(Y=0;ye;){Y++;let Se=ye,Me=0;for(let ot=0;ot<ie&&(Me++,Se=Se.nextZ,Se);ot++);let We=ie;for(;Me>0||We>0&&Se;)Me!==0&&(We===0||!Se||ye.z<=Se.z)?(ae=ye,ye=ye.nextZ,Me--):(ae=Se,Se=Se.nextZ,We--),qe?qe.nextZ=ae:H=ae,ae.prevZ=qe,qe=ae;ye=Se}qe.nextZ=null,ie*=2}while(Y>1)})(Z)})(o,d,h,b);let A=o;for(;o.prev!==o.next;){const S=o.prev,D=o.next;if(b?FI(o,d,h,b):NI(o))r.push(S.i,o.i,D.i),qf(o),o=D.next,A=D.next;else if((o=D)===A){x?x===1?jf(o=qI(ku(o),r),r,s,d,h,b,2):x===2&&KI(o,r,s,d,h,b):jf(ku(o),r,s,d,h,b,1);break}}}function NI(o){const r=o.prev,s=o,d=o.next;if(Ui(r,s,d)>=0)return!1;const h=r.x,b=s.x,x=d.x,A=r.y,S=s.y,D=d.y,M=Math.min(h,b,x),F=Math.min(A,S,D),Z=Math.max(h,b,x),H=Math.max(A,S,D);let Y=d.next;for(;Y!==r;){if(Y.x>=M&&Y.x<=Z&&Y.y>=F&&Y.y<=H&&Nf(h,A,b,S,x,D,Y.x,Y.y)&&Ui(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function FI(o,r,s,d){const h=o.prev,b=o,x=o.next;if(Ui(h,b,x)>=0)return!1;const A=h.x,S=b.x,D=x.x,M=h.y,F=b.y,Z=x.y,H=Math.min(A,S,D),Y=Math.min(M,F,Z),ie=Math.max(A,S,D),ae=Math.max(M,F,Z),ye=jv(H,Y,r,s,d),qe=jv(ie,ae,r,s,d);let Se=o.prevZ,Me=o.nextZ;for(;Se&&Se.z>=ye&&Me&&Me.z<=qe;){if(Se.x>=H&&Se.x<=ie&&Se.y>=Y&&Se.y<=ae&&Se!==h&&Se!==x&&Nf(A,M,S,F,D,Z,Se.x,Se.y)&&Ui(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,Me.x>=H&&Me.x<=ie&&Me.y>=Y&&Me.y<=ae&&Me!==h&&Me!==x&&Nf(A,M,S,F,D,Z,Me.x,Me.y)&&Ui(Me.prev,Me,Me.next)>=0))return!1;Me=Me.nextZ}for(;Se&&Se.z>=ye;){if(Se.x>=H&&Se.x<=ie&&Se.y>=Y&&Se.y<=ae&&Se!==h&&Se!==x&&Nf(A,M,S,F,D,Z,Se.x,Se.y)&&Ui(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;Me&&Me.z<=qe;){if(Me.x>=H&&Me.x<=ie&&Me.y>=Y&&Me.y<=ae&&Me!==h&&Me!==x&&Nf(A,M,S,F,D,Z,Me.x,Me.y)&&Ui(Me.prev,Me,Me.next)>=0)return!1;Me=Me.nextZ}return!0}function qI(o,r){let s=o;do{const d=s.prev,h=s.next.next;!dd(d,h)&&R1(d,s,s.next,h)&&Ff(d,h)&&Ff(h,d)&&(r.push(d.i,s.i,h.i),qf(s),qf(s.next),s=o=h),s=s.next}while(s!==o);return ku(s)}function KI(o,r,s,d,h,b){let x=o;do{let A=x.next.next;for(;A!==x.prev;){if(x.i!==A.i&&XI(x,A)){let S=S1(x,A);return x=ku(x,x.next),S=ku(S,S.next),jf(x,r,s,d,h,b,0),void jf(S,r,s,d,h,b,0)}A=A.next}x=x.next}while(x!==o)}function GI(o,r){let s=o.x-r.x;return s===0&&(s=o.y-r.y,s===0)&&(s=(o.next.y-o.y)/(o.next.x-o.x)-(r.next.y-r.y)/(r.next.x-r.x)),s}function $I(o,r){const s=(function(h,b){let x=b;const A=h.x,S=h.y;let D,M=-1/0;if(dd(h,x))return x;do{if(dd(h,x.next))return x.next;if(S<=x.y&&S>=x.next.y&&x.next.y!==x.y){const ie=x.x+(S-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(ie<=A&&ie>M&&(M=ie,D=x.x<x.next.x?x:x.next,ie===A))return D}x=x.next}while(x!==b);if(!D)return null;const F=D,Z=D.x,H=D.y;let Y=1/0;x=D;do{if(A>=x.x&&x.x>=Z&&A!==x.x&&A1(S<H?A:M,S,Z,H,S<H?M:A,S,x.x,x.y)){const ie=Math.abs(S-x.y)/(A-x.x);Ff(x,h)&&(ie<Y||ie===Y&&(x.x>D.x||x.x===D.x&&ZI(D,x)))&&(D=x,Y=ie)}x=x.next}while(x!==F);return D})(o,r);if(!s)return r;const d=S1(s,o);return ku(d,d.next),ku(s,s.next)}function ZI(o,r){return Ui(o.prev,o,r.prev)<0&&Ui(r.next,o,o.next)<0}function jv(o,r,s,d,h){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-s)*h|0)|o<<8))|o<<4))|o<<2))|o<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-d)*h|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function HI(o){let r=o,s=o;do(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next;while(r!==o);return s}function A1(o,r,s,d,h,b,x,A){return(h-x)*(r-A)>=(o-x)*(b-A)&&(o-x)*(d-A)>=(s-x)*(r-A)&&(s-x)*(b-A)>=(h-x)*(d-A)}function Nf(o,r,s,d,h,b,x,A){return!(o===x&&r===A)&&A1(o,r,s,d,h,b,x,A)}function XI(o,r){return o.next.i!==r.i&&o.prev.i!==r.i&&!(function(s,d){let h=s;do{if(h.i!==s.i&&h.next.i!==s.i&&h.i!==d.i&&h.next.i!==d.i&&R1(h,h.next,s,d))return!0;h=h.next}while(h!==s);return!1})(o,r)&&(Ff(o,r)&&Ff(r,o)&&(function(s,d){let h=s,b=!1;const x=(s.x+d.x)/2,A=(s.y+d.y)/2;do h.y>A!=h.next.y>A&&h.next.y!==h.y&&x<(h.next.x-h.x)*(A-h.y)/(h.next.y-h.y)+h.x&&(b=!b),h=h.next;while(h!==s);return b})(o,r)&&(Ui(o.prev,o,r.prev)||Ui(o,r.prev,r))||dd(o,r)&&Ui(o.prev,o,o.next)>0&&Ui(r.prev,r,r.next)>0)}function Ui(o,r,s){return(r.y-o.y)*(s.x-r.x)-(r.x-o.x)*(s.y-r.y)}function dd(o,r){return o.x===r.x&&o.y===r.y}function R1(o,r,s,d){const h=uy(Ui(o,r,s)),b=uy(Ui(o,r,d)),x=uy(Ui(s,d,o)),A=uy(Ui(s,d,r));return h!==b&&x!==A||!(h!==0||!ly(o,s,r))||!(b!==0||!ly(o,d,r))||!(x!==0||!ly(s,o,d))||!(A!==0||!ly(s,r,d))}function ly(o,r,s){return r.x<=Math.max(o.x,s.x)&&r.x>=Math.min(o.x,s.x)&&r.y<=Math.max(o.y,s.y)&&r.y>=Math.min(o.y,s.y)}function uy(o){return o>0?1:o<0?-1:0}function Ff(o,r){return Ui(o.prev,o,o.next)<0?Ui(o,r,o.next)>=0&&Ui(o,o.prev,r)>=0:Ui(o,r,o.prev)<0||Ui(o,o.next,r)<0}function S1(o,r){const s=Nv(o.i,o.x,o.y),d=Nv(r.i,r.x,r.y),h=o.next,b=r.prev;return o.next=r,r.prev=o,s.next=h,h.prev=s,d.next=s,s.prev=d,b.next=d,d.prev=b,d}function T1(o,r,s,d){const h=Nv(o,r,s);return d?(h.next=d.next,h.prev=d,d.next.prev=h,d.next=h):(h.prev=h,h.next=h),h}function qf(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Nv(o,r,s){return{i:o,x:r,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class pd{constructor(r,s){if(s>r)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=r,this._minGranularity=s}getGranularityForZoomLevel(r){return Math.max(Math.floor(this._baseZoomGranularity/(1<<r)),this._minGranularity,1)}}class cy{constructor(r){this.fill=r.fill,this.line=r.line,this.tile=r.tile,this.stencil=r.stencil,this.circle=r.circle}}cy.noSubdivision=new cy({fill:new pd(0,0),line:new pd(0,0),tile:new pd(0,0),stencil:new pd(0,0),circle:1}),It("SubdivisionGranularityExpression",pd),It("SubdivisionGranularitySetting",cy);const fd=-32768,Kf=32767;class WI{constructor(r,s){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=r,this._granularityCellSize=lt/r,this._canonical=s}_getKey(r,s){return(r+=32768)<<16|s+32768}_vertexToIndex(r,s){if(r<-32768||s<-32768||r>32767||s>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const d=0|Math.round(r),h=0|Math.round(s),b=this._getKey(d,h);if(this._vertexDictionary.has(b))return this._vertexDictionary.get(b);const x=this._vertexBuffer.length/2;return this._vertexDictionary.set(b,x),this._vertexBuffer.push(d,h),x}_subdivideTrianglesScanline(r){if(this._granularity<2)return(function(h,b){const x=[];for(let A=0;A<b.length;A+=3){const S=b[A],D=b[A+1],M=b[A+2],F=h[2*S],Z=h[2*S+1];(h[2*D]-F)*(h[2*M+1]-Z)-(h[2*D+1]-Z)*(h[2*M]-F)>0?(x.push(S),x.push(M),x.push(D)):(x.push(S),x.push(D),x.push(M))}return x})(this._vertexBuffer,r);const s=[],d=r.length;for(let h=0;h<d;h+=3){const b=[r[h+0],r[h+1],r[h+2]],x=[this._vertexBuffer[2*r[h+0]+0],this._vertexBuffer[2*r[h+0]+1],this._vertexBuffer[2*r[h+1]+0],this._vertexBuffer[2*r[h+1]+1],this._vertexBuffer[2*r[h+2]+0],this._vertexBuffer[2*r[h+2]+1]];let A=1/0,S=1/0,D=-1/0,M=-1/0;for(let ie=0;ie<3;ie++){const ae=x[2*ie],ye=x[2*ie+1];A=Math.min(A,ae),D=Math.max(D,ae),S=Math.min(S,ye),M=Math.max(M,ye)}if(A===D||S===M)continue;const F=Math.floor(A/this._granularityCellSize),Z=Math.ceil(D/this._granularityCellSize),H=Math.floor(S/this._granularityCellSize),Y=Math.ceil(M/this._granularityCellSize);if(F!==Z||H!==Y)for(let ie=H;ie<Y;ie++){const ae=this._scanlineGenerateVertexRingForCellRow(ie,x,b);YI(this._vertexBuffer,ae,s)}else s.push(...b)}return s}_scanlineGenerateVertexRingForCellRow(r,s,d){const h=r*this._granularityCellSize,b=h+this._granularityCellSize,x=[];for(let A=0;A<3;A++){const S=s[2*A],D=s[2*A+1],M=s[2*(A+1)%6],F=s[(2*(A+1)+1)%6],Z=s[2*(A+2)%6],H=s[(2*(A+2)+1)%6],Y=M-S,ie=F-D,ae=Y===0,ye=ie===0,qe=(h-D)/ie,Se=(b-D)/ie,Me=Math.min(qe,Se),We=Math.max(qe,Se);if(!ye&&(Me>=1||We<=0)||ye&&(D<h||D>b)){F>=h&&F<=b&&x.push(d[(A+1)%3]);continue}!ye&&Me>0&&x.push(this._vertexToIndex(S+Y*Me,D+ie*Me));const ot=S+Y*Math.max(Me,0),mt=S+Y*Math.min(We,1);ae||this._generateIntraEdgeVertices(x,S,D,M,F,ot,mt),!ye&&We<1&&x.push(this._vertexToIndex(S+Y*We,D+ie*We)),(ye||F>=h&&F<=b)&&x.push(d[(A+1)%3]),!ye&&(F<=h||F>=b)&&this._generateInterEdgeVertices(x,S,D,M,F,Z,H,mt,h,b)}return x}_generateIntraEdgeVertices(r,s,d,h,b,x,A){const S=h-s,D=b-d,M=D===0,F=M?Math.min(s,h):Math.min(x,A),Z=M?Math.max(s,h):Math.max(x,A),H=Math.floor(F/this._granularityCellSize)+1,Y=Math.ceil(Z/this._granularityCellSize)-1;if(M?s<h:x<A)for(let ie=H;ie<=Y;ie++){const ae=ie*this._granularityCellSize;r.push(this._vertexToIndex(ae,d+D*(ae-s)/S))}else for(let ie=Y;ie>=H;ie--){const ae=ie*this._granularityCellSize;r.push(this._vertexToIndex(ae,d+D*(ae-s)/S))}}_generateInterEdgeVertices(r,s,d,h,b,x,A,S,D,M){const F=b-d,Z=x-h,H=A-b,Y=(D-b)/H,ie=(M-b)/H,ae=Math.min(Y,ie),ye=Math.max(Y,ie),qe=h+Z*ae;let Se=Math.floor(Math.min(qe,S)/this._granularityCellSize)+1,Me=Math.ceil(Math.max(qe,S)/this._granularityCellSize)-1,We=S<qe;const ot=H===0;if(ot&&(A===D||A===M))return;if(ot||ae>=1||ye<=0){const Dt=d-A,Rt=x+(s-x)*Math.min((D-A)/Dt,(M-A)/Dt);Se=Math.floor(Math.min(Rt,S)/this._granularityCellSize)+1,Me=Math.ceil(Math.max(Rt,S)/this._granularityCellSize)-1,We=S<Rt}const mt=F>0?M:D;if(We)for(let Dt=Se;Dt<=Me;Dt++)r.push(this._vertexToIndex(Dt*this._granularityCellSize,mt));else for(let Dt=Me;Dt>=Se;Dt--)r.push(this._vertexToIndex(Dt*this._granularityCellSize,mt))}_generateOutline(r){const s=[];for(const d of r){const h=Pu(d,this._granularity,!0),b=this._pointArrayToIndices(h),x=[];for(let A=1;A<b.length;A++)x.push(b[A-1]),x.push(b[A]);s.push(x)}return s}_handlePoles(r){let s=!1,d=!1;this._canonical&&(this._canonical.y===0&&(s=!0),this._canonical.y===(1<<this._canonical.z)-1&&(d=!0)),(s||d)&&this._fillPoles(r,s,d)}_ensureNoPoleVertices(){const r=this._vertexBuffer;for(let s=0;s<r.length;s+=2){const d=r[s+1];d===fd&&(r[s+1]=-32767),d===Kf&&(r[s+1]=32766)}}_generatePoleQuad(r,s,d,h,b,x){h>b!=(x===fd)?(r.push(s),r.push(d),r.push(this._vertexToIndex(h,x)),r.push(d),r.push(this._vertexToIndex(b,x)),r.push(this._vertexToIndex(h,x))):(r.push(d),r.push(s),r.push(this._vertexToIndex(h,x)),r.push(this._vertexToIndex(b,x)),r.push(d),r.push(this._vertexToIndex(h,x)))}_fillPoles(r,s,d){const h=this._vertexBuffer,b=lt,x=r.length;for(let A=2;A<x;A+=3){const S=r[A-2],D=r[A-1],M=r[A],F=h[2*S],Z=h[2*S+1],H=h[2*D],Y=h[2*D+1],ie=h[2*M],ae=h[2*M+1];s&&(Z===0&&Y===0&&this._generatePoleQuad(r,S,D,F,H,fd),Y===0&&ae===0&&this._generatePoleQuad(r,D,M,H,ie,fd),ae===0&&Z===0&&this._generatePoleQuad(r,M,S,ie,F,fd)),d&&(Z===b&&Y===b&&this._generatePoleQuad(r,S,D,F,H,Kf),Y===b&&ae===b&&this._generatePoleQuad(r,D,M,H,ie,Kf),ae===b&&Z===b&&this._generatePoleQuad(r,M,S,ie,F,Kf))}}_initializeVertices(r){for(let s=0;s<r.length;s+=2)this._vertexToIndex(r[s],r[s+1])}subdividePolygonInternal(r,s){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:d,holeIndices:h}=(function(A){const S=[],D=[];for(const M of A)if(M.length!==0){M!==A[0]&&S.push(D.length/2);for(let F=0;F<M.length;F++)D.push(M[F].x),D.push(M[F].y)}return{flattened:D,holeIndices:S}})(r);let b;this._initializeVertices(d);try{const A=(function(D,M,F=2){const Z=M&&M.length,H=Z?M[0]*F:D.length;let Y=E1(D,0,H,F,!0);const ie=[];if(!Y||Y.next===Y.prev)return ie;let ae,ye,qe;if(Z&&(Y=(function(Se,Me,We,ot){const mt=[];for(let Dt=0,Rt=Me.length;Dt<Rt;Dt++){const Pt=E1(Se,Me[Dt]*ot,Dt<Rt-1?Me[Dt+1]*ot:Se.length,ot,!1);Pt===Pt.next&&(Pt.steiner=!0),mt.push(HI(Pt))}mt.sort(GI);for(let Dt=0;Dt<mt.length;Dt++)We=$I(mt[Dt],We);return We})(D,M,Y,F)),D.length>80*F){ae=D[0],ye=D[1];let Se=ae,Me=ye;for(let We=F;We<H;We+=F){const ot=D[We],mt=D[We+1];ot<ae&&(ae=ot),mt<ye&&(ye=mt),ot>Se&&(Se=ot),mt>Me&&(Me=mt)}qe=Math.max(Se-ae,Me-ye),qe=qe!==0?32767/qe:0}return jf(Y,ie,F,ae,ye,qe,0),ie})(d,h),S=this._convertIndices(d,A);b=this._subdivideTrianglesScanline(S)}catch(A){console.error(A)}let x=[];return s&&(x=this._generateOutline(r)),this._ensureNoPoleVertices(),this._handlePoles(b),{verticesFlattened:this._vertexBuffer,indicesTriangles:b,indicesLineList:x}}_convertIndices(r,s){const d=[];for(let h=0;h<s.length;h++)d.push(this._vertexToIndex(r[2*s[h]],r[2*s[h]+1]));return d}_pointArrayToIndices(r){const s=[];for(let d=0;d<r.length;d++){const h=r[d];s.push(this._vertexToIndex(h.x,h.y))}return s}}function C1(o,r,s,d=!0){return new WI(s,r).subdividePolygonInternal(o,d)}function Pu(o,r,s=!1){if(!o||o.length<1)return[];if(o.length<2)return[];const d=o[0],h=o[o.length-1],b=s&&(d.x!==h.x||d.y!==h.y);if(r<2)return b?[...o,o[0]]:[...o];const x=Math.floor(lt/r),A=[];A.push(new _(o[0].x,o[0].y));const S=o.length,D=b?S:S-1;for(let M=0;M<D;M++){const F=o[M],Z=M<S-1?o[M+1]:o[0],H=F.x,Y=F.y,ie=Z.x,ae=Z.y,ye=H!==ie,qe=Y!==ae;if(!ye&&!qe)continue;const Se=ie-H,Me=ae-Y,We=Math.abs(Se),ot=Math.abs(Me);let mt=H,Dt=Y;for(;;){const Pt=Se>0?(Math.floor(mt/x)+1)*x:(Math.ceil(mt/x)-1)*x,Zt=Me>0?(Math.floor(Dt/x)+1)*x:(Math.ceil(Dt/x)-1)*x,Tt=Math.abs(mt-Pt),Lt=Math.abs(Dt-Zt),ct=Math.abs(mt-ie),sr=Math.abs(Dt-ae),cr=ye?Tt/We:Number.POSITIVE_INFINITY,Yt=qe?Lt/ot:Number.POSITIVE_INFINITY;if((ct<=Tt||!ye)&&(sr<=Lt||!qe))break;if(cr<Yt&&ye||!qe){mt=Pt,Dt+=Me*cr;const Kt=new _(mt,Math.round(Dt));A[A.length-1].x===Kt.x&&A[A.length-1].y===Kt.y||A.push(Kt)}else{mt+=Se*Yt,Dt=Zt;const Kt=new _(Math.round(mt),Dt);A[A.length-1].x===Kt.x&&A[A.length-1].y===Kt.y||A.push(Kt)}}const Rt=new _(ie,ae);A[A.length-1].x===Rt.x&&A[A.length-1].y===Rt.y||A.push(Rt)}return A}function YI(o,r,s){if(r.length===0)throw new Error("Subdivision vertex ring is empty.");let d=0,h=o[2*r[0]];for(let S=1;S<r.length;S++){const D=o[2*r[S]];D<h&&(h=D,d=S)}const b=r.length;let x=d,A=(x+1)%b;for(;;){const S=x-1>=0?x-1:b-1,D=(A+1)%b,M=o[2*r[S]],F=o[2*r[D]],Z=o[2*r[x]],H=o[2*r[x]+1],Y=o[2*r[A]+1];let ie=!1;if(M<F)ie=!0;else if(M>F)ie=!1;else{const ae=Y-H,ye=-(o[2*r[A]]-Z),qe=H<Y?1:-1;((M-Z)*ae+(o[2*r[S]+1]-H)*ye)*qe>((F-Z)*ae+(o[2*r[D]+1]-H)*ye)*qe&&(ie=!0)}if(ie){const ae=r[S],ye=r[x],qe=r[A];ae!==ye&&ae!==qe&&ye!==qe&&s.push(qe,ye,ae),x--,x<0&&(x=b-1)}else{const ae=r[D],ye=r[x],qe=r[A];ae!==ye&&ae!==qe&&ye!==qe&&s.push(qe,ye,ae),A++,A>=b&&(A=0)}if(S===D)break}}function k1(o,r,s,d,h,b,x,A,S){const D=h.length/2,M=x&&A&&S;if(D<Vr.MAX_VERTEX_ARRAY_LENGTH){const F=r.prepareSegment(D,s,d),Z=F.vertexLength;for(let ie=0;ie<b.length;ie+=3)d.emplaceBack(Z+b[ie],Z+b[ie+1],Z+b[ie+2]);let H,Y;F.vertexLength+=D,F.primitiveLength+=b.length/3,M&&(Y=x.prepareSegment(D,s,A),H=Y.vertexLength,Y.vertexLength+=D);for(let ie=0;ie<h.length;ie+=2)o(h[ie],h[ie+1]);if(M)for(let ie=0;ie<S.length;ie++){const ae=S[ie];for(let ye=1;ye<ae.length;ye+=2)A.emplaceBack(H+ae[ye-1],H+ae[ye]);Y.primitiveLength+=ae.length/2}}else(function(F,Z,H,Y,ie,ae){const ye=[];for(let ot=0;ot<Y.length/2;ot++)ye.push(-1);const qe={count:0};let Se=0,Me=F.getOrCreateLatestSegment(Z,H),We=Me.vertexLength;for(let ot=2;ot<ie.length;ot+=3){const mt=ie[ot-2],Dt=ie[ot-1],Rt=ie[ot];let Pt=ye[mt]<Se,Zt=ye[Dt]<Se,Tt=ye[Rt]<Se;Me.vertexLength+((Pt?1:0)+(Zt?1:0)+(Tt?1:0))>Vr.MAX_VERTEX_ARRAY_LENGTH&&(Me=F.createNewSegment(Z,H),Se=qe.count,Pt=!0,Zt=!0,Tt=!0,We=0);const Lt=Gf(ye,Y,ae,qe,mt,Pt,Me),ct=Gf(ye,Y,ae,qe,Dt,Zt,Me),sr=Gf(ye,Y,ae,qe,Rt,Tt,Me);H.emplaceBack(We+Lt-Se,We+ct-Se,We+sr-Se),Me.primitiveLength++}})(r,s,d,h,b,o),M&&(function(F,Z,H,Y,ie,ae){const ye=[];for(let ot=0;ot<Y.length/2;ot++)ye.push(-1);const qe={count:0};let Se=0,Me=F.getOrCreateLatestSegment(Z,H),We=Me.vertexLength;for(let ot=0;ot<ie.length;ot++){const mt=ie[ot];for(let Dt=1;Dt<ie[ot].length;Dt+=2){const Rt=mt[Dt-1],Pt=mt[Dt];let Zt=ye[Rt]<Se,Tt=ye[Pt]<Se;Me.vertexLength+((Zt?1:0)+(Tt?1:0))>Vr.MAX_VERTEX_ARRAY_LENGTH&&(Me=F.createNewSegment(Z,H),Se=qe.count,Zt=!0,Tt=!0,We=0);const Lt=Gf(ye,Y,ae,qe,Rt,Zt,Me),ct=Gf(ye,Y,ae,qe,Pt,Tt,Me);H.emplaceBack(We+Lt-Se,We+ct-Se),Me.primitiveLength++}}})(x,s,A,h,S,o),r.forceNewSegmentOnNextPrepare(),x?.forceNewSegmentOnNextPrepare()}function Gf(o,r,s,d,h,b,x){if(b){const A=d.count;return s(r[2*h],r[2*h+1]),o[h]=d.count,d.count++,x.vertexLength++,A}return o[h]}class Fv{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=r.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Fe,this.indexArray=new Jr,this.indexArray2=new ii,this.programConfigurations=new Ko(r.layers,r.zoom),this.segments=new Vr,this.segments2=new Vr,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(r,s,d){this.hasDependencies=ay("fill",this.layers,s);const h=this.layers[0].layout.get("fill-sort-key"),b=!h.isConstant(),x=[];for(const{feature:A,id:S,index:D,sourceLayerIndex:M}of r){const F=this.layers[0]._featureFilter.needGeometry,Z=Cu(A,F);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),Z,d))continue;const H=b?h.evaluate(Z,{},d,s.availableImages):void 0,Y={id:S,properties:A.properties,type:A.type,sourceLayerIndex:M,index:D,geometry:F?Z.geometry:Tu(A),patterns:{},sortKey:H};x.push(Y)}b&&x.sort(((A,S)=>A.sortKey-S.sortKey));for(const A of x){const{geometry:S,index:D,sourceLayerIndex:M}=A;if(this.hasDependencies){const F=Uv("fill",this.layers,A,{zoom:this.zoom},s);this.patternFeatures.push(F)}else this.addFeature(A,S,D,d,{},s.subdivisionGranularity);s.featureIndex.insert(r[D].feature,S,D,M,this.index)}}update(r,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,{imagePositions:d})}addFeatures(r,s,d){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,s,d,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,jI),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,s,d,h,b,x){for(const A of Pc(s,500)){const S=C1(A,h,x.fill.getGranularityForZoomLevel(h.z)),D=this.layoutVertexArray;k1(((M,F)=>{D.emplaceBack(M,F)}),this.segments,this.layoutVertexArray,this.indexArray,S.verticesFlattened,S.indicesTriangles,this.segments2,this.indexArray2,S.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,{imagePositions:b,canonical:h})}}let P1,L1;It("FillBucket",Fv,{omit:["layers","patternFeatures"]});var JI={get paint(){return L1=L1||new Tn({"fill-antialias":new qt(Ke.paint_fill["fill-antialias"]),"fill-opacity":new tr(Ke.paint_fill["fill-opacity"]),"fill-color":new tr(Ke.paint_fill["fill-color"]),"fill-outline-color":new tr(Ke.paint_fill["fill-outline-color"]),"fill-translate":new qt(Ke.paint_fill["fill-translate"]),"fill-translate-anchor":new qt(Ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new dl(Ke.paint_fill["fill-pattern"])})},get layout(){return P1=P1||new Tn({"fill-sort-key":new tr(Ke.layout_fill["fill-sort-key"])})}};class QI extends ks{constructor(r,s){super(r,JI,s)}recalculate(r,s){super.recalculate(r,s);const d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Fv(r)}queryRadius(){return sy(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:r,geometry:s,transform:d,pixelsToTileUnits:h}){return u1(oy(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-d.bearingInRadians,h),s)}isTileClipped(){return!0}}const eB=Li([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),tB=Li([{name:"a_centroid",components:2,type:"Int16"}],4),{members:rB}=eB;class hd{constructor(r,s,d,h,b){this.properties={},this.extent=d,this.type=0,this.id=void 0,this._pbf=r,this._geometry=-1,this._keys=h,this._values=b,r.readFields(iB,this,s)}loadGeometry(){const r=this._pbf;r.pos=this._geometry;const s=r.readVarint()+r.pos,d=[];let h,b=1,x=0,A=0,S=0;for(;r.pos<s;){if(x<=0){const D=r.readVarint();b=7&D,x=D>>3}if(x--,b===1||b===2)A+=r.readSVarint(),S+=r.readSVarint(),b===1&&(h&&d.push(h),h=[]),h&&h.push(new _(A,S));else{if(b!==7)throw new Error(`unknown command ${b}`);h&&h.push(h[0].clone())}}return h&&d.push(h),d}bbox(){const r=this._pbf;r.pos=this._geometry;const s=r.readVarint()+r.pos;let d=1,h=0,b=0,x=0,A=1/0,S=-1/0,D=1/0,M=-1/0;for(;r.pos<s;){if(h<=0){const F=r.readVarint();d=7&F,h=F>>3}if(h--,d===1||d===2)b+=r.readSVarint(),x+=r.readSVarint(),b<A&&(A=b),b>S&&(S=b),x<D&&(D=x),x>M&&(M=x);else if(d!==7)throw new Error(`unknown command ${d}`)}return[A,D,S,M]}toGeoJSON(r,s,d){const h=this.extent*Math.pow(2,d),b=this.extent*r,x=this.extent*s,A=this.loadGeometry();function S(Z){return[360*(Z.x+b)/h-180,360/Math.PI*Math.atan(Math.exp((1-2*(Z.y+x)/h)*Math.PI))-90]}function D(Z){return Z.map(S)}let M;if(this.type===1){const Z=[];for(const Y of A)Z.push(Y[0]);const H=D(Z);M=Z.length===1?{type:"Point",coordinates:H[0]}:{type:"MultiPoint",coordinates:H}}else if(this.type===2){const Z=A.map(D);M=Z.length===1?{type:"LineString",coordinates:Z[0]}:{type:"MultiLineString",coordinates:Z}}else{if(this.type!==3)throw new Error("unknown feature type");{const Z=(function(Y){const ie=Y.length;if(ie<=1)return[Y];const ae=[];let ye,qe;for(let Se=0;Se<ie;Se++){const Me=nB(Y[Se]);Me!==0&&(qe===void 0&&(qe=Me<0),qe===Me<0?(ye&&ae.push(ye),ye=[Y[Se]]):ye&&ye.push(Y[Se]))}return ye&&ae.push(ye),ae})(A),H=[];for(const Y of Z)H.push(Y.map(D));M=H.length===1?{type:"Polygon",coordinates:H[0]}:{type:"MultiPolygon",coordinates:H}}}const F={type:"Feature",geometry:M,properties:this.properties};return this.id!=null&&(F.id=this.id),F}}function iB(o,r,s){o===1?r.id=s.readVarint():o===2?(function(d,h){const b=d.readVarint()+d.pos;for(;d.pos<b;){const x=h._keys[d.readVarint()],A=h._values[d.readVarint()];h.properties[x]=A}})(s,r):o===3?r.type=s.readVarint():o===4&&(r._geometry=s.pos)}function nB(o){let r=0;for(let s,d,h=0,b=o.length,x=b-1;h<b;x=h++)s=o[h],d=o[x],r+=(d.x-s.x)*(s.y+d.y);return r}hd.types=["Unknown","Point","LineString","Polygon"];class D1{constructor(r,s){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(sB,this,s),this.length=this._features.length}feature(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];const s=this._pbf.readVarint()+this._pbf.pos;return new hd(this._pbf,s,this.extent,this._keys,this._values)}}function sB(o,r,s){o===15?r.version=s.readVarint():o===1?r.name=s.readString():o===5?r.extent=s.readVarint():o===2?r._features.push(s.pos):o===3?r._keys.push(s.readString()):o===4&&r._values.push((function(d){let h=null;const b=d.readVarint()+d.pos;for(;d.pos<b;){const x=d.readVarint()>>3;h=x===1?d.readString():x===2?d.readFloat():x===3?d.readDouble():x===4?d.readVarint64():x===5?d.readVarint():x===6?d.readSVarint():x===7?d.readBoolean():null}if(h==null)throw new Error("unknown feature value");return h})(s))}class I1{constructor(r,s){this.layers=r.readFields(oB,{},s)}}function oB(o,r,s){if(o===3){const d=new D1(s,s.readVarint()+s.pos);d.length&&(r[d.name]=d)}}const qv=Math.pow(2,13);function $f(o,r,s,d,h,b,x,A){o.emplaceBack(r,s,2*Math.floor(d*qv)+x,h*qv*2,b*qv*2,Math.round(A))}class Kv{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=r.index,this.hasDependencies=!1,this.layoutVertexArray=new it,this.centroidVertexArray=new Ue,this.indexArray=new Jr,this.programConfigurations=new Ko(r.layers,r.zoom),this.segments=new Vr,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(r,s,d){this.features=[],this.hasDependencies=ay("fill-extrusion",this.layers,s);for(const{feature:h,id:b,index:x,sourceLayerIndex:A}of r){const S=this.layers[0]._featureFilter.needGeometry,D=Cu(h,S);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),D,d))continue;const M={id:b,sourceLayerIndex:A,index:x,geometry:S?D.geometry:Tu(h),properties:h.properties,type:h.type,patterns:{}};this.hasDependencies?this.features.push(Uv("fill-extrusion",this.layers,M,{zoom:this.zoom},s)):this.addFeature(M,M.geometry,x,d,{},s.subdivisionGranularity),s.featureIndex.insert(h,M.geometry,x,A,this.index,!0)}}addFeatures(r,s,d){for(const h of this.features){const{geometry:b}=h;this.addFeature(h,b,h.index,s,d,r.subdivisionGranularity)}}update(r,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,{imagePositions:d})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,rB),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,tB.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,s,d,h,b,x){for(const A of Pc(s,500)){const S={x:0,y:0,sampleCount:0},D=this.layoutVertexArray.length;this.processPolygon(S,h,r,A,x);const M=this.layoutVertexArray.length-D,F=Math.floor(S.x/S.sampleCount),Z=Math.floor(S.y/S.sampleCount);for(let H=0;H<M;H++)this.centroidVertexArray.emplaceBack(F,Z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,{imagePositions:b,canonical:h})}processPolygon(r,s,d,h,b){if(h.length<1||B1(h[0]))return;for(const F of h)F.length!==0&&aB(r,F);const x={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},A=b.fill.getGranularityForZoomLevel(s.z),S=hd.types[d.type]==="Polygon";for(const F of h){if(F.length===0||B1(F))continue;const Z=Pu(F,A,S);this._generateSideFaces(Z,x)}if(!S)return;const D=C1(h,s,A,!1),M=this.layoutVertexArray;k1(((F,Z)=>{$f(M,F,Z,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,D.verticesFlattened,D.indicesTriangles)}_generateSideFaces(r,s){let d=0;for(let h=1;h<r.length;h++){const b=r[h],x=r[h-1];if(lB(b,x))continue;s.segment.vertexLength+4>Vr.MAX_VERTEX_ARRAY_LENGTH&&(s.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const A=b.sub(x)._perp()._unit(),S=x.dist(b);d+S>32768&&(d=0),$f(this.layoutVertexArray,b.x,b.y,A.x,A.y,0,0,d),$f(this.layoutVertexArray,b.x,b.y,A.x,A.y,0,1,d),d+=S,$f(this.layoutVertexArray,x.x,x.y,A.x,A.y,0,0,d),$f(this.layoutVertexArray,x.x,x.y,A.x,A.y,0,1,d);const D=s.segment.vertexLength;this.indexArray.emplaceBack(D,D+2,D+1),this.indexArray.emplaceBack(D+1,D+2,D+3),s.segment.vertexLength+=4,s.segment.primitiveLength+=2}}}function aB(o,r){for(let s=0;s<r.length;s++){const d=r[s];s===r.length-1&&r[0].x===d.x&&r[0].y===d.y||(o.x+=d.x,o.y+=d.y,o.sampleCount++)}}function lB(o,r){return o.x===r.x&&(o.x<0||o.x>lt)||o.y===r.y&&(o.y<0||o.y>lt)}function B1(o){return o.every((r=>r.x<0))||o.every((r=>r.x>lt))||o.every((r=>r.y<0))||o.every((r=>r.y>lt))}let M1;It("FillExtrusionBucket",Kv,{omit:["layers","features"]});var uB={get paint(){return M1=M1||new Tn({"fill-extrusion-opacity":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new tr(Ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new dl(Ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new tr(Ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new tr(Ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new qt(Ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class cB extends ks{constructor(r,s){super(r,uB,s)}createBucket(r){return new Kv(r)}queryRadius(){return sy(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:d,geometry:h,transform:b,pixelsToTileUnits:x,pixelPosMatrix:A}){const S=oy(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-b.bearingInRadians,x),D=this.paint.get("fill-extrusion-height").evaluate(s,d),M=this.paint.get("fill-extrusion-base").evaluate(s,d),F=(function(H,Y){const ie=[];for(const ae of H){const ye=[ae.x,ae.y,0,1];Le(ye,ye,Y),ie.push(new _(ye[0]/ye[3],ye[1]/ye[3]))}return ie})(S,A),Z=(function(H,Y,ie,ae){const ye=[],qe=[],Se=ae[8]*Y,Me=ae[9]*Y,We=ae[10]*Y,ot=ae[11]*Y,mt=ae[8]*ie,Dt=ae[9]*ie,Rt=ae[10]*ie,Pt=ae[11]*ie;for(const Zt of H){const Tt=[],Lt=[];for(const ct of Zt){const sr=ct.x,cr=ct.y,Yt=ae[0]*sr+ae[4]*cr+ae[12],Kt=ae[1]*sr+ae[5]*cr+ae[13],Mr=ae[2]*sr+ae[6]*cr+ae[14],Si=ae[3]*sr+ae[7]*cr+ae[15],Gi=Mr+We,bn=Si+ot,Is=Yt+mt,es=Kt+Dt,fn=Mr+Rt,wi=Si+Pt,tn=new _((Yt+Se)/bn,(Kt+Me)/bn);tn.z=Gi/bn,Tt.push(tn);const hn=new _(Is/wi,es/wi);hn.z=fn/wi,Lt.push(hn)}ye.push(Tt),qe.push(Lt)}return[ye,qe]})(h,M,D,A);return(function(H,Y,ie){let ae=1/0;u1(ie,Y)&&(ae=z1(ie,Y[0]));for(let ye=0;ye<Y.length;ye++){const qe=Y[ye],Se=H[ye];for(let Me=0;Me<qe.length-1;Me++){const We=qe[Me],ot=[We,qe[Me+1],Se[Me+1],Se[Me],We];l1(ie,ot)&&(ae=Math.min(ae,z1(ie,ot)))}}return ae!==1/0&&ae})(Z[0],Z[1],F)}}function Zf(o,r){return o.x*r.x+o.y*r.y}function z1(o,r){if(o.length===1){let s=0;const d=r[s++];let h;for(;!h||d.equals(h);)if(h=r[s++],!h)return 1/0;for(;s<r.length;s++){const b=r[s],x=o[0],A=h.sub(d),S=b.sub(d),D=x.sub(d),M=Zf(A,A),F=Zf(A,S),Z=Zf(S,S),H=Zf(D,A),Y=Zf(D,S),ie=M*Z-F*F,ae=(Z*H-F*Y)/ie,ye=(M*Y-F*H)/ie,qe=d.z*(1-ae-ye)+h.z*ae+b.z*ye;if(isFinite(qe))return qe}return 1/0}{let s=1/0;for(const d of r)s=Math.min(s,d.z);return s}}const dB=Li([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:pB}=dB,fB=Li([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:hB}=fB,mB=Math.cos(Math.PI/180*37.5),O1=Math.pow(2,14)/.5;class Gv{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=r.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((s=>{this.gradients[s.id]={}})),this.layoutVertexArray=new Xe,this.layoutVertexArray2=new Je,this.indexArray=new Jr,this.programConfigurations=new Ko(r.layers,r.zoom),this.segments=new Vr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(r,s,d){this.hasDependencies=ay("line",this.layers,s)||this.hasLineDasharray(this.layers);const h=this.layers[0].layout.get("line-sort-key"),b=!h.isConstant(),x=[];for(const{feature:A,id:S,index:D,sourceLayerIndex:M}of r){const F=this.layers[0]._featureFilter.needGeometry,Z=Cu(A,F);if(!this.layers[0]._featureFilter.filter(new ci(this.zoom),Z,d))continue;const H=b?h.evaluate(Z,{},d):void 0,Y={id:S,properties:A.properties,type:A.type,sourceLayerIndex:M,index:D,geometry:F?Z.geometry:Tu(A),patterns:{},dashes:{},sortKey:H};x.push(Y)}b&&x.sort(((A,S)=>A.sortKey-S.sortKey));for(const A of x){const{geometry:S,index:D,sourceLayerIndex:M}=A;this.hasDependencies?(ay("line",this.layers,s)?Uv("line",this.layers,A,{zoom:this.zoom},s):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,A,this.zoom,s),this.patternFeatures.push(A)):this.addFeature(A,S,D,d,{},{},s.subdivisionGranularity),s.featureIndex.insert(r[D].feature,S,D,M,this.index)}}update(r,s,d,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,{imagePositions:d,dashPositions:h})}addFeatures(r,s,d,h){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,s,d,h,r.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,hB)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,pB),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,s,d,h,b,x,A){const S=this.layers[0].layout,D=S.get("line-join").evaluate(r,{}),M=S.get("line-cap"),F=S.get("line-miter-limit"),Z=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const H of s)this.addLine(H,r,D,M,F,Z,h,A);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,d,{imagePositions:b,dashPositions:x,canonical:h})}addLine(r,s,d,h,b,x,A,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,r=Pu(r,A?S.line.getGranularityForZoomLevel(A.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Se=0;Se<r.length-1;Se++)this.totalDistance+=r[Se].dist(r[Se+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const D=hd.types[s.type]==="Polygon";let M=r.length;for(;M>=2&&r[M-1].equals(r[M-2]);)M--;let F=0;for(;F<M-1&&r[F].equals(r[F+1]);)F++;if(M<(D?3:2))return;d==="bevel"&&(b=1.05);const Z=this.overscaling<=16?122880/(512*this.overscaling):0,H=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let Y,ie,ae,ye,qe;this.e1=this.e2=-1,D&&(Y=r[M-2],qe=r[F].sub(Y)._unit()._perp());for(let Se=F;Se<M;Se++){if(ae=Se===M-1?D?r[F+1]:void 0:r[Se+1],ae&&r[Se].equals(ae))continue;qe&&(ye=qe),Y&&(ie=Y),Y=r[Se],qe=ae?ae.sub(Y)._unit()._perp():ye,ye=ye||qe;let Me=ye.add(qe);Me.x===0&&Me.y===0||Me._unit();const We=ye.x*qe.x+ye.y*qe.y,ot=Me.x*qe.x+Me.y*qe.y,mt=ot!==0?1/ot:1/0,Dt=2*Math.sqrt(2-2*ot),Rt=ot<mB&&ie&&ae,Pt=ye.x*qe.y-ye.y*qe.x>0;if(Rt&&Se>F){const Lt=Y.dist(ie);if(Lt>2*Z){const ct=Y.sub(Y.sub(ie)._mult(Z/Lt)._round());this.updateDistance(ie,ct),this.addCurrentVertex(ct,ye,0,0,H),ie=ct}}const Zt=ie&&ae;let Tt=Zt?d:D?"butt":h;if(Zt&&Tt==="round"&&(mt<x?Tt="miter":mt<=2&&(Tt="fakeround")),Tt==="miter"&&mt>b&&(Tt="bevel"),Tt==="bevel"&&(mt>2&&(Tt="flipbevel"),mt<b&&(Tt="miter")),ie&&this.updateDistance(ie,Y),Tt==="miter")Me._mult(mt),this.addCurrentVertex(Y,Me,0,0,H);else if(Tt==="flipbevel"){if(mt>100)Me=qe.mult(-1);else{const Lt=mt*ye.add(qe).mag()/ye.sub(qe).mag();Me._perp()._mult(Lt*(Pt?-1:1))}this.addCurrentVertex(Y,Me,0,0,H),this.addCurrentVertex(Y,Me.mult(-1),0,0,H)}else if(Tt==="bevel"||Tt==="fakeround"){const Lt=-Math.sqrt(mt*mt-1),ct=Pt?Lt:0,sr=Pt?0:Lt;if(ie&&this.addCurrentVertex(Y,ye,ct,sr,H),Tt==="fakeround"){const cr=Math.round(180*Dt/Math.PI/20);for(let Yt=1;Yt<cr;Yt++){let Kt=Yt/cr;if(Kt!==.5){const Si=Kt-.5;Kt+=Kt*Si*(Kt-1)*((1.0904+We*(We*(3.55645-1.43519*We)-3.2452))*Si*Si+(.848013+We*(.215638*We-1.06021)))}const Mr=qe.sub(ye)._mult(Kt)._add(ye)._unit()._mult(Pt?-1:1);this.addHalfVertex(Y,Mr.x,Mr.y,!1,Pt,0,H)}}ae&&this.addCurrentVertex(Y,qe,-ct,-sr,H)}else if(Tt==="butt")this.addCurrentVertex(Y,Me,0,0,H);else if(Tt==="square"){const Lt=ie?1:-1;this.addCurrentVertex(Y,Me,Lt,Lt,H)}else Tt==="round"&&(ie&&(this.addCurrentVertex(Y,ye,0,0,H),this.addCurrentVertex(Y,ye,1,1,H,!0)),ae&&(this.addCurrentVertex(Y,qe,-1,-1,H,!0),this.addCurrentVertex(Y,qe,0,0,H)));if(Rt&&Se<M-1){const Lt=Y.dist(ae);if(Lt>2*Z){const ct=Y.add(ae.sub(Y)._mult(Z/Lt)._round());this.updateDistance(Y,ct),this.addCurrentVertex(ct,qe,0,0,H),Y=ct}}}}addCurrentVertex(r,s,d,h,b,x=!1){const A=s.y*h-s.x,S=-s.y-s.x*h;this.addHalfVertex(r,s.x+s.y*d,s.y-s.x*d,x,!1,d,b),this.addHalfVertex(r,A,S,x,!0,-h,b),this.distance>O1/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,s,d,h,b,x))}addHalfVertex({x:r,y:s},d,h,b,x,A,S){const D=.5*(this.lineClips?this.scaledDistance*(O1-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(b?1:0),(s<<1)+(x?1:0),Math.round(63*d)+128,Math.round(63*h)+128,1+(A===0?0:A<0?-1:1)|(63&D)<<2,D>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,M,this.e2),S.primitiveLength++),x?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,s){this.distance+=r.dist(s),this.updateScaledDistance()}hasLineDasharray(r){for(const s of r){const d=s.paint.get("line-dasharray");if(d&&!d.isConstant())return!0}return!1}addLineDashDependencies(r,s,d,h){for(const b of r){const x=b.paint.get("line-dasharray");if(!x||x.value.kind==="constant")continue;const A=b.layout.get("line-cap")==="round",S={dasharray:x.value.evaluate({zoom:d-1},s,{}),round:A},D={dasharray:x.value.evaluate({zoom:d},s,{}),round:A},M={dasharray:x.value.evaluate({zoom:d+1},s,{}),round:A},F=`${S.dasharray.join(",")},${S.round}`,Z=`${D.dasharray.join(",")},${D.round}`,H=`${M.dasharray.join(",")},${M.round}`;h.dashDependencies[F]=S,h.dashDependencies[Z]=D,h.dashDependencies[H]=M,s.dashes[b.id]={min:F,mid:Z,max:H}}}}let V1,U1;It("LineBucket",Gv,{omit:["layers","patternFeatures"]});var j1={get paint(){return U1=U1||new Tn({"line-opacity":new tr(Ke.paint_line["line-opacity"]),"line-color":new tr(Ke.paint_line["line-color"]),"line-translate":new qt(Ke.paint_line["line-translate"]),"line-translate-anchor":new qt(Ke.paint_line["line-translate-anchor"]),"line-width":new tr(Ke.paint_line["line-width"]),"line-gap-width":new tr(Ke.paint_line["line-gap-width"]),"line-offset":new tr(Ke.paint_line["line-offset"]),"line-blur":new tr(Ke.paint_line["line-blur"]),"line-dasharray":new dl(Ke.paint_line["line-dasharray"]),"line-pattern":new dl(Ke.paint_line["line-pattern"]),"line-gradient":new nd(Ke.paint_line["line-gradient"])})},get layout(){return V1=V1||new Tn({"line-cap":new qt(Ke.layout_line["line-cap"]),"line-join":new tr(Ke.layout_line["line-join"]),"line-miter-limit":new qt(Ke.layout_line["line-miter-limit"]),"line-round-limit":new qt(Ke.layout_line["line-round-limit"]),"line-sort-key":new tr(Ke.layout_line["line-sort-key"])})}};class yB extends tr{possiblyEvaluate(r,s){return s=new ci(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(r,s)}evaluate(r,s,d,h){return s=or({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(r,s,d,h)}}let dy;class gB extends ks{constructor(r,s){super(r,j1,s),this.gradientVersion=0,dy||(dy=new yB(j1.paint.properties["line-width"].specification),dy.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!(function(d){return d._styleExpression!==void 0})(s)&&s._styleExpression.expression instanceof Bo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,s){super.recalculate(r,s),this.paint._values["line-floorwidth"]=dy.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Gv(r)}queryRadius(r){const s=r,d=N1(cd("line-width",this,s),cd("line-gap-width",this,s)),h=cd("line-offset",this,s);return d/2+Math.abs(h)+sy(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:r,feature:s,featureState:d,geometry:h,transform:b,pixelsToTileUnits:x}){const A=oy(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-b.bearingInRadians,x),S=x/2*N1(this.paint.get("line-width").evaluate(s,d),this.paint.get("line-gap-width").evaluate(s,d)),D=this.paint.get("line-offset").evaluate(s,d);return D&&(h=(function(M,F){const Z=[];for(let H=0;H<M.length;H++){const Y=M[H],ie=[];for(let ae=0;ae<Y.length;ae++){const ye=Y[ae-1],qe=Y[ae],Se=Y[ae+1],Me=ae===0?new _(0,0):qe.sub(ye)._unit()._perp(),We=ae===Y.length-1?new _(0,0):Se.sub(qe)._unit()._perp(),ot=Me._add(We)._unit(),mt=ot.x*We.x+ot.y*We.y;mt!==0&&ot._mult(1/mt),ie.push(ot._mult(F)._add(qe))}Z.push(ie)}return Z})(h,D*x)),(function(M,F,Z){for(let H=0;H<F.length;H++){const Y=F[H];if(M.length>=3){for(let ie=0;ie<Y.length;ie++)if(ud(M,Y[ie]))return!0}if(AI(M,Y,Z))return!0}return!1})(A,h,S)}isTileClipped(){return!0}}function N1(o,r){return r>0?r+2*o:o}const _B=Li([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),bB=Li([{name:"a_projected_pos",components:3,type:"Float32"}],4);Li([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const vB=Li([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Li([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const F1=Li([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),xB=Li([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function wB(o,r,s){return o.sections.forEach((d=>{d.text=(function(h,b,x){const A=b.layout.get("text-transform").evaluate(x,{});return A==="uppercase"?h=h.toLocaleUpperCase():A==="lowercase"&&(h=h.toLocaleLowerCase()),Oo.applyArabicShaping&&(h=Oo.applyArabicShaping(h)),h})(d.text,r,s)})),o}Li([{name:"triangle",components:3,type:"Uint16"}]),Li([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Li([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Li([{type:"Float32",name:"offsetX"}]),Li([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Li([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Hf={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var en=24;const $v=4294967296,q1=1/$v,K1=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Zv{constructor(r=new Uint8Array(16)){this.buf=ArrayBuffer.isView(r)?r:new Uint8Array(r),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(r,s,d=this.length){for(;this.pos<d;){const h=this.readVarint(),b=h>>3,x=this.pos;this.type=7&h,r(b,s,this),this.pos===x&&this.skip(h)}return s}readMessage(r,s){return this.readFields(r,s,this.readVarint()+this.pos)}readFixed32(){const r=this.dataView.getUint32(this.pos,!0);return this.pos+=4,r}readSFixed32(){const r=this.dataView.getInt32(this.pos,!0);return this.pos+=4,r}readFixed64(){const r=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*$v;return this.pos+=8,r}readSFixed64(){const r=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*$v;return this.pos+=8,r}readFloat(){const r=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,r}readDouble(){const r=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,r}readVarint(r){const s=this.buf;let d,h;return h=s[this.pos++],d=127&h,h<128?d:(h=s[this.pos++],d|=(127&h)<<7,h<128?d:(h=s[this.pos++],d|=(127&h)<<14,h<128?d:(h=s[this.pos++],d|=(127&h)<<21,h<128?d:(h=s[this.pos],d|=(15&h)<<28,(function(b,x,A){const S=A.buf;let D,M;if(M=S[A.pos++],D=(112&M)>>4,M<128||(M=S[A.pos++],D|=(127&M)<<3,M<128)||(M=S[A.pos++],D|=(127&M)<<10,M<128)||(M=S[A.pos++],D|=(127&M)<<17,M<128)||(M=S[A.pos++],D|=(127&M)<<24,M<128)||(M=S[A.pos++],D|=(1&M)<<31,M<128))return md(b,D,x);throw new Error("Expected varint not more than 10 bytes")})(d,r,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const r=this.readVarint();return r%2==1?(r+1)/-2:r/2}readBoolean(){return!!this.readVarint()}readString(){const r=this.readVarint()+this.pos,s=this.pos;return this.pos=r,r-s>=12&&K1?K1.decode(this.buf.subarray(s,r)):(function(d,h,b){let x="",A=h;for(;A<b;){const S=d[A];let D,M,F,Z=null,H=S>239?4:S>223?3:S>191?2:1;if(A+H>b)break;H===1?S<128&&(Z=S):H===2?(D=d[A+1],(192&D)==128&&(Z=(31&S)<<6|63&D,Z<=127&&(Z=null))):H===3?(D=d[A+1],M=d[A+2],(192&D)==128&&(192&M)==128&&(Z=(15&S)<<12|(63&D)<<6|63&M,(Z<=2047||Z>=55296&&Z<=57343)&&(Z=null))):H===4&&(D=d[A+1],M=d[A+2],F=d[A+3],(192&D)==128&&(192&M)==128&&(192&F)==128&&(Z=(15&S)<<18|(63&D)<<12|(63&M)<<6|63&F,(Z<=65535||Z>=1114112)&&(Z=null))),Z===null?(Z=65533,H=1):Z>65535&&(Z-=65536,x+=String.fromCharCode(Z>>>10&1023|55296),Z=56320|1023&Z),x+=String.fromCharCode(Z),A+=H}return x})(this.buf,s,r)}readBytes(){const r=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,r);return this.pos=r,s}readPackedVarint(r=[],s){const d=this.readPackedEnd();for(;this.pos<d;)r.push(this.readVarint(s));return r}readPackedSVarint(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readSVarint());return r}readPackedBoolean(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readBoolean());return r}readPackedFloat(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readFloat());return r}readPackedDouble(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readDouble());return r}readPackedFixed32(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readFixed32());return r}readPackedSFixed32(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readSFixed32());return r}readPackedFixed64(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readFixed64());return r}readPackedSFixed64(r=[]){const s=this.readPackedEnd();for(;this.pos<s;)r.push(this.readSFixed64());return r}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(r){const s=7&r;if(s===0)for(;this.buf[this.pos++]>127;);else if(s===2)this.pos=this.readVarint()+this.pos;else if(s===5)this.pos+=4;else{if(s!==1)throw new Error(`Unimplemented type: ${s}`);this.pos+=8}}writeTag(r,s){this.writeVarint(r<<3|s)}realloc(r){let s=this.length||16;for(;s<this.pos+r;)s*=2;if(s!==this.length){const d=new Uint8Array(s);d.set(this.buf),this.buf=d,this.dataView=new DataView(d.buffer),this.length=s}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(r){this.realloc(4),this.dataView.setInt32(this.pos,r,!0),this.pos+=4}writeSFixed32(r){this.realloc(4),this.dataView.setInt32(this.pos,r,!0),this.pos+=4}writeFixed64(r){this.realloc(8),this.dataView.setInt32(this.pos,-1&r,!0),this.dataView.setInt32(this.pos+4,Math.floor(r*q1),!0),this.pos+=8}writeSFixed64(r){this.realloc(8),this.dataView.setInt32(this.pos,-1&r,!0),this.dataView.setInt32(this.pos+4,Math.floor(r*q1),!0),this.pos+=8}writeVarint(r){(r=+r||0)>268435455||r<0?(function(s,d){let h,b;if(s>=0?(h=s%4294967296|0,b=s/4294967296|0):(h=~(-s%4294967296),b=~(-s/4294967296),4294967295^h?h=h+1|0:(h=0,b=b+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");d.realloc(10),(function(x,A,S){S.buf[S.pos++]=127&x|128,x>>>=7,S.buf[S.pos++]=127&x|128,x>>>=7,S.buf[S.pos++]=127&x|128,x>>>=7,S.buf[S.pos++]=127&x|128,S.buf[S.pos]=127&(x>>>=7)})(h,0,d),(function(x,A){const S=(7&x)<<4;A.buf[A.pos++]|=S|((x>>>=3)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x|((x>>>=7)?128:0),x&&(A.buf[A.pos++]=127&x)))))})(b,d)})(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))}writeSVarint(r){this.writeVarint(r<0?2*-r-1:2*r)}writeBoolean(r){this.writeVarint(+r)}writeString(r){r=String(r),this.realloc(4*r.length),this.pos++;const s=this.pos;this.pos=(function(h,b,x){for(let A,S,D=0;D<b.length;D++){if(A=b.charCodeAt(D),A>55295&&A<57344){if(!S){A>56319||D+1===b.length?(h[x++]=239,h[x++]=191,h[x++]=189):S=A;continue}if(A<56320){h[x++]=239,h[x++]=191,h[x++]=189,S=A;continue}A=S-55296<<10|A-56320|65536,S=null}else S&&(h[x++]=239,h[x++]=191,h[x++]=189,S=null);A<128?h[x++]=A:(A<2048?h[x++]=A>>6|192:(A<65536?h[x++]=A>>12|224:(h[x++]=A>>18|240,h[x++]=A>>12&63|128),h[x++]=A>>6&63|128),h[x++]=63&A|128)}return x})(this.buf,r,this.pos);const d=this.pos-s;d>=128&&G1(s,d,this),this.pos=s-1,this.writeVarint(d),this.pos+=d}writeFloat(r){this.realloc(4),this.dataView.setFloat32(this.pos,r,!0),this.pos+=4}writeDouble(r){this.realloc(8),this.dataView.setFloat64(this.pos,r,!0),this.pos+=8}writeBytes(r){const s=r.length;this.writeVarint(s),this.realloc(s);for(let d=0;d<s;d++)this.buf[this.pos++]=r[d]}writeRawMessage(r,s){this.pos++;const d=this.pos;r(s,this);const h=this.pos-d;h>=128&&G1(d,h,this),this.pos=d-1,this.writeVarint(h),this.pos+=h}writeMessage(r,s,d){this.writeTag(r,2),this.writeRawMessage(s,d)}writePackedVarint(r,s){s.length&&this.writeMessage(r,EB,s)}writePackedSVarint(r,s){s.length&&this.writeMessage(r,AB,s)}writePackedBoolean(r,s){s.length&&this.writeMessage(r,TB,s)}writePackedFloat(r,s){s.length&&this.writeMessage(r,RB,s)}writePackedDouble(r,s){s.length&&this.writeMessage(r,SB,s)}writePackedFixed32(r,s){s.length&&this.writeMessage(r,CB,s)}writePackedSFixed32(r,s){s.length&&this.writeMessage(r,kB,s)}writePackedFixed64(r,s){s.length&&this.writeMessage(r,PB,s)}writePackedSFixed64(r,s){s.length&&this.writeMessage(r,LB,s)}writeBytesField(r,s){this.writeTag(r,2),this.writeBytes(s)}writeFixed32Field(r,s){this.writeTag(r,5),this.writeFixed32(s)}writeSFixed32Field(r,s){this.writeTag(r,5),this.writeSFixed32(s)}writeFixed64Field(r,s){this.writeTag(r,1),this.writeFixed64(s)}writeSFixed64Field(r,s){this.writeTag(r,1),this.writeSFixed64(s)}writeVarintField(r,s){this.writeTag(r,0),this.writeVarint(s)}writeSVarintField(r,s){this.writeTag(r,0),this.writeSVarint(s)}writeStringField(r,s){this.writeTag(r,2),this.writeString(s)}writeFloatField(r,s){this.writeTag(r,5),this.writeFloat(s)}writeDoubleField(r,s){this.writeTag(r,1),this.writeDouble(s)}writeBooleanField(r,s){this.writeVarintField(r,+s)}}function md(o,r,s){return s?4294967296*r+(o>>>0):4294967296*(r>>>0)+(o>>>0)}function G1(o,r,s){const d=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));s.realloc(d);for(let h=s.pos-1;h>=o;h--)s.buf[h+d]=s.buf[h]}function EB(o,r){for(let s=0;s<o.length;s++)r.writeVarint(o[s])}function AB(o,r){for(let s=0;s<o.length;s++)r.writeSVarint(o[s])}function RB(o,r){for(let s=0;s<o.length;s++)r.writeFloat(o[s])}function SB(o,r){for(let s=0;s<o.length;s++)r.writeDouble(o[s])}function TB(o,r){for(let s=0;s<o.length;s++)r.writeBoolean(o[s])}function CB(o,r){for(let s=0;s<o.length;s++)r.writeFixed32(o[s])}function kB(o,r){for(let s=0;s<o.length;s++)r.writeSFixed32(o[s])}function PB(o,r){for(let s=0;s<o.length;s++)r.writeFixed64(o[s])}function LB(o,r){for(let s=0;s<o.length;s++)r.writeSFixed64(o[s])}function DB(o,r,s){o===1&&s.readMessage(IB,r)}function IB(o,r,s){if(o===3){const{id:d,bitmap:h,width:b,height:x,left:A,top:S,advance:D}=s.readMessage(BB,{});r.push({id:d,bitmap:new Uf({width:b+6,height:x+6},h),metrics:{width:b,height:x,left:A,top:S,advance:D}})}}function BB(o,r,s){o===1?r.id=s.readVarint():o===2?r.bitmap=s.readBytes():o===3?r.width=s.readVarint():o===4?r.height=s.readVarint():o===5?r.left=s.readSVarint():o===6?r.top=s.readSVarint():o===7&&(r.advance=s.readVarint())}function $1(o){let r=0,s=0;for(const x of o)r+=x.w*x.h,s=Math.max(s,x.w);o.sort(((x,A)=>A.h-x.h));const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}];let h=0,b=0;for(const x of o)for(let A=d.length-1;A>=0;A--){const S=d[A];if(!(x.w>S.w||x.h>S.h)){if(x.x=S.x,x.y=S.y,b=Math.max(b,x.y+x.h),h=Math.max(h,x.x+x.w),x.w===S.w&&x.h===S.h){const D=d.pop();D&&A<d.length&&(d[A]=D)}else x.h===S.h?(S.x+=x.w,S.w-=x.w):x.w===S.w?(S.y+=x.h,S.h-=x.h):(d.push({x:S.x+x.w,y:S.y,w:S.w-x.w,h:x.h}),S.y+=x.h,S.h-=x.h);break}}return{w:h,h:b,fill:r/(h*b)||0}}class Hv{constructor(r,{pixelRatio:s,version:d,stretchX:h,stretchY:b,content:x,textFitWidth:A,textFitHeight:S}){this.paddedRect=r,this.pixelRatio=s,this.stretchX=h,this.stretchY=b,this.content=x,this.version=d,this.textFitWidth=A,this.textFitHeight=S}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Z1{constructor(r,s){const d={},h={};this.haveRenderCallbacks=[];const b=[];this.addImages(r,d,b),this.addImages(s,h,b);const{w:x,h:A}=$1(b),S=new Qn({width:x||1,height:A||1});for(const D in r){const M=r[D],F=d[D].paddedRect;Qn.copy(M.data,S,{x:0,y:0},{x:F.x+1,y:F.y+1},M.data)}for(const D in s){const M=s[D],F=h[D].paddedRect,Z=F.x+1,H=F.y+1,Y=M.data.width,ie=M.data.height;Qn.copy(M.data,S,{x:0,y:0},{x:Z,y:H},M.data),Qn.copy(M.data,S,{x:0,y:ie-1},{x:Z,y:H-1},{width:Y,height:1}),Qn.copy(M.data,S,{x:0,y:0},{x:Z,y:H+ie},{width:Y,height:1}),Qn.copy(M.data,S,{x:Y-1,y:0},{x:Z-1,y:H},{width:1,height:ie}),Qn.copy(M.data,S,{x:0,y:0},{x:Z+Y,y:H},{width:1,height:ie})}this.image=S,this.iconPositions=d,this.patternPositions=h}addImages(r,s,d){for(const h in r){const b=r[h],x={x:0,y:0,w:b.data.width+2,h:b.data.height+2};d.push(x),s[h]=new Hv(x,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(r,s){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in r.updatedImages)this.patchUpdatedImage(this.iconPositions[d],r.getImage(d),s),this.patchUpdatedImage(this.patternPositions[d],r.getImage(d),s)}patchUpdatedImage(r,s,d){if(!r||!s||r.version===s.version)return;r.version=s.version;const[h,b]=r.tl;d.update(s.data,void 0,{x:h,y:b})}}var yl;It("ImagePosition",Hv),It("ImageAtlas",Z1),e.ao=void 0,(yl=e.ao||(e.ao={}))[yl.none=0]="none",yl[yl.horizontal=1]="horizontal",yl[yl.vertical=2]="vertical",yl[yl.horizontalOnly=3]="horizontalOnly";class Xf{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(r,s,d){const h=new Xf;return h.scale=r||1,h.fontStack=s,h.verticalAlign=d||"bottom",h}static forImage(r,s){const d=new Xf;return d.imageName=r,d.verticalAlign=s||"bottom",d}}class yd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,s){const d=new yd;for(let h=0;h<r.sections.length;h++){const b=r.sections[h];b.image?d.addImageSection(b):d.addTextSection(b,s)}return d}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=(function(r){let s="";for(let d=0;d<r.length;d++){const h=r.charCodeAt(d+1)||null,b=r.charCodeAt(d-1)||null;s+=h&&Xm(h)&&!Hf[r[d+1]]||b&&Xm(b)&&!Hf[r[d-1]]||!Hf[r[d]]?r[d]:Hf[r[d]]}return s})(this.text)}trim(){let r=0;for(let d=0;d<this.text.length&&fy[this.text.charCodeAt(d)];d++)r++;let s=this.text.length;for(let d=this.text.length-1;d>=0&&d>=r&&fy[this.text.charCodeAt(d)];d--)s--;this.text=this.text.substring(r,s),this.sectionIndex=this.sectionIndex.slice(r,s)}substring(r,s){const d=new yd;return d.text=this.text.substring(r,s),d.sectionIndex=this.sectionIndex.slice(r,s),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((r,s)=>Math.max(r,this.sections[s].scale)),0)}getMaxImageSize(r){let s=0,d=0;for(let h=0;h<this.length();h++){const b=this.getSection(h);if(b.imageName){const x=r[b.imageName];if(!x)continue;const A=x.displaySize;s=Math.max(s,A[0]),d=Math.max(d,A[1])}}return{maxImageWidth:s,maxImageHeight:d}}addTextSection(r,s){this.text+=r.text,this.sections.push(Xf.forText(r.scale,r.fontStack||s,r.verticalAlign));const d=this.sections.length-1;for(let h=0;h<r.text.length;++h)this.sectionIndex.push(d)}addImageSection(r){const s=r.image?r.image.name:"";if(s.length===0)return void ir("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(Xf.forImage(s,r.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):ir("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function py(o,r,s,d,h,b,x,A,S,D,M,F,Z,H,Y){const ie=yd.fromFeature(o,h);let ae;F===e.ao.vertical&&ie.verticalizePunctuation();const{processBidirectionalText:ye,processStyledBidirectionalText:qe}=Oo;if(ye&&ie.sections.length===1){ae=[];const We=ye(ie.toString(),Xv(ie,D,b,r,d,H));for(const ot of We){const mt=new yd;mt.text=ot,mt.sections=ie.sections;for(let Dt=0;Dt<ot.length;Dt++)mt.sectionIndex.push(0);ae.push(mt)}}else if(qe){ae=[];const We=qe(ie.text,ie.sectionIndex,Xv(ie,D,b,r,d,H));for(const ot of We){const mt=new yd;mt.text=ot[0],mt.sectionIndex=ot[1],mt.sections=ie.sections,ae.push(mt)}}else ae=(function(We,ot){const mt=[],Dt=We.text;let Rt=0;for(const Pt of ot)mt.push(We.substring(Rt,Pt)),Rt=Pt;return Rt<Dt.length&&mt.push(We.substring(Rt,Dt.length)),mt})(ie,Xv(ie,D,b,r,d,H));const Se=[],Me={positionedLines:Se,text:ie.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:F,iconsInText:!1,verticalizable:!1};return(function(We,ot,mt,Dt,Rt,Pt,Zt,Tt,Lt,ct,sr,cr){let Yt=0,Kt=0,Mr=0,Si=0;const Gi=Tt==="right"?1:Tt==="left"?0:.5,bn=en/cr;let Is=0;for(const wi of Rt){wi.trim();const tn=wi.getMaxScale(),hn={positionedGlyphs:[],lineOffset:0};We.positionedLines[Is]=hn;const mn=hn.positionedGlyphs;let jn=0;if(!wi.length()){Kt+=Pt,++Is;continue}const Bs=VB(Dt,wi,bn);for(let ts=0;ts<wi.length();ts++){const $i=wi.getSection(ts),nn=wi.getSectionIndex(ts),sn=wi.getCharCode(ts),Fi=UB(Lt,sr,sn);let mi;if($i.imageName){if(We.iconsInText=!0,$i.scale=$i.scale*bn,mi=NB($i,Fi,tn,Bs,Dt),!mi)continue;jn=Math.max(jn,mi.imageOffset)}else if(mi=jB($i,sn,Fi,Bs,ot,mt),!mi)continue;const{rect:ho,metrics:vd,baselineOffset:mo}=mi;mn.push({glyph:sn,imageName:$i.imageName,x:Yt,y:Kt+mo+-17,vertical:Fi,scale:$i.scale,fontStack:$i.fontStack,sectionIndex:nn,metrics:vd,rect:ho}),Fi?(We.verticalizable=!0,Yt+=($i.imageName?vd.advance:en)*$i.scale+ct):Yt+=vd.advance*$i.scale+ct}mn.length!==0&&(Mr=Math.max(Yt-ct,Mr),FB(mn,0,mn.length-1,Gi)),Yt=0,hn.lineOffset=Math.max(jn,(tn-1)*en);const rn=Pt*tn+jn;Kt+=rn,Si=Math.max(rn,Si),++Is}const{horizontalAlign:es,verticalAlign:fn}=Wv(Zt);(function(wi,tn,hn,mn,jn,Bs,rn,ts,$i){const nn=(tn-hn)*jn;let sn=0;sn=Bs!==rn?-ts*mn- -17:-mn*$i*rn+.5*rn;for(const Fi of wi)for(const mi of Fi.positionedGlyphs)mi.x+=nn,mi.y+=sn})(We.positionedLines,Gi,es,fn,Mr,Si,Pt,Kt,Rt.length),We.top+=-fn*Kt,We.bottom=We.top+Kt,We.left+=-es*Mr,We.right=We.left+Mr})(Me,r,s,d,ae,x,A,S,F,D,Z,Y),!(function(We){for(const ot of We)if(ot.positionedGlyphs.length!==0)return!1;return!0})(Se)&&Me}const fy={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},MB={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},zB={40:!0};function H1(o,r,s,d,h,b){if(r.imageName){const x=d[r.imageName];return x?x.displaySize[0]*r.scale*en/b+h:0}{const x=s[r.fontStack],A=x&&x[o];return A?A.metrics.advance*r.scale+h:0}}function X1(o,r,s,d){const h=Math.pow(o-r,2);return d?o<r?h/2:2*h:h+Math.abs(s)*s}function OB(o,r,s){let d=0;return o===10&&(d-=1e4),s&&(d+=150),o!==40&&o!==65288||(d+=50),r!==41&&r!==65289||(d+=50),d}function W1(o,r,s,d,h,b){let x=null,A=X1(r,s,h,b);for(const S of d){const D=X1(r-S.x,s,h,b)+S.badness;D<=A&&(x=S,A=D)}return{index:o,x:r,priorBreak:x,badness:A}}function Y1(o){return o?Y1(o.priorBreak).concat(o.index):[]}function Xv(o,r,s,d,h,b){if(!o)return[];const x=[],A=(function(F,Z,H,Y,ie,ae){let ye=0;for(let qe=0;qe<F.length();qe++){const Se=F.getSection(qe);ye+=H1(F.getCharCode(qe),Se,Y,ie,Z,ae)}return ye/Math.max(1,Math.ceil(ye/H))})(o,r,s,d,h,b),S=o.text.indexOf("​")>=0;let D=0;for(let F=0;F<o.length();F++){const Z=o.getSection(F),H=o.getCharCode(F);if(fy[H]||(D+=H1(H,Z,d,h,r,b)),F<o.length()-1){const Y=!((M=H)<11904)&&(!!Ir["CJK Compatibility Forms"](M)||!!Ir["CJK Compatibility"](M)||!!Ir["CJK Strokes"](M)||!!Ir["CJK Symbols and Punctuation"](M)||!!Ir["Enclosed CJK Letters and Months"](M)||!!Ir["Halfwidth and Fullwidth Forms"](M)||!!Ir["Ideographic Description Characters"](M)||!!Ir["Vertical Forms"](M)||Hm.test(String.fromCodePoint(M)));(MB[H]||Y||Z.imageName||F!==o.length()-2&&zB[o.getCharCode(F+1)])&&x.push(W1(F+1,D,A,x,OB(H,o.getCharCode(F+1),Y&&S),!1))}}var M;return Y1(W1(o.length(),D,A,x,0,!0))}function Wv(o){let r=.5,s=.5;switch(o){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function VB(o,r,s){const d=r.getMaxScale()*en,{maxImageWidth:h,maxImageHeight:b}=r.getMaxImageSize(o),x=Math.max(d,b*s);return{verticalLineContentWidth:Math.max(d,h*s),horizontalLineContentHeight:x}}function J1(o){switch(o){case"top":return 0;case"center":return .5;default:return 1}}function UB(o,r,s){return!(o===e.ao.horizontal||!r&&!td(s)||r&&(fy[s]||(d=s,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(d)))));var d}function jB(o,r,s,d,h,b){const x=b[o.fontStack],A=(function(D,M,F,Z){if(D&&D.rect)return D;const H=M[F.fontStack],Y=H&&H[Z];return Y?{rect:null,metrics:Y.metrics}:null})(x&&x[r],h,o,r);if(A===null)return null;let S;if(s)S=d.verticalLineContentWidth-o.scale*en;else{const D=J1(o.verticalAlign);S=(d.horizontalLineContentHeight-o.scale*en)*D}return{rect:A.rect,metrics:A.metrics,baselineOffset:S}}function NB(o,r,s,d,h){const b=h[o.imageName];if(!b)return null;const x=b.paddedRect,A=b.displaySize,S={width:A[0],height:A[1],left:1,top:-3,advance:r?A[1]:A[0]};let D;if(r)D=d.verticalLineContentWidth-A[1]*o.scale;else{const M=J1(o.verticalAlign);D=(d.horizontalLineContentHeight-A[1]*o.scale)*M}return{rect:x,metrics:S,baselineOffset:D,imageOffset:(r?A[0]:A[1])*o.scale-en*s}}function FB(o,r,s,d){if(d===0)return;const h=o[s],b=(o[s].x+h.metrics.advance*h.scale)*d;for(let x=r;x<=s;x++)o[x].x-=b}function qB(o,r,s){const{horizontalAlign:d,verticalAlign:h}=Wv(s),b=r[0]-o.displaySize[0]*d,x=r[1]-o.displaySize[1]*h;return{image:o,top:x,bottom:x+o.displaySize[1],left:b,right:b+o.displaySize[0]}}function Q1(o){var r,s;let d=o.left,h=o.top,b=o.right-d,x=o.bottom-h;const A=(r=o.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",S=(s=o.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",D=(o.image.content[2]-o.image.content[0])/(o.image.content[3]-o.image.content[1]);if(S==="proportional"){if(A==="stretchOnly"&&b/x<D||A==="proportional"){const M=Math.ceil(x*D);d*=M/b,b=M}}else if(A==="proportional"&&S==="stretchOnly"&&D!==0&&b/x>D){const M=Math.ceil(b/D);h*=M/x,x=M}return{x1:d,y1:h,x2:d+b,y2:h+x}}function ew(o,r,s,d,h,b){const x=o.image;let A;if(x.content){const ae=x.content,ye=x.pixelRatio||1;A=[ae[0]/ye,ae[1]/ye,x.displaySize[0]-ae[2]/ye,x.displaySize[1]-ae[3]/ye]}const S=r.left*b,D=r.right*b;let M,F,Z,H;s==="width"||s==="both"?(H=h[0]+S-d[3],F=h[0]+D+d[1]):(H=h[0]+(S+D-x.displaySize[0])/2,F=H+x.displaySize[0]);const Y=r.top*b,ie=r.bottom*b;return s==="height"||s==="both"?(M=h[1]+Y-d[0],Z=h[1]+ie+d[2]):(M=h[1]+(Y+ie-x.displaySize[1])/2,Z=M+x.displaySize[1]),{image:x,top:M,right:F,bottom:Z,left:H,collisionPadding:A}}const Ta=128,gl=32640;function tw(o,r){const{expression:s}=r;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new ci(o+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:h}=s;let b=0;for(;b<d.length&&d[b]<=o;)b++;b=Math.max(0,b-1);let x=b;for(;x<d.length&&d[x]<o+1;)x++;x=Math.min(d.length-1,x);const A=d[b],S=d[x];return s.kind==="composite"?{kind:"composite",minZoom:A,maxZoom:S,interpolationType:h}:{kind:"camera",minZoom:A,maxZoom:S,minSize:s.evaluate(new ci(A)),maxSize:s.evaluate(new ci(S)),interpolationType:h}}}function Yv(o,r,s){let d="never";const h=o.get(r);return h?d=h:o.get(s)&&(d="always"),d}const KB=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function hy(o,r,s,d,h,b,x,A,S,D,M,F,Z){const H=A?Math.min(gl,Math.round(A[0])):0,Y=A?Math.min(gl,Math.round(A[1])):0;o.emplaceBack(r,s,Math.round(32*d),Math.round(32*h),b,x,(H<<1)+(S?1:0),Y,16*D,16*M,256*F,256*Z)}function Jv(o,r,s){o.emplaceBack(r.x,r.y,s),o.emplaceBack(r.x,r.y,s),o.emplaceBack(r.x,r.y,s),o.emplaceBack(r.x,r.y,s)}function GB(o){for(const r of o.sections)if(Qm(r.text))return!0;return!1}class Qv{constructor(r){this.layoutVertexArray=new wt,this.indexArray=new Jr,this.programConfigurations=r,this.segments=new Vr,this.dynamicLayoutVertexArray=new pt,this.opacityVertexArray=new jt,this.hasVisibleVertices=!1,this.placedSymbolArray=new X}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,s,d,h){this.isEmpty()||(d&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,_B.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,bB.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,KB,!0),this.opacityVertexBuffer.itemSize=1),(d||h)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}It("SymbolBuffers",Qv);class e0{constructor(r,s,d){this.layoutVertexArray=new r,this.layoutAttributes=s,this.indexArray=new d,this.segments=new Vr,this.collisionVertexArray=new Yr}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,vB.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}It("CollisionBuffers",e0);class gd{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=St(globalThis)?Math.min(r.overscaling,128):r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((x=>x.id)),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tw(this.zoom,s["text-size"]),this.iconSizeData=tw(this.zoom,s["icon-size"]);const d=this.layers[0].layout,h=d.get("symbol-sort-key"),b=d.get("symbol-z-order");this.canOverlap=Yv(d,"text-overlap","text-allow-overlap")!=="never"||Yv(d,"icon-overlap","icon-allow-overlap")!=="never"||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,d.get("symbol-placement")==="point"&&(this.writingModes=d.get("text-writing-mode").map((x=>e.ao[x]))),this.stateDependentLayerIds=this.layers.filter((x=>x.isStateDependent())).map((x=>x.id)),this.sourceID=r.sourceID}createArrays(){this.text=new Qv(new Ko(this.layers,this.zoom,(r=>/^text/.test(r)))),this.icon=new Qv(new Ko(this.layers,this.zoom,(r=>/^icon/.test(r)))),this.glyphOffsetArray=new ue,this.lineVertexArray=new ce,this.symbolInstances=new le,this.textAnchorOffsets=new Ee}calculateGlyphDependencies(r,s,d,h,b){for(let x=0;x<r.length;x++)if(s[r.charCodeAt(x)]=!0,(d||h)&&b){const A=Hf[r.charAt(x)];A&&(s[A.charCodeAt(0)]=!0)}}populate(r,s,d){const h=this.layers[0],b=h.layout,x=b.get("text-font"),A=b.get("text-field"),S=b.get("icon-image"),D=(A.value.kind!=="constant"||A.value.value instanceof On&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),M=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,F=b.get("symbol-sort-key");if(this.features=[],!D&&!M)return;const Z=s.iconDependencies,H=s.glyphDependencies,Y=s.availableImages,ie=new ci(this.zoom);for(const{feature:ae,id:ye,index:qe,sourceLayerIndex:Se}of r){const Me=h._featureFilter.needGeometry,We=Cu(ae,Me);if(!h._featureFilter.filter(ie,We,d))continue;let ot,mt;if(Me||(We.geometry=Tu(ae)),D){const Rt=h.getValueAndResolveTokens("text-field",We,d,Y),Pt=On.factory(Rt),Zt=this.hasRTLText=this.hasRTLText||GB(Pt);(!Zt||Oo.getRTLTextPluginStatus()==="unavailable"||Zt&&Oo.isParsed())&&(ot=wB(Pt,h,We))}if(M){const Rt=h.getValueAndResolveTokens("icon-image",We,d,Y);mt=Rt instanceof Xn?Rt:Xn.fromString(Rt)}if(!ot&&!mt)continue;const Dt=this.sortFeaturesByKey?F.evaluate(We,{},d):void 0;if(this.features.push({id:ye,text:ot,icon:mt,index:qe,sourceLayerIndex:Se,geometry:We.geometry,properties:ae.properties,type:hd.types[ae.type],sortKey:Dt}),mt&&(Z[mt.name]=!0),ot){const Rt=x.evaluate(We,{},d).join(","),Pt=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(e.ao.vertical)>=0;for(const Zt of ot.sections)if(Zt.image)Z[Zt.image.name]=!0;else{const Tt=Qc(ot.toString()),Lt=Zt.fontStack||Rt,ct=H[Lt]=H[Lt]||{};this.calculateGlyphDependencies(Zt.text,ct,Pt,this.allowVerticalPlacement,Tt)}}}b.get("symbol-placement")==="line"&&(this.features=(function(ae){const ye={},qe={},Se=[];let Me=0;function We(Rt){Se.push(ae[Rt]),Me++}function ot(Rt,Pt,Zt){const Tt=qe[Rt];return delete qe[Rt],qe[Pt]=Tt,Se[Tt].geometry[0].pop(),Se[Tt].geometry[0]=Se[Tt].geometry[0].concat(Zt[0]),Tt}function mt(Rt,Pt,Zt){const Tt=ye[Pt];return delete ye[Pt],ye[Rt]=Tt,Se[Tt].geometry[0].shift(),Se[Tt].geometry[0]=Zt[0].concat(Se[Tt].geometry[0]),Tt}function Dt(Rt,Pt,Zt){const Tt=Zt?Pt[0][Pt[0].length-1]:Pt[0][0];return`${Rt}:${Tt.x}:${Tt.y}`}for(let Rt=0;Rt<ae.length;Rt++){const Pt=ae[Rt],Zt=Pt.geometry,Tt=Pt.text?Pt.text.toString():null;if(!Tt){We(Rt);continue}const Lt=Dt(Tt,Zt),ct=Dt(Tt,Zt,!0);if(Lt in qe&&ct in ye&&qe[Lt]!==ye[ct]){const sr=mt(Lt,ct,Zt),cr=ot(Lt,ct,Se[sr].geometry);delete ye[Lt],delete qe[ct],qe[Dt(Tt,Se[cr].geometry,!0)]=cr,Se[sr].geometry=null}else Lt in qe?ot(Lt,ct,Zt):ct in ye?mt(Lt,ct,Zt):(We(Rt),ye[Lt]=Me-1,qe[ct]=Me-1)}return Se.filter((Rt=>Rt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((ae,ye)=>ae.sortKey-ye.sortKey))}update(r,s,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,s,this.layers,{imagePositions:d}),this.icon.programConfigurations.updatePaintArrays(r,s,this.layers,{imagePositions:d}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,s){const d=this.lineVertexArray.length;if(r.segment!==void 0){let h=r.dist(s[r.segment+1]),b=r.dist(s[r.segment]);const x={};for(let A=r.segment+1;A<s.length;A++)x[A]={x:s[A].x,y:s[A].y,tileUnitDistanceFromAnchor:h},A<s.length-1&&(h+=s[A+1].dist(s[A]));for(let A=r.segment||0;A>=0;A--)x[A]={x:s[A].x,y:s[A].y,tileUnitDistanceFromAnchor:b},A>0&&(b+=s[A-1].dist(s[A]));for(let A=0;A<s.length;A++){const S=x[A];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(r,s,d,h,b,x,A,S,D,M,F,Z){const H=r.indexArray,Y=r.layoutVertexArray,ie=r.segments.prepareSegment(4*s.length,Y,H,this.canOverlap?x.sortKey:void 0),ae=this.glyphOffsetArray.length,ye=ie.vertexLength,qe=this.allowVerticalPlacement&&A===e.ao.vertical?Math.PI/2:0,Se=x.text&&x.text.sections;for(let Me=0;Me<s.length;Me++){const{tl:We,tr:ot,bl:mt,br:Dt,tex:Rt,pixelOffsetTL:Pt,pixelOffsetBR:Zt,minFontScaleX:Tt,minFontScaleY:Lt,glyphOffset:ct,isSDF:sr,sectionIndex:cr}=s[Me],Yt=ie.vertexLength,Kt=ct[1];hy(Y,S.x,S.y,We.x,Kt+We.y,Rt.x,Rt.y,d,sr,Pt.x,Pt.y,Tt,Lt),hy(Y,S.x,S.y,ot.x,Kt+ot.y,Rt.x+Rt.w,Rt.y,d,sr,Zt.x,Pt.y,Tt,Lt),hy(Y,S.x,S.y,mt.x,Kt+mt.y,Rt.x,Rt.y+Rt.h,d,sr,Pt.x,Zt.y,Tt,Lt),hy(Y,S.x,S.y,Dt.x,Kt+Dt.y,Rt.x+Rt.w,Rt.y+Rt.h,d,sr,Zt.x,Zt.y,Tt,Lt),Jv(r.dynamicLayoutVertexArray,S,qe),H.emplaceBack(Yt,Yt+2,Yt+1),H.emplaceBack(Yt+1,Yt+2,Yt+3),ie.vertexLength+=4,ie.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ct[0]),Me!==s.length-1&&cr===s[Me+1].sectionIndex||r.programConfigurations.populatePaintArrays(Y.length,x,x.index,{imagePositions:{},canonical:Z,formattedSection:Se&&Se[cr]})}r.placedSymbolArray.emplaceBack(S.x,S.y,ae,this.glyphOffsetArray.length-ae,ye,D,M,S.segment,d?d[0]:0,d?d[1]:0,h[0],h[1],A,0,!1,0,F)}_addCollisionDebugVertex(r,s,d,h,b,x){return s.emplaceBack(0,0),r.emplaceBack(d.x,d.y,h,b,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(r,s,d,h,b,x,A){const S=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),D=S.vertexLength,M=b.layoutVertexArray,F=b.collisionVertexArray,Z=A.anchorX,H=A.anchorY;this._addCollisionDebugVertex(M,F,x,Z,H,new _(r,s)),this._addCollisionDebugVertex(M,F,x,Z,H,new _(d,s)),this._addCollisionDebugVertex(M,F,x,Z,H,new _(d,h)),this._addCollisionDebugVertex(M,F,x,Z,H,new _(r,h)),S.vertexLength+=4;const Y=b.indexArray;Y.emplaceBack(D,D+1),Y.emplaceBack(D+1,D+2),Y.emplaceBack(D+2,D+3),Y.emplaceBack(D+3,D),S.primitiveLength+=4}addDebugCollisionBoxes(r,s,d,h){for(let b=r;b<s;b++){const x=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,h?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new e0(fr,F1.members,ii),this.iconCollisionBox=new e0(fr,F1.members,ii);for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(r,s,d,h,b,x,A,S,D){const M={};for(let F=s;F<d;F++){const Z=r.get(F);M.textBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},M.textFeatureIndex=Z.featureIndex;break}for(let F=h;F<b;F++){const Z=r.get(F);M.verticalTextBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},M.verticalTextFeatureIndex=Z.featureIndex;break}for(let F=x;F<A;F++){const Z=r.get(F);M.iconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},M.iconFeatureIndex=Z.featureIndex;break}for(let F=S;F<D;F++){const Z=r.get(F);M.verticalIconBox={x1:Z.x1,y1:Z.y1,x2:Z.x2,y2:Z.y2,anchorPointX:Z.anchorPointX,anchorPointY:Z.anchorPointY},M.verticalIconFeatureIndex=Z.featureIndex;break}return M}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const d=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,s){const d=r.placedSymbolArray.get(s),h=d.vertexStartIndex+4*d.numGlyphs;for(let b=d.vertexStartIndex;b<h;b+=4)r.indexArray.emplaceBack(b,b+2,b+1),r.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(r),d=Math.cos(r),h=[],b=[],x=[];for(let A=0;A<this.symbolInstances.length;++A){x.push(A);const S=this.symbolInstances.get(A);h.push(0|Math.round(s*S.anchorX+d*S.anchorY)),b.push(S.featureIndex)}return x.sort(((A,S)=>h[A]-h[S]||b[S]-b[A])),x}addToSortKeyRanges(r,s){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===s?d.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const d=this.symbolInstances.get(s);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach(((h,b,x)=>{h>=0&&x.indexOf(h)===b&&this.addIndicesForPlacedSymbol(this.text,h)})),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let rw,iw;It("SymbolBucket",gd,{omit:["layers","collisionBoxArray","features","compareText"]}),gd.MAX_GLYPHS=65535,gd.addDynamicAttributes=Jv;var t0={get paint(){return iw=iw||new Tn({"icon-opacity":new tr(Ke.paint_symbol["icon-opacity"]),"icon-color":new tr(Ke.paint_symbol["icon-color"]),"icon-halo-color":new tr(Ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new tr(Ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new tr(Ke.paint_symbol["icon-halo-blur"]),"icon-translate":new qt(Ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new qt(Ke.paint_symbol["icon-translate-anchor"]),"text-opacity":new tr(Ke.paint_symbol["text-opacity"]),"text-color":new tr(Ke.paint_symbol["text-color"],{runtimeType:Ni,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new tr(Ke.paint_symbol["text-halo-color"]),"text-halo-width":new tr(Ke.paint_symbol["text-halo-width"]),"text-halo-blur":new tr(Ke.paint_symbol["text-halo-blur"]),"text-translate":new qt(Ke.paint_symbol["text-translate"]),"text-translate-anchor":new qt(Ke.paint_symbol["text-translate-anchor"])})},get layout(){return rw=rw||new Tn({"symbol-placement":new qt(Ke.layout_symbol["symbol-placement"]),"symbol-spacing":new qt(Ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new qt(Ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new tr(Ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new qt(Ke.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new qt(Ke.layout_symbol["icon-allow-overlap"]),"icon-overlap":new qt(Ke.layout_symbol["icon-overlap"]),"icon-ignore-placement":new qt(Ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new qt(Ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new qt(Ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new tr(Ke.layout_symbol["icon-size"]),"icon-text-fit":new qt(Ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new qt(Ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new tr(Ke.layout_symbol["icon-image"]),"icon-rotate":new tr(Ke.layout_symbol["icon-rotate"]),"icon-padding":new tr(Ke.layout_symbol["icon-padding"]),"icon-keep-upright":new qt(Ke.layout_symbol["icon-keep-upright"]),"icon-offset":new tr(Ke.layout_symbol["icon-offset"]),"icon-anchor":new tr(Ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new qt(Ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new qt(Ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new qt(Ke.layout_symbol["text-rotation-alignment"]),"text-field":new tr(Ke.layout_symbol["text-field"]),"text-font":new tr(Ke.layout_symbol["text-font"]),"text-size":new tr(Ke.layout_symbol["text-size"]),"text-max-width":new tr(Ke.layout_symbol["text-max-width"]),"text-line-height":new qt(Ke.layout_symbol["text-line-height"]),"text-letter-spacing":new tr(Ke.layout_symbol["text-letter-spacing"]),"text-justify":new tr(Ke.layout_symbol["text-justify"]),"text-radial-offset":new tr(Ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new qt(Ke.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new tr(Ke.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new tr(Ke.layout_symbol["text-anchor"]),"text-max-angle":new qt(Ke.layout_symbol["text-max-angle"]),"text-writing-mode":new qt(Ke.layout_symbol["text-writing-mode"]),"text-rotate":new tr(Ke.layout_symbol["text-rotate"]),"text-padding":new qt(Ke.layout_symbol["text-padding"]),"text-keep-upright":new qt(Ke.layout_symbol["text-keep-upright"]),"text-transform":new tr(Ke.layout_symbol["text-transform"]),"text-offset":new tr(Ke.layout_symbol["text-offset"]),"text-allow-overlap":new qt(Ke.layout_symbol["text-allow-overlap"]),"text-overlap":new qt(Ke.layout_symbol["text-overlap"]),"text-ignore-placement":new qt(Ke.layout_symbol["text-ignore-placement"]),"text-optional":new qt(Ke.layout_symbol["text-optional"])})}};class nw{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:at,this.defaultValue=r}evaluate(r){if(r.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(r.formattedSection))return s.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}It("FormatSectionOverride",nw,{omit:["defaultValue"]});class my extends ks{constructor(r,s){super(r,t0,s)}recalculate(r,s){if(super.recalculate(r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const d=this.layout.get("text-writing-mode");if(d){const h=[];for(const b of d)h.indexOf(b)<0&&h.push(b);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,s,d,h){const b=this.layout.get(r).evaluate(s,{},d,h),x=this._unevaluatedLayout._values[r];return x.isDataDriven()||jc(x.value)||!b?b:(function(A,S){return S.replace(/{([^{}]+)}/g,((D,M)=>A&&M in A?String(A[M]):""))})(s.properties,b)}createBucket(r){return new gd(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of t0.paint.overridableProperties){if(!my.hasPaintOverride(this.layout,r))continue;const s=this.paint.get(r),d=new nw(s),h=new yf(d,s.property.specification);let b=null;b=s.value.kind==="constant"||s.value.kind==="source"?new Fc("source",h):new qc("composite",h,s.value.zoomStops),this.paint._values[r]=new Ws(s.property,b,s.parameters)}}_handleOverridablePaintPropertyUpdate(r,s,d){return!(!this.layout||s.isDataDriven()||d.isDataDriven())&&my.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,s){const d=r.get("text-field"),h=t0.paint.properties[s];let b=!1;const x=A=>{for(const S of A)if(h.overrides&&h.overrides.hasOverride(S))return void(b=!0)};if(d.value.kind==="constant"&&d.value.value instanceof On)x(d.value.value.sections);else if(d.value.kind==="source"||d.value.kind==="composite"){const A=D=>{b||(D instanceof pr&&Ri(D.value)===Hn?x(D.value.sections):D instanceof Cc?x(D.sections):D.eachChild(A))},S=d.value;S._styleExpression&&A(S._styleExpression.expression)}return b}}let sw;var $B={get paint(){return sw=sw||new Tn({"background-color":new qt(Ke.paint_background["background-color"]),"background-pattern":new ry(Ke.paint_background["background-pattern"]),"background-opacity":new qt(Ke.paint_background["background-opacity"])})}};class ZB extends ks{constructor(r,s){super(r,$B,s)}}class HB extends ks{constructor(r,s){super(r,{},s),this.onAdd=d=>{this.implementation.onAdd&&this.implementation.onAdd(d,d.painter.context.gl)},this.onRemove=d=>{this.implementation.onRemove&&this.implementation.onRemove(d,d.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class XB{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const WB={once:!0},r0=63710088e-1;class _l{constructor(r,s){if(isNaN(r)||isNaN(s))throw new Error(`Invalid LngLat object: (${r}, ${s})`);if(this.lng=+r,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new _l(Ur(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const s=Math.PI/180,d=this.lat*s,h=r.lat*s,b=Math.sin(d)*Math.sin(h)+Math.cos(d)*Math.cos(h)*Math.cos((r.lng-this.lng)*s);return r0*Math.acos(Math.min(b,1))}static convert(r){if(r instanceof _l)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new _l(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new _l(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const ow=2*Math.PI*r0;function aw(o){return ow*Math.cos(o*Math.PI/180)}function lw(o){return(180+o)/360}function uw(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function cw(o,r){return o/aw(r)}function i0(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function dw(o,r){return o*aw(i0(r))}class Wf{constructor(r,s,d=0){this.x=+r,this.y=+s,this.z=+d}static fromLngLat(r,s=0){const d=_l.convert(r);return new Wf(lw(d.lng),uw(d.lat),cw(s,d.lat))}toLngLat(){return new _l(360*this.x-180,i0(this.y))}toAltitude(){return dw(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ow*(r=i0(this.y),1/Math.cos(r*Math.PI/180));var r}}function pw(o,r,s){var d=2*Math.PI*6378137/256/Math.pow(2,s);return[o*d-2*Math.PI*6378137/2,r*d-2*Math.PI*6378137/2]}class n0{constructor(r,s,d){if(!(function(h,b,x){return!(h<0||h>25||x<0||x>=Math.pow(2,h)||b<0||b>=Math.pow(2,h))})(r,s,d))throw new Error(`x=${s}, y=${d}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=s,this.y=d,this.key=_d(0,r,r,s,d)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,s,d){const h=(x=this.y,A=this.z,S=pw(256*(b=this.x),256*(x=Math.pow(2,A)-x-1),A),D=pw(256*(b+1),256*(x+1),A),S[0]+","+S[1]+","+D[0]+","+D[1]);var b,x,A,S,D;const M=(function(F,Z,H){let Y,ie="";for(let ae=F;ae>0;ae--)Y=1<<ae-1,ie+=(Z&Y?1:0)+(H&Y?2:0);return ie})(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,h)}isChildOf(r){const s=this.z-r.z;return s>0&&r.x===this.x>>s&&r.y===this.y>>s}getTilePoint(r){const s=Math.pow(2,this.z);return new _((r.x*s-this.x)*lt,(r.y*s-this.y)*lt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class fw{constructor(r,s){this.wrap=r,this.canonical=s,this.key=_d(r,s.z,s.z,s.x,s.y)}}class Ds{constructor(r,s,d,h,b){if(this.terrainRttPosMatrix32f=null,r<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${d}`);this.overscaledZ=r,this.wrap=s,this.canonical=new n0(d,+h,+b),this.key=_d(s,r,d,h,b)}clone(){return new Ds(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-r;return r>this.canonical.z?new Ds(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ds(r,this.wrap,r,this.canonical.x>>s,this.canonical.y>>s)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(r,s){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-r;return r>this.canonical.z?_d(this.wrap*+s,r,this.canonical.z,this.canonical.x,this.canonical.y):_d(this.wrap*+s,r,r,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(r){if(r.wrap!==this.wrap||this.overscaledZ-r.overscaledZ<=0)return!1;if(r.overscaledZ===0)return this.overscaledZ>0;const s=this.canonical.z-r.canonical.z;return!(s<0)&&r.canonical.x===this.canonical.x>>s&&r.canonical.y===this.canonical.y>>s}children(r){if(this.overscaledZ>=r)return[new Ds(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,d=2*this.canonical.x,h=2*this.canonical.y;return[new Ds(s,this.wrap,s,d,h),new Ds(s,this.wrap,s,d+1,h),new Ds(s,this.wrap,s,d,h+1),new Ds(s,this.wrap,s,d+1,h+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ds(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ds(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new fw(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Wf(r.x-this.wrap,r.y))}}function _d(o,r,s,d,h){(o*=2)<0&&(o=-1*o-1);const b=1<<s;return(b*b*o+b*h+d).toString(36)+s.toString(36)+r.toString(36)}function Yf(o,r){return r?o.properties[r]:o.id}It("CanonicalTileID",n0),It("OverscaledTileID",Ds,{omit:["terrainRttPosMatrix32f"]});class Lu{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(r){return this.minX=Math.min(this.minX,r.x),this.minY=Math.min(this.minY,r.y),this.maxX=Math.max(this.maxX,r.x),this.maxY=Math.max(this.maxY,r.y),this}expandBy(r){return this.minX-=r,this.minY-=r,this.maxX+=r,this.maxY+=r,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(r){return this.expandBy(-r)}map(r){const s=new Lu;return s.extend(r(new _(this.minX,this.minY))),s.extend(r(new _(this.maxX,this.minY))),s.extend(r(new _(this.minX,this.maxY))),s.extend(r(new _(this.maxX,this.maxY))),s}static fromPoints(r){const s=new Lu;for(const d of r)s.extend(d);return s}contains(r){return r.x>=this.minX&&r.x<=this.maxX&&r.y>=this.minY&&r.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(r){return!this.empty()&&!r.empty()&&r.minX>=this.minX&&r.maxX<=this.maxX&&r.minY>=this.minY&&r.maxY<=this.maxY}intersects(r){return!this.empty()&&!r.empty()&&r.minX<=this.maxX&&r.maxX>=this.minX&&r.minY<=this.maxY&&r.maxY>=this.minY}}class hw{constructor(r){this._stringToNumber={},this._numberToString=[];for(let s=0;s<r.length;s++){const d=r[s];this._stringToNumber[d]=s,this._numberToString[s]=d}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class mw{constructor(r,s,d,h,b){this.type="Feature",this._vectorTileFeature=r,r._z=s,r._x=d,r._y=h,this.properties=r.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(r[s]=this[s]);return r}}class yw{constructor(r,s){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new bu(lt,16,0),this.grid3D=new bu(lt,16,0),this.featureIndexArray=new Pe,this.promoteId=s}insert(r,s,d,h,b,x){const A=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,h,b);const S=x?this.grid3D:this.grid;for(let D=0;D<s.length;D++){const M=s[D],F=[1/0,1/0,-1/0,-1/0];for(let Z=0;Z<M.length;Z++){const H=M[Z];F[0]=Math.min(F[0],H.x),F[1]=Math.min(F[1],H.y),F[2]=Math.max(F[2],H.x),F[3]=Math.max(F[3],H.y)}F[0]<lt&&F[1]<lt&&F[2]>=0&&F[3]>=0&&S.insert(A,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new I1(new Zv(this.rawTileData)).layers,this.sourceLayerCoder=new hw(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,s,d,h){this.loadVTLayers();const b=r.params,x=lt/r.tileSize/r.scale,A=hu(b.filter,b.globalState),S=r.queryGeometry,D=r.queryPadding*x,M=Lu.fromPoints(S),F=this.grid.query(M.minX-D,M.minY-D,M.maxX+D,M.maxY+D),Z=Lu.fromPoints(r.cameraQueryGeometry).expandBy(D),H=this.grid3D.query(Z.minX,Z.minY,Z.maxX,Z.maxY,((ae,ye,qe,Se)=>(function(Me,We,ot,mt,Dt){for(const Pt of Me)if(We<=Pt.x&&ot<=Pt.y&&mt>=Pt.x&&Dt>=Pt.y)return!0;const Rt=[new _(We,ot),new _(We,Dt),new _(mt,Dt),new _(mt,ot)];if(Me.length>2){for(const Pt of Rt)if(ud(Me,Pt))return!0}for(let Pt=0;Pt<Me.length-1;Pt++)if(SI(Me[Pt],Me[Pt+1],Rt))return!0;return!1})(r.cameraQueryGeometry,ae-D,ye-D,qe+D,Se+D)));for(const ae of H)F.push(ae);F.sort(YB);const Y={};let ie;for(let ae=0;ae<F.length;ae++){const ye=F[ae];if(ye===ie)continue;ie=ye;const qe=this.featureIndexArray.get(ye);let Se=null;this.loadMatchingFeature(Y,qe.bucketIndex,qe.sourceLayerIndex,qe.featureIndex,A,b.layers,b.availableImages,s,d,h,((Me,We,ot)=>(Se||(Se=Tu(Me)),We.queryIntersectsFeature({queryGeometry:S,feature:Me,featureState:ot,geometry:Se,zoom:this.z,transform:r.transform,pixelsToTileUnits:x,pixelPosMatrix:r.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:r.getElevation}))))}return Y}loadMatchingFeature(r,s,d,h,b,x,A,S,D,M,F){const Z=this.bucketLayerIDs[s];if(x&&!Z.some((ae=>x.has(ae))))return;const H=this.sourceLayerCoder.decode(d),Y=this.vtLayers[H].feature(h);if(b.needGeometry){const ae=Cu(Y,!0);if(!b.filter(new ci(this.tileID.overscaledZ),ae,this.tileID.canonical))return}else if(!b.filter(new ci(this.tileID.overscaledZ),Y))return;const ie=this.getId(Y,H);for(let ae=0;ae<Z.length;ae++){const ye=Z[ae];if(x&&!x.has(ye))continue;const qe=S[ye];if(!qe)continue;let Se={};ie&&M&&(Se=M.getState(qe.sourceLayer||"_geojsonTileLayer",ie));const Me=or({},D[ye]);Me.paint=gw(Me.paint,qe.paint,Y,Se,A),Me.layout=gw(Me.layout,qe.layout,Y,Se,A);const We=!F||F(Y,qe,Se);if(!We)continue;const ot=new mw(Y,this.z,this.x,this.y,ie);ot.layer=Me;let mt=r[ye];mt===void 0&&(mt=r[ye]=[]),mt.push({featureIndex:h,feature:ot,intersectionZ:We})}}lookupSymbolFeatures(r,s,d,h,b,x,A,S){const D={};this.loadVTLayers();const M=hu(b.filterSpec,b.globalState);for(const F of r)this.loadMatchingFeature(D,d,h,F,M,x,A,S,s);return D}hasLayer(r){for(const s of this.bucketLayerIDs)for(const d of s)if(r===d)return!0;return!1}getId(r,s){var d;let h=r.id;return this.promoteId&&(h=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((d=r.properties)===null||d===void 0)&&d.cluster)&&this.promoteId&&(h=Number(r.properties.cluster_id))),h}}function gw(o,r,s,d,h){return Ar(o,((b,x)=>{const A=r instanceof id?r.get(x):null;return A&&A.evaluate?A.evaluate(s,d,h):A}))}function YB(o,r){return r-o}function _w(o,r,s,d,h){const b=[];for(let x=0;x<o.length;x++){const A=o[x];let S;for(let D=0;D<A.length-1;D++){let M=A[D],F=A[D+1];M.x<r&&F.x<r||(M.x<r?M=new _(r,M.y+(r-M.x)/(F.x-M.x)*(F.y-M.y))._round():F.x<r&&(F=new _(r,M.y+(r-M.x)/(F.x-M.x)*(F.y-M.y))._round()),M.y<s&&F.y<s||(M.y<s?M=new _(M.x+(s-M.y)/(F.y-M.y)*(F.x-M.x),s)._round():F.y<s&&(F=new _(M.x+(s-M.y)/(F.y-M.y)*(F.x-M.x),s)._round()),M.x>=d&&F.x>=d||(M.x>=d?M=new _(d,M.y+(d-M.x)/(F.x-M.x)*(F.y-M.y))._round():F.x>=d&&(F=new _(d,M.y+(d-M.x)/(F.x-M.x)*(F.y-M.y))._round()),M.y>=h&&F.y>=h||(M.y>=h?M=new _(M.x+(h-M.y)/(F.y-M.y)*(F.x-M.x),h)._round():F.y>=h&&(F=new _(M.x+(h-M.y)/(F.y-M.y)*(F.x-M.x),h)._round()),S&&M.equals(S[S.length-1])||(S=[M],b.push(S)),S.push(F)))))}}return b}It("FeatureIndex",yw,{omit:["rawTileData","sourceLayerCoder"]});class bl extends _{constructor(r,s,d,h){super(r,s),this.angle=d,h!==void 0&&(this.segment=h)}clone(){return new bl(this.x,this.y,this.angle,this.segment)}}function bw(o,r,s,d,h){if(r.segment===void 0||s===0)return!0;let b=r,x=r.segment+1,A=0;for(;A>-s/2;){if(x--,x<0)return!1;A-=o[x].dist(b),b=o[x]}A+=o[x].dist(o[x+1]),x++;const S=[];let D=0;for(;A<s/2;){const M=o[x],F=o[x+1];if(!F)return!1;let Z=o[x-1].angleTo(M)-M.angleTo(F);for(Z=Math.abs((Z+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:A,angleDelta:Z}),D+=Z;A-S[0].distance>d;)D-=S.shift().angleDelta;if(D>h)return!1;x++,A+=M.dist(F)}return!0}function vw(o){let r=0;for(let s=0;s<o.length-1;s++)r+=o[s].dist(o[s+1]);return r}function xw(o,r,s){return o?.6*r*s:0}function ww(o,r){return Math.max(o?o.right-o.left:0,r?r.right-r.left:0)}function JB(o,r,s,d,h,b){const x=xw(s,h,b),A=ww(s,d)*b;let S=0;const D=vw(o)/2;for(let M=0;M<o.length-1;M++){const F=o[M],Z=o[M+1],H=F.dist(Z);if(S+H>D){const Y=(D-S)/H,ie=fs.number(F.x,Z.x,Y),ae=fs.number(F.y,Z.y,Y),ye=new bl(ie,ae,Z.angleTo(F),M);return ye._round(),!x||bw(o,ye,A,x,r)?ye:void 0}S+=H}}function QB(o,r,s,d,h,b,x,A,S){const D=xw(d,b,x),M=ww(d,h),F=M*x,Z=o[0].x===0||o[0].x===S||o[0].y===0||o[0].y===S;return r-F<r/4&&(r=F+r/4),Ew(o,Z?r/2*A%r:(M/2+2*b)*x*A%r,r,D,s,F,Z,!1,S)}function Ew(o,r,s,d,h,b,x,A,S){const D=b/2,M=vw(o);let F=0,Z=r-s,H=[];for(let Y=0;Y<o.length-1;Y++){const ie=o[Y],ae=o[Y+1],ye=ie.dist(ae),qe=ae.angleTo(ie);for(;Z+s<F+ye;){Z+=s;const Se=(Z-F)/ye,Me=fs.number(ie.x,ae.x,Se),We=fs.number(ie.y,ae.y,Se);if(Me>=0&&Me<S&&We>=0&&We<S&&Z-D>=0&&Z+D<=M){const ot=new bl(Me,We,qe,Y);ot._round(),d&&!bw(o,ot,b,d,h)||H.push(ot)}}F+=ye}return A||H.length||x||(H=Ew(o,F/2,s,d,h,b,x,!0,S)),H}function Aw(o,r,s,d){const h=[],b=o.image,x=b.pixelRatio,A=b.paddedRect.w-2,S=b.paddedRect.h-2;let D={x1:o.left,y1:o.top,x2:o.right,y2:o.bottom};const M=b.stretchX||[[0,A]],F=b.stretchY||[[0,S]],Z=(ct,sr)=>ct+sr[1]-sr[0],H=M.reduce(Z,0),Y=F.reduce(Z,0),ie=A-H,ae=S-Y;let ye=0,qe=H,Se=0,Me=Y,We=0,ot=ie,mt=0,Dt=ae;if(b.content&&d){const ct=b.content,sr=ct[2]-ct[0],cr=ct[3]-ct[1];(b.textFitWidth||b.textFitHeight)&&(D=Q1(o)),ye=yy(M,0,ct[0]),Se=yy(F,0,ct[1]),qe=yy(M,ct[0],ct[2]),Me=yy(F,ct[1],ct[3]),We=ct[0]-ye,mt=ct[1]-Se,ot=sr-qe,Dt=cr-Me}const Rt=D.x1,Pt=D.y1,Zt=D.x2-Rt,Tt=D.y2-Pt,Lt=(ct,sr,cr,Yt)=>{const Kt=gy(ct.stretch-ye,qe,Zt,Rt),Mr=_y(ct.fixed-We,ot,ct.stretch,H),Si=gy(sr.stretch-Se,Me,Tt,Pt),Gi=_y(sr.fixed-mt,Dt,sr.stretch,Y),bn=gy(cr.stretch-ye,qe,Zt,Rt),Is=_y(cr.fixed-We,ot,cr.stretch,H),es=gy(Yt.stretch-Se,Me,Tt,Pt),fn=_y(Yt.fixed-mt,Dt,Yt.stretch,Y),wi=new _(Kt,Si),tn=new _(bn,Si),hn=new _(bn,es),mn=new _(Kt,es),jn=new _(Mr/x,Gi/x),Bs=new _(Is/x,fn/x),rn=r*Math.PI/180;if(rn){const nn=Math.sin(rn),sn=Math.cos(rn),Fi=[sn,-nn,nn,sn];wi._matMult(Fi),tn._matMult(Fi),mn._matMult(Fi),hn._matMult(Fi)}const ts=ct.stretch+ct.fixed,$i=sr.stretch+sr.fixed;return{tl:wi,tr:tn,bl:mn,br:hn,tex:{x:b.paddedRect.x+1+ts,y:b.paddedRect.y+1+$i,w:cr.stretch+cr.fixed-ts,h:Yt.stretch+Yt.fixed-$i},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:jn,pixelOffsetBR:Bs,minFontScaleX:ot/x/Zt,minFontScaleY:Dt/x/Tt,isSDF:s}};if(d&&(b.stretchX||b.stretchY)){const ct=Rw(M,ie,H),sr=Rw(F,ae,Y);for(let cr=0;cr<ct.length-1;cr++){const Yt=ct[cr],Kt=ct[cr+1];for(let Mr=0;Mr<sr.length-1;Mr++)h.push(Lt(Yt,sr[Mr],Kt,sr[Mr+1]))}}else h.push(Lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:S+1}));return h}function yy(o,r,s){let d=0;for(const h of o)d+=Math.max(r,Math.min(s,h[1]))-Math.max(r,Math.min(s,h[0]));return d}function Rw(o,r,s){const d=[{fixed:-1,stretch:0}];for(const[h,b]of o){const x=d[d.length-1];d.push({fixed:h-x.stretch,stretch:x.stretch}),d.push({fixed:h-x.stretch,stretch:x.stretch+(b-h)})}return d.push({fixed:r+1,stretch:s}),d}function gy(o,r,s,d){return o/r*s+d}function _y(o,r,s,d){return o-r*s/d}It("Anchor",bl);class by{constructor(r,s,d,h,b,x,A,S,D,M){var F;if(this.boxStartIndex=r.length,D){let Z=x.top,H=x.bottom;const Y=x.collisionPadding;Y&&(Z-=Y[1],H+=Y[3]);let ie=H-Z;ie>0&&(ie=Math.max(10,ie),this.circleDiameter=ie)}else{const Z=!((F=x.image)===null||F===void 0)&&F.content&&(x.image.textFitWidth||x.image.textFitHeight)?Q1(x):{x1:x.left,y1:x.top,x2:x.right,y2:x.bottom};Z.y1=Z.y1*A-S[0],Z.y2=Z.y2*A+S[2],Z.x1=Z.x1*A-S[3],Z.x2=Z.x2*A+S[1];const H=x.collisionPadding;if(H&&(Z.x1-=H[0]*A,Z.y1-=H[1]*A,Z.x2+=H[2]*A,Z.y2+=H[3]*A),M){const Y=new _(Z.x1,Z.y1),ie=new _(Z.x2,Z.y1),ae=new _(Z.x1,Z.y2),ye=new _(Z.x2,Z.y2),qe=M*Math.PI/180;Y._rotate(qe),ie._rotate(qe),ae._rotate(qe),ye._rotate(qe),Z.x1=Math.min(Y.x,ie.x,ae.x,ye.x),Z.x2=Math.max(Y.x,ie.x,ae.x,ye.x),Z.y1=Math.min(Y.y,ie.y,ae.y,ye.y),Z.y2=Math.max(Y.y,ie.y,ae.y,ye.y)}r.emplaceBack(s.x,s.y,Z.x1,Z.y1,Z.x2,Z.y2,d,h,b)}this.boxEndIndex=r.length}}class eM{constructor(r=[],s=(d,h)=>d<h?-1:d>h?1:0){if(this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:s,compare:d}=this,h=s[r];for(;r>0;){const b=r-1>>1,x=s[b];if(d(h,x)>=0)break;s[r]=x,r=b}s[r]=h}_down(r){const{data:s,compare:d}=this,h=this.length>>1,b=s[r];for(;r<h;){let x=1+(r<<1);const A=x+1;if(A<this.length&&d(s[A],s[x])<0&&(x=A),d(s[x],b)>=0)break;s[r]=s[x],r=x}s[r]=b}}function tM(o,r=1,s=!1){const d=Lu.fromPoints(o[0]),h=Math.min(d.width(),d.height());let b=h/2;const x=new eM([],rM),{minX:A,minY:S,maxX:D,maxY:M}=d;if(h===0)return new _(A,S);for(let H=A;H<D;H+=h)for(let Y=S;Y<M;Y+=h)x.push(new bd(H+b,Y+b,b,o));let F=(function(H){let Y=0,ie=0,ae=0;const ye=H[0];for(let qe=0,Se=ye.length,Me=Se-1;qe<Se;Me=qe++){const We=ye[qe],ot=ye[Me],mt=We.x*ot.y-ot.x*We.y;ie+=(We.x+ot.x)*mt,ae+=(We.y+ot.y)*mt,Y+=3*mt}return new bd(ie/Y,ae/Y,0,H)})(o),Z=x.length;for(;x.length;){const H=x.pop();(H.d>F.d||!F.d)&&(F=H,s&&console.log("found best %d after %d probes",Math.round(1e4*H.d)/1e4,Z)),H.max-F.d<=r||(b=H.h/2,x.push(new bd(H.p.x-b,H.p.y-b,b,o)),x.push(new bd(H.p.x+b,H.p.y-b,b,o)),x.push(new bd(H.p.x-b,H.p.y+b,b,o)),x.push(new bd(H.p.x+b,H.p.y+b,b,o)),Z+=4)}return s&&(console.log(`num probes: ${Z}`),console.log(`best distance: ${F.d}`)),F.p}function rM(o,r){return r.max-o.max}function bd(o,r,s,d){this.p=new _(o,r),this.h=s,this.d=(function(h,b){let x=!1,A=1/0;for(let S=0;S<b.length;S++){const D=b[S];for(let M=0,F=D.length,Z=F-1;M<F;Z=M++){const H=D[M],Y=D[Z];H.y>h.y!=Y.y>h.y&&h.x<(Y.x-H.x)*(h.y-H.y)/(Y.y-H.y)+H.x&&(x=!x),A=Math.min(A,c1(h,H,Y))}}return(x?1:-1)*Math.sqrt(A)})(this.p,d),this.max=this.d+this.h*Math.SQRT2}var _n;e.aE=void 0,(_n=e.aE||(e.aE={}))[_n.center=1]="center",_n[_n.left=2]="left",_n[_n.right=3]="right",_n[_n.top=4]="top",_n[_n.bottom=5]="bottom",_n[_n["top-left"]=6]="top-left",_n[_n["top-right"]=7]="top-right",_n[_n["bottom-left"]=8]="bottom-left",_n[_n["bottom-right"]=9]="bottom-right";const s0=Number.POSITIVE_INFINITY;function Sw(o,r){return r[1]!==s0?(function(s,d,h){let b=0,x=0;switch(d=Math.abs(d),h=Math.abs(h),s){case"top-right":case"top-left":case"top":x=h-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-h}switch(s){case"top-right":case"bottom-right":case"right":b=-d;break;case"top-left":case"bottom-left":case"left":b=d}return[b,x]})(o,r[0],r[1]):(function(s,d){let h=0,b=0;d<0&&(d=0);const x=d/Math.SQRT2;switch(s){case"top-right":case"top-left":b=x-7;break;case"bottom-right":case"bottom-left":b=7-x;break;case"bottom":b=7-d;break;case"top":b=d-7}switch(s){case"top-right":case"bottom-right":h=-x;break;case"top-left":case"bottom-left":h=x;break;case"left":h=d;break;case"right":h=-d}return[h,b]})(o,r[0])}function Tw(o,r,s){var d;const h=o.layout,b=(d=h.get("text-variable-anchor-offset"))===null||d===void 0?void 0:d.evaluate(r,{},s);if(b){const A=b.values,S=[];for(let D=0;D<A.length;D+=2){const M=S[D]=A[D],F=A[D+1].map((Z=>Z*en));M.startsWith("top")?F[1]-=7:M.startsWith("bottom")&&(F[1]+=7),S[D+1]=F}return new Sn(S)}const x=h.get("text-variable-anchor");if(x){let A;A=o._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(r,{},s)*en,s0]:h.get("text-offset").evaluate(r,{},s).map((D=>D*en));const S=[];for(const D of x)S.push(D,Sw(D,A));return new Sn(S)}return null}function o0(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function iM(o,r,s,d,h,b,x,A,S,D,M,F){let Z=b.textMaxSize.evaluate(r,{});Z===void 0&&(Z=x);const H=o.layers[0].layout,Y=H.get("icon-offset").evaluate(r,{},M),ie=kw(s.horizontal),ae=x/24,ye=o.tilePixelRatio*ae,qe=o.tilePixelRatio*Z/24,Se=o.tilePixelRatio*A,Me=o.tilePixelRatio*H.get("symbol-spacing"),We=H.get("text-padding")*o.tilePixelRatio,ot=(function(cr,Yt,Kt,Mr=1){const Si=cr.get("icon-padding").evaluate(Yt,{},Kt),Gi=Si&&Si.values;return[Gi[0]*Mr,Gi[1]*Mr,Gi[2]*Mr,Gi[3]*Mr]})(H,r,M,o.tilePixelRatio),mt=H.get("text-max-angle")/180*Math.PI,Dt=H.get("text-rotation-alignment")!=="viewport"&&H.get("symbol-placement")!=="point",Rt=H.get("icon-rotation-alignment")==="map"&&H.get("symbol-placement")!=="point",Pt=H.get("symbol-placement"),Zt=Me/2,Tt=H.get("icon-text-fit");let Lt;d&&Tt!=="none"&&(o.allowVerticalPlacement&&s.vertical&&(Lt=ew(d,s.vertical,Tt,H.get("icon-text-fit-padding"),Y,ae)),ie&&(d=ew(d,ie,Tt,H.get("icon-text-fit-padding"),Y,ae)));const ct=M?F.line.getGranularityForZoomLevel(M.z):1,sr=(cr,Yt)=>{Yt.x<0||Yt.x>=lt||Yt.y<0||Yt.y>=lt||(function(Kt,Mr,Si,Gi,bn,Is,es,fn,wi,tn,hn,mn,jn,Bs,rn,ts,$i,nn,sn,Fi,mi,ho,vd,mo,oM){const xd=Kt.addToLineVertexArray(Mr,Si);let Du,wd,Ed,Ad,Iw=0,Bw=0,Mw=0,zw=0,h0=-1,m0=-1;const Ca={};let Ow=ml("");if(Kt.allowVerticalPlacement&&Gi.vertical){const kn=fn.layout.get("text-rotate").evaluate(mi,{},mo)+90;Ed=new by(wi,Mr,tn,hn,mn,Gi.vertical,jn,Bs,rn,kn),es&&(Ad=new by(wi,Mr,tn,hn,mn,es,$i,nn,rn,kn))}if(bn){const kn=fn.layout.get("icon-rotate").evaluate(mi,{}),Ms=fn.layout.get("icon-text-fit")!=="none",Iu=Aw(bn,kn,vd,Ms),go=es?Aw(es,kn,vd,Ms):void 0;wd=new by(wi,Mr,tn,hn,mn,bn,$i,nn,!1,kn),Iw=4*Iu.length;const Bu=Kt.iconSizeData;let Go=null;Bu.kind==="source"?(Go=[Ta*fn.layout.get("icon-size").evaluate(mi,{})],Go[0]>gl&&ir(`${Kt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Bu.kind==="composite"&&(Go=[Ta*ho.compositeIconSizes[0].evaluate(mi,{},mo),Ta*ho.compositeIconSizes[1].evaluate(mi,{},mo)],(Go[0]>gl||Go[1]>gl)&&ir(`${Kt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Kt.addSymbols(Kt.icon,Iu,Go,Fi,sn,mi,e.ao.none,Mr,xd.lineStartIndex,xd.lineLength,-1,mo),h0=Kt.icon.placedSymbolArray.length-1,go&&(Bw=4*go.length,Kt.addSymbols(Kt.icon,go,Go,Fi,sn,mi,e.ao.vertical,Mr,xd.lineStartIndex,xd.lineLength,-1,mo),m0=Kt.icon.placedSymbolArray.length-1)}const Vw=Object.keys(Gi.horizontal);for(const kn of Vw){const Ms=Gi.horizontal[kn];if(!Du){Ow=ml(Ms.text);const go=fn.layout.get("text-rotate").evaluate(mi,{},mo);Du=new by(wi,Mr,tn,hn,mn,Ms,jn,Bs,rn,go)}const Iu=Ms.positionedLines.length===1;if(Mw+=Cw(Kt,Mr,Ms,Is,fn,rn,mi,ts,xd,Gi.vertical?e.ao.horizontal:e.ao.horizontalOnly,Iu?Vw:[kn],Ca,h0,ho,mo),Iu)break}Gi.vertical&&(zw+=Cw(Kt,Mr,Gi.vertical,Is,fn,rn,mi,ts,xd,e.ao.vertical,["vertical"],Ca,m0,ho,mo));const aM=Du?Du.boxStartIndex:Kt.collisionBoxArray.length,lM=Du?Du.boxEndIndex:Kt.collisionBoxArray.length,uM=Ed?Ed.boxStartIndex:Kt.collisionBoxArray.length,cM=Ed?Ed.boxEndIndex:Kt.collisionBoxArray.length,dM=wd?wd.boxStartIndex:Kt.collisionBoxArray.length,pM=wd?wd.boxEndIndex:Kt.collisionBoxArray.length,fM=Ad?Ad.boxStartIndex:Kt.collisionBoxArray.length,hM=Ad?Ad.boxEndIndex:Kt.collisionBoxArray.length;let yo=-1;const xy=(kn,Ms)=>kn&&kn.circleDiameter?Math.max(kn.circleDiameter,Ms):Ms;yo=xy(Du,yo),yo=xy(Ed,yo),yo=xy(wd,yo),yo=xy(Ad,yo);const Uw=yo>-1?1:0;Uw&&(yo*=oM/en),Kt.glyphOffsetArray.length>=gd.MAX_GLYPHS&&ir("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mi.sortKey!==void 0&&Kt.addToSortKeyRanges(Kt.symbolInstances.length,mi.sortKey);const mM=Tw(fn,mi,mo),[yM,gM]=(function(kn,Ms){const Iu=kn.length,go=Ms?.values;if(go?.length>0)for(let Bu=0;Bu<go.length;Bu+=2){const Go=go[Bu+1];kn.emplaceBack(e.aE[go[Bu]],Go[0],Go[1])}return[Iu,kn.length]})(Kt.textAnchorOffsets,mM);Kt.symbolInstances.emplaceBack(Mr.x,Mr.y,Ca.right>=0?Ca.right:-1,Ca.center>=0?Ca.center:-1,Ca.left>=0?Ca.left:-1,Ca.vertical||-1,h0,m0,Ow,aM,lM,uM,cM,dM,pM,fM,hM,tn,Mw,zw,Iw,Bw,Uw,0,jn,yo,yM,gM)})(o,Yt,cr,s,d,h,Lt,o.layers[0],o.collisionBoxArray,r.index,r.sourceLayerIndex,o.index,ye,[We,We,We,We],Dt,S,Se,ot,Rt,Y,r,b,D,M,x)};if(Pt==="line")for(const cr of _w(r.geometry,0,0,lt,lt)){const Yt=Pu(cr,ct),Kt=QB(Yt,Me,mt,s.vertical||ie,d,24,qe,o.overscaling,lt);for(const Mr of Kt)ie&&nM(o,ie.text,Zt,Mr)||sr(Yt,Mr)}else if(Pt==="line-center"){for(const cr of r.geometry)if(cr.length>1){const Yt=Pu(cr,ct),Kt=JB(Yt,mt,s.vertical||ie,d,24,qe);Kt&&sr(Yt,Kt)}}else if(r.type==="Polygon")for(const cr of Pc(r.geometry,0)){const Yt=tM(cr,16);sr(Pu(cr[0],ct,!0),new bl(Yt.x,Yt.y,0))}else if(r.type==="LineString")for(const cr of r.geometry){const Yt=Pu(cr,ct);sr(Yt,new bl(Yt[0].x,Yt[0].y,0))}else if(r.type==="Point")for(const cr of r.geometry)for(const Yt of cr)sr([Yt],new bl(Yt.x,Yt.y,0))}function Cw(o,r,s,d,h,b,x,A,S,D,M,F,Z,H,Y){const ie=(function(qe,Se,Me,We,ot,mt,Dt,Rt){const Pt=We.layout.get("text-rotate").evaluate(mt,{})*Math.PI/180,Zt=[];for(const Tt of Se.positionedLines)for(const Lt of Tt.positionedGlyphs){if(!Lt.rect)continue;const ct=Lt.rect||{};let sr=4,cr=!0,Yt=1,Kt=0;const Mr=(ot||Rt)&&Lt.vertical,Si=Lt.metrics.advance*Lt.scale/2;if(Rt&&Se.verticalizable&&(Kt=Tt.lineOffset/2-(Lt.imageName?-(en-Lt.metrics.width*Lt.scale)/2:(Lt.scale-1)*en)),Lt.imageName){const nn=Dt[Lt.imageName];cr=nn.sdf,Yt=nn.pixelRatio,sr=1/Yt}const Gi=ot?[Lt.x+Si,Lt.y]:[0,0];let bn=ot?[0,0]:[Lt.x+Si+Me[0],Lt.y+Me[1]-Kt],Is=[0,0];Mr&&(Is=bn,bn=[0,0]);const es=Lt.metrics.isDoubleResolution?2:1,fn=(Lt.metrics.left-sr)*Lt.scale-Si+bn[0],wi=(-Lt.metrics.top-sr)*Lt.scale+bn[1],tn=fn+ct.w/es*Lt.scale/Yt,hn=wi+ct.h/es*Lt.scale/Yt,mn=new _(fn,wi),jn=new _(tn,wi),Bs=new _(fn,hn),rn=new _(tn,hn);if(Mr){const nn=new _(-Si,Si- -17),sn=-Math.PI/2,Fi=12-Si,mi=new _(22-Fi,-(Lt.imageName?Fi:0)),ho=new _(...Is);mn._rotateAround(sn,nn)._add(mi)._add(ho),jn._rotateAround(sn,nn)._add(mi)._add(ho),Bs._rotateAround(sn,nn)._add(mi)._add(ho),rn._rotateAround(sn,nn)._add(mi)._add(ho)}if(Pt){const nn=Math.sin(Pt),sn=Math.cos(Pt),Fi=[sn,-nn,nn,sn];mn._matMult(Fi),jn._matMult(Fi),Bs._matMult(Fi),rn._matMult(Fi)}const ts=new _(0,0),$i=new _(0,0);Zt.push({tl:mn,tr:jn,bl:Bs,br:rn,tex:ct,writingMode:Se.writingMode,glyphOffset:Gi,sectionIndex:Lt.sectionIndex,isSDF:cr,pixelOffsetTL:ts,pixelOffsetBR:$i,minFontScaleX:0,minFontScaleY:0})}return Zt})(0,s,A,h,b,x,d,o.allowVerticalPlacement),ae=o.textSizeData;let ye=null;ae.kind==="source"?(ye=[Ta*h.layout.get("text-size").evaluate(x,{})],ye[0]>gl&&ir(`${o.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ae.kind==="composite"&&(ye=[Ta*H.compositeTextSizes[0].evaluate(x,{},Y),Ta*H.compositeTextSizes[1].evaluate(x,{},Y)],(ye[0]>gl||ye[1]>gl)&&ir(`${o.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),o.addSymbols(o.text,ie,ye,A,b,x,D,r,S.lineStartIndex,S.lineLength,Z,Y);for(const qe of M)F[qe]=o.text.placedSymbolArray.length-1;return 4*ie.length}function kw(o){for(const r in o)return o[r];return null}function nM(o,r,s,d){const h=o.compareText;if(r in h){const b=h[r];for(let x=b.length-1;x>=0;x--)if(d.dist(b[x])<s)return!0}else h[r]=[];return h[r].push(d),!1}const Pw=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class a0{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,d]=new Uint8Array(r,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=d>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const b=Pw[15&d];if(!b)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(r,2,1),[A]=new Uint32Array(r,4,1);return new a0(A,x,b,r)}constructor(r,s=64,d=Float64Array,h){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=d,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const b=Pw.indexOf(this.ArrayType),x=2*r*this.ArrayType.BYTES_PER_ELEMENT,A=r*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-A%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${d}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+A+S,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+x+A+S),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+A+S,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=r)}add(r,s){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=r,this.coords[this._pos++]=s,d}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return l0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,s,d,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:x,nodeSize:A}=this,S=[0,b.length-1,0],D=[];for(;S.length;){const M=S.pop()||0,F=S.pop()||0,Z=S.pop()||0;if(F-Z<=A){for(let ae=Z;ae<=F;ae++){const ye=x[2*ae],qe=x[2*ae+1];ye>=r&&ye<=d&&qe>=s&&qe<=h&&D.push(b[ae])}continue}const H=Z+F>>1,Y=x[2*H],ie=x[2*H+1];Y>=r&&Y<=d&&ie>=s&&ie<=h&&D.push(b[H]),(M===0?r<=Y:s<=ie)&&(S.push(Z),S.push(H-1),S.push(1-M)),(M===0?d>=Y:h>=ie)&&(S.push(H+1),S.push(F),S.push(1-M))}return D}within(r,s,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:b,nodeSize:x}=this,A=[0,h.length-1,0],S=[],D=d*d;for(;A.length;){const M=A.pop()||0,F=A.pop()||0,Z=A.pop()||0;if(F-Z<=x){for(let ae=Z;ae<=F;ae++)Dw(b[2*ae],b[2*ae+1],r,s)<=D&&S.push(h[ae]);continue}const H=Z+F>>1,Y=b[2*H],ie=b[2*H+1];Dw(Y,ie,r,s)<=D&&S.push(h[H]),(M===0?r-d<=Y:s-d<=ie)&&(A.push(Z),A.push(H-1),A.push(1-M)),(M===0?r+d>=Y:s+d>=ie)&&(A.push(H+1),A.push(F),A.push(1-M))}return S}}function l0(o,r,s,d,h,b){if(h-d<=s)return;const x=d+h>>1;Lw(o,r,x,d,h,b),l0(o,r,s,d,x-1,1-b),l0(o,r,s,x+1,h,1-b)}function Lw(o,r,s,d,h,b){for(;h>d;){if(h-d>600){const D=h-d+1,M=s-d+1,F=Math.log(D),Z=.5*Math.exp(2*F/3),H=.5*Math.sqrt(F*Z*(D-Z)/D)*(M-D/2<0?-1:1);Lw(o,r,s,Math.max(d,Math.floor(s-M*Z/D+H)),Math.min(h,Math.floor(s+(D-M)*Z/D+H)),b)}const x=r[2*s+b];let A=d,S=h;for(Jf(o,r,d,s),r[2*h+b]>x&&Jf(o,r,d,h);A<S;){for(Jf(o,r,A,S),A++,S--;r[2*A+b]<x;)A++;for(;r[2*S+b]>x;)S--}r[2*d+b]===x?Jf(o,r,d,S):(S++,Jf(o,r,S,h)),S<=s&&(d=S+1),s<=S&&(h=S-1)}}function Jf(o,r,s,d){u0(o,s,d),u0(r,2*s,2*d),u0(r,2*s+1,2*d+1)}function u0(o,r,s){const d=o[r];o[r]=o[s],o[s]=d}function Dw(o,r,s,d){const h=o-s,b=r-d;return h*h+b*b}var c0;e.cx=void 0,(c0=e.cx||(e.cx={})).create="create",c0.load="load",c0.fullLoad="fullLoad";let vy=null,Qf=[];const d0=1e3/60,p0="loadTime",f0="fullLoadTime",sM={mark(o){performance.mark(o)},frame(o){const r=o;vy!=null&&Qf.push(r-vy),vy=r},clearMetrics(){vy=null,Qf=[],performance.clearMeasures(p0),performance.clearMeasures(f0);for(const o in e.cx)performance.clearMarks(e.cx[o])},getPerformanceMetrics(){performance.measure(p0,e.cx.create,e.cx.load),performance.measure(f0,e.cx.create,e.cx.fullLoad);const o=performance.getEntriesByName(p0)[0].duration,r=performance.getEntriesByName(f0)[0].duration,s=Qf.length,d=1/(Qf.reduce(((b,x)=>b+x),0)/s/1e3),h=Qf.filter((b=>b>d0)).reduce(((b,x)=>b+(x-d0)/d0),0);return{loadTime:o,fullLoadTime:r,fps:d,percentDroppedFrames:h/(s+h)*100,totalFrames:s}}};e.$=lt,e.A=he,e.B=function([o,r,s]){return r+=90,r*=Math.PI/180,s*=Math.PI/180,{x:o*Math.cos(r)*Math.sin(s),y:o*Math.sin(r)*Math.sin(s),z:o*Math.cos(s)}},e.C=fs,e.D=qt,e.E=Ft,e.F=ci,e.G=Af,e.H=St,e.I=Hv,e.J=class{constructor(o,r){this.target=o,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new XB((()=>this.process())),this.subscription=pi(this.target,"message",(s=>this.receive(s)),!1),this.globalScope=Vt(self)?o:window}registerMessageHandler(o,r){this.messageHandlers[o]=r}sendAsync(o,r){return new Promise(((s,d)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),b=r?pi(r.signal,"abort",(()=>{b?.unsubscribe(),delete this.resolveRejects[h];const S={id:h,type:"<cancel>",origin:location.origin,targetMapId:o.targetMapId,sourceMapId:this.mapId};this.target.postMessage(S)}),WB):null;this.resolveRejects[h]={resolve:S=>{b?.unsubscribe(),s(S)},reject:S=>{b?.unsubscribe(),d(S)}};const x=[],A=Object.assign(Object.assign({},o),{id:h,sourceMapId:this.mapId,origin:location.origin,data:xu(o.data,x)});this.target.postMessage(A,{transfer:x})}))}receive(o){const r=o.data,s=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[s];const d=this.abortControllers[s];return delete this.abortControllers[s],void(d&&d.abort())}if(Vt(self)||r.mustQueue)return this.tasks[s]=r,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,r)}}process(){if(this.taskQueue.length===0)return;const o=this.taskQueue.shift(),r=this.tasks[o];delete this.tasks[o],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(o,r)}processTask(o,r){return l(this,void 0,void 0,(function*(){if(r.type==="<response>"){const h=this.resolveRejects[o];return delete this.resolveRejects[o],h?void(r.error?h.reject(xa(r.error)):h.resolve(xa(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(o,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=xa(r.data),d=new AbortController;this.abortControllers[o]=d;try{const h=yield this.messageHandlers[r.type](r.sourceMapId,s,d);this.completeTask(o,null,h)}catch(h){this.completeTask(o,h)}}))}completeTask(o,r,s){const d=[];delete this.abortControllers[o];const h={id:o,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?xu(r):null,data:xu(s,d)};this.target.postMessage(h,{transfer:d})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},e.K=_e,e.L=function(){var o=new he(16);return he!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},e.M=function(o,r,s){var d,h,b,x,A,S,D,M,F,Z,H,Y,ie=s[0],ae=s[1],ye=s[2];return r===o?(o[12]=r[0]*ie+r[4]*ae+r[8]*ye+r[12],o[13]=r[1]*ie+r[5]*ae+r[9]*ye+r[13],o[14]=r[2]*ie+r[6]*ae+r[10]*ye+r[14],o[15]=r[3]*ie+r[7]*ae+r[11]*ye+r[15]):(h=r[1],b=r[2],x=r[3],A=r[4],S=r[5],D=r[6],M=r[7],F=r[8],Z=r[9],H=r[10],Y=r[11],o[0]=d=r[0],o[1]=h,o[2]=b,o[3]=x,o[4]=A,o[5]=S,o[6]=D,o[7]=M,o[8]=F,o[9]=Z,o[10]=H,o[11]=Y,o[12]=d*ie+A*ae+F*ye+r[12],o[13]=h*ie+S*ae+Z*ye+r[13],o[14]=b*ie+D*ae+H*ye+r[14],o[15]=x*ie+M*ae+Y*ye+r[15]),o},e.N=function(o,r,s){var d=s[0],h=s[1],b=s[2];return o[0]=r[0]*d,o[1]=r[1]*d,o[2]=r[2]*d,o[3]=r[3]*d,o[4]=r[4]*h,o[5]=r[5]*h,o[6]=r[6]*h,o[7]=r[7]*h,o[8]=r[8]*b,o[9]=r[9]*b,o[10]=r[10]*b,o[11]=r[11]*b,o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o},e.O=function(o,r,s){var d=r[0],h=r[1],b=r[2],x=r[3],A=r[4],S=r[5],D=r[6],M=r[7],F=r[8],Z=r[9],H=r[10],Y=r[11],ie=r[12],ae=r[13],ye=r[14],qe=r[15],Se=s[0],Me=s[1],We=s[2],ot=s[3];return o[0]=Se*d+Me*A+We*F+ot*ie,o[1]=Se*h+Me*S+We*Z+ot*ae,o[2]=Se*b+Me*D+We*H+ot*ye,o[3]=Se*x+Me*M+We*Y+ot*qe,o[4]=(Se=s[4])*d+(Me=s[5])*A+(We=s[6])*F+(ot=s[7])*ie,o[5]=Se*h+Me*S+We*Z+ot*ae,o[6]=Se*b+Me*D+We*H+ot*ye,o[7]=Se*x+Me*M+We*Y+ot*qe,o[8]=(Se=s[8])*d+(Me=s[9])*A+(We=s[10])*F+(ot=s[11])*ie,o[9]=Se*h+Me*S+We*Z+ot*ae,o[10]=Se*b+Me*D+We*H+ot*ye,o[11]=Se*x+Me*M+We*Y+ot*qe,o[12]=(Se=s[12])*d+(Me=s[13])*A+(We=s[14])*F+(ot=s[15])*ie,o[13]=Se*h+Me*S+We*Z+ot*ae,o[14]=Se*b+Me*D+We*H+ot*ye,o[15]=Se*x+Me*M+We*Y+ot*qe,o},e.P=_,e.Q=function(o,r){const s={};for(let d=0;d<r.length;d++){const h=r[d];h in o&&(s[h]=o[h])}return s},e.R=Qn,e.S=_l,e.T=Vv,e.U=uw,e.V=lw,e.W=G,e.X=j,e.Y=Tr,e.Z=Ds,e._=l,e.a=J,e.a$=ee,e.a0=function(o,r){var s,d,h,b,x;if(!o)return r??{};if(!r)return o;let A=Object.assign({},o);if(r.removeAll&&(A={removeAll:!0}),r.remove){const S=new Set(r.remove);A.add&&(A.add=A.add.filter((M=>!S.has(M.id)))),A.update&&(A.update=A.update.filter((M=>!S.has(M.id))));const D=new Set(((s=o.add)!==null&&s!==void 0?s:[]).map((M=>M.id)));r.remove=r.remove.filter((M=>!D.has(M)))}if(r.remove){const S=new Set(A.remove?A.remove.concat(r.remove):r.remove);A.remove=Array.from(S.values())}if(r.add){const S=A.add?A.add.concat(r.add):r.add,D=new Map(S.map((M=>[M.id,M])));A.add=Array.from(D.values())}if(r.update){const S=new Map((d=A.update)===null||d===void 0?void 0:d.map((D=>[D.id,D])));for(const D of r.update){const M=(h=S.get(D.id))!==null&&h!==void 0?h:{id:D.id};D.newGeometry&&(M.newGeometry=D.newGeometry),D.addOrUpdateProperties&&(M.addOrUpdateProperties=((b=M.addOrUpdateProperties)!==null&&b!==void 0?b:[]).concat(D.addOrUpdateProperties)),D.removeProperties&&(M.removeProperties=((x=M.removeProperties)!==null&&x!==void 0?x:[]).concat(D.removeProperties)),D.removeAllProperties&&(M.removeAllProperties=!0),S.set(D.id,M)}A.update=Array.from(S.values())}return A.remove&&A.add&&(A.remove=A.remove.filter((S=>A.add.findIndex((D=>D.id===S))===-1))),A},e.a1=Wf,e.a2=Lu,e.a3=25,e.a4=n0,e.a5=o=>{const r=window.document.createElement("video");return r.muted=!0,new Promise((s=>{r.onloadstart=()=>{s(r)};for(const d of o){const h=window.document.createElement("source");Ne(d)||(r.crossOrigin="Anonymous"),h.src=d,r.appendChild(h)}}))},e.a6=dt,e.a7=function(){return Sr++},e.a8=$,e.a9=gd,e.aA=function(o){let r=1/0,s=1/0,d=-1/0,h=-1/0;for(const b of o)r=Math.min(r,b.x),s=Math.min(s,b.y),d=Math.max(d,b.x),h=Math.max(h,b.y);return[r,s,d,h]},e.aB=en,e.aC=ge,e.aD=function(o,r,s,d,h=!1){if(!s[0]&&!s[1])return[0,0];const b=h?d==="map"?-o.bearingInRadians:0:d==="viewport"?o.bearingInRadians:0;if(b){const x=Math.sin(b),A=Math.cos(b);s=[s[0]*A-s[1]*x,s[0]*x+s[1]*A]}return[h?s[0]:ge(r,s[0],o.zoom),h?s[1]:ge(r,s[1],o.zoom)]},e.aF=Yv,e.aG=o0,e.aH=Wv,e.aI=a0,e.aJ=Li,e.aK=cy,e.aL=Ue,e.aM=Vr,e.aN=Jr,e.aO=Ur,e.aP=Oe,e.aQ=dw,e.aR=st,e.aS=gt,e.aT=function(o){var r=new he(3);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r},e.aU=function(o,r,s){return o[0]=r[0]-s[0],o[1]=r[1]-s[1],o[2]=r[2]-s[2],o},e.aV=function(o,r){var s=r[0],d=r[1],h=r[2],b=s*s+d*d+h*h;return b>0&&(b=1/Math.sqrt(b)),o[0]=r[0]*b,o[1]=r[1]*b,o[2]=r[2]*b,o},e.aW=nt,e.aX=function(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]},e.aY=function(o,r,s){return o[0]=r[0]*s[0],o[1]=r[1]*s[1],o[2]=r[2]*s[2],o[3]=r[3]*s[3],o},e.aZ=ze,e.a_=function(o,r,s){const d=r[0]*s[0]+r[1]*s[1]+r[2]*s[2];return d===0?null:(-(o[0]*s[0]+o[1]*s[1]+o[2]*s[2])-s[3])/d},e.aa=hu,e.ab=Cu,e.ac=mw,e.ad=function(o){const r={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((s,d,h,b)=>{const x=h||b;return r[d]=!x||x.toLowerCase(),""})),r["max-age"]){const s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r},e.ae=Ii,e.af=function(o){return Math.pow(2,o)},e.ag=Be,e.ah=er,e.ai=85.051129,e.aj=cw,e.ak=function(o){return Math.log(o)/Math.LN2},e.al=function(o){var r=o[0],s=o[1];return r*r+s*s},e.am=function(o){if(!o.length)return new Set;const r=Math.max(...o.map((S=>S.canonical.z)));let s=1/0,d=-1/0,h=1/0,b=-1/0;const x=[];for(const S of o){const{x:D,y:M,z:F}=S.canonical,Z=Math.pow(2,r-F),H=D*Z,Y=M*Z;x.push({id:S,x:H,y:Y}),H<s&&(s=H),H>d&&(d=H),Y<h&&(h=Y),Y>b&&(b=Y)}const A=new Set;for(const S of x)S.x!==s&&S.x!==d&&S.y!==h&&S.y!==b||A.add(S.id);return A},e.an=function(o,r){let s=0,d=0;if(o.kind==="constant")d=o.layoutSize;else if(o.kind!=="source"){const{interpolationType:h,minZoom:b,maxZoom:x}=o,A=h?er(qi.interpolationFactor(h,r,b,x),0,1):0;o.kind==="camera"?d=fs.number(o.minSize,o.maxSize,A):s=A}return{uSizeT:s,uSize:d}},e.ap=function(o,{uSize:r,uSizeT:s},{lowerSize:d,upperSize:h}){return o.kind==="source"?d/Ta:o.kind==="composite"?fs.number(d/Ta,h/Ta,s):r},e.aq=function(o,r){var s=r[0],d=r[1],h=r[2],b=r[3],x=r[4],A=r[5],S=r[6],D=r[7],M=r[8],F=r[9],Z=r[10],H=r[11],Y=r[12],ie=r[13],ae=r[14],ye=r[15],qe=s*A-d*x,Se=s*S-h*x,Me=s*D-b*x,We=d*S-h*A,ot=d*D-b*A,mt=h*D-b*S,Dt=M*ie-F*Y,Rt=M*ae-Z*Y,Pt=M*ye-H*Y,Zt=F*ae-Z*ie,Tt=F*ye-H*ie,Lt=Z*ye-H*ae,ct=qe*Lt-Se*Tt+Me*Zt+We*Pt-ot*Rt+mt*Dt;return ct?(o[0]=(A*Lt-S*Tt+D*Zt)*(ct=1/ct),o[1]=(h*Tt-d*Lt-b*Zt)*ct,o[2]=(ie*mt-ae*ot+ye*We)*ct,o[3]=(Z*ot-F*mt-H*We)*ct,o[4]=(S*Pt-x*Lt-D*Rt)*ct,o[5]=(s*Lt-h*Pt+b*Rt)*ct,o[6]=(ae*Me-Y*mt-ye*Se)*ct,o[7]=(M*mt-Z*Me+H*Se)*ct,o[8]=(x*Tt-A*Pt+D*Dt)*ct,o[9]=(d*Pt-s*Tt-b*Dt)*ct,o[10]=(Y*ot-ie*Me+ye*qe)*ct,o[11]=(F*Me-M*ot-H*qe)*ct,o[12]=(A*Rt-x*Zt-S*Dt)*ct,o[13]=(s*Zt-d*Rt+h*Dt)*ct,o[14]=(ie*Se-Y*We-ae*qe)*ct,o[15]=(M*We-F*Se+Z*qe)*ct,o):null},e.ar=tt,e.as=function(o){var r=o[0],s=o[1];return Math.sqrt(r*r+s*s)},e.at=function(o){return o[0]=0,o[1]=0,o},e.au=function(o,r,s){return o[0]=r[0]*s,o[1]=r[1]*s,o},e.av=Jv,e.aw=Le,e.ax=function(o,r,s,d){const h=r.y-o.y,b=r.x-o.x,x=d.y-s.y,A=d.x-s.x,S=x*b-A*h;if(S===0)return null;const D=(A*(o.y-s.y)-x*(o.x-s.x))/S;return new _(o.x+D*b,o.y+D*h)},e.ay=_w,e.az=l1,e.b=Qt,e.b$=class extends Yn{constructor(o,r){super(o,r),this.current=new Array}set(o){if(o!=this.current){this.current=o;const r=new Float32Array(o);this.gl.uniform1fv(this.location,r)}}},e.b0=function(o,r,s){return o[0]=r[0]*s,o[1]=r[1]*s,o[2]=r[2]*s,o[3]=r[3]*s,o},e.b1=function(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]+o[3]},e.b2=fw,e.b3=_d,e.b4=function(o,r,s,d,h){var b=1/Math.tan(r/2);if(o[0]=b/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=b,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,h!=null&&h!==1/0){var x=1/(d-h);o[10]=(h+d)*x,o[14]=2*h*d*x}else o[10]=-1,o[14]=-2*d;return o},e.b5=function(o){var r=new he(16);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r[8]=o[8],r[9]=o[9],r[10]=o[10],r[11]=o[11],r[12]=o[12],r[13]=o[13],r[14]=o[14],r[15]=o[15],r},e.b6=function(o,r,s){var d=Math.sin(s),h=Math.cos(s),b=r[0],x=r[1],A=r[2],S=r[3],D=r[4],M=r[5],F=r[6],Z=r[7];return r!==o&&(o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=b*h+D*d,o[1]=x*h+M*d,o[2]=A*h+F*d,o[3]=S*h+Z*d,o[4]=D*h-b*d,o[5]=M*h-x*d,o[6]=F*h-A*d,o[7]=Z*h-S*d,o},e.b7=function(o,r,s){var d=Math.sin(s),h=Math.cos(s),b=r[4],x=r[5],A=r[6],S=r[7],D=r[8],M=r[9],F=r[10],Z=r[11];return r!==o&&(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[4]=b*h+D*d,o[5]=x*h+M*d,o[6]=A*h+F*d,o[7]=S*h+Z*d,o[8]=D*h-b*d,o[9]=M*h-x*d,o[10]=F*h-A*d,o[11]=Z*h-S*d,o},e.b8=function(){const o=new Float32Array(16);return Be(o),o},e.b9=function(){const o=new Float64Array(16);return Be(o),o},e.bA=function(o,r){const s=Gt(o,360),d=Gt(r,360),h=d-s,b=d>s?h-360:h+360;return Math.abs(h)<Math.abs(b)?h:b},e.bB=function(o){return o[0]=0,o[1]=0,o[2]=0,o},e.bC=function(o,r,s,d){const h=Math.sqrt(o*o+r*r),b=Math.sqrt(s*s+d*d);o/=h,r/=h,s/=b,d/=b;const x=Math.acos(o*s+r*d);return-r*s+o*d>0?x:-x},e.bD=function(o,r){const s=Gt(o,2*Math.PI),d=Gt(r,2*Math.PI);return Math.min(Math.abs(s-d),Math.abs(s-d+2*Math.PI),Math.abs(s-d-2*Math.PI))},e.bE=function(){const o={},r=Ke.$version;for(const s in Ke.$root){const d=Ke.$root[s];if(d.required){let h=null;h=s==="version"?r:d.type==="array"?[]:{},h!=null&&(o[s]=h)}}return o},e.bF=cl,e.bG=je,e.bH=function o(r,s){if(Array.isArray(r)){if(!Array.isArray(s)||r.length!==s.length)return!1;for(let d=0;d<r.length;d++)if(!o(r[d],s[d]))return!1;return!0}if(typeof r=="object"&&r!==null&&s!==null){if(typeof s!="object"||Object.keys(r).length!==Object.keys(s).length)return!1;for(const d in r)if(!o(r[d],s[d]))return!1;return!0}return r===s},e.bI=function(o){o=o.slice();const r=Object.create(null);for(let s=0;s<o.length;s++)r[o[s].id]=o[s];for(let s=0;s<o.length;s++)"ref"in o[s]&&(o[s]=Cr(o[s],r[o[s].ref]));return o},e.bJ=function(o,r){if(o.type==="custom")return new HB(o,r);switch(o.type){case"background":return new ZB(o,r);case"circle":return new DI(o,r);case"color-relief":return new VI(o,r);case"fill":return new QI(o,r);case"fill-extrusion":return new cB(o,r);case"heatmap":return new BI(o,r);case"hillshade":return new zI(o,r);case"line":return new gB(o,r);case"raster":return new kv(o,r);case"symbol":return new my(o,r)}},e.bK=o=>o.type==="raster",e.bL=rr,e.bM=function(o,r){if(!o)return[{command:"setStyle",args:[r]}];let s=[];try{if(!Ot(o.version,r.version))return[{command:"setStyle",args:[r]}];Ot(o.center,r.center)||s.push({command:"setCenter",args:[r.center]}),Ot(o.state,r.state)||s.push({command:"setGlobalState",args:[r.state]}),Ot(o.centerAltitude,r.centerAltitude)||s.push({command:"setCenterAltitude",args:[r.centerAltitude]}),Ot(o.zoom,r.zoom)||s.push({command:"setZoom",args:[r.zoom]}),Ot(o.bearing,r.bearing)||s.push({command:"setBearing",args:[r.bearing]}),Ot(o.pitch,r.pitch)||s.push({command:"setPitch",args:[r.pitch]}),Ot(o.roll,r.roll)||s.push({command:"setRoll",args:[r.roll]}),Ot(o.sprite,r.sprite)||s.push({command:"setSprite",args:[r.sprite]}),Ot(o.glyphs,r.glyphs)||s.push({command:"setGlyphs",args:[r.glyphs]}),Ot(o.transition,r.transition)||s.push({command:"setTransition",args:[r.transition]}),Ot(o.light,r.light)||s.push({command:"setLight",args:[r.light]}),Ot(o.terrain,r.terrain)||s.push({command:"setTerrain",args:[r.terrain]}),Ot(o.sky,r.sky)||s.push({command:"setSky",args:[r.sky]}),Ot(o.projection,r.projection)||s.push({command:"setProjection",args:[r.projection]});const d={},h=[];(function(x,A,S,D){let M;for(M in A=A||{},x=x||{})Object.prototype.hasOwnProperty.call(x,M)&&(Object.prototype.hasOwnProperty.call(A,M)||li(M,S,D));for(M in A)Object.prototype.hasOwnProperty.call(A,M)&&(Object.prototype.hasOwnProperty.call(x,M)?Ot(x[M],A[M])||(x[M].type==="geojson"&&A[M].type==="geojson"&&fi(x,A,M)?mr(S,{command:"setGeoJSONSourceData",args:[M,A[M].data]}):Wr(M,A,S,D)):ai(M,A,S))})(o.sources,r.sources,h,d);const b=[];o.layers&&o.layers.forEach((x=>{"source"in x&&d[x.source]?s.push({command:"removeLayer",args:[x.id]}):b.push(x)})),s=s.concat(h),(function(x,A,S){A=A||[];const D=(x=x||[]).map(ei),M=A.map(ei),F=x.reduce(Lr,{}),Z=A.reduce(Lr,{}),H=D.slice(),Y=Object.create(null);let ie,ae,ye,qe,Se;for(let Me=0,We=0;Me<D.length;Me++)ie=D[Me],Object.prototype.hasOwnProperty.call(Z,ie)?We++:(mr(S,{command:"removeLayer",args:[ie]}),H.splice(H.indexOf(ie,We),1));for(let Me=0,We=0;Me<M.length;Me++)ie=M[M.length-1-Me],H[H.length-1-Me]!==ie&&(Object.prototype.hasOwnProperty.call(F,ie)?(mr(S,{command:"removeLayer",args:[ie]}),H.splice(H.lastIndexOf(ie,H.length-We),1)):We++,qe=H[H.length-Me],mr(S,{command:"addLayer",args:[Z[ie],qe]}),H.splice(H.length-Me,0,ie),Y[ie]=!0);for(let Me=0;Me<M.length;Me++)if(ie=M[Me],ae=F[ie],ye=Z[ie],!Y[ie]&&!Ot(ae,ye))if(Ot(ae.source,ye.source)&&Ot(ae["source-layer"],ye["source-layer"])&&Ot(ae.type,ye.type)){for(Se in jr(ae.layout,ye.layout,S,ie,null,"setLayoutProperty"),jr(ae.paint,ye.paint,S,ie,null,"setPaintProperty"),Ot(ae.filter,ye.filter)||mr(S,{command:"setFilter",args:[ie,ye.filter]}),Ot(ae.minzoom,ye.minzoom)&&Ot(ae.maxzoom,ye.maxzoom)||mr(S,{command:"setLayerZoomRange",args:[ie,ye.minzoom,ye.maxzoom]}),ae)Object.prototype.hasOwnProperty.call(ae,Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?jr(ae[Se],ye[Se],S,ie,Se.slice(6),"setPaintProperty"):Ot(ae[Se],ye[Se])||mr(S,{command:"setLayerProperty",args:[ie,Se,ye[Se]]}));for(Se in ye)Object.prototype.hasOwnProperty.call(ye,Se)&&!Object.prototype.hasOwnProperty.call(ae,Se)&&Se!=="layout"&&Se!=="paint"&&Se!=="filter"&&Se!=="metadata"&&Se!=="minzoom"&&Se!=="maxzoom"&&(Se.indexOf("paint.")===0?jr(ae[Se],ye[Se],S,ie,Se.slice(6),"setPaintProperty"):Ot(ae[Se],ye[Se])||mr(S,{command:"setLayerProperty",args:[ie,Se,ye[Se]]}))}else mr(S,{command:"removeLayer",args:[ie]}),qe=H[H.lastIndexOf(ie)+1],mr(S,{command:"addLayer",args:[ye,qe]})})(b,r.layers,s)}catch(d){console.warn("Unable to compute style diff:",d),s=[{command:"setStyle",args:[r]}]}return s},e.bN=function(o){const r=[],s=o.id;return s===void 0&&r.push({message:`layers.${s}: missing required property "id"`}),o.render===void 0&&r.push({message:`layers.${s}: missing required method "render"`}),o.renderingMode&&o.renderingMode!=="2d"&&o.renderingMode!=="3d"&&r.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),r},e.bO=Ar,e.bP=Nr,e.bQ=class extends Yn{constructor(o,r){super(o,r),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},e.bR=Jn,e.bS=class extends Yn{constructor(o,r){super(o,r),this.current=Qi}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let r=1;r<16;r++)if(o[r]!==this.current[r]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},e.bT=Ki,e.bU=class extends Yn{constructor(o,r){super(o,r),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},e.bV=class extends Yn{constructor(o,r){super(o,r),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},e.bW=Q,e.bX=function(o,r){var s=Math.sin(r),d=Math.cos(r);return o[0]=d,o[1]=s,o[2]=0,o[3]=-s,o[4]=d,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},e.bY=function(o,r,s){var d=r[0],h=r[1],b=r[2];return o[0]=d*s[0]+h*s[3]+b*s[6],o[1]=d*s[1]+h*s[4]+b*s[7],o[2]=d*s[2]+h*s[5]+b*s[8],o},e.bZ=function(o,r,s,d,h,b,x){var A=1/(r-s),S=1/(d-h),D=1/(b-x);return o[0]=-2*A,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*S,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*D,o[11]=0,o[12]=(r+s)*A,o[13]=(h+d)*S,o[14]=(x+b)*D,o[15]=1,o},e.b_=class extends Yn{constructor(o,r){super(o,r),this.current=new Array}set(o){if(o!=this.current){this.current=o;const r=new Float32Array(4*o.length);for(let s=0;s<o.length;s++)r[4*s]=o[s].r,r[4*s+1]=o[s].g,r[4*s+2]=o[s].b,r[4*s+3]=o[s].a;this.gl.uniform4fv(this.location,r)}}},e.ba=function(){return new Float64Array(16)},e.bb=function(o,r,s){const d=new Float64Array(4);return me(d,o,r-90,s),d},e.bc=function(o,r,s,d){var h,b,x,A,S,D=r[0],M=r[1],F=r[2],Z=r[3],H=s[0],Y=s[1],ie=s[2],ae=s[3];return(b=D*H+M*Y+F*ie+Z*ae)<0&&(b=-b,H=-H,Y=-Y,ie=-ie,ae=-ae),1-b>ne?(h=Math.acos(b),x=Math.sin(h),A=Math.sin((1-d)*h)/x,S=Math.sin(d*h)/x):(A=1-d,S=d),o[0]=A*D+S*H,o[1]=A*M+S*Y,o[2]=A*F+S*ie,o[3]=A*Z+S*ae,o},e.bd=function(o){const r=new Float64Array(9);var s,d,h,b,x,A,S,D,M,F,Z,H,Y,ie,ae,ye,qe,Se;F=(h=(d=o)[0])*(S=h+h),Z=(b=d[1])*S,Y=(x=d[2])*S,ie=x*(D=b+b),ye=(A=d[3])*S,qe=A*D,Se=A*(M=x+x),(s=r)[0]=1-(H=b*D)-(ae=x*M),s[3]=Z-Se,s[6]=Y+qe,s[1]=Z+Se,s[4]=1-F-ae,s[7]=ie-ye,s[2]=Y-qe,s[5]=ie+ye,s[8]=1-F-H;const Me=Oe(-Math.asin(er(r[2],-1,1)));let We,ot;return Math.hypot(r[5],r[8])<.001?(We=0,ot=-Oe(Math.atan2(r[3],r[4]))):(We=Oe(r[5]===0&&r[8]===0?0:Math.atan2(r[5],r[8])),ot=Oe(r[1]===0&&r[0]===0?0:Math.atan2(r[1],r[0]))),{roll:We,pitch:Me+90,bearing:ot}},e.be=function(o,r){return o.roll==r.roll&&o.pitch==r.pitch&&o.bearing==r.bearing},e.bf=Rr,e.bg=Di,e.bh=fd,e.bi=Kf,e.bj=pd,e.bk=Ut,e.bl=Ce,e.bm=Vn,e.bn=function(o,r,s,d,h){return Ut(d,h,er((o-r)/(s-r),0,1))},e.bo=Gt,e.bp=function(){return new Float64Array(3)},e.bq=function(o,r,s,d){return o[0]=r[0]+s[0]*d,o[1]=r[1]+s[1]*d,o[2]=r[2]+s[2]*d,o},e.br=me,e.bs=function(o,r,s){var d=s[0],h=s[1],b=s[2],x=s[3],A=r[0],S=r[1],D=r[2],M=h*D-b*S,F=b*A-d*D,Z=d*S-h*A;return o[0]=A+x*(M+=M)+h*(Z+=Z)-b*(F+=F),o[1]=S+x*F+b*M-d*Z,o[2]=D+x*Z+d*F-h*M,o},e.bt=function(o,r,s){const d=(h=[o[0],o[1],o[2],r[0],r[1],r[2],s[0],s[1],s[2]])[0]*((M=h[8])*(x=h[4])-(A=h[5])*(D=h[7]))+h[1]*(-M*(b=h[3])+A*(S=h[6]))+h[2]*(D*b-x*S);var h,b,x,A,S,D,M;if(d===0)return null;const F=nt([],[r[0],r[1],r[2]],[s[0],s[1],s[2]]),Z=nt([],[s[0],s[1],s[2]],[o[0],o[1],o[2]]),H=nt([],[o[0],o[1],o[2]],[r[0],r[1],r[2]]),Y=st([],F,-o[3]);return gt(Y,Y,st([],Z,-r[3])),gt(Y,Y,st([],H,-s[3])),st(Y,Y,1/d),Y},e.bu=r0,e.bv=function(){return new Float64Array(4)},e.bw=function(o,r,s,d){var h=[],b=[];return h[0]=r[0]-s[0],h[1]=r[1]-s[1],h[2]=r[2]-s[2],b[0]=h[0]*Math.cos(d)-h[1]*Math.sin(d),b[1]=h[0]*Math.sin(d)+h[1]*Math.cos(d),b[2]=h[2],o[0]=b[0]+s[0],o[1]=b[1]+s[1],o[2]=b[2]+s[2],o},e.bx=function(o,r,s,d){var h=[],b=[];return h[0]=r[0]-s[0],h[1]=r[1]-s[1],h[2]=r[2]-s[2],b[0]=h[0],b[1]=h[1]*Math.cos(d)-h[2]*Math.sin(d),b[2]=h[1]*Math.sin(d)+h[2]*Math.cos(d),o[0]=b[0]+s[0],o[1]=b[1]+s[1],o[2]=b[2]+s[2],o},e.by=function(o,r,s,d){var h=[],b=[];return h[0]=r[0]-s[0],h[1]=r[1]-s[1],h[2]=r[2]-s[2],b[0]=h[2]*Math.sin(d)+h[0]*Math.cos(d),b[1]=h[1],b[2]=h[2]*Math.cos(d)-h[0]*Math.sin(d),o[0]=b[0]+s[0],o[1]=b[1]+s[1],o[2]=b[2]+s[2],o},e.bz=function(o,r,s){var d=Math.sin(s),h=Math.cos(s),b=r[0],x=r[1],A=r[2],S=r[3],D=r[8],M=r[9],F=r[10],Z=r[11];return r!==o&&(o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=b*h-D*d,o[1]=x*h-M*d,o[2]=A*h-F*d,o[3]=S*h-Z*d,o[8]=b*d+D*h,o[9]=x*d+M*h,o[10]=A*d+F*h,o[11]=S*d+Z*h,o},e.c=W,e.c0=class extends If{},e.c1=xB,e.c2=class extends t{},e.c3=Ov,e.c4=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},e.c5=_1,e.c6=function(o,r,s){var d=r[0],h=r[1],b=r[2],x=s[3]*d+s[7]*h+s[11]*b+s[15];return o[0]=(s[0]*d+s[4]*h+s[8]*b+s[12])/(x=x||1),o[1]=(s[1]*d+s[5]*h+s[9]*b+s[13])/x,o[2]=(s[2]*d+s[6]*h+s[10]*b+s[14])/x,o},e.c7=class extends sd{},e.c8=class extends k{},e.c9=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]&&o[4]===r[4]&&o[5]===r[5]&&o[6]===r[6]&&o[7]===r[7]&&o[8]===r[8]&&o[9]===r[9]&&o[10]===r[10]&&o[11]===r[11]&&o[12]===r[12]&&o[13]===r[13]&&o[14]===r[14]&&o[15]===r[15]},e.cA=function(o,r){J.REGISTERED_PROTOCOLS[o]=r},e.cB=function(o){delete J.REGISTERED_PROTOCOLS[o]},e.cC=function(o,r){const s={};for(let h=0;h<o.length;h++){const b=r&&r[o[h].id]||Wc(o[h]);r&&(r[o[h].id]=b);let x=s[b];x||(x=s[b]=[]),x.push(o[h])}const d=[];for(const h in s)d.push(s[h]);return d},e.cD=It,e.cE=hw,e.cF=yw,e.cG=Z1,e.cH=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=lt/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const r=o.bucket.layers[0],s=r.layout,d=r._unevaluatedLayout._values,h={layoutIconSize:d["icon-size"].possiblyEvaluate(new ci(o.bucket.zoom+1),o.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new ci(o.bucket.zoom+1),o.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new ci(18))};if(o.bucket.textSizeData.kind==="composite"){const{minZoom:D,maxZoom:M}=o.bucket.textSizeData;h.compositeTextSizes=[d["text-size"].possiblyEvaluate(new ci(D),o.canonical),d["text-size"].possiblyEvaluate(new ci(M),o.canonical)]}if(o.bucket.iconSizeData.kind==="composite"){const{minZoom:D,maxZoom:M}=o.bucket.iconSizeData;h.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new ci(D),o.canonical),d["icon-size"].possiblyEvaluate(new ci(M),o.canonical)]}const b=s.get("text-line-height")*en,x=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",A=s.get("text-keep-upright"),S=s.get("text-size");for(const D of o.bucket.features){const M=s.get("text-font").evaluate(D,{},o.canonical).join(","),F=S.evaluate(D,{},o.canonical),Z=h.layoutTextSize.evaluate(D,{},o.canonical),H=h.layoutIconSize.evaluate(D,{},o.canonical),Y={horizontal:{},vertical:void 0},ie=D.text;let ae,ye=[0,0];if(ie){const Me=ie.toString(),We=s.get("text-letter-spacing").evaluate(D,{},o.canonical)*en,ot=$m(Me)?We:0,mt=s.get("text-anchor").evaluate(D,{},o.canonical),Dt=Tw(r,D,o.canonical);if(!Dt){const Tt=s.get("text-radial-offset").evaluate(D,{},o.canonical);ye=Tt?Sw(mt,[Tt*en,s0]):s.get("text-offset").evaluate(D,{},o.canonical).map((Lt=>Lt*en))}let Rt=x?"center":s.get("text-justify").evaluate(D,{},o.canonical);const Pt=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(D,{},o.canonical)*en:1/0,Zt=()=>{o.bucket.allowVerticalPlacement&&Qc(Me)&&(Y.vertical=py(ie,o.glyphMap,o.glyphPositions,o.imagePositions,M,Pt,b,mt,"left",ot,ye,e.ao.vertical,!0,Z,F))};if(!x&&Dt){const Tt=new Set;if(Rt==="auto")for(let ct=0;ct<Dt.values.length;ct+=2)Tt.add(o0(Dt.values[ct]));else Tt.add(Rt);let Lt=!1;for(const ct of Tt)if(!Y.horizontal[ct])if(Lt)Y.horizontal[ct]=Y.horizontal[0];else{const sr=py(ie,o.glyphMap,o.glyphPositions,o.imagePositions,M,Pt,b,"center",ct,ot,ye,e.ao.horizontal,!1,Z,F);sr&&(Y.horizontal[ct]=sr,Lt=sr.positionedLines.length===1)}Zt()}else{Rt==="auto"&&(Rt=o0(mt));const Tt=py(ie,o.glyphMap,o.glyphPositions,o.imagePositions,M,Pt,b,mt,Rt,ot,ye,e.ao.horizontal,!1,Z,F);Tt&&(Y.horizontal[Rt]=Tt),Zt(),Qc(Me)&&x&&A&&(Y.vertical=py(ie,o.glyphMap,o.glyphPositions,o.imagePositions,M,Pt,b,mt,Rt,ot,ye,e.ao.vertical,!1,Z,F))}}let qe=!1;if(D.icon&&D.icon.name){const Me=o.imageMap[D.icon.name];Me&&(ae=qB(o.imagePositions[D.icon.name],s.get("icon-offset").evaluate(D,{},o.canonical),s.get("icon-anchor").evaluate(D,{},o.canonical)),qe=!!Me.sdf,o.bucket.sdfIcons===void 0?o.bucket.sdfIcons=qe:o.bucket.sdfIcons!==qe&&ir("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Me.pixelRatio!==o.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(o.bucket.iconsNeedLinear=!0))}const Se=kw(Y.horizontal)||Y.vertical;o.bucket.iconsInText=!!Se&&Se.iconsInText,(Se||ae)&&iM(o.bucket,D,Y,ae,o.imageMap,h,Z,H,ye,qe,o.canonical,o.subdivisionGranularity)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},e.cI=Fv,e.cJ=Kv,e.cK=Gv,e.cL=I1,e.cM=Zv,e.cN=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return o.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},e.cO=function(o,r,s,d,h){return l(this,void 0,void 0,(function*(){if(j())try{return yield Tr(o,r,s,d,h)}catch{}return(function(b,x,A,S,D){const M=b.width,F=b.height;$r&&bt||($r=new OffscreenCanvas(M,F),bt=$r.getContext("2d",{willReadFrequently:!0})),$r.width=M,$r.height=F,bt.drawImage(b,0,0,M,F);const Z=bt.getImageData(x,A,S,D);return bt.clearRect(0,0,M,F),Z.data})(o,r,s,d,h)}))},e.cP=x1,e.cQ=w,e.cR=D1,e.cS=hd,e.cT=Nc,e.cU=function(o,r){const s=new Map;if(o!=null)if(o.type==="Feature")s.set(Yf(o,r),o);else for(const d of o.features)s.set(Yf(d,r),d);return s},e.cV=function(o,r){if(o==null)return!0;if(o.type==="Feature")return Yf(o,r)!=null;if(o.type==="FeatureCollection"){const s=new Set;for(const d of o.features){const h=Yf(d,r);if(h==null||s.has(h))return!1;s.add(h)}return!0}return!1},e.cW=function(o,r,s){var d,h,b,x;if(r.removeAll&&o.clear(),r.remove)for(const A of r.remove)o.delete(A);if(r.add)for(const A of r.add){const S=Yf(A,s);S!=null&&o.set(S,A)}if(r.update)for(const A of r.update){let S=o.get(A.id);if(S==null)continue;const D=!A.removeAllProperties&&(((d=A.removeProperties)===null||d===void 0?void 0:d.length)>0||((h=A.addOrUpdateProperties)===null||h===void 0?void 0:h.length)>0);if((A.newGeometry||A.removeAllProperties||D)&&(S=Object.assign({},S),o.set(A.id,S),D&&(S.properties=Object.assign({},S.properties))),A.newGeometry&&(S.geometry=A.newGeometry),A.removeAllProperties)S.properties={};else if(((b=A.removeProperties)===null||b===void 0?void 0:b.length)>0)for(const M of A.removeProperties)Object.prototype.hasOwnProperty.call(S.properties,M)&&delete S.properties[M];if(((x=A.addOrUpdateProperties)===null||x===void 0?void 0:x.length)>0)for(const{key:M,value:F}of A.addOrUpdateProperties)S.properties[M]=F}},e.cX=Oo,e.ca=function(o,r){var s=o[0],d=o[1],h=o[2],b=o[3],x=o[4],A=o[5],S=o[6],D=o[7],M=o[8],F=o[9],Z=o[10],H=o[11],Y=o[12],ie=o[13],ae=o[14],ye=o[15],qe=r[0],Se=r[1],Me=r[2],We=r[3],ot=r[4],mt=r[5],Dt=r[6],Rt=r[7],Pt=r[8],Zt=r[9],Tt=r[10],Lt=r[11],ct=r[12],sr=r[13],cr=r[14],Yt=r[15];return Math.abs(s-qe)<=ne*Math.max(1,Math.abs(s),Math.abs(qe))&&Math.abs(d-Se)<=ne*Math.max(1,Math.abs(d),Math.abs(Se))&&Math.abs(h-Me)<=ne*Math.max(1,Math.abs(h),Math.abs(Me))&&Math.abs(b-We)<=ne*Math.max(1,Math.abs(b),Math.abs(We))&&Math.abs(x-ot)<=ne*Math.max(1,Math.abs(x),Math.abs(ot))&&Math.abs(A-mt)<=ne*Math.max(1,Math.abs(A),Math.abs(mt))&&Math.abs(S-Dt)<=ne*Math.max(1,Math.abs(S),Math.abs(Dt))&&Math.abs(D-Rt)<=ne*Math.max(1,Math.abs(D),Math.abs(Rt))&&Math.abs(M-Pt)<=ne*Math.max(1,Math.abs(M),Math.abs(Pt))&&Math.abs(F-Zt)<=ne*Math.max(1,Math.abs(F),Math.abs(Zt))&&Math.abs(Z-Tt)<=ne*Math.max(1,Math.abs(Z),Math.abs(Tt))&&Math.abs(H-Lt)<=ne*Math.max(1,Math.abs(H),Math.abs(Lt))&&Math.abs(Y-ct)<=ne*Math.max(1,Math.abs(Y),Math.abs(ct))&&Math.abs(ie-sr)<=ne*Math.max(1,Math.abs(ie),Math.abs(sr))&&Math.abs(ae-cr)<=ne*Math.max(1,Math.abs(ae),Math.abs(cr))&&Math.abs(ye-Yt)<=ne*Math.max(1,Math.abs(ye),Math.abs(Yt))},e.cb=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o},e.cc=o=>o.type==="symbol",e.cd=o=>o.type==="circle",e.ce=o=>o.type==="heatmap",e.cf=o=>o.type==="line",e.cg=o=>o.type==="fill",e.ch=o=>o.type==="fill-extrusion",e.ci=o=>o.type==="hillshade",e.cj=o=>o.type==="color-relief",e.ck=o=>o.type==="background",e.cl=o=>o.type==="custom",e.cm=ar,e.cn=function(o,r,s){const d=yt(r.x-s.x,r.y-s.y),h=yt(o.x-s.x,o.y-s.y);var b,x;return Oe(Math.atan2(d[0]*h[1]-d[1]*h[0],(b=d)[0]*(x=h)[0]+b[1]*x[1]))},e.co=kt,e.cp=function(o,r){return Nt[r]&&(o instanceof MouseEvent||o instanceof WheelEvent)},e.cq=function(o,r){return vt[r]&&"touches"in o},e.cr=function(o){return vt[o]||Nt[o]},e.cs=function(o,r,s){var d=r[0],h=r[1];return o[0]=s[0]*d+s[4]*h+s[12],o[1]=s[1]*d+s[5]*h+s[13],o},e.ct=function(o,r){const{x:s,y:d}=Wf.fromLngLat(r);return!(o<0||o>25||d<0||d>=1||s<0||s>=1)},e.cu=function(o,r){return o[0]=r[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=r[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=r[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},e.cv=class extends hl{},e.cw=sM,e.cy=function(o){return o.message===ve},e.cz=Re,e.d=Ne,e.e=or,e.f=o=>l(void 0,void 0,void 0,(function*(){if(o.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(o)],{type:"image/png"});try{return createImageBitmap(r)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),e.g=se,e.h=o=>new Promise(((r,s)=>{const d=new Image;d.onload=()=>{r(d),URL.revokeObjectURL(d.src),d.onload=null,window.requestAnimationFrame((()=>{d.src=nr}))},d.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(o)],{type:"image/png"});d.src=o.byteLength?URL.createObjectURL(h):nr})),e.i=Vt,e.j=(o,r)=>Ge(or(o,{type:"json"}),r),e.k=Mt,e.l=Ze,e.m=Ge,e.n=(o,r)=>Ge(or(o,{type:"arrayBuffer"}),r),e.o=function(o){return new Zv(o).readFields(DB,[])},e.p=$1,e.q=Uf,e.r=Tn,e.s=pi,e.t=Tf,e.u=Ir,e.v=Ke,e.w=ir,e.x=Sv,e.y=Km,e.z=zo})),f("worker",["./shared"],(function(e){class l{constructor(W,J){this.keyCache={},W&&this.replace(W,J)}replace(W,J){this._layerConfigs={},this._layers={},this.update(W,[],J)}update(W,J,se){for(const Re of W){this._layerConfigs[Re.id]=Re;const je=this._layers[Re.id]=e.bJ(Re,se);je._featureFilter=e.aa(je.filter,se),this.keyCache[Re.id]&&delete this.keyCache[Re.id]}for(const Re of J)delete this.keyCache[Re],delete this._layerConfigs[Re],delete this._layers[Re];this.familiesBySource={};const _e=e.cC(Object.values(this._layerConfigs),this.keyCache);for(const Re of _e){const je=Re.map((Mt=>this._layers[Mt.id])),Ge=je[0];if(Ge.visibility==="none")continue;const Ne=Ge.source||"";let Ye=this.familiesBySource[Ne];Ye||(Ye=this.familiesBySource[Ne]={});const ht=Ge.sourceLayer||"_geojsonTileLayer";let Ze=Ye[ht];Ze||(Ze=Ye[ht]=[]),Ze.push(je)}}}class _{constructor(W){const J={},se=[];for(const Ge in W){const Ne=W[Ge],Ye=J[Ge]={};for(const ht in Ne){const Ze=Ne[+ht];if(!Ze||Ze.bitmap.width===0||Ze.bitmap.height===0)continue;const Mt={x:0,y:0,w:Ze.bitmap.width+2,h:Ze.bitmap.height+2};se.push(Mt),Ye[ht]={rect:Mt,metrics:Ze.metrics}}}const{w:_e,h:Re}=e.p(se),je=new e.q({width:_e||1,height:Re||1});for(const Ge in W){const Ne=W[Ge];for(const Ye in Ne){const ht=Ne[+Ye];if(!ht||ht.bitmap.width===0||ht.bitmap.height===0)continue;const Ze=J[Ge][Ye].rect;e.q.copy(ht.bitmap,je,{x:0,y:0},{x:Ze.x+1,y:Ze.y+1},ht.bitmap)}}this.image=je,this.positions=J}}e.cD("GlyphAtlas",_);class w{constructor(W){this.tileID=new e.Z(W.tileID.overscaledZ,W.tileID.wrap,W.tileID.canonical.z,W.tileID.canonical.x,W.tileID.canonical.y),this.uid=W.uid,this.zoom=W.zoom,this.pixelRatio=W.pixelRatio,this.tileSize=W.tileSize,this.source=W.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=W.showCollisionBoxes,this.collectResourceTiming=!!W.collectResourceTiming,this.returnDependencies=!!W.returnDependencies,this.promoteId=W.promoteId,this.inFlightDependencies=[]}parse(W,J,se,_e,Re){return e._(this,void 0,void 0,(function*(){this.status="parsing",this.data=W,this.collisionBoxArray=new e.a8;const je=new e.cE(Object.keys(W.layers).sort()),Ge=new e.cF(this.tileID,this.promoteId);Ge.bucketLayerIDs=[];const Ne={},Ye={featureIndex:Ge,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:se,subdivisionGranularity:Re},ht=J.familiesBySource[this.source];for(const Lr in ht){const dt=W.layers[Lr];if(!dt)continue;dt.version===1&&e.w(`Vector tile source "${this.source}" layer "${Lr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Bi=je.encode(Lr),Ci=[];for(let ki=0;ki<dt.length;ki++){const at=dt.feature(ki),At=Ge.getId(at,Lr);Ci.push({feature:at,id:At,index:ki,sourceLayerIndex:Bi})}for(const ki of ht[Lr]){const at=ki[0];at.source!==this.source&&e.w(`layer.source = ${at.source} does not equal this.source = ${this.source}`),at.minzoom&&this.zoom<Math.floor(at.minzoom)||at.maxzoom&&this.zoom>=at.maxzoom||at.visibility!=="none"&&(R(ki,this.zoom,se),(Ne[at.id]=at.createBucket({index:Ge.bucketLayerIDs.length,layers:ki,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Bi,sourceID:this.source})).populate(Ci,Ye,this.tileID.canonical),Ge.bucketLayerIDs.push(ki.map((At=>At.id))))}}const Ze=e.bO(Ye.glyphDependencies,(Lr=>Object.keys(Lr).map(Number)));this.inFlightDependencies.forEach((Lr=>Lr?.abort())),this.inFlightDependencies=[];let Mt=Promise.resolve({});if(Object.keys(Ze).length){const Lr=new AbortController;this.inFlightDependencies.push(Lr),Mt=_e.sendAsync({type:"GG",data:{stacks:Ze,source:this.source,tileID:this.tileID,type:"glyphs"}},Lr)}const Ft=Object.keys(Ye.iconDependencies);let Ke=Promise.resolve({});if(Ft.length){const Lr=new AbortController;this.inFlightDependencies.push(Lr),Ke=_e.sendAsync({type:"GI",data:{icons:Ft,source:this.source,tileID:this.tileID,type:"icons"}},Lr)}const hr=Object.keys(Ye.patternDependencies);let Cr=Promise.resolve({});if(hr.length){const Lr=new AbortController;this.inFlightDependencies.push(Lr),Cr=_e.sendAsync({type:"GI",data:{icons:hr,source:this.source,tileID:this.tileID,type:"patterns"}},Lr)}const Ot=Ye.dashDependencies;let mr=Promise.resolve({});if(Object.keys(Ot).length){const Lr=new AbortController;this.inFlightDependencies.push(Lr),mr=_e.sendAsync({type:"GDA",data:{dashes:Ot}},Lr)}const[ai,li,Wr,fi]=yield Promise.all([Mt,Ke,Cr,mr]),jr=new _(ai),ei=new e.cG(li,Wr);for(const Lr in Ne){const dt=Ne[Lr];dt instanceof e.a9?(R(dt.layers,this.zoom,se),e.cH({bucket:dt,glyphMap:ai,glyphPositions:jr.positions,imageMap:li,imagePositions:ei.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ye.subdivisionGranularity})):dt.hasDependencies&&(dt instanceof e.cI||dt instanceof e.cJ||dt instanceof e.cK)&&(R(dt.layers,this.zoom,se),dt.addFeatures(Ye,this.tileID.canonical,ei.patternPositions,fi))}return this.status="done",{buckets:Object.values(Ne).filter((Lr=>!Lr.isEmpty())),featureIndex:Ge,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:jr.image,imageAtlas:ei,dashPositions:fi,glyphMap:this.returnDependencies?ai:null,iconMap:this.returnDependencies?li:null,glyphPositions:this.returnDependencies?jr.positions:null}}))}}function R(ve,W,J){const se=new e.F(W);for(const _e of ve)_e.recalculate(se,J)}class C{constructor(W,J,se){this.actor=W,this.layerIndex=J,this.availableImages=se,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(W,J){return e._(this,void 0,void 0,(function*(){const se=yield e.n(W.request,J);try{return{vectorTile:new e.cL(new e.cM(se.data)),rawData:se.data,cacheControl:se.cacheControl,expires:se.expires}}catch(_e){const Re=new Uint8Array(se.data);let je=`Unable to parse the tile at ${W.request.url}, `;throw je+=Re[0]===31&&Re[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${_e.message}`,new Error(je)}}))}loadTile(W){return e._(this,void 0,void 0,(function*(){const J=W.uid,se=!!(W&&W.request&&W.request.collectResourceTiming)&&new e.cN(W.request),_e=new w(W);this.loading[J]=_e;const Re=new AbortController;_e.abort=Re;try{const je=yield this.loadVectorTile(W,Re);if(delete this.loading[J],!je)return null;const Ge=je.rawData,Ne={};je.expires&&(Ne.expires=je.expires),je.cacheControl&&(Ne.cacheControl=je.cacheControl);const Ye={};if(se){const Ze=se.finish();Ze&&(Ye.resourceTiming=JSON.parse(JSON.stringify(Ze)))}_e.vectorTile=je.vectorTile;const ht=_e.parse(je.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity);this.loaded[J]=_e,this.fetching[J]={rawTileData:Ge,cacheControl:Ne,resourceTiming:Ye};try{const Ze=yield ht;return e.e({rawTileData:Ge.slice(0)},Ze,Ne,Ye)}finally{delete this.fetching[J]}}catch(je){throw delete this.loading[J],_e.status="done",this.loaded[J]=_e,je}}))}reloadTile(W){return e._(this,void 0,void 0,(function*(){const J=W.uid;if(!this.loaded||!this.loaded[J])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const se=this.loaded[J];if(se.showCollisionBoxes=W.showCollisionBoxes,se.status==="parsing"){const _e=yield se.parse(se.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity);let Re;if(this.fetching[J]){const{rawTileData:je,cacheControl:Ge,resourceTiming:Ne}=this.fetching[J];delete this.fetching[J],Re=e.e({rawTileData:je.slice(0)},_e,Ge,Ne)}else Re=_e;return Re}if(se.status==="done"&&se.vectorTile)return se.parse(se.vectorTile,this.layerIndex,this.availableImages,this.actor,W.subdivisionGranularity)}))}abortTile(W){return e._(this,void 0,void 0,(function*(){const J=this.loading,se=W.uid;J&&J[se]&&J[se].abort&&(J[se].abort.abort(),delete J[se])}))}removeTile(W){return e._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[W.uid]&&delete this.loaded[W.uid]}))}}class I{constructor(){this.loaded={}}loadTile(W){return e._(this,void 0,void 0,(function*(){const{uid:J,encoding:se,rawImageData:_e,redFactor:Re,greenFactor:je,blueFactor:Ge,baseShift:Ne}=W,Ye=_e.width+2,ht=_e.height+2,Ze=e.b(_e)?new e.R({width:Ye,height:ht},yield e.cO(_e,-1,-1,Ye,ht)):_e,Mt=new e.cP(J,Ze,se,Re,je,Ge,Ne);return this.loaded=this.loaded||{},this.loaded[J]=Mt,Mt}))}removeTile(W){const J=this.loaded,se=W.uid;J&&J[se]&&delete J[se]}}var L,O,q=(function(){if(O)return L;function ve(J,se){if(J.length!==0){W(J[0],se);for(var _e=1;_e<J.length;_e++)W(J[_e],!se)}}function W(J,se){for(var _e=0,Re=0,je=0,Ge=J.length,Ne=Ge-1;je<Ge;Ne=je++){var Ye=(J[je][0]-J[Ne][0])*(J[Ne][1]+J[je][1]),ht=_e+Ye;Re+=Math.abs(_e)>=Math.abs(Ye)?_e-ht+Ye:Ye-ht+_e,_e=ht}_e+Re>=0!=!!se&&J.reverse()}return O=1,L=function J(se,_e){var Re,je=se&&se.type;if(je==="FeatureCollection")for(Re=0;Re<se.features.length;Re++)J(se.features[Re],_e);else if(je==="GeometryCollection")for(Re=0;Re<se.geometries.length;Re++)J(se.geometries[Re],_e);else if(je==="Feature")J(se.geometry,_e);else if(je==="Polygon")ve(se.coordinates,_e);else if(je==="MultiPolygon")for(Re=0;Re<se.coordinates.length;Re++)ve(se.coordinates[Re],_e);return se}})(),G=e.cQ(q);class j extends e.cS{constructor(W,J){super(new e.cM,0,J,[],[]),this.feature=W,this.type=W.type,this.properties=W.tags?W.tags:{},"id"in W&&(typeof W.id=="string"?this.id=parseInt(W.id,10):typeof W.id!="number"||isNaN(W.id)||(this.id=W.id))}loadGeometry(){const W=[],J=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const se of J){const _e=[];for(const Re of se)_e.push(new e.P(Re[0],Re[1]));W.push(_e)}return W}}class ne extends e.cR{constructor(W,J){super(new e.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=J?J.version:1,this.extent=J?J.extent:4096,this.length=W.length,this.features=W}feature(W){return new j(this.features[W],this.extent)}}function he(ve,W){W.writeVarintField(15,ve.version||1),W.writeStringField(1,ve.name||""),W.writeVarintField(5,ve.extent||4096);const J={keys:[],values:[],keycache:{},valuecache:{}};for(let Re=0;Re<ve.length;Re++)J.feature=ve.feature(Re),W.writeMessage(2,Q,J);const se=J.keys;for(const Re of se)W.writeStringField(3,Re);const _e=J.values;for(const Re of _e)W.writeMessage(4,gt,Re)}function Q(ve,W){if(!ve.feature)return;const J=ve.feature;J.id!==void 0&&W.writeVarintField(1,J.id),W.writeMessage(2,Be,ve),W.writeVarintField(3,J.type),W.writeMessage(4,et,J)}function Be(ve,W){for(const J in ve.feature?.properties){let se=ve.feature.properties[J],_e=ve.keycache[J];if(se===null)continue;_e===void 0&&(ve.keys.push(J),_e=ve.keys.length-1,ve.keycache[J]=_e),W.writeVarint(_e),typeof se!="string"&&typeof se!="boolean"&&typeof se!="number"&&(se=JSON.stringify(se));const Re=typeof se+":"+se;let je=ve.valuecache[Re];je===void 0&&(ve.values.push(se),je=ve.values.length-1,ve.valuecache[Re]=je),W.writeVarint(je)}}function we(ve,W){return(W<<3)+(7&ve)}function ze(ve){return ve<<1^ve>>31}function et(ve,W){const J=ve.loadGeometry(),se=ve.type;let _e=0,Re=0;for(const je of J){let Ge=1;se===1&&(Ge=je.length),W.writeVarint(we(1,Ge));const Ne=se===3?je.length-1:je.length;for(let Ye=0;Ye<Ne;Ye++){Ye===1&&se!==1&&W.writeVarint(we(2,Ne-1));const ht=je[Ye].x-_e,Ze=je[Ye].y-Re;W.writeVarint(ze(ht)),W.writeVarint(ze(Ze)),_e+=ht,Re+=Ze}ve.type===3&&W.writeVarint(we(7,1))}}function gt(ve,W){const J=typeof ve;J==="string"?W.writeStringField(1,ve):J==="boolean"?W.writeBooleanField(7,ve):J==="number"&&(ve%1!=0?W.writeDoubleField(3,ve):ve<0?W.writeSVarintField(6,ve):W.writeVarintField(5,ve))}const st={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ve=>ve},nt=Math.fround||(rt=new Float32Array(1),ve=>(rt[0]=+ve,rt[0]));var rt;class ee{constructor(W){this.options=Object.assign(Object.create(st),W),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(W){const{log:J,minZoom:se,maxZoom:_e}=this.options;J&&console.time("total time");const Re=`prepare ${W.length} points`;J&&console.time(Re),this.points=W;const je=[];for(let Ne=0;Ne<W.length;Ne++){const Ye=W[Ne];if(!Ye.geometry)continue;const[ht,Ze]=Ye.geometry.coordinates,Mt=nt(me(ht)),Ft=nt(tt(Ze));je.push(Mt,Ft,1/0,Ne,-1,1),this.options.reduce&&je.push(0)}let Ge=this.trees[_e+1]=this._createTree(je);J&&console.timeEnd(Re);for(let Ne=_e;Ne>=se;Ne--){const Ye=+Date.now();Ge=this.trees[Ne]=this._createTree(this._cluster(Ge,Ne)),J&&console.log("z%d: %d clusters in %dms",Ne,Ge.numItems,+Date.now()-Ye)}return J&&console.timeEnd("total time"),this}getClusters(W,J){let se=((W[0]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,W[1]));let Re=W[2]===180?180:((W[2]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,W[3]));if(W[2]-W[0]>=360)se=-180,Re=180;else if(se>Re){const Ze=this.getClusters([se,_e,180,je],J),Mt=this.getClusters([-180,_e,Re,je],J);return Ze.concat(Mt)}const Ge=this.trees[this._limitZoom(J)],Ne=Ge.range(me(se),tt(je),me(Re),tt(_e)),Ye=Ge.data,ht=[];for(const Ze of Ne){const Mt=this.stride*Ze;ht.push(Ye[Mt+5]>1?Le(Ye,Mt,this.clusterProps):this.points[Ye[Mt+3]])}return ht}getChildren(W){const J=this._getOriginId(W),se=this._getOriginZoom(W),_e="No cluster with the specified id.",Re=this.trees[se];if(!Re)throw new Error(_e);const je=Re.data;if(J*this.stride>=je.length)throw new Error(_e);const Ge=this.options.radius/(this.options.extent*Math.pow(2,se-1)),Ne=Re.within(je[J*this.stride],je[J*this.stride+1],Ge),Ye=[];for(const ht of Ne){const Ze=ht*this.stride;je[Ze+4]===W&&Ye.push(je[Ze+5]>1?Le(je,Ze,this.clusterProps):this.points[je[Ze+3]])}if(Ye.length===0)throw new Error(_e);return Ye}getLeaves(W,J,se){const _e=[];return this._appendLeaves(_e,W,J=J||10,se=se||0,0),_e}getTile(W,J,se){const _e=this.trees[this._limitZoom(W)],Re=Math.pow(2,W),{extent:je,radius:Ge}=this.options,Ne=Ge/je,Ye=(se-Ne)/Re,ht=(se+1+Ne)/Re,Ze={features:[]};return this._addTileFeatures(_e.range((J-Ne)/Re,Ye,(J+1+Ne)/Re,ht),_e.data,J,se,Re,Ze),J===0&&this._addTileFeatures(_e.range(1-Ne/Re,Ye,1,ht),_e.data,Re,se,Re,Ze),J===Re-1&&this._addTileFeatures(_e.range(0,Ye,Ne/Re,ht),_e.data,-1,se,Re,Ze),Ze.features.length?Ze:null}getClusterExpansionZoom(W){let J=this._getOriginZoom(W)-1;for(;J<=this.options.maxZoom;){const se=this.getChildren(W);if(J++,se.length!==1)break;W=se[0].properties.cluster_id}return J}_appendLeaves(W,J,se,_e,Re){const je=this.getChildren(J);for(const Ge of je){const Ne=Ge.properties;if(Ne&&Ne.cluster?Re+Ne.point_count<=_e?Re+=Ne.point_count:Re=this._appendLeaves(W,Ne.cluster_id,se,_e,Re):Re<_e?Re++:W.push(Ge),W.length===se)break}return Re}_createTree(W){const J=new e.aI(W.length/this.stride|0,this.options.nodeSize,Float32Array);for(let se=0;se<W.length;se+=this.stride)J.add(W[se],W[se+1]);return J.finish(),J.data=W,J}_addTileFeatures(W,J,se,_e,Re,je){for(const Ge of W){const Ne=Ge*this.stride,Ye=J[Ne+5]>1;let ht,Ze,Mt;if(Ye)ht=de(J,Ne,this.clusterProps),Ze=J[Ne],Mt=J[Ne+1];else{const hr=this.points[J[Ne+3]];ht=hr.properties;const[Cr,Ot]=hr.geometry.coordinates;Ze=me(Cr),Mt=tt(Ot)}const Ft={type:1,geometry:[[Math.round(this.options.extent*(Ze*Re-se)),Math.round(this.options.extent*(Mt*Re-_e))]],tags:ht};let Ke;Ke=Ye||this.options.generateId?J[Ne+3]:this.points[J[Ne+3]].id,Ke!==void 0&&(Ft.id=Ke),je.features.push(Ft)}}_limitZoom(W){return Math.max(this.options.minZoom,Math.min(Math.floor(+W),this.options.maxZoom+1))}_cluster(W,J){const{radius:se,extent:_e,reduce:Re,minPoints:je}=this.options,Ge=se/(_e*Math.pow(2,J)),Ne=W.data,Ye=[],ht=this.stride;for(let Ze=0;Ze<Ne.length;Ze+=ht){if(Ne[Ze+2]<=J)continue;Ne[Ze+2]=J;const Mt=Ne[Ze],Ft=Ne[Ze+1],Ke=W.within(Ne[Ze],Ne[Ze+1],Ge),hr=Ne[Ze+5];let Cr=hr;for(const Ot of Ke){const mr=Ot*ht;Ne[mr+2]>J&&(Cr+=Ne[mr+5])}if(Cr>hr&&Cr>=je){let Ot,mr=Mt*hr,ai=Ft*hr,li=-1;const Wr=(Ze/ht<<5)+(J+1)+this.points.length;for(const fi of Ke){const jr=fi*ht;if(Ne[jr+2]<=J)continue;Ne[jr+2]=J;const ei=Ne[jr+5];mr+=Ne[jr]*ei,ai+=Ne[jr+1]*ei,Ne[jr+4]=Wr,Re&&(Ot||(Ot=this._map(Ne,Ze,!0),li=this.clusterProps.length,this.clusterProps.push(Ot)),Re(Ot,this._map(Ne,jr)))}Ne[Ze+4]=Wr,Ye.push(mr/Cr,ai/Cr,1/0,Wr,-1,Cr),Re&&Ye.push(li)}else{for(let Ot=0;Ot<ht;Ot++)Ye.push(Ne[Ze+Ot]);if(Cr>1)for(const Ot of Ke){const mr=Ot*ht;if(!(Ne[mr+2]<=J)){Ne[mr+2]=J;for(let ai=0;ai<ht;ai++)Ye.push(Ne[mr+ai])}}}}return Ye}_getOriginId(W){return W-this.points.length>>5}_getOriginZoom(W){return(W-this.points.length)%32}_map(W,J,se){if(W[J+5]>1){const je=this.clusterProps[W[J+6]];return se?Object.assign({},je):je}const _e=this.points[W[J+3]].properties,Re=this.options.map(_e);return se&&Re===_e?Object.assign({},Re):Re}}function Le(ve,W,J){return{type:"Feature",id:ve[W+3],properties:de(ve,W,J),geometry:{type:"Point",coordinates:[(se=ve[W],360*(se-.5)),yt(ve[W+1])]}};var se}function de(ve,W,J){const se=ve[W+5],_e=se>=1e4?`${Math.round(se/1e3)}k`:se>=1e3?Math.round(se/100)/10+"k":se,Re=ve[W+6],je=Re===-1?{}:Object.assign({},J[Re]);return Object.assign(je,{cluster:!0,cluster_id:ve[W+3],point_count:se,point_count_abbreviated:_e})}function me(ve){return ve/360+.5}function tt(ve){const W=Math.sin(ve*Math.PI/180),J=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return J<0?0:J>1?1:J}function yt(ve){const W=(180-360*ve)*Math.PI/180;return 360*Math.atan(Math.exp(W))/Math.PI-90}function lt(ve,W,J,se){let _e=se;const Re=W+(J-W>>1);let je,Ge=J-W;const Ne=ve[W],Ye=ve[W+1],ht=ve[J],Ze=ve[J+1];for(let Mt=W+3;Mt<J;Mt+=3){const Ft=ge(ve[Mt],ve[Mt+1],Ne,Ye,ht,Ze);if(Ft>_e)je=Mt,_e=Ft;else if(Ft===_e){const Ke=Math.abs(Mt-Re);Ke<Ge&&(je=Mt,Ge=Ke)}}_e>se&&(je-W>3&&lt(ve,W,je,se),ve[je+2]=_e,J-je>3&&lt(ve,je,J,se))}function ge(ve,W,J,se,_e,Re){let je=_e-J,Ge=Re-se;if(je!==0||Ge!==0){const Ne=((ve-J)*je+(W-se)*Ge)/(je*je+Ge*Ge);Ne>1?(J=_e,se=Re):Ne>0&&(J+=je*Ne,se+=Ge*Ne)}return je=ve-J,Ge=W-se,je*je+Ge*Ge}function Gt(ve,W,J,se){const _e={id:ve??null,type:W,geometry:J,tags:se,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(W==="Point"||W==="MultiPoint"||W==="LineString")Ut(_e,J);else if(W==="Polygon")Ut(_e,J[0]);else if(W==="MultiLineString")for(const Re of J)Ut(_e,Re);else if(W==="MultiPolygon")for(const Re of J)Ut(_e,Re[0]);return _e}function Ut(ve,W){for(let J=0;J<W.length;J+=3)ve.minX=Math.min(ve.minX,W[J]),ve.minY=Math.min(ve.minY,W[J+1]),ve.maxX=Math.max(ve.maxX,W[J]),ve.maxY=Math.max(ve.maxY,W[J+1])}function Ce(ve,W,J,se){if(!W.geometry)return;const _e=W.geometry.coordinates;if(_e&&_e.length===0)return;const Re=W.geometry.type,je=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2);let Ge=[],Ne=W.id;if(J.promoteId?Ne=W.properties[J.promoteId]:J.generateId&&(Ne=se||0),Re==="Point")ar(_e,Ge);else if(Re==="MultiPoint")for(const Ye of _e)ar(Ye,Ge);else if(Re==="LineString")kt(_e,Ge,je,!1);else if(Re==="MultiLineString"){if(J.lineMetrics){for(const Ye of _e)Ge=[],kt(Ye,Ge,je,!1),ve.push(Gt(Ne,"LineString",Ge,W.properties));return}er(_e,Ge,je,!1)}else if(Re==="Polygon")er(_e,Ge,je,!0);else{if(Re!=="MultiPolygon"){if(Re==="GeometryCollection"){for(const Ye of W.geometry.geometries)Ce(ve,{id:Ne,geometry:Ye,properties:W.properties},J,se);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ye of _e){const ht=[];er(Ye,ht,je,!0),Ge.push(ht)}}ve.push(Gt(Ne,Re,Ge,W.properties))}function ar(ve,W){W.push(Ur(ve[0]),or(ve[1]),0)}function kt(ve,W,J,se){let _e,Re,je=0;for(let Ne=0;Ne<ve.length;Ne++){const Ye=Ur(ve[Ne][0]),ht=or(ve[Ne][1]);W.push(Ye,ht,0),Ne>0&&(je+=se?(_e*ht-Ye*Re)/2:Math.sqrt(Math.pow(Ye-_e,2)+Math.pow(ht-Re,2))),_e=Ye,Re=ht}const Ge=W.length-3;W[2]=1,lt(W,0,Ge,J),W[Ge+2]=1,W.size=Math.abs(je),W.start=0,W.end=W.size}function er(ve,W,J,se){for(let _e=0;_e<ve.length;_e++){const Re=[];kt(ve[_e],Re,J,se),W.push(Re)}}function Ur(ve){return ve/360+.5}function or(ve){const W=Math.sin(ve*Math.PI/180),J=.5-.25*Math.log((1+W)/(1-W))/Math.PI;return J<0?0:J>1?1:J}function Sr(ve,W,J,se,_e,Re,je,Ge){if(se/=W,Re>=(J/=W)&&je<se)return ve;if(je<J||Re>=se)return null;const Ne=[];for(const Ye of ve){const ht=Ye.geometry;let Ze=Ye.type;const Mt=_e===0?Ye.minX:Ye.minY,Ft=_e===0?Ye.maxX:Ye.maxY;if(Mt>=J&&Ft<se){Ne.push(Ye);continue}if(Ft<J||Mt>=se)continue;let Ke=[];if(Ze==="Point"||Ze==="MultiPoint")Ar(ht,Ke,J,se,_e);else if(Ze==="LineString")Nr(ht,Ke,J,se,_e,!1,Ge.lineMetrics);else if(Ze==="MultiLineString")gr(ht,Ke,J,se,_e,!1);else if(Ze==="Polygon")gr(ht,Ke,J,se,_e,!0);else if(Ze==="MultiPolygon")for(const hr of ht){const Cr=[];gr(hr,Cr,J,se,_e,!0),Cr.length&&Ke.push(Cr)}if(Ke.length){if(Ge.lineMetrics&&Ze==="LineString"){for(const hr of Ke)Ne.push(Gt(Ye.id,Ze,hr,Ye.tags));continue}Ze!=="LineString"&&Ze!=="MultiLineString"||(Ke.length===1?(Ze="LineString",Ke=Ke[0]):Ze="MultiLineString"),Ze!=="Point"&&Ze!=="MultiPoint"||(Ze=Ke.length===3?"Point":"MultiPoint"),Ne.push(Gt(Ye.id,Ze,Ke,Ye.tags))}}return Ne.length?Ne:null}function Ar(ve,W,J,se,_e){for(let Re=0;Re<ve.length;Re+=3){const je=ve[Re+_e];je>=J&&je<=se&&ir(W,ve[Re],ve[Re+1],ve[Re+2])}}function Nr(ve,W,J,se,_e,Re,je){let Ge=rr(ve);const Ne=_e===0?qr:Vt;let Ye,ht,Ze=ve.start;for(let Cr=0;Cr<ve.length-3;Cr+=3){const Ot=ve[Cr],mr=ve[Cr+1],ai=ve[Cr+2],li=ve[Cr+3],Wr=ve[Cr+4],fi=_e===0?Ot:mr,jr=_e===0?li:Wr;let ei=!1;je&&(Ye=Math.sqrt(Math.pow(Ot-li,2)+Math.pow(mr-Wr,2))),fi<J?jr>J&&(ht=Ne(Ge,Ot,mr,li,Wr,J),je&&(Ge.start=Ze+Ye*ht)):fi>se?jr<se&&(ht=Ne(Ge,Ot,mr,li,Wr,se),je&&(Ge.start=Ze+Ye*ht)):ir(Ge,Ot,mr,ai),jr<J&&fi>=J&&(ht=Ne(Ge,Ot,mr,li,Wr,J),ei=!0),jr>se&&fi<=se&&(ht=Ne(Ge,Ot,mr,li,Wr,se),ei=!0),!Re&&ei&&(je&&(Ge.end=Ze+Ye*ht),W.push(Ge),Ge=rr(ve)),je&&(Ze+=Ye)}let Mt=ve.length-3;const Ft=ve[Mt],Ke=ve[Mt+1],hr=_e===0?Ft:Ke;hr>=J&&hr<=se&&ir(Ge,Ft,Ke,ve[Mt+2]),Mt=Ge.length-3,Re&&Mt>=3&&(Ge[Mt]!==Ge[0]||Ge[Mt+1]!==Ge[1])&&ir(Ge,Ge[0],Ge[1],Ge[2]),Ge.length&&W.push(Ge)}function rr(ve){const W=[];return W.size=ve.size,W.start=ve.start,W.end=ve.end,W}function gr(ve,W,J,se,_e,Re){for(const je of ve)Nr(je,W,J,se,_e,Re,!1)}function ir(ve,W,J,se){ve.push(W,J,se)}function qr(ve,W,J,se,_e,Re){const je=(Re-W)/(se-W);return ir(ve,Re,J+(_e-J)*je,1),je}function Vt(ve,W,J,se,_e,Re){const je=(Re-J)/(_e-J);return ir(ve,W+(se-W)*je,Re,1),je}function Pr(ve,W){const J=[];for(let se=0;se<ve.length;se++){const _e=ve[se],Re=_e.type;let je;if(Re==="Point"||Re==="MultiPoint"||Re==="LineString")je=St(_e.geometry,W);else if(Re==="MultiLineString"||Re==="Polygon"){je=[];for(const Ge of _e.geometry)je.push(St(Ge,W))}else if(Re==="MultiPolygon"){je=[];for(const Ge of _e.geometry){const Ne=[];for(const Ye of Ge)Ne.push(St(Ye,W));je.push(Ne)}}J.push(Gt(_e.id,Re,je,_e.tags))}return J}function St(ve,W){const J=[];J.size=ve.size,ve.start!==void 0&&(J.start=ve.start,J.end=ve.end);for(let se=0;se<ve.length;se+=3)J.push(ve[se]+W,ve[se+1],ve[se+2]);return J}function Qt(ve,W){if(ve.transformed)return ve;const J=1<<ve.z,se=ve.x,_e=ve.y;for(const Re of ve.features){const je=Re.geometry,Ge=Re.type;if(Re.geometry=[],Ge===1)for(let Ne=0;Ne<je.length;Ne+=2)Re.geometry.push(nr(je[Ne],je[Ne+1],W,J,se,_e));else for(let Ne=0;Ne<je.length;Ne++){const Ye=[];for(let ht=0;ht<je[Ne].length;ht+=2)Ye.push(nr(je[Ne][ht],je[Ne][ht+1],W,J,se,_e));Re.geometry.push(Ye)}}return ve.transformed=!0,ve}function nr(ve,W,J,se,_e,Re){return[Math.round(J*(ve*se-_e)),Math.round(J*(W*se-Re))]}function Tr(ve,W,J,se,_e){const Re=W===_e.maxZoom?0:_e.tolerance/((1<<W)*_e.extent),je={features:[],numPoints:0,numSimplified:0,numFeatures:ve.length,source:null,x:J,y:se,z:W,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ge of ve)$r(je,Ge,Re,_e);return je}function $r(ve,W,J,se){const _e=W.geometry,Re=W.type,je=[];if(ve.minX=Math.min(ve.minX,W.minX),ve.minY=Math.min(ve.minY,W.minY),ve.maxX=Math.max(ve.maxX,W.maxX),ve.maxY=Math.max(ve.maxY,W.maxY),Re==="Point"||Re==="MultiPoint")for(let Ge=0;Ge<_e.length;Ge+=3)je.push(_e[Ge],_e[Ge+1]),ve.numPoints++,ve.numSimplified++;else if(Re==="LineString")bt(je,_e,ve,J,!1,!1);else if(Re==="MultiLineString"||Re==="Polygon")for(let Ge=0;Ge<_e.length;Ge++)bt(je,_e[Ge],ve,J,Re==="Polygon",Ge===0);else if(Re==="MultiPolygon")for(let Ge=0;Ge<_e.length;Ge++){const Ne=_e[Ge];for(let Ye=0;Ye<Ne.length;Ye++)bt(je,Ne[Ye],ve,J,!0,Ye===0)}if(je.length){let Ge=W.tags||null;if(Re==="LineString"&&se.lineMetrics){Ge={};for(const Ye in W.tags)Ge[Ye]=W.tags[Ye];Ge.mapbox_clip_start=_e.start/_e.size,Ge.mapbox_clip_end=_e.end/_e.size}const Ne={geometry:je,type:Re==="Polygon"||Re==="MultiPolygon"?3:Re==="LineString"||Re==="MultiLineString"?2:1,tags:Ge};W.id!==null&&(Ne.id=W.id),ve.features.push(Ne)}}function bt(ve,W,J,se,_e,Re){const je=se*se;if(se>0&&W.size<(_e?je:se))return void(J.numPoints+=W.length/3);const Ge=[];for(let Ne=0;Ne<W.length;Ne+=3)(se===0||W[Ne+2]>je)&&(J.numSimplified++,Ge.push(W[Ne],W[Ne+1])),J.numPoints++;_e&&(function(Ne,Ye){let ht=0;for(let Ze=0,Mt=Ne.length,Ft=Mt-2;Ze<Mt;Ft=Ze,Ze+=2)ht+=(Ne[Ze]-Ne[Ft])*(Ne[Ze+1]+Ne[Ft+1]);if(ht>0===Ye)for(let Ze=0,Mt=Ne.length;Ze<Mt/2;Ze+=2){const Ft=Ne[Ze],Ke=Ne[Ze+1];Ne[Ze]=Ne[Mt-2-Ze],Ne[Ze+1]=Ne[Mt-1-Ze],Ne[Mt-2-Ze]=Ft,Ne[Mt-1-Ze]=Ke}})(Ge,Re),ve.push(Ge)}const pi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ii{constructor(W,J){const se=(J=this.options=(function(Re,je){for(const Ge in je)Re[Ge]=je[Ge];return Re})(Object.create(pi),J)).debug;if(se&&console.time("preprocess data"),J.maxZoom<0||J.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(J.promoteId&&J.generateId)throw new Error("promoteId and generateId cannot be used together.");let _e=(function(Re,je){const Ge=[];if(Re.type==="FeatureCollection")for(let Ne=0;Ne<Re.features.length;Ne++)Ce(Ge,Re.features[Ne],je,Ne);else Ce(Ge,Re.type==="Feature"?Re:{geometry:Re},je);return Ge})(W,J);this.tiles={},this.tileCoords=[],se&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",J.indexMaxZoom,J.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),_e=(function(Re,je){const Ge=je.buffer/je.extent;let Ne=Re;const Ye=Sr(Re,1,-1-Ge,Ge,0,-1,2,je),ht=Sr(Re,1,1-Ge,2+Ge,0,-1,2,je);return(Ye||ht)&&(Ne=Sr(Re,1,-Ge,1+Ge,0,-1,2,je)||[],Ye&&(Ne=Pr(Ye,1).concat(Ne)),ht&&(Ne=Ne.concat(Pr(ht,-1)))),Ne})(_e,J),_e.length&&this.splitTile(_e,0,0,0),se&&(_e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(W,J,se,_e,Re,je,Ge){const Ne=[W,J,se,_e],Ye=this.options,ht=Ye.debug;for(;Ne.length;){_e=Ne.pop(),se=Ne.pop(),J=Ne.pop(),W=Ne.pop();const Ze=1<<J,Mt=Oe(J,se,_e);let Ft=this.tiles[Mt];if(!Ft&&(ht>1&&console.time("creation"),Ft=this.tiles[Mt]=Tr(W,J,se,_e,Ye),this.tileCoords.push({z:J,x:se,y:_e}),ht)){ht>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",J,se,_e,Ft.numFeatures,Ft.numPoints,Ft.numSimplified),console.timeEnd("creation"));const ei=`z${J}`;this.stats[ei]=(this.stats[ei]||0)+1,this.total++}if(Ft.source=W,Re==null){if(J===Ye.indexMaxZoom||Ft.numPoints<=Ye.indexMaxPoints)continue}else{if(J===Ye.maxZoom||J===Re)continue;if(Re!=null){const ei=Re-J;if(se!==je>>ei||_e!==Ge>>ei)continue}}if(Ft.source=null,W.length===0)continue;ht>1&&console.time("clipping");const Ke=.5*Ye.buffer/Ye.extent,hr=.5-Ke,Cr=.5+Ke,Ot=1+Ke;let mr=null,ai=null,li=null,Wr=null,fi=Sr(W,Ze,se-Ke,se+Cr,0,Ft.minX,Ft.maxX,Ye),jr=Sr(W,Ze,se+hr,se+Ot,0,Ft.minX,Ft.maxX,Ye);W=null,fi&&(mr=Sr(fi,Ze,_e-Ke,_e+Cr,1,Ft.minY,Ft.maxY,Ye),ai=Sr(fi,Ze,_e+hr,_e+Ot,1,Ft.minY,Ft.maxY,Ye),fi=null),jr&&(li=Sr(jr,Ze,_e-Ke,_e+Cr,1,Ft.minY,Ft.maxY,Ye),Wr=Sr(jr,Ze,_e+hr,_e+Ot,1,Ft.minY,Ft.maxY,Ye),jr=null),ht>1&&console.timeEnd("clipping"),Ne.push(mr||[],J+1,2*se,2*_e),Ne.push(ai||[],J+1,2*se,2*_e+1),Ne.push(li||[],J+1,2*se+1,2*_e),Ne.push(Wr||[],J+1,2*se+1,2*_e+1)}}getTile(W,J,se){W=+W,J=+J,se=+se;const _e=this.options,{extent:Re,debug:je}=_e;if(W<0||W>24)return null;const Ge=1<<W,Ne=Oe(W,J=J+Ge&Ge-1,se);if(this.tiles[Ne])return Qt(this.tiles[Ne],Re);je>1&&console.log("drilling down to z%d-%d-%d",W,J,se);let Ye,ht=W,Ze=J,Mt=se;for(;!Ye&&ht>0;)ht--,Ze>>=1,Mt>>=1,Ye=this.tiles[Oe(ht,Ze,Mt)];return Ye&&Ye.source?(je>1&&(console.log("found parent tile z%d-%d-%d",ht,Ze,Mt),console.time("drilling down")),this.splitTile(Ye.source,ht,Ze,Mt,W,J,se),je>1&&console.timeEnd("drilling down"),this.tiles[Ne]?Qt(this.tiles[Ne],Re):null):null}}function Oe(ve,W,J){return 32*((1<<ve)*J+W)+ve}class vt extends C{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(W,J){return e._(this,void 0,void 0,(function*(){const se=W.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const _e=this._geoJSONIndex.getTile(se.z,se.x,se.y);if(!_e)return null;const Re=new ne(_e.features,{version:2,extent:e.$});let je=(function(Ge){const Ne=new e.cM;return(function(Ye,ht){for(const Ze in Ye.layers)ht.writeMessage(3,he,Ye.layers[Ze])})(Ge,Ne),Ne.finish()})(Re);return je.byteOffset===0&&je.byteLength===je.buffer.byteLength||(je=new Uint8Array(je)),{vectorTile:Re,rawData:je.buffer}}))}loadData(W){return e._(this,void 0,void 0,(function*(){var J;(J=this._pendingRequest)===null||J===void 0||J.abort();const se=!!(W&&W.request&&W.request.collectResourceTiming)&&new e.cN(W.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(W,this._pendingRequest);const _e=yield this._pendingData;this._geoJSONIndex=W.cluster?new ee((function({superclusterOptions:je,clusterProperties:Ge}){if(!Ge||!je)return je;const Ne={},Ye={},ht={accumulated:null,zoom:0},Ze={properties:null},Mt=Object.keys(Ge);for(const Ft of Mt){const[Ke,hr]=Ge[Ft],Cr=e.cT(hr),Ot=e.cT(typeof Ke=="string"?[Ke,["accumulated"],["get",Ft]]:Ke);Ne[Ft]=Cr.value,Ye[Ft]=Ot.value}return je.map=Ft=>{Ze.properties=Ft;const Ke={};for(const hr of Mt)Ke[hr]=Ne[hr].evaluate(ht,Ze);return Ke},je.reduce=(Ft,Ke)=>{Ze.properties=Ke;for(const hr of Mt)ht.accumulated=Ft[hr],Ft[hr]=Ye[hr].evaluate(ht,Ze)},je})(W)).load(_e.features):(function(je,Ge){return new Ii(je,Ge)})(_e,W.geojsonVtOptions),this.loaded={};const Re={data:_e};if(se){const je=se.finish();je&&(Re.resourceTiming={},Re.resourceTiming[W.source]=JSON.parse(JSON.stringify(je)))}return Re}catch(_e){if(delete this._pendingRequest,e.cy(_e))return{abandoned:!0};throw _e}}))}getData(){return e._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(W){const J=this.loaded;return J&&J[W.uid]?super.reloadTile(W):this.loadTile(W)}loadAndProcessGeoJSON(W,J){return e._(this,void 0,void 0,(function*(){let se=yield this.loadGeoJSON(W,J);if(delete this._pendingRequest,typeof se!="object")throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(G(se,!0),W.filter){const _e=e.cT(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(_e.result==="error")throw new Error(_e.value.map((je=>`${je.key}: ${je.message}`)).join(", "));se={type:"FeatureCollection",features:se.features.filter((je=>_e.value.evaluate({zoom:0},je)))}}return se}))}loadGeoJSON(W,J){return e._(this,void 0,void 0,(function*(){const{promoteId:se}=W;if(W.request){const _e=yield e.j(W.request,J);return this._dataUpdateable=e.cV(_e.data,se)?e.cU(_e.data,se):void 0,_e.data}if(typeof W.data=="string")try{const _e=JSON.parse(W.data);return this._dataUpdateable=e.cV(_e,se)?e.cU(_e,se):void 0,_e}catch{throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`)}if(!W.dataDiff)throw new Error(`Input data given to '${W.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${W.source}`);return e.cW(this._dataUpdateable,W.dataDiff,se),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(W){return e._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(W){return this._geoJSONIndex.getClusterExpansionZoom(W.clusterId)}getClusterChildren(W){return this._geoJSONIndex.getChildren(W.clusterId)}getClusterLeaves(W){return this._geoJSONIndex.getLeaves(W.clusterId,W.limit,W.offset)}}class Nt{constructor(W){this.self=W,this.actor=new e.J(W),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(J,se)=>{if(this.externalWorkerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.externalWorkerSourceTypes[J]=se},this.self.addProtocol=e.cA,this.self.removeProtocol=e.cB,this.self.registerRTLTextPlugin=J=>{e.cX.setMethods(J)},this.actor.registerMessageHandler("LDT",((J,se)=>this._getDEMWorkerSource(J,se.source).loadTile(se))),this.actor.registerMessageHandler("RDT",((J,se)=>e._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(J,se.source).removeTile(se)})))),this.actor.registerMessageHandler("GCEZ",((J,se)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,se.type,se.source).getClusterExpansionZoom(se)})))),this.actor.registerMessageHandler("GCC",((J,se)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,se.type,se.source).getClusterChildren(se)})))),this.actor.registerMessageHandler("GCL",((J,se)=>e._(this,void 0,void 0,(function*(){return this._getWorkerSource(J,se.type,se.source).getClusterLeaves(se)})))),this.actor.registerMessageHandler("LD",((J,se)=>this._getWorkerSource(J,se.type,se.source).loadData(se))),this.actor.registerMessageHandler("GD",((J,se)=>this._getWorkerSource(J,se.type,se.source).getData())),this.actor.registerMessageHandler("LT",((J,se)=>this._getWorkerSource(J,se.type,se.source).loadTile(se))),this.actor.registerMessageHandler("RT",((J,se)=>this._getWorkerSource(J,se.type,se.source).reloadTile(se))),this.actor.registerMessageHandler("AT",((J,se)=>this._getWorkerSource(J,se.type,se.source).abortTile(se))),this.actor.registerMessageHandler("RMT",((J,se)=>this._getWorkerSource(J,se.type,se.source).removeTile(se))),this.actor.registerMessageHandler("RS",((J,se)=>e._(this,void 0,void 0,(function*(){if(!this.workerSources[J]||!this.workerSources[J][se.type]||!this.workerSources[J][se.type][se.source])return;const _e=this.workerSources[J][se.type][se.source];delete this.workerSources[J][se.type][se.source],_e.removeSource!==void 0&&_e.removeSource(se)})))),this.actor.registerMessageHandler("RM",(J=>e._(this,void 0,void 0,(function*(){delete this.layerIndexes[J],delete this.availableImages[J],delete this.workerSources[J],delete this.demWorkerSources[J],this.globalStates.delete(J)})))),this.actor.registerMessageHandler("SR",((J,se)=>e._(this,void 0,void 0,(function*(){this.referrer=se})))),this.actor.registerMessageHandler("SRPS",((J,se)=>this._syncRTLPluginState(J,se))),this.actor.registerMessageHandler("IS",((J,se)=>e._(this,void 0,void 0,(function*(){this.self.importScripts(se)})))),this.actor.registerMessageHandler("SI",((J,se)=>this._setImages(J,se))),this.actor.registerMessageHandler("UL",((J,se)=>e._(this,void 0,void 0,(function*(){this._getLayerIndex(J).update(se.layers,se.removedIds,this._getGlobalState(J))})))),this.actor.registerMessageHandler("UGS",((J,se)=>e._(this,void 0,void 0,(function*(){const _e=this._getGlobalState(J);for(const Re in se)_e[Re]=se[Re]})))),this.actor.registerMessageHandler("SL",((J,se)=>e._(this,void 0,void 0,(function*(){this._getLayerIndex(J).replace(se,this._getGlobalState(J))}))))}_getGlobalState(W){let J=this.globalStates.get(W);return J||(J={},this.globalStates.set(W,J)),J}_setImages(W,J){return e._(this,void 0,void 0,(function*(){this.availableImages[W]=J;for(const se in this.workerSources[W]){const _e=this.workerSources[W][se];for(const Re in _e)_e[Re].availableImages=J}}))}_syncRTLPluginState(W,J){return e._(this,void 0,void 0,(function*(){return yield e.cX.syncState(J,this.self.importScripts)}))}_getAvailableImages(W){let J=this.availableImages[W];return J||(J=[]),J}_getLayerIndex(W){let J=this.layerIndexes[W];return J||(J=this.layerIndexes[W]=new l),J}_getWorkerSource(W,J,se){if(this.workerSources[W]||(this.workerSources[W]={}),this.workerSources[W][J]||(this.workerSources[W][J]={}),!this.workerSources[W][J][se]){const _e={sendAsync:(Re,je)=>(Re.targetMapId=W,this.actor.sendAsync(Re,je))};switch(J){case"vector":this.workerSources[W][J][se]=new C(_e,this._getLayerIndex(W),this._getAvailableImages(W));break;case"geojson":this.workerSources[W][J][se]=new vt(_e,this._getLayerIndex(W),this._getAvailableImages(W));break;default:this.workerSources[W][J][se]=new this.externalWorkerSourceTypes[J](_e,this._getLayerIndex(W),this._getAvailableImages(W))}}return this.workerSources[W][J][se]}_getDEMWorkerSource(W,J){return this.demWorkerSources[W]||(this.demWorkerSources[W]={}),this.demWorkerSources[W][J]||(this.demWorkerSources[W][J]=new I),this.demWorkerSources[W][J]}}return e.i(self)&&(self.worker=new Nt(self)),Nt})),f("index",["exports","./shared"],(function(e,l){var _="5.9.0";function w(){var g=new l.A(4);return l.A!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g}let R,C;const I={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(g,t,u){const p=requestAnimationFrame((v=>{m(),t(v)})),{unsubscribe:m}=l.s(g.signal,"abort",(()=>{m(),cancelAnimationFrame(p),u(l.c())}),!1)},frameAsync(g){return new Promise(((t,u)=>{this.frame(g,t,u)}))},getImageData(g,t=0){return this.getImageCanvasContext(g).getImageData(-t,-t,g.width+2*t,g.height+2*t)},getImageCanvasContext(g){const t=window.document.createElement("canvas"),u=t.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return t.width=g.width,t.height=g.height,u.drawImage(g,0,0,g.width,g.height),u},resolveURL:g=>(R||(R=document.createElement("a")),R.href=g,R.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(C==null&&(C=matchMedia("(prefers-reduced-motion: reduce)")),C.matches)}};class L{static testProp(t){if(!L.docStyle)return t[0];for(let u=0;u<t.length;u++)if(t[u]in L.docStyle)return t[u];return t[0]}static create(t,u,p){const m=window.document.createElement(t);return u!==void 0&&(m.className=u),p&&p.appendChild(m),m}static createNS(t,u){return window.document.createElementNS(t,u)}static disableDrag(){L.docStyle&&L.selectProp&&(L.userSelect=L.docStyle[L.selectProp],L.docStyle[L.selectProp]="none")}static enableDrag(){L.docStyle&&L.selectProp&&(L.docStyle[L.selectProp]=L.userSelect)}static setTransform(t,u){t.style[L.transformProp]=u}static addEventListener(t,u,p,m={}){t.addEventListener(u,p,"passive"in m?m:m.capture)}static removeEventListener(t,u,p,m={}){t.removeEventListener(u,p,"passive"in m?m:m.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",L.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",L.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",L.suppressClickInternal,!0)}),0)}static getScale(t){const u=t.getBoundingClientRect();return{x:u.width/t.offsetWidth||1,y:u.height/t.offsetHeight||1,boundingClientRect:u}}static getPoint(t,u,p){const m=u.boundingClientRect;return new l.P((p.clientX-m.left)/u.x-t.clientLeft,(p.clientY-m.top)/u.y-t.clientTop)}static mousePos(t,u){const p=L.getScale(t);return L.getPoint(t,p,u)}static touchPos(t,u){const p=[],m=L.getScale(t);for(let v=0;v<u.length;v++)p.push(L.getPoint(t,m,u[v]));return p}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const u=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),p=u.querySelectorAll("script");for(const m of p)m.remove();return L.clean(u),u.innerHTML}static isPossiblyDangerous(t,u){const p=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!p.includes("javascript:")&&!p.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const u=t.children;for(const p of u)L.removeAttributes(p),L.clean(p)}static removeAttributes(t){for(const{name:u,value:p}of t.attributes)L.isPossiblyDangerous(u,p)&&t.removeAttribute(u)}}L.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,L.selectProp=L.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),L.transformProp=L.testProp(["transform","WebkitTransform"]);const O={supported:!1,testSupport:function(g){!j&&G&&(ne?he(g):q=g)}};let q,G,j=!1,ne=!1;function he(g){const t=g.createTexture();g.bindTexture(g.TEXTURE_2D,t);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,G),g.isContextLost())return;O.supported=!0}catch{}g.deleteTexture(t),j=!0}var Q;typeof document<"u"&&(G=document.createElement("img"),G.onload=()=>{q&&he(q),q=null,ne=!0},G.onerror=()=>{j=!0,q=null},G.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(g){let t,u,p,m;g.resetRequestQueue=()=>{t=[],u=0,p=0,m={}},g.addThrottleControl=k=>{const V=p++;return m[V]=k,V},g.removeThrottleControl=k=>{delete m[k],E()},g.getImage=(k,V,N=!0)=>new Promise((($,K)=>{O.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*"),l.e(k,{type:"image"}),t.push({abortController:V,requestParameters:k,supportImageRefresh:N,state:"queued",onError:X=>{K(X)},onSuccess:X=>{$(X)}}),E()}));const v=k=>l._(this,void 0,void 0,(function*(){k.state="running";const{requestParameters:V,supportImageRefresh:N,onError:$,onSuccess:K,abortController:X}=k,re=N===!1&&!l.i(self)&&!l.g(V.url)&&(!V.headers||Object.keys(V.headers).reduce(((ce,be)=>ce&&be==="accept"),!0));u++;const le=re?T(V,X):l.m(V,X);try{const ce=yield le;delete k.abortController,k.state="completed",ce.data instanceof HTMLImageElement||l.b(ce.data)?K(ce):ce.data&&K({data:yield(ue=ce.data,typeof createImageBitmap=="function"?l.f(ue):l.h(ue)),cacheControl:ce.cacheControl,expires:ce.expires})}catch(ce){delete k.abortController,$(ce)}finally{u--,E()}var ue})),E=()=>{const k=(()=>{for(const V of Object.keys(m))if(m[V]())return!0;return!1})()?l.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:l.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let V=u;V<k&&t.length>0;V++){const N=t.shift();N.abortController.signal.aborted?V--:v(N)}},T=(k,V)=>new Promise(((N,$)=>{const K=new Image,X=k.url,re=k.credentials;re&&re==="include"?K.crossOrigin="use-credentials":(re&&re==="same-origin"||!l.d(X))&&(K.crossOrigin="anonymous"),V.signal.addEventListener("abort",(()=>{K.src="",$(l.c())})),K.fetchPriority="high",K.onload=()=>{K.onerror=K.onload=null,N({data:K})},K.onerror=()=>{K.onerror=K.onload=null,V.signal.aborted||$(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},K.src=X}))})(Q||(Q={})),Q.resetRequestQueue();class Be{constructor(t){this._transformRequestFn=t??null}transformRequest(t,u){return this._transformRequestFn&&this._transformRequestFn(t,u)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function we(g){const t=[];if(typeof g=="string")t.push({id:"default",url:g});else if(g&&g.length>0){const u=[];for(const{id:p,url:m}of g){const v=`${p}${m}`;u.indexOf(v)===-1&&(u.push(v),t.push({id:p,url:m}))}}return t}function ze(g,t,u){try{const p=new URL(g);return p.pathname+=`${t}${u}`,p.toString()}catch{throw new Error(`Invalid sprite URL "${g}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function et(g){const{userImage:t}=g;return!!(t&&t.render&&t.render())&&(g.data.replace(new Uint8Array(t.data.buffer)),!0)}class gt extends l.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:u,promiseResolve:p}of this.requestors)p(this._getImagesForIds(u));this.requestors=[]}}getImage(t){const u=this.images[t];if(u&&!u.data&&u.spriteData){const p=u.spriteData;u.data=new l.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),u.spriteData=null}return u}addImage(t,u){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,u)&&(this.images[t]=u)}_validate(t,u){let p=!0;const m=u.data||u.spriteData;return this._validateStretch(u.stretchX,m&&m.width)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "stretchX" value`))),p=!1),this._validateStretch(u.stretchY,m&&m.height)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "stretchY" value`))),p=!1),this._validateContent(u.content,u)||(this.fire(new l.k(new Error(`Image "${t}" has invalid "content" value`))),p=!1),p}_validateStretch(t,u){if(!t)return!0;let p=0;for(const m of t){if(m[0]<p||m[1]<m[0]||u<m[1])return!1;p=m[1]}return!0}_validateContent(t,u){if(!t)return!0;if(t.length!==4)return!1;const p=u.spriteData,m=p&&p.width||u.data.width,v=p&&p.height||u.data.height;return!(t[0]<0||m<t[0]||t[1]<0||v<t[1]||t[2]<0||m<t[2]||t[3]<0||v<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,u,p=!0){const m=this.getImage(t);if(p&&(m.data.width!==u.data.width||m.data.height!==u.data.height))throw new Error(`size mismatch between old image (${m.data.width}x${m.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=m.version+1,this.images[t]=u,this.updatedImages[t]=!0}removeImage(t){const u=this.images[t];delete this.images[t],delete this.patterns[t],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise(((u,p)=>{let m=!0;if(!this.isLoaded())for(const v of t)this.images[v]||(m=!1);this.isLoaded()||m?u(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:u})}))}_getImagesForIds(t){const u={};for(const p of t){let m=this.getImage(p);m||(this.fire(new l.l("styleimagemissing",{id:p})),m=this.getImage(p)),m?u[p]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,textFitWidth:m.textFitWidth,textFitHeight:m.textFitHeight,hasRenderCallback:!!(m.userImage&&m.userImage.render)}:l.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:t,height:u}=this.atlasImage;return{width:t,height:u}}getPattern(t){const u=this.patterns[t],p=this.getImage(t);if(!p)return null;if(u&&u.position.version===p.version)return u.position;if(u)u.position.version=p.version;else{const m={w:p.data.width+2,h:p.data.height+2,x:0,y:0},v=new l.I(m,p);this.patterns[t]={bin:m,position:v}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const u=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.T(t,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const v in this.patterns)t.push(this.patterns[v].bin);const{w:u,h:p}=l.p(t),m=this.atlasImage;m.resize({width:u||1,height:p||1});for(const v in this.patterns){const{bin:E}=this.patterns[v],T=E.x+1,k=E.y+1,V=this.getImage(v).data,N=V.width,$=V.height;l.R.copy(V,m,{x:0,y:0},{x:T,y:k},{width:N,height:$}),l.R.copy(V,m,{x:0,y:$-1},{x:T,y:k-1},{width:N,height:1}),l.R.copy(V,m,{x:0,y:0},{x:T,y:k+$},{width:N,height:1}),l.R.copy(V,m,{x:N-1,y:0},{x:T-1,y:k},{width:1,height:$}),l.R.copy(V,m,{x:0,y:0},{x:T+N,y:k},{width:1,height:$})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const u of t){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const p=this.getImage(u);p||l.w(`Image with ID: "${u}" was not found`),et(p)&&this.updateImage(u,p)}}}const st=1e20;function nt(g,t,u,p,m,v,E,T,k){for(let V=t;V<t+p;V++)rt(g,u*v+V,v,m,E,T,k);for(let V=u;V<u+m;V++)rt(g,V*v+t,1,p,E,T,k)}function rt(g,t,u,p,m,v,E){v[0]=0,E[0]=-st,E[1]=st,m[0]=g[t];for(let T=1,k=0,V=0;T<p;T++){m[T]=g[t+T*u];const N=T*T;do{const $=v[k];V=(m[T]-m[$]+N-$*$)/(T-$)/2}while(V<=E[k]&&--k>-1);k++,v[k]=T,E[k]=V,E[k+1]=st}for(let T=0,k=0;T<p;T++){for(;E[k+1]<T;)k++;const V=v[k],N=T-V;g[t+T*u]=m[V]+N*N}}class ee{constructor(t,u,p){this.requestManager=t,this.localIdeographFontFamily=u,this.entries={},this.lang=p}setURL(t){this.url=t}getGlyphs(t){return l._(this,void 0,void 0,(function*(){const u=[];for(const v in t)for(const E of t[v])u.push(this._getAndCacheGlyphsPromise(v,E));const p=yield Promise.all(u),m={};for(const{stack:v,id:E,glyph:T}of p)m[v]||(m[v]={}),m[v][E]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return m}))}_getAndCacheGlyphsPromise(t,u){return l._(this,void 0,void 0,(function*(){let p=this.entries[t];p||(p=this.entries[t]={glyphs:{},requests:{},ranges:{}});let m=p.glyphs[u];if(m!==void 0)return{stack:t,id:u,glyph:m};if(m=this._tinySDF(p,t,u),m)return p.glyphs[u]=m,{stack:t,id:u,glyph:m};const v=Math.floor(u/256);if(256*v>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[v])return{stack:t,id:u,glyph:m};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[v]){const T=ee.loadGlyphRange(t,v,this.url,this.requestManager);p.requests[v]=T}const E=yield p.requests[v];for(const T in E)this._doesCharSupportLocalGlyph(+T)||(p.glyphs[+T]=E[+T]);return p.ranges[v]=!0,{stack:t,id:u,glyph:E[u]||null}}))}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))||l.u["CJK Unified Ideographs"](t)||l.u["Hangul Syllables"](t)||l.u.Hiragana(t)||l.u.Katakana(t)||l.u["CJK Symbols and Punctuation"](t)||l.u["Halfwidth and Fullwidth Forms"](t))}_tinySDF(t,u,p){const m=this.localIdeographFontFamily;if(!m||!this._doesCharSupportLocalGlyph(p))return;let v=t.tinySDF;if(!v){let T="400";/bold/i.test(u)?T="900":/medium/i.test(u)?T="500":/light/i.test(u)&&(T="200"),v=t.tinySDF=new ee.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:m,fontWeight:T})}const E=v.draw(String.fromCharCode(p));return{id:p,bitmap:new l.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}ee.loadGlyphRange=function(g,t,u,p){return l._(this,void 0,void 0,(function*(){const m=256*t,v=m+255,E=p.transformRequest(u.replace("{fontstack}",g).replace("{range}",`${m}-${v}`),"Glyphs"),T=yield l.n(E,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${t}, ${m}-${v}`);const k={};for(const V of l.o(T.data))k[V.id]=V;return k}))},ee.TinySDF=class{constructor({fontSize:g=24,buffer:t=3,radius:u=8,cutoff:p=.25,fontFamily:m="sans-serif",fontWeight:v="normal",fontStyle:E="normal",lang:T=null}={}){this.buffer=t,this.cutoff=p,this.radius=u,this.lang=T;const k=this.size=g+4*t,V=this._createCanvas(k),N=this.ctx=V.getContext("2d",{willReadFrequently:!0});N.font=`${E} ${v} ${g}px ${m}`,N.textBaseline="alphabetic",N.textAlign="left",N.fillStyle="black",this.gridOuter=new Float64Array(k*k),this.gridInner=new Float64Array(k*k),this.f=new Float64Array(k),this.z=new Float64Array(k+1),this.v=new Uint16Array(k)}_createCanvas(g){const t=document.createElement("canvas");return t.width=t.height=g,t}draw(g){const{width:t,actualBoundingBoxAscent:u,actualBoundingBoxDescent:p,actualBoundingBoxLeft:m,actualBoundingBoxRight:v}=this.ctx.measureText(g),E=Math.ceil(u),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-m))),k=Math.min(this.size-this.buffer,E+Math.ceil(p)),V=T+2*this.buffer,N=k+2*this.buffer,$=Math.max(V*N,0),K=new Uint8ClampedArray($),X={data:K,width:V,height:N,glyphWidth:T,glyphHeight:k,glyphTop:E,glyphLeft:0,glyphAdvance:t};if(T===0||k===0)return X;const{ctx:re,buffer:le,gridInner:ue,gridOuter:ce}=this;this.lang&&(re.lang=this.lang),re.clearRect(le,le,T,k),re.fillText(g,le,le+E);const be=re.getImageData(le,le,T,k);ce.fill(st,0,$),ue.fill(0,0,$);for(let Ee=0;Ee<k;Ee++)for(let xe=0;xe<T;xe++){const Pe=be.data[4*(Ee*T+xe)+3]/255;if(Pe===0)continue;const Ue=(Ee+le)*V+xe+le;if(Pe===1)ce[Ue]=0,ue[Ue]=st;else{const Ae=.5-Pe;ce[Ue]=Ae>0?Ae*Ae:0,ue[Ue]=Ae<0?Ae*Ae:0}}nt(ce,0,0,V,N,V,this.f,this.v,this.z),nt(ue,le,le,T,k,V,this.f,this.v,this.z);for(let Ee=0;Ee<$;Ee++){const xe=Math.sqrt(ce[Ee])-Math.sqrt(ue[Ee]);K[Ee]=Math.round(255-255*(xe/this.radius+this.cutoff))}return X}};class Le{constructor(){this.specification=l.v.light.position}possiblyEvaluate(t,u){return l.B(t.expression.evaluate(u))}interpolate(t,u,p){return{x:l.C.number(t.x,u.x,p),y:l.C.number(t.y,u.y,p),z:l.C.number(t.z,u.z,p)}}}let de;class me extends l.E{constructor(t){super(),de=de||new l.r({anchor:new l.D(l.v.light.anchor),position:new Le,color:new l.D(l.v.light.color),intensity:new l.D(l.v.light.intensity)}),this._transitionable=new l.t(de,void 0),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,u={}){if(!this._validate(l.x,t,u))for(const p in t){const m=t[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),m):this._transitionable.setValue(p,m)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,u,p){return(!p||p.validate!==!1)&&l.y(this,t.call(l.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:l.v}))}}const tt=new l.r({"sky-color":new l.D(l.v.sky["sky-color"]),"horizon-color":new l.D(l.v.sky["horizon-color"]),"fog-color":new l.D(l.v.sky["fog-color"]),"fog-ground-blend":new l.D(l.v.sky["fog-ground-blend"]),"horizon-fog-blend":new l.D(l.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new l.D(l.v.sky["sky-horizon-blend"]),"atmosphere-blend":new l.D(l.v.sky["atmosphere-blend"])});class yt extends l.E{constructor(t){super(),this._transitionable=new l.t(tt,void 0),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.F(0))}setSky(t,u={}){if(!this._validate(l.G,t,u)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const p in t){const m=t[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),m):this._transitionable.setValue(p,m)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,u,p={}){return p?.validate!==!1&&l.y(this,t.call(l.z,l.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:l.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class lt{constructor(t,u){this.width=t,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,u){const p=t.join(",")+String(u);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(t,u)),this.dashEntry[p]}getDashRanges(t,u,p){const m=[];let v=t.length%2==1?-t[t.length-1]*p:0,E=t[0]*p,T=!0;m.push({left:v,right:E,isDash:T,zeroLength:t[0]===0});let k=t[0];for(let V=1;V<t.length;V++){T=!T;const N=t[V];v=k*p,k+=N,E=k*p,m.push({left:v,right:E,isDash:T,zeroLength:N===0})}return m}addRoundDash(t,u,p){const m=u/2;for(let v=-p;v<=p;v++){const E=this.width*(this.nextRow+p+v);let T=0,k=t[T];for(let V=0;V<this.width;V++){V/k.right>1&&(k=t[++T]);const N=Math.abs(V-k.left),$=Math.abs(V-k.right),K=Math.min(N,$);let X;const re=v/p*(m+1);if(k.isDash){const le=m-Math.abs(re);X=Math.sqrt(K*K+le*le)}else X=m-Math.sqrt(K*K+re*re);this.data[E+V]=Math.max(0,Math.min(255,X+128))}}}addRegularDash(t){for(let T=t.length-1;T>=0;--T){const k=t[T],V=t[T+1];k.zeroLength?t.splice(T,1):V&&V.isDash===k.isDash&&(V.left=k.left,t.splice(T,1))}const u=t[0],p=t[t.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const m=this.width*this.nextRow;let v=0,E=t[v];for(let T=0;T<this.width;T++){T/E.right>1&&(E=t[++v]);const k=Math.abs(T-E.left),V=Math.abs(T-E.right),N=Math.min(k,V);this.data[m+T]=Math.max(0,Math.min(255,(E.isDash?N:-N)+128))}}addDash(t,u){const p=u?7:0,m=2*p+1;if(this.nextRow+m>this.height)return l.w("LineAtlas out of space"),null;let v=0;for(let T=0;T<t.length;T++)v+=t[T];if(v!==0){const T=this.width/v,k=this.getDashRanges(t,this.width,T);u?this.addRoundDash(k,T,p):this.addRegularDash(k)}const E={y:this.nextRow+p,height:2*p,width:v};return this.nextRow+=m,this.dirty=!0,E}bind(t){const u=t.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const ge="maplibre_preloaded_worker_pool";class Gt{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Gt.workerCount;)this.workers.push(new Worker(l.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach((u=>{u.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[ge]}numActive(){return Object.keys(this.active).length}}const Ut=Math.floor(I.hardwareConcurrency/2);let Ce,ar;function kt(){return Ce||(Ce=new Gt),Ce}Gt.workerCount=l.H(globalThis)?Math.max(Math.min(Ut,3),1):1;class er{constructor(t,u){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=u;const p=this.workerPool.acquire(u);for(let m=0;m<p.length;m++){const v=new l.J(p[m],u);v.name=`Worker ${m}`,this.actors.push(v)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,u){const p=[];for(const m of this.actors)p.push(m.sendAsync({type:t,data:u}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach((u=>{u.remove()})),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,u){for(const p of this.actors)p.registerMessageHandler(t,u)}}function Ur(){return ar||(ar=new er(kt(),l.K),ar.registerMessageHandler("GR",((g,t,u)=>l.m(t,u)))),ar}function or(g,t){const u=l.L();return l.M(u,u,[1,1,0]),l.N(u,u,[.5*g.width,.5*g.height,1]),g.calculatePosMatrix?l.O(u,u,g.calculatePosMatrix(t.toUnwrapped())):u}function Sr(g,t,u,p,m,v,E){var T;const k=(function(K,X,re){if(K)for(const le of K){const ue=X[le];if(ue&&ue.source===re&&ue.type==="fill-extrusion")return!0}else for(const le in X){const ue=X[le];if(ue.source===re&&ue.type==="fill-extrusion")return!0}return!1})((T=m?.layers)!==null&&T!==void 0?T:null,t,g.id),V=v.maxPitchScaleFactor(),N=g.tilesIn(p,V,k);N.sort(Ar);const $=[];for(const K of N)$.push({wrappedTileID:K.tileID.wrapped().key,queryResults:K.tile.queryRenderedFeatures(t,u,g._state,K.queryGeometry,K.cameraQueryGeometry,K.scale,m,v,V,or(g.transform,K.tileID),E?(X,re)=>E(K.tileID,X,re):void 0)});return(function(K,X){for(const re in K)for(const le of K[re])Nr(le,X);return K})((function(K){const X={},re={};for(const le of K){const ue=le.queryResults,ce=le.wrappedTileID,be=re[ce]=re[ce]||{};for(const Ee in ue){const xe=ue[Ee],Pe=be[Ee]=be[Ee]||{},Ue=X[Ee]=X[Ee]||[];for(const Ae of xe)Pe[Ae.featureIndex]||(Pe[Ae.featureIndex]=!0,Ue.push(Ae))}}return X})($),g)}function Ar(g,t){const u=g.tileID,p=t.tileID;return u.overscaledZ-p.overscaledZ||u.canonical.y-p.canonical.y||u.wrap-p.wrap||u.canonical.x-p.canonical.x}function Nr(g,t){const u=g.feature,p=t.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=p}function rr(g,t,u){return l._(this,void 0,void 0,(function*(){let p=g;if(g.url?p=(yield l.j(t.transformRequest(g.url,"Source"),u)).data:yield I.frameAsync(u),!p)return null;const m=l.Q(l.e(p,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(m.vectorLayerIds=p.vector_layers.map((v=>v.id))),m}))}class gr{constructor(t,u){t&&(u?this.setSouthWest(t).setNorthEast(u):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof l.S?new l.S(t.lng,t.lat):l.S.convert(t),this}setSouthWest(t){return this._sw=t instanceof l.S?new l.S(t.lng,t.lat):l.S.convert(t),this}extend(t){const u=this._sw,p=this._ne;let m,v;if(t instanceof l.S)m=t,v=t;else{if(!(t instanceof gr))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(gr.convert(t)):this.extend(l.S.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(l.S.convert(t)):this;if(m=t._sw,v=t._ne,!m||!v)return this}return u||p?(u.lng=Math.min(m.lng,u.lng),u.lat=Math.min(m.lat,u.lat),p.lng=Math.max(v.lng,p.lng),p.lat=Math.max(v.lat,p.lat)):(this._sw=new l.S(m.lng,m.lat),this._ne=new l.S(v.lng,v.lat)),this}getCenter(){return new l.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l.S(this.getWest(),this.getNorth())}getSouthEast(){return new l.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:u,lat:p}=l.S.convert(t);let m=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&m}static convert(t){return t instanceof gr?t:t&&new gr(t)}static fromLngLat(t,u=0){const p=360*u/40075017,m=p/Math.cos(Math.PI/180*t.lat);return new gr(new l.S(t.lng-m,t.lat-p),new l.S(t.lng+m,t.lat+p))}adjustAntiMeridian(){const t=new l.S(this._sw.lng,this._sw.lat),u=new l.S(this._ne.lng,this._ne.lat);return new gr(t,t.lng>u.lng?new l.S(u.lng+360,u.lat):u)}}class ir{constructor(t,u,p){this.bounds=gr.convert(this.validateBounds(t)),this.minzoom=u||0,this.maxzoom=p||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const u=Math.pow(2,t.z),p=Math.floor(l.V(this.bounds.getWest())*u),m=Math.floor(l.U(this.bounds.getNorth())*u),v=Math.ceil(l.V(this.bounds.getEast())*u),E=Math.ceil(l.U(this.bounds.getSouth())*u);return t.x>=p&&t.x<v&&t.y>=m&&t.y<E}}class qr extends l.E{constructor(t,u,p,m){if(super(),this.id=t,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.e(this,l.Q(u,["url","scheme","tileSize","promoteId"])),this._options=l.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m)}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield rr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(l.e(this,t),t.bounds&&(this.tileBounds=new ir(t.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this._loaded=!0,this.fire(new l.k(t))}}))}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return l.e({},this._options)}loadTile(t){return l._(this,void 0,void 0,(function*(){const u=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(u,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};p.request.collectResourceTiming=this._collectResourceTiming;let m="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise(((v,E)=>{t.reloadPromise={resolve:v,reject:E}}))}else t.actor=this.dispatcher.getActor(),m="LT";t.abortController=new AbortController;try{const v=yield t.actor.sendAsync({type:m,data:p},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,v)}catch(v){if(delete t.abortController,t.aborted)return;if(v&&v.status!==404)throw v;this._afterTileLoadWorkerResponse(t,null)}}))}_afterTileLoadWorkerResponse(t,u){if(u&&u.resourceTiming&&(t.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&t.setExpiryData(u),t.loadVectorData(u,this.map.painter),t.reloadPromise){const p=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(p.resolve).catch(p.reject)}}abortTile(t){return l._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Vt extends l.E{constructor(t,u,p,m){super(),this.id=t,this.dispatcher=p,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.e({type:"raster"},u),l.e(this,l.Q(u,["url","scheme","tileSize"]))}load(){return l._(this,arguments,void 0,(function*(t=!1){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield rr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(l.e(this,u),u.bounds&&(this.tileBounds=new ir(u.bounds,this.minzoom,this.maxzoom)),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(u){this._tileJSONRequest=null,this._loaded=!0,this.fire(new l.k(u))}}))}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty((()=>{this._options.tiles=t})),this}setUrl(t){return this.setSourceProperty((()=>{this.url=t,this._options.url=t})),this}serialize(){return l.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return l._(this,void 0,void 0,(function*(){const u=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const p=yield Q.getImage(this.map._requestManager.transformRequest(u,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&(p.cacheControl||p.expires)&&t.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const m=this.map.painter.context,v=m.gl,E=p.data;t.texture=this.map.painter.getTileTexture(E.width),t.texture?t.texture.update(E,{useMipmap:!0}):(t.texture=new l.T(m,E,v.RGBA,{useMipmap:!0}),t.texture.bind(v.LINEAR,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(p){if(delete t.abortController,t.aborted)t.state="unloaded";else if(p)throw t.state="errored",p}}))}abortTile(t){return l._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)}))}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)}))}hasTransition(){return!1}}class Pr extends Vt{constructor(t,u,p,m){super(t,u,p,m),this.type="raster-dem",this.maxzoom=22,this._options=l.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(t){return l._(this,void 0,void 0,(function*(){const u=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(u,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const m=yield Q.getImage(p,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(m&&m.data){const v=m.data;this.map._refreshExpiredTiles&&(m.cacheControl||m.expires)&&t.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const E=l.b(v)&&l.W()?v:yield this.readImageNow(v),T={type:this.type,uid:t.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const k=yield t.actor.sendAsync({type:"LDT",data:T});t.dem=k,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(m){if(delete t.abortController,t.aborted)t.state="unloaded";else if(m)throw t.state="errored",m}}))}readImageNow(t){return l._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&l.X()){const u=t.width+2,p=t.height+2;try{return new l.R({width:u,height:p},yield l.Y(t,-1,-1,u,p))}catch{}}return I.getImageData(t,1)}))}_getNeighboringTiles(t){const u=t.canonical,p=Math.pow(2,u.z),m=(u.x-1+p)%p,v=u.x===0?t.wrap-1:t.wrap,E=(u.x+1+p)%p,T=u.x+1===p?t.wrap+1:t.wrap,k={};return k[new l.Z(t.overscaledZ,v,u.z,m,u.y).key]={backfilled:!1},k[new l.Z(t.overscaledZ,T,u.z,E,u.y).key]={backfilled:!1},u.y>0&&(k[new l.Z(t.overscaledZ,v,u.z,m,u.y-1).key]={backfilled:!1},k[new l.Z(t.overscaledZ,t.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},k[new l.Z(t.overscaledZ,T,u.z,E,u.y-1).key]={backfilled:!1}),u.y+1<p&&(k[new l.Z(t.overscaledZ,v,u.z,m,u.y+1).key]={backfilled:!1},k[new l.Z(t.overscaledZ,t.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},k[new l.Z(t.overscaledZ,T,u.z,E,u.y+1).key]={backfilled:!1}),k}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))}))}}class St extends l.E{constructor(t,u,p,m){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:u.data},this.actor=p.getActor(),this.setEventedParent(m),this._data=u.data,this._options=l.e({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,u.clusterMaxZoom!==void 0&&this.maxzoom<=u.clusterMaxZoom&&l.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=l.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(u.buffer!==void 0?u.buffer:128),tolerance:this._pixelsToTileUnits(u.tolerance!==void 0?u.tolerance:.375),extent:l.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:l.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(l.$/this.tileSize)}_getClusterMaxZoom(t){const u=t?Math.round(t):this.maxzoom-1;return Number.isInteger(t)||t===void 0||l.w(`Integer expected for option 'clusterMaxZoom': provided value "${t}" rounded to "${u}"`),u}load(){return l._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._pendingWorkerUpdate={data:t},this._updateWorkerData(),this}updateData(t){return this._pendingWorkerUpdate.diff=l.a0(this._pendingWorkerUpdate.diff,t),this._updateWorkerData(),this}getData(){return l._(this,void 0,void 0,(function*(){const t=l.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})}))}getCoordinatesFromGeometry(t){return t.type==="GeometryCollection"?t.geometries.map((u=>u.coordinates)).flat(1/0):t.coordinates.flat(1/0)}getBounds(){return l._(this,void 0,void 0,(function*(){const t=new gr,u=yield this.getData();let p;switch(u.type){case"FeatureCollection":p=u.features.map((m=>this.getCoordinatesFromGeometry(m.geometry))).flat(1/0);break;case"Feature":p=this.getCoordinatesFromGeometry(u.geometry);break;default:p=this.getCoordinatesFromGeometry(u)}if(p.length==0)return t;for(let m=0;m<p.length-1;m+=2)t.extend([p[m],p[m+1]]);return t}))}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(t.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,u,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:u,offset:p}})}_updateWorkerData(){return l._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:t,diff:u}=this._pendingWorkerUpdate;if(!t&&!u)return void l.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const p=l.e({type:this.type},this.workerOptions);t?(typeof t=="string"?(p.request=this.map._requestManager.transformRequest(I.resolveURL(t),"Source"),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(t),this._pendingWorkerUpdate.data=void 0):u&&(p.dataDiff=u,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new l.l("dataloading",{dataType:"source"}));try{const m=yield this.actor.sendAsync({type:"LD",data:p});if(this._isUpdatingWorker=!1,this._removed||m.abandoned)return void this.fire(new l.l("dataabort",{dataType:"source"}));this._data=m.data;let v=null;m.resourceTiming&&m.resourceTiming[this.id]&&(v=m.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&v&&v.length>0&&l.e(E,{resourceTiming:v}),this.fire(new l.l("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new l.l("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))}catch(m){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new l.l("dataabort",{dataType:"source"}));this.fire(new l.k(m))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(t){return l._(this,void 0,void 0,(function*(){const u=t.actor?"RT":"LT";t.actor=this.actor;const p={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const m=yield this.actor.sendAsync({type:u,data:p},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(m,this.map.painter,u==="RT")}))}abortTile(t){return l._(this,void 0,void 0,(function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0}))}unloadTile(t){return l._(this,void 0,void 0,(function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return l.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Qt extends l.E{constructor(t,u,p,m){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=p,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=u}load(t){return l._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new l.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield Q.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,t&&(this.coordinates=t),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new l.k(u))}}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const u=t.map(l.a1.fromLngLat);var p;return this.tileID=(function(m){const v=l.a2.fromPoints(m),E=v.width(),T=v.height(),k=Math.max(E,T),V=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),N=Math.pow(2,V);return new l.a4(V,Math.floor((v.minX+v.maxX)/2*N),Math.floor((v.minY+v.maxY)/2*N))})(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map((m=>this.tileID.getTilePoint(m)._round())),this.flippedWindingOrder=((p=this.tileCoords)[1].x-p[0].x)*(p[2].y-p[0].y)-(p[1].y-p[0].y)*(p[2].x-p[0].x)<0,this.fire(new l.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,u=t.gl;this.texture||(this.texture=new l.T(t,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let p=!1;for(const m in this.tiles){const v=this.tiles[m];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,p=!0)}p&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return l._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(t){const{minX:u,minY:p,maxX:m,maxY:v}=l.a2.fromPoints(t),E={};for(let T=0;T<=l.a3;T++){const k=Math.pow(2,T),V=Math.floor(u*k),N=Math.floor(p*k),$=Math.floor(m*k),K=Math.floor(v*k);E[T]={minTileX:V,minTileY:N,maxTileX:$,maxTileY:K}}return E}}class nr extends Qt{constructor(t,u,p,m){super(t,u,p,m),this.roundZoom=!0,this.type="video",this.options=u}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const u of t.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield l.a5(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new l.k(u))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const u=this.video.seekable;t<u.start(0)||t>u.end(0)?this.fire(new l.k(new l.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,u=t.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new l.T(t,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let p=!1;for(const m in this.tiles){const v=this.tiles[m];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture,p=!0)}p&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Tr extends Qt{constructor(t,u,p,m){super(t,u,p,m),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some((v=>!Array.isArray(v)||v.length!==2||v.some((E=>typeof E!="number"))))||this.fire(new l.k(new l.a6(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.k(new l.a6(`sources.${t}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new l.k(new l.a6(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new l.k(new l.a6(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.k(new l.a6(`sources.${t}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){return l._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context,p=u.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.T(u,this.canvas,p.RGBA,{premultiply:!0});let m=!1;for(const v in this.tiles){const E=this.tiles[v];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,m=!0)}m&&this.fire(new l.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const $r={},bt=g=>{switch(g){case"geojson":return St;case"image":return Qt;case"raster":return Vt;case"raster-dem":return Pr;case"vector":return qr;case"video":return nr;case"canvas":return Tr}return $r[g]},pi="RTLPluginLoaded";class Ii extends l.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Ur()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch((u=>{throw this.status="error",u}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return l._(this,arguments,void 0,(function*(u,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=I.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return l._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new l.l(pi))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Oe=null;function vt(){return Oe||(Oe=new Ii),Oe}var Nt,ve;(function(g){g[g.Base=0]="Base",g[g.Parent=1]="Parent"})(Nt||(Nt={})),(function(g){g[g.Departing=0]="Departing",g[g.Incoming=1]="Incoming"})(ve||(ve={}));class W{constructor(t,u){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=t,this.uid=l.a7(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(t){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(t||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:t,fadingDirection:u,fadingParentID:p,fadeEndTime:m}){this.resetFadeLogic(),this.fadingRole=t,this.fadingDirection=u,this.fadingParentID=p,this.fadeEndTime=m}setSelfFadeLogic(t){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=t}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=I.now(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,u,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=(function(m,v){const E={};if(!v)return E;for(const T of m){const k=T.layerIds.map((V=>v.getLayer(V))).filter(Boolean);if(k.length!==0){T.layers=k,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map((V=>k.filter((N=>N.id===V))[0])));for(const V of k)E[V.id]=T}}return E})(t.buckets,u?.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const v=this.buckets[m];if(v instanceof l.a9){if(this.hasSymbolBuckets=!0,!p)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const v=this.buckets[m];if(v instanceof l.a9&&v.hasRTLText){this.hasRTLText=!0,vt().lazyLoad();break}}this.queryPadding=0;for(const m in this.buckets){const v=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(m).queryRadius(v))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),this.dashPositions=t.dashPositions}else this.collisionBoxArray=new l.a8}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const p in this.buckets){const m=this.buckets[p];m.uploadPending()&&m.upload(t)}const u=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new l.T(t,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new l.T(t,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,u,p,m,v,E,T,k,V,N,$){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:v,scale:E,tileSize:this.tileSize,pixelPosMatrix:N,transform:k,params:T,queryPadding:this.queryPadding*V,getElevation:$},t,u,p):{}}querySourceFeatures(t,u){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const m=p.loadVTLayers(),v=u&&u.sourceLayer?u.sourceLayer:"",E=m._geojsonTileLayer||m[v];if(!E)return;const T=l.aa(u?.filter,u?.globalState),{z:k,x:V,y:N}=this.tileID.canonical,$={z:k,x:V,y:N};for(let K=0;K<E.length;K++){const X=E.feature(K);if(T.needGeometry){const ue=l.ab(X,!0);if(!T.filter(new l.F(this.tileID.overscaledZ),ue,this.tileID.canonical))continue}else if(!T.filter(new l.F(this.tileID.overscaledZ),X))continue;const re=p.getId(X,v),le=new l.ac(X,k,V,N,re);le.tile=$,t.push(le)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const u=this.expirationTime;if(t.cacheControl){const p=l.ad(t.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const p=Date.now();let m=!1;if(this.expirationTime>p)m=!1;else if(u)if(this.expirationTime<u)m=!0;else{const v=this.expirationTime-u;v?this.expirationTime=p+Math.max(v,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const m in this.buckets){if(!u.style.hasLayer(m))continue;const v=this.buckets[m],E=v.layers[0].sourceLayer||"_geojsonTileLayer",T=p[E],k=t[E];if(!T||!k||Object.keys(k).length===0)continue;v.update(k,T,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const V=u&&u.style&&u.style.getLayer(m);V&&(this.queryPadding=Math.max(this.queryPadding,V.queryRadius(v)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<I.now()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(t){this.symbolFadeHoldUntil=I.now()+t}setDependencies(t,u){const p={};for(const m of u)p[m]=!0;this.dependencies[t]=p}hasDependency(t,u){for(const p of t){const m=this.dependencies[p];if(m){for(const v of u)if(m[v])return!0}}return!1}}class J{constructor(t,u){this.max=t,this.onRemove=u,this.reset()}reset(){for(const t in this.data)for(const u of this.data[t])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(t,u,p){const m=t.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const v={value:u,timeout:void 0};if(p!==void 0&&(v.timeout=setTimeout((()=>{this.remove(t,v)}),p)),this.data[m].push(v),this.order.push(m),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const u=this.data[t].shift();return u.timeout&&clearTimeout(u.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),u.value}getByKey(t){const u=this.data[t];return u?u[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,u){if(!this.has(t))return this;const p=t.wrapped().key,m=u===void 0?0:this.data[p].indexOf(u),v=this.data[p][m];return this.data[p].splice(m,1),v.timeout&&clearTimeout(v.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(v.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(t){const u=[];for(const p in this.data)for(const m of this.data[p])t(m.value)||u.push(m);for(const p of u)this.remove(p.value.tileID,p)}}class se{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,u,p){const m=String(u);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][m]=this.stateChanges[t][m]||{},l.e(this.stateChanges[t][m],p),this.deletedStates[t]===null){this.deletedStates[t]={};for(const v in this.state[t])v!==m&&(this.deletedStates[t][v]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][m]===null){this.deletedStates[t][m]={};for(const v in this.state[t][m])p[v]||(this.deletedStates[t][m][v]=null)}else for(const v in p)this.deletedStates[t]&&this.deletedStates[t][m]&&this.deletedStates[t][m][v]===null&&delete this.deletedStates[t][m][v]}removeFeatureState(t,u,p){if(this.deletedStates[t]===null)return;const m=String(u);if(this.deletedStates[t]=this.deletedStates[t]||{},p&&u!==void 0)this.deletedStates[t][m]!==null&&(this.deletedStates[t][m]=this.deletedStates[t][m]||{},this.deletedStates[t][m][p]=null);else if(u!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][m])for(p in this.deletedStates[t][m]={},this.stateChanges[t][m])this.deletedStates[t][m][p]=null;else this.deletedStates[t][m]=null;else this.deletedStates[t]=null}getState(t,u){const p=String(u),m=l.e({},(this.state[t]||{})[p],(this.stateChanges[t]||{})[p]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const v=this.deletedStates[t][u];if(v===null)return{};for(const E in v)delete m[E]}return m}initializeTileState(t,u){t.setFeatureState(this.state,u)}coalesceChanges(t,u){const p={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const v={};for(const E in this.stateChanges[m])this.state[m][E]||(this.state[m][E]={}),l.e(this.state[m][E],this.stateChanges[m][E]),v[E]=this.state[m][E];p[m]=v}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const v={};if(this.deletedStates[m]===null)for(const E in this.state[m])v[E]={},this.state[m][E]={};else for(const E in this.deletedStates[m]){if(this.deletedStates[m][E]===null)this.state[m][E]={};else for(const T of Object.keys(this.deletedStates[m][E]))delete this.state[m][E][T];v[E]=this.state[m][E]}p[m]=p[m]||{},l.e(p[m],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const m in t)t[m].setFeatureState(p,u)}}const _e=89.25;function Re(g,t){const u=l.ah(t.lat,-l.ai,l.ai);return new l.P(l.V(t.lng)*g,l.U(u)*g)}function je(g,t){return new l.a1(t.x/g,t.y/g).toLngLat()}function Ge(g){return g.cameraToCenterDistance*Math.min(.85*Math.tan(l.ae(90-g.pitch)),Math.tan(l.ae(_e-g.pitch)))}function Ne(g,t){const u=g.canonical,p=t/l.af(u.z),m=u.x+Math.pow(2,u.z)*g.wrap,v=l.ag(new Float64Array(16));return l.M(v,v,[m*p,u.y*p,0]),l.N(v,v,[p/l.$,p/l.$,1]),v}function Ye(g,t,u,p,m){const v=l.a1.fromLngLat(g,t),E=m*l.aj(1,g.lat),T=E*Math.cos(l.ae(u)),k=Math.sqrt(E*E-T*T),V=k*Math.sin(l.ae(-p)),N=k*Math.cos(l.ae(-p));return new l.a1(v.x+V,v.y+N,v.z+T)}function ht(g,t,u){const p=t.intersectsFrustum(g);if(!u||p===0)return p;const m=t.intersectsPlane(u);return m===0?0:p===2&&m===2?2:1}function Ze(g,t,u){let p=0;const m=(u-t)/10;for(let v=0;v<10;v++)p+=m*Math.pow(Math.cos(t+(v+.5)/10*(u-t)),g);return p}function Mt(g,t){return function(u,p,m,v,E){const T=2*((g-1)/l.ak(Math.cos(l.ae(_e-E))/Math.cos(l.ae(_e)))-1),k=Math.acos(m/v),V=2*Ze(T-1,0,l.ae(E/2)),N=Math.min(l.ae(_e),k+l.ae(E/2)),$=Ze(T-1,Math.min(N,k-l.ae(E/2)),N),K=Math.atan(p/m),X=Math.hypot(p,m);let re=u;return re+=l.ak(v/X/Math.max(.5,Math.cos(l.ae(E/2)))),re+=T*l.ak(Math.cos(K))/2,re-=l.ak(Math.max(1,$/V/t))/2,re}}const Ft=Mt(9.314,3);function Ke(g,t){const u=(t.roundZoom?Math.round:Math.floor)(g.zoom+l.ak(g.tileSize/t.tileSize));return Math.max(0,u)}function hr(g,t){const u=g.getCameraFrustum(),p=g.getClippingPlane(),m=g.screenPointToMercatorCoordinate(g.getCameraPoint()),v=l.a1.fromLngLat(g.center,g.elevation);m.z=v.z+Math.cos(g.pitchInRadians)*g.cameraToCenterDistance/g.worldSize;const E=g.getCoveringTilesDetailsProvider(),T=E.allowVariableZoom(g,t),k=Ke(g,t),V=t.minzoom||0,N=t.maxzoom!==void 0?t.maxzoom:g.maxZoom,$=Math.min(Math.max(0,k),N),K=Math.pow(2,$),X=[K*m.x,K*m.y,0],re=[K*v.x,K*v.y,0],le=Math.hypot(v.x-m.x,v.y-m.y),ue=Math.abs(v.z-m.z),ce=Math.hypot(le,ue),be=Pe=>({zoom:0,x:0,y:0,wrap:Pe,fullyVisible:!1}),Ee=[],xe=[];if(g.renderWorldCopies&&E.allowWorldCopies())for(let Pe=1;Pe<=3;Pe++)Ee.push(be(-Pe)),Ee.push(be(Pe));for(Ee.push(be(0));Ee.length>0;){const Pe=Ee.pop(),Ue=Pe.x,Ae=Pe.y;let Fe=Pe.fullyVisible;const it={x:Ue,y:Ae,z:Pe.zoom},Xe=E.getTileBoundingVolume(it,Pe.wrap,g.elevation,t);if(!Fe){const wt=ht(u,Xe,p);if(wt===0)continue;Fe=wt===2}const Je=E.distanceToTile2d(m.x,m.y,it,Xe);let Qe=k;T&&(Qe=(t.calculateTileZoom||Ft)(g.zoom+l.ak(g.tileSize/t.tileSize),Je,ue,ce,g.fov)),Qe=(t.roundZoom?Math.round:Math.floor)(Qe),Qe=Math.max(0,Qe);const xt=Math.min(Qe,N);if(Pe.wrap=E.getWrap(v,it,Pe.wrap),Pe.zoom>=xt){if(Pe.zoom<V)continue;const wt=$-Pe.zoom,pt=X[0]-.5-(Ue<<wt),jt=X[1]-.5-(Ae<<wt),fr=t.reparseOverscaled?Math.max(Pe.zoom,Qe):Pe.zoom;xe.push({tileID:new l.Z(Pe.zoom===N?fr:Pe.zoom,Pe.wrap,Pe.zoom,Ue,Ae),distanceSq:l.al([re[0]-.5-Ue,re[1]-.5-Ae]),tileDistanceToCamera:Math.sqrt(pt*pt+jt*jt)})}else for(let wt=0;wt<4;wt++)Ee.push({zoom:Pe.zoom+1,x:(Ue<<1)+wt%2,y:(Ae<<1)+(wt>>1),wrap:Pe.wrap,fullyVisible:Fe})}return xe.sort(((Pe,Ue)=>Pe.distanceSq-Ue.distanceSq)).map((Pe=>Pe.tileID))}const Cr=l.a2.fromPoints([new l.P(0,0),new l.P(l.$,l.$)]);class Ot extends l.E{constructor(t,u,p){super(),this.id=t,this.dispatcher=p,this.on("data",(m=>this._dataHandler(m))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((m,v,E,T)=>{const k=new(bt(v.type))(m,v,E,T);if(k.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${k.id}`);return k})(t,u,p,this),this._tiles={},this._cache=new J(0,(m=>this._unloadTile(m))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new se,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const u=this._tiles[t];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,u,p){return l._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,u,p)}catch(m){t.state="errored",m.status!==404?this._source.fire(new l.k(m,{tile:t})):this.update(this.transform,this.terrain)}}))}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new l.l("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const p=this._tiles[u];p.upload(t),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((t=>t.tileID)).sort(mr).map((t=>t.key))}getRenderableIds(t){const u=[];for(const p in this._tiles)this._isIdRenderable(p,t)&&u.push(this._tiles[p]);return t?u.sort(((p,m)=>{const v=p.tileID,E=m.tileID,T=new l.P(v.canonical.x,v.canonical.y)._rotate(-this.transform.bearingInRadians),k=new l.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return v.overscaledZ-E.overscaledZ||k.y-T.y||k.x-T.x})).map((p=>p.tileID.key)):u.map((p=>p.tileID)).sort(mr).map((p=>p.key))}hasRenderableParent(t){const u=t.overscaledZ-1;if(u>=this._source.minzoom){const p=this._getLoadedTile(t.scaledTo(u));if(p)return this._isIdRenderable(p.tileID.key)}return!1}_isIdRenderable(t,u=!1){var p;return(p=this._tiles[t])===null||p===void 0?void 0:p.isRenderable(u)}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)t?this._reloadTile(u,"expired"):this._tiles[u].state!=="errored"&&this._reloadTile(u,"reloading")}}_reloadTile(t,u){return l._(this,void 0,void 0,(function*(){const p=this._tiles[t];p&&(p.state!=="loading"&&(p.state=u),yield this._loadTile(p,t,u))}))}_tileLoaded(t,u,p){t.timeAdded=I.now(),p==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(u,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new l.l("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const u=this.getRenderableIds();for(let m=0;m<u.length;m++){const v=u[m];if(t.neighboringTiles&&t.neighboringTiles[v]){const E=this.getTileByID(v);p(t,E),p(E,t)}}function p(m,v){m.needsHillshadePrepare=!0,m.needsTerrainPrepare=!0;let E=v.tileID.canonical.x-m.tileID.canonical.x;const T=v.tileID.canonical.y-m.tileID.canonical.y,k=Math.pow(2,m.tileID.canonical.z),V=v.tileID.key;E===0&&T===0||Math.abs(T)>1||(Math.abs(E)>1&&(Math.abs(E+k)===1?E+=k:Math.abs(E-k)===1&&(E-=k)),v.dem&&m.dem&&(m.dem.backfillBorder(v.dem,E,T),m.neighboringTiles&&m.neighboringTiles[V]&&(m.neighboringTiles[V].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,u){const p=Object.values(t),m=this._getLoadedDescendents(p),v={};for(const E of p){const T=m[E.key];if(!T?.length){v[E.key]=E;continue}const k=E.overscaledZ+Ot.maxUnderzooming,V=T.filter((K=>K.tileID.overscaledZ<=k));if(!V.length){v[E.key]=E;continue}const N=Math.min(...V.map((K=>K.tileID.overscaledZ))),$=V.filter((K=>K.tileID.overscaledZ===N)).map((K=>K.tileID));for(const K of $)u[K.key]=K;this._areDescendentsComplete($,N,E.overscaledZ)||(v[E.key]=E)}return v}_getLoadedDescendents(t){var u;const p={};for(const m in this._tiles){const v=this._tiles[m];if(v.hasData())for(const E of t)v.tileID.isChildOf(E)&&(p[u=E.key]||(p[u]=[])).push(v)}return p}_areDescendentsComplete(t,u,p){return t.length===1&&t[0].isOverscaled()?t[0].overscaledZ===u:Math.pow(4,u-p)===t.length}_getLoadedTile(t){const u=this._tiles[t.key];return u?.hasData()?u:null}updateCacheSize(t){const u=Math.ceil(t.width/this._source.tileSize)+1,p=Math.ceil(t.height/this._source.tileSize)+1,m=Math.floor(u*p*(this._maxTileCacheZoomLevels===null?l.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(v)}handleWrapJump(t){const u=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,u){const p={};for(const m in this._tiles){const v=this._tiles[m];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+u),p[v.tileID.key]=v}this._tiles=p;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(m,this._tiles[m])}}update(t,u){if(!this._sourceLoaded||this._paused)return;let p;this.transform=t,this.terrain=u,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?p=t.getVisibleUnwrappedCoordinates(this._source.tileID).map((k=>new l.Z(k.canonical.z,k.wrap,k.canonical.z,k.canonical.x,k.canonical.y))):(p=hr(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(p=p.filter((k=>this._source.hasTile(k))))):p=[],this.usedForTerrain&&(p=this._addTerrainIdealTiles(p));const m=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,m&&this.fire(new l.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const v=Ke(t,this._source),E=this._updateRetainedTiles(p,v),T=ai(this._source.type);T&&this._rasterFadeDuration>0&&!u&&this._updateFadingTiles(p,E),T?this._cleanUpRasterTiles(E):this._cleanUpVectorTiles(E)}_cleanUpRasterTiles(t){for(const u in this._tiles)t[u]||this._removeTile(u)}_cleanUpVectorTiles(t){for(const u in this._tiles){const p=this._tiles[u];t[u]?p.clearSymbolFadeHold():p.hasSymbolBuckets?p.holdingForSymbolFade()?p.symbolFadeFinished()&&this._removeTile(u):p.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(u)}}_addTerrainIdealTiles(t){const u=[];for(const p of t)if(p.canonical.z>this._source.minzoom){const m=p.scaledTo(p.canonical.z-1);u.push(m);const v=p.scaledTo(Math.max(this._source.minzoom,Math.min(p.canonical.z,5)));u.push(v)}return t.concat(u)}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForSymbolFade()&&this._removeTile(t)}_updateRetainedTiles(t,u){var p;const m={},v={},E=Math.max(u-Ot.maxOverzooming,this._source.minzoom);let T={};for(const k of t){const V=this._addTile(k);m[k.key]=k,V.hasData()||(T[k.key]=k)}T=this._retainLoadedChildren(T,m);for(const k in T){const V=T[k];let N=this._tiles[k],$=N?.wasRequested();for(let K=V.overscaledZ-1;K>=E;--K){const X=V.scaledTo(K);if(v[X.key])break;if(v[X.key]=!0,N=this.getTile(X),!N&&$&&(N=this._addTile(X)),N){const re=N.hasData();if((re||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||$)&&(m[X.key]=X),$=N.wasRequested(),re)break}}}return m}_updateFadingTiles(t,u){const p=I.now(),m=l.am(t);for(const v of t){const E=this._tiles[v.key];E.fadingDirection!==ve.Departing&&E.fadeOpacity!==0||E.resetFadeLogic(),this._updateFadingAncestor(E,u,p)||this._updateFadingDescendents(E,u,p)||this._updateFadingEdge(E,m,p)||E.resetFadeLogic()}}_updateFadingAncestor(t,u,p){if(!t.hasData())return!1;const{tileID:m,fadingRole:v,fadingDirection:E,fadingParentID:T}=t;if(v===Nt.Base&&E===ve.Incoming&&T)return u[T.key]=T,!0;const k=Math.max(m.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let V=m.overscaledZ-1;V>=k;V--){const N=m.scaledTo(V),$=this._getLoadedTile(N);if($)return t.setCrossFadeLogic({fadingRole:Nt.Base,fadingDirection:ve.Incoming,fadingParentID:$.tileID,fadeEndTime:p+this._rasterFadeDuration}),$.setCrossFadeLogic({fadingRole:Nt.Parent,fadingDirection:ve.Departing,fadeEndTime:p+this._rasterFadeDuration}),u[N.key]=N,!0}return!1}_updateFadingDescendents(t,u,p){if(!t.hasData())return!1;const m=t.tileID.children(this._source.maxzoom);let v=this._updateFadingChildren(t,m,u,p);if(v)return!0;for(const E of m){const T=E.children(this._source.maxzoom);this._updateFadingChildren(t,T,u,p)&&(v=!0)}return v}_updateFadingChildren(t,u,p,m){if(u[0].overscaledZ>=this._source.maxzoom)return!1;let v=!1;for(const E of u){const T=this._getLoadedTile(E);if(!T)continue;const{fadingRole:k,fadingDirection:V,fadingParentID:N}=T;k===Nt.Base&&V===ve.Departing&&N||(T.setCrossFadeLogic({fadingRole:Nt.Base,fadingDirection:ve.Departing,fadingParentID:t.tileID,fadeEndTime:m+this._rasterFadeDuration}),t.setCrossFadeLogic({fadingRole:Nt.Parent,fadingDirection:ve.Incoming,fadeEndTime:m+this._rasterFadeDuration})),p[E.key]=E,v=!0}return v}_updateFadingEdge(t,u,p){const m=t.tileID;return!!t.selfFading||!t.hasData()&&!!u.has(m)&&(t.setSelfFadeLogic(p+this._rasterFadeDuration),!0)}_addTile(t){let u=this._tiles[t.key];if(u)return u;u=this._cache.getAndRemove(t),u&&(u.resetFadeLogic(),this._setTileReloadTimer(t.key,u),u.tileID=t,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,u)));const p=u;return u||(u=new W(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(u,t.key,u.state)),u.uses++,this._tiles[t.key]=u,p||this._source.fire(new l.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(t,u){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const p=u.getExpiryTimeout();p&&(this._timers[t]=setTimeout((()=>{this._reloadTile(t,"expired"),delete this._timers[t]}),p))}refreshTiles(t){for(const u in this._tiles)(this._isIdRenderable(u)||this._tiles[u].state=="errored")&&t.some((p=>p.equals(this._tiles[u].tileID.canonical)))&&this._reloadTile(u,"expired")}_removeTile(t){const u=this._tiles[t];u&&(u.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(t){t.dataType==="source"&&(t.sourceDataType!=="metadata"?t.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,u,p){const m=[],v=this.transform;if(!v)return m;const E=v.getCoveringTilesDetailsProvider().allowWorldCopies(),T=p?v.getCameraQueryGeometry(t):t,k=X=>v.screenPointToMercatorCoordinate(X,this.terrain),V=this.transformBbox(t,k,!E),N=this.transformBbox(T,k,!E),$=this.getIds(),K=l.a2.fromPoints(N);for(let X=0;X<$.length;X++){const re=this._tiles[$[X]];if(re.holdingForSymbolFade())continue;const le=E?[re.tileID]:[re.tileID.unwrapTo(-1),re.tileID.unwrapTo(0)],ue=Math.pow(2,v.zoom-re.tileID.overscaledZ),ce=u*re.queryPadding*l.$/re.tileSize/ue;for(const be of le){const Ee=K.map((xe=>be.getTilePoint(new l.a1(xe.x,xe.y))));if(Ee.expandBy(ce),Ee.intersects(Cr)){const xe=V.map((Ue=>be.getTilePoint(Ue))),Pe=N.map((Ue=>be.getTilePoint(Ue)));m.push({tile:re,tileID:E?be:be.unwrapTo(0),queryGeometry:xe,cameraQueryGeometry:Pe,scale:ue})}}}return m}transformBbox(t,u,p){let m=t.map(u);if(p){const v=l.a2.fromPoints(t);v.shrinkBy(.001*Math.min(v.width(),v.height()));const E=v.map(u);l.a2.fromPoints(m).covers(E)||(m=m.map((T=>T.x>.5?new l.a1(T.x-1,T.y,T.z):T)))}return m}getVisibleCoordinates(t){const u=this.getRenderableIds(t).map((p=>this._tiles[p].tileID));return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(ai(this._source.type)&&this._rasterFadeDuration>0){const t=I.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=t)return!0}return!1}setRasterFadeDuration(t){this._rasterFadeDuration=t}setFeatureState(t,u,p){this._state.updateState(t=t||"_geojsonTileLayer",u,p)}removeFeatureState(t,u,p){this._state.removeFeatureState(t=t||"_geojsonTileLayer",u,p)}getFeatureState(t,u){return this._state.getState(t=t||"_geojsonTileLayer",u)}setDependencies(t,u,p){const m=this._tiles[t];m&&m.setDependencies(u,p)}reloadTilesForDependencies(t,u){for(const p in this._tiles)this._tiles[p].hasDependency(t,u)&&this._reloadTile(p,"reloading");this._cache.filter((p=>!p.hasDependency(t,u)))}}function mr(g,t){const u=Math.abs(2*g.wrap)-+(g.wrap<0),p=Math.abs(2*t.wrap)-+(t.wrap<0);return g.overscaledZ-t.overscaledZ||p-u||t.canonical.y-g.canonical.y||t.canonical.x-g.canonical.x}function ai(g){return g==="raster"||g==="image"||g==="video"}Ot.maxOverzooming=10,Ot.maxUnderzooming=3;class li{constructor(t,u){this.reset(t,u)}reset(t,u){this.points=t||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=l.ah(t,0,1);let u=1,p=this._distances[u];const m=t*this.paddedLength+this.padding;for(;p<m&&u<this._distances.length;)p=this._distances[++u];const v=u-1,E=this._distances[v],T=p-E,k=T>0?(m-E)/T:0;return this.points[v].mult(1-k).add(this.points[u].mult(k))}}function Wr(g,t){let u=!0;return g==="always"||g!=="never"&&t!=="never"||(u=!1),u}class fi{constructor(t,u,p){const m=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(t/p),this.yCellCount=Math.ceil(u/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)m.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=u,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,u,p,m,v){this._forEachCell(u,p,m,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(m),this.bboxes.push(v)}insertCircle(t,u,p,m){this._forEachCell(u-m,p-m,u+m,p+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(u),this.circles.push(p),this.circles.push(m)}_insertBoxCell(t,u,p,m,v,E){this.boxCells[v].push(E)}_insertCircleCell(t,u,p,m,v,E){this.circleCells[v].push(E)}_query(t,u,p,m,v,E,T){if(p<0||t>this.width||m<0||u>this.height)return[];const k=[];if(t<=0&&u<=0&&this.width<=p&&this.height<=m){if(v)return[{key:null,x1:t,y1:u,x2:p,y2:m}];for(let V=0;V<this.boxKeys.length;V++)k.push({key:this.boxKeys[V],x1:this.bboxes[4*V],y1:this.bboxes[4*V+1],x2:this.bboxes[4*V+2],y2:this.bboxes[4*V+3]});for(let V=0;V<this.circleKeys.length;V++){const N=this.circles[3*V],$=this.circles[3*V+1],K=this.circles[3*V+2];k.push({key:this.circleKeys[V],x1:N-K,y1:$-K,x2:N+K,y2:$+K})}}else this._forEachCell(t,u,p,m,this._queryCell,k,{hitTest:v,overlapMode:E,seenUids:{box:{},circle:{}}},T);return k}query(t,u,p,m){return this._query(t,u,p,m,!1,null)}hitTest(t,u,p,m,v,E){return this._query(t,u,p,m,!0,v,E).length>0}hitTestCircle(t,u,p,m,v){const E=t-p,T=t+p,k=u-p,V=u+p;if(T<0||E>this.width||V<0||k>this.height)return!1;const N=[];return this._forEachCell(E,k,T,V,this._queryCellCircle,N,{hitTest:!0,overlapMode:m,circle:{x:t,y:u,radius:p},seenUids:{box:{},circle:{}}},v),N.length>0}_queryCell(t,u,p,m,v,E,T,k){const{seenUids:V,hitTest:N,overlapMode:$}=T,K=this.boxCells[v];if(K!==null){const re=this.bboxes;for(const le of K)if(!V.box[le]){V.box[le]=!0;const ue=4*le,ce=this.boxKeys[le];if(t<=re[ue+2]&&u<=re[ue+3]&&p>=re[ue+0]&&m>=re[ue+1]&&(!k||k(ce))&&(!N||!Wr($,ce.overlapMode))&&(E.push({key:ce,x1:re[ue],y1:re[ue+1],x2:re[ue+2],y2:re[ue+3]}),N))return!0}}const X=this.circleCells[v];if(X!==null){const re=this.circles;for(const le of X)if(!V.circle[le]){V.circle[le]=!0;const ue=3*le,ce=this.circleKeys[le];if(this._circleAndRectCollide(re[ue],re[ue+1],re[ue+2],t,u,p,m)&&(!k||k(ce))&&(!N||!Wr($,ce.overlapMode))){const be=re[ue],Ee=re[ue+1],xe=re[ue+2];if(E.push({key:ce,x1:be-xe,y1:Ee-xe,x2:be+xe,y2:Ee+xe}),N)return!0}}}return!1}_queryCellCircle(t,u,p,m,v,E,T,k){const{circle:V,seenUids:N,overlapMode:$}=T,K=this.boxCells[v];if(K!==null){const re=this.bboxes;for(const le of K)if(!N.box[le]){N.box[le]=!0;const ue=4*le,ce=this.boxKeys[le];if(this._circleAndRectCollide(V.x,V.y,V.radius,re[ue+0],re[ue+1],re[ue+2],re[ue+3])&&(!k||k(ce))&&!Wr($,ce.overlapMode))return E.push(!0),!0}}const X=this.circleCells[v];if(X!==null){const re=this.circles;for(const le of X)if(!N.circle[le]){N.circle[le]=!0;const ue=3*le,ce=this.circleKeys[le];if(this._circlesCollide(re[ue],re[ue+1],re[ue+2],V.x,V.y,V.radius)&&(!k||k(ce))&&!Wr($,ce.overlapMode))return E.push(!0),!0}}}_forEachCell(t,u,p,m,v,E,T,k){const V=this._convertToXCellCoord(t),N=this._convertToYCellCoord(u),$=this._convertToXCellCoord(p),K=this._convertToYCellCoord(m);for(let X=V;X<=$;X++)for(let re=N;re<=K;re++)if(v.call(this,t,u,p,m,this.xCellCount*re+X,E,T,k))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,u,p,m,v,E){const T=m-t,k=v-u,V=p+E;return V*V>T*T+k*k}_circleAndRectCollide(t,u,p,m,v,E,T){const k=(E-m)/2,V=Math.abs(t-(m+k));if(V>k+p)return!1;const N=(T-v)/2,$=Math.abs(u-(v+N));if($>N+p)return!1;if(V<=k||$<=N)return!0;const K=V-k,X=$-N;return K*K+X*X<=p*p}}function jr(g,t,u){const p=l.L();if(!g){const{vecSouth:$,vecEast:K}=Lr(t),X=w();X[0]=K[0],X[1]=K[1],X[2]=$[0],X[3]=$[1],m=X,(N=(E=(v=X)[0])*(V=v[3])-(k=v[2])*(T=v[1]))&&(m[0]=V*(N=1/N),m[1]=-T*N,m[2]=-k*N,m[3]=E*N),p[0]=X[0],p[1]=X[1],p[4]=X[2],p[5]=X[3]}var m,v,E,T,k,V,N;return l.N(p,p,[1/u,1/u,1]),p}function ei(g,t,u,p){if(g){const m=l.L();if(!t){const{vecSouth:v,vecEast:E}=Lr(u);m[0]=E[0],m[1]=E[1],m[4]=v[0],m[5]=v[1]}return l.N(m,m,[p,p,1]),m}return u.pixelsToClipSpaceMatrix}function Lr(g){const t=Math.cos(g.rollInRadians),u=Math.sin(g.rollInRadians),p=Math.cos(g.pitchInRadians),m=Math.cos(g.bearingInRadians),v=Math.sin(g.bearingInRadians),E=l.ar();E[0]=-m*p*u-v*t,E[1]=-v*p*u+m*t;const T=l.as(E);T<1e-9?l.at(E):l.au(E,E,1/T);const k=l.ar();k[0]=m*p*t-v*u,k[1]=v*p*t+m*u;const V=l.as(k);return V<1e-9?l.at(k):l.au(k,k,1/V),{vecEast:k,vecSouth:E}}function dt(g,t,u,p){let m;p?(m=[g,t,p(g,t),1],l.aw(m,m,u)):(m=[g,t,0,1],Mn(m,m,u));const v=m[3];return{point:new l.P(m[0]/v,m[1]/v),signedDistanceFromCamera:v,isOccluded:!1}}function Bi(g,t){return .5+g/t*.5}function Ci(g,t){return g.x>=-t[0]&&g.x<=t[0]&&g.y>=-t[1]&&g.y<=t[1]}function ki(g,t,u,p,m,v,E,T,k,V,N,$,K){const X=u?g.textSizeData:g.iconSizeData,re=l.an(X,t.transform.zoom),le=[256/t.width*2+1,256/t.height*2+1],ue=u?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;ue.clear();const ce=g.lineVertexArray,be=u?g.text.placedSymbolArray:g.icon.placedSymbolArray,Ee=t.transform.width/t.transform.height;let xe=!1;for(let Pe=0;Pe<be.length;Pe++){const Ue=be.get(Pe);if(Ue.hidden||Ue.writingMode===l.ao.vertical&&!xe){Xi(Ue.numGlyphs,ue);continue}xe=!1;const Ae=new l.P(Ue.anchorX,Ue.anchorY),Fe={getElevation:K,pitchedLabelPlaneMatrix:p,lineVertexArray:ce,pitchWithMap:v,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:Ae,unwrappedTileID:k,width:V,height:N,translation:$},it=ur(Ue.anchorX,Ue.anchorY,Fe);if(!Ci(it.point,le)){Xi(Ue.numGlyphs,ue);continue}const Xe=Bi(t.transform.cameraToCenterDistance,it.signedDistanceFromCamera),Je=l.ap(X,re,Ue),Qe=v?Je*t.transform.getPitchedTextCorrection(Ue.anchorX,Ue.anchorY,k)/Xe:Je*Xe,xt=yr({projectionContext:Fe,pitchedLabelPlaneMatrixInverse:m,symbol:Ue,fontSize:Qe,flip:!1,keepUpright:E,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:ue,aspectRatio:Ee,rotateToLine:T});xe=xt.useVertical,(xt.notEnoughRoom||xe||xt.needsFlipping&&yr({projectionContext:Fe,pitchedLabelPlaneMatrixInverse:m,symbol:Ue,fontSize:Qe,flip:!0,keepUpright:E,glyphOffsetArray:g.glyphOffsetArray,dynamicLayoutVertexArray:ue,aspectRatio:Ee,rotateToLine:T}).notEnoughRoom)&&Xi(Ue.numGlyphs,ue)}u?g.text.dynamicLayoutVertexBuffer.updateData(ue):g.icon.dynamicLayoutVertexBuffer.updateData(ue)}function at(g,t,u,p,m,v,E,T){const k=v.glyphStartIndex+v.numGlyphs,V=v.lineStartIndex,N=v.lineStartIndex+v.lineLength,$=t.getoffsetX(v.glyphStartIndex),K=t.getoffsetX(k-1),X=Bn(g*$,u,p,m,v.segment,V,N,T,E);if(!X)return null;const re=Bn(g*K,u,p,m,v.segment,V,N,T,E);return re?T.projectionCache.anyProjectionOccluded?null:{first:X,last:re}:null}function At(g,t,u,p){return g===l.ao.horizontal&&Math.abs(u.y-t.y)>Math.abs(u.x-t.x)*p?{useVertical:!0}:(g===l.ao.vertical?t.y<u.y:t.x>u.x)?{needsFlipping:!0}:null}function yr(g){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:u,symbol:p,fontSize:m,flip:v,keepUpright:E,glyphOffsetArray:T,dynamicLayoutVertexArray:k,aspectRatio:V,rotateToLine:N}=g,$=m/24,K=p.lineOffsetX*$,X=p.lineOffsetY*$;let re;if(p.numGlyphs>1){const le=p.glyphStartIndex+p.numGlyphs,ue=p.lineStartIndex,ce=p.lineStartIndex+p.lineLength,be=at($,T,K,X,v,p,N,t);if(!be)return{notEnoughRoom:!0};const Ee=Hi(be.first.point.x,be.first.point.y,t,u),xe=Hi(be.last.point.x,be.last.point.y,t,u);if(E&&!v){const Pe=At(p.writingMode,Ee,xe,V);if(Pe)return Pe}re=[be.first];for(let Pe=p.glyphStartIndex+1;Pe<le-1;Pe++){const Ue=Bn($*T.getoffsetX(Pe),K,X,v,p.segment,ue,ce,t,N);if(!Ue)return{notEnoughRoom:!0};re.push(Ue)}re.push(be.last)}else{if(E&&!v){const ue=an(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,ce=p.lineStartIndex+p.segment+1,be=new l.P(t.lineVertexArray.getx(ce),t.lineVertexArray.gety(ce)),Ee=an(be.x,be.y,t),xe=Ee.signedDistanceFromCamera>0?Ee.point:lr(t.tileAnchorPoint,be,ue,1,t),Pe=Hi(ue.x,ue.y,t,u),Ue=Hi(xe.x,xe.y,t,u),Ae=At(p.writingMode,Pe,Ue,V);if(Ae)return Ae}const le=Bn($*T.getoffsetX(p.glyphStartIndex),K,X,v,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,t,N);if(!le||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};re=[le]}for(const le of re)l.av(k,le.point,le.angle);return{}}function lr(g,t,u,p,m){const v=g.add(g.sub(t)._unit()),E=an(v.x,v.y,m).point,T=u.sub(E);return u.add(T._mult(p/T.mag()))}function Ni(g,t,u){const p=t.projectionCache;if(p.projections[g])return p.projections[g];const m=new l.P(t.lineVertexArray.getx(g),t.lineVertexArray.gety(g)),v=an(m.x,m.y,t);if(v.signedDistanceFromCamera>0)return p.projections[g]=v.point,p.anyProjectionOccluded=p.anyProjectionOccluded||v.isOccluded,v.point;const E=g-u.direction;return lr(u.distanceFromAnchor===0?t.tileAnchorPoint:new l.P(t.lineVertexArray.getx(E),t.lineVertexArray.gety(E)),m,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,t)}function an(g,t,u){const p=g+u.translation[0],m=t+u.translation[1];let v;return u.pitchWithMap?(v=dt(p,m,u.pitchedLabelPlaneMatrix,u.getElevation),v.isOccluded=!1):(v=u.transform.projectTileCoordinates(p,m,u.unwrappedTileID,u.getElevation),v.point.x=(.5*v.point.x+.5)*u.width,v.point.y=(.5*-v.point.y+.5)*u.height),v}function Hi(g,t,u,p){if(u.pitchWithMap){const m=[g,t,0,1];return l.aw(m,m,p),u.transform.projectTileCoordinates(m[0]/m[3],m[1]/m[3],u.unwrappedTileID,u.getElevation).point}return{x:g/u.width*2-1,y:1-t/u.height*2}}function ur(g,t,u){return u.transform.projectTileCoordinates(g,t,u.unwrappedTileID,u.getElevation)}function Zn(g,t,u){return g._unit()._perp()._mult(t*u)}function Hn(g,t,u,p,m,v,E,T,k){if(T.projectionCache.offsets[g])return T.projectionCache.offsets[g];const V=u.add(t);if(g+k.direction<p||g+k.direction>=m)return T.projectionCache.offsets[g]=V,V;const N=Ni(g+k.direction,T,k),$=Zn(N.sub(u),E,k.direction),K=u.add($),X=N.add($);return T.projectionCache.offsets[g]=l.ax(v,V,K,X)||V,T.projectionCache.offsets[g]}function Bn(g,t,u,p,m,v,E,T,k){const V=p?g-t:g+t;let N=V>0?1:-1,$=0;p&&(N*=-1,$=Math.PI),N<0&&($+=Math.PI);let K,X=N>0?v+m:v+m+1;T.projectionCache.cachedAnchorPoint?K=T.projectionCache.cachedAnchorPoint:(K=an(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=K);let re,le,ue=K,ce=K,be=0,Ee=0;const xe=Math.abs(V),Pe=[];let Ue;for(;be+Ee<=xe;){if(X+=N,X<v||X>=E)return null;be+=Ee,ce=ue,le=re;const it={absOffsetX:xe,direction:N,distanceFromAnchor:be,previousVertex:ce};if(ue=Ni(X,T,it),u===0)Pe.push(ce),Ue=ue.sub(ce);else{let Xe;const Je=ue.sub(ce);Xe=Je.mag()===0?Zn(Ni(X+N,T,it).sub(ue),u,N):Zn(Je,u,N),le||(le=ce.add(Xe)),re=Hn(X,Xe,ue,v,E,le,u,T,it),Pe.push(le),Ue=re.sub(le)}Ee=Ue.mag()}const Ae=Ue._mult((xe-be)/Ee)._add(le||ce),Fe=$+Math.atan2(ue.y-ce.y,ue.x-ce.x);return Pe.push(Ae),{point:Ae,angle:k?Fe:0,path:Pe}}const ds=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Xi(g,t){for(let u=0;u<g;u++){const p=t.length;t.resize(p+4),t.float32.set(ds,3*p)}}function Mn(g,t,u){const p=t[0],m=t[1];return g[0]=u[0]*p+u[4]*m+u[12],g[1]=u[1]*p+u[5]*m+u[13],g[3]=u[3]*p+u[7]*m+u[15],g}const ui=100;class Mi{constructor(t,u=new fi(t.width+200,t.height+200,25),p=new fi(t.width+200,t.height+200,25)){this.transform=t,this.grid=u,this.ignoredGrid=p,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+ui,this.screenBottomBoundary=t.height+ui,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,u,p,m,v,E,T,k,V,N,$,K){const X=this.projectAndGetPerspectiveRatio(t.anchorPointX+k[0],t.anchorPointY+k[1],v,N,K),re=p*X.perspectiveRatio;let le;if(E||T)le=this._projectCollisionBox(t,re,m,v,E,T,k,X,N,$,K);else{const Ue=X.x+($?$.x*re:0),Ae=X.y+($?$.y*re:0);le={allPointsOccluded:!1,box:[Ue+t.x1*re,Ae+t.y1*re,Ue+t.x2*re,Ae+t.y2*re]}}const[ue,ce,be,Ee]=le.box,xe=E?le.allPointsOccluded:X.isOccluded;let Pe=xe;return Pe||(Pe=X.perspectiveRatio<this.perspectiveRatioCutoff),Pe||(Pe=!this.isInsideGrid(ue,ce,be,Ee)),Pe||u!=="always"&&this.grid.hitTest(ue,ce,be,Ee,u,V)?{box:[ue,ce,be,Ee],placeable:!1,offscreen:!1,occluded:xe}:{box:[ue,ce,be,Ee],placeable:!0,offscreen:this.isOffscreen(ue,ce,be,Ee),occluded:xe}}placeCollisionCircles(t,u,p,m,v,E,T,k,V,N,$,K,X,re){const le=[],ue=new l.P(u.anchorX,u.anchorY),ce=this.getPerspectiveRatio(ue.x,ue.y,E,re),be=(V?v*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,E)/ce:v*ce)/l.aB,Ee={getElevation:re,pitchedLabelPlaneMatrix:T,lineVertexArray:p,pitchWithMap:V,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ue,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:X},xe=at(be,m,u.lineOffsetX*be,u.lineOffsetY*be,!1,u,!1,Ee);let Pe=!1,Ue=!1,Ae=!0;if(xe){const Fe=.5*$*ce+K,it=new l.P(-100,-100),Xe=new l.P(this.screenRightBoundary,this.screenBottomBoundary),Je=new li,Qe=xe.first,xt=xe.last;let wt=[];for(let fr=Qe.path.length-1;fr>=1;fr--)wt.push(Qe.path[fr]);for(let fr=1;fr<xt.path.length;fr++)wt.push(xt.path[fr]);const pt=2.5*Fe;if(V){const fr=this.projectPathToScreenSpace(wt,Ee);wt=fr.some((Yr=>Yr.signedDistanceFromCamera<=0))?[]:fr.map((Yr=>Yr.point))}let jt=[];if(wt.length>0){const fr=wt[0].clone(),Yr=wt[0].clone();for(let Jr=1;Jr<wt.length;Jr++)fr.x=Math.min(fr.x,wt[Jr].x),fr.y=Math.min(fr.y,wt[Jr].y),Yr.x=Math.max(Yr.x,wt[Jr].x),Yr.y=Math.max(Yr.y,wt[Jr].y);jt=fr.x>=it.x&&Yr.x<=Xe.x&&fr.y>=it.y&&Yr.y<=Xe.y?[wt]:Yr.x<it.x||fr.x>Xe.x||Yr.y<it.y||fr.y>Xe.y?[]:l.ay([wt],it.x,it.y,Xe.x,Xe.y)}for(const fr of jt){Je.reset(fr,.25*Fe);let Yr=0;Yr=Je.length<=.5*Fe?1:Math.ceil(Je.paddedLength/pt)+1;for(let Jr=0;Jr<Yr;Jr++){const ii=Jr/Math.max(Yr-1,1),xi=Je.lerp(ii),di=xi.x+ui,Vr=xi.y+ui;le.push(di,Vr,Fe,0);const gi=di-Fe,pn=Vr-Fe,Oi=di+Fe,Vi=Vr+Fe;if(Ae=Ae&&this.isOffscreen(gi,pn,Oi,Vi),Ue=Ue||this.isInsideGrid(gi,pn,Oi,Vi),t!=="always"&&this.grid.hitTestCircle(di,Vr,Fe,t,N)&&(Pe=!0,!k))return{circles:[],offscreen:!1,collisionDetected:Pe}}}}return{circles:!k&&Pe||!Ue||ce<this.perspectiveRatioCutoff?[]:le,offscreen:Ae,collisionDetected:Pe}}projectPathToScreenSpace(t,u){const p=(function(m,v){const E=l.L();return l.aq(E,v.pitchedLabelPlaneMatrix),m.map((T=>{const k=dt(T.x,T.y,E,v.getElevation),V=v.transform.projectTileCoordinates(k.point.x,k.point.y,v.unwrappedTileID,v.getElevation);return V.point.x=(.5*V.point.x+.5)*v.width,V.point.y=(.5*-V.point.y+.5)*v.height,V}))})(t,u);return(function(m){let v=0,E=0,T=0,k=0;for(let V=0;V<m.length;V++)m[V].isOccluded?(T=V+1,k=0):(k++,k>E&&(E=k,v=T));return m.slice(v,v+E)})(p)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[],p=new l.a2;for(const $ of t){const K=new l.P($.x+ui,$.y+ui);p.extend(K),u.push(K)}const{minX:m,minY:v,maxX:E,maxY:T}=p,k=this.grid.query(m,v,E,T).concat(this.ignoredGrid.query(m,v,E,T)),V={},N={};for(const $ of k){const K=$.key;if(V[K.bucketInstanceId]===void 0&&(V[K.bucketInstanceId]={}),V[K.bucketInstanceId][K.featureIndex])continue;const X=[new l.P($.x1,$.y1),new l.P($.x2,$.y1),new l.P($.x2,$.y2),new l.P($.x1,$.y2)];l.az(u,X)&&(V[K.bucketInstanceId][K.featureIndex]=!0,N[K.bucketInstanceId]===void 0&&(N[K.bucketInstanceId]=[]),N[K.bucketInstanceId].push(K.featureIndex))}return N}insertCollisionBox(t,u,p,m,v,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:v,collisionGroupID:E,overlapMode:u},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,u,p,m,v,E){const T=p?this.ignoredGrid:this.grid,k={bucketInstanceId:m,featureIndex:v,collisionGroupID:E,overlapMode:u};for(let V=0;V<t.length;V+=4)T.insertCircle(k,t[V],t[V+1],t[V+2])}projectAndGetPerspectiveRatio(t,u,p,m,v){if(v){let E;m?(E=[t,u,m(t,u),1],l.aw(E,E,v)):(E=[t,u,0,1],Mn(E,E,v));const T=E[3];return{x:(E[0]/T+1)/2*this.transform.width+ui,y:(-E[1]/T+1)/2*this.transform.height+ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/T*.5,isOccluded:!1,signedDistanceFromCamera:T}}{const E=this.transform.projectTileCoordinates(t,u,p,m);return{x:(E.point.x+1)/2*this.transform.width+ui,y:(1-E.point.y)/2*this.transform.height+ui,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(t,u,p,m){const v=this.transform.projectTileCoordinates(t,u,p,m);return .5+this.transform.cameraToCenterDistance/v.signedDistanceFromCamera*.5}isOffscreen(t,u,p,m){return p<ui||t>=this.screenRightBoundary||m<ui||u>this.screenBottomBoundary}isInsideGrid(t,u,p,m){return p>=0&&t<this.gridRightBoundary&&m>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const t=l.ag([]);return l.M(t,t,[-100,-100,0]),t}_projectCollisionBox(t,u,p,m,v,E,T,k,V,N,$){let K=1,X=0,re=0,le=1;const ue=t.anchorPointX+T[0],ce=t.anchorPointY+T[1];if(E&&!v){const wt=this.projectAndGetPerspectiveRatio(ue+1,ce,m,V,$),pt=wt.x-k.x,jt=Math.atan((wt.y-k.y)/pt)+(pt<0?Math.PI:0),fr=Math.sin(jt),Yr=Math.cos(jt);K=Yr,X=fr,re=-fr,le=Yr}else if(!E&&v){const wt=Lr(this.transform);K=wt.vecEast[0],X=wt.vecEast[1],re=wt.vecSouth[0],le=wt.vecSouth[1]}let be=k.x,Ee=k.y,xe=u;v&&(be=ue,Ee=ce,xe=Math.pow(2,-(this.transform.zoom-p.overscaledZ)),xe*=this.transform.getPitchedTextCorrection(ue,ce,m),N||(xe*=l.ah(.5+k.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),N&&(be+=K*N.x*xe+re*N.y*xe,Ee+=X*N.x*xe+le*N.y*xe);const Pe=t.x1*xe,Ue=t.x2*xe,Ae=(Pe+Ue)/2,Fe=t.y1*xe,it=t.y2*xe,Xe=(Fe+it)/2,Je=[{offsetX:Pe,offsetY:Fe},{offsetX:Ae,offsetY:Fe},{offsetX:Ue,offsetY:Fe},{offsetX:Ue,offsetY:Xe},{offsetX:Ue,offsetY:it},{offsetX:Ae,offsetY:it},{offsetX:Pe,offsetY:it},{offsetX:Pe,offsetY:Xe}];let Qe=[];for(const{offsetX:wt,offsetY:pt}of Je)Qe.push(new l.P(be+K*wt+re*pt,Ee+X*wt+le*pt));let xt=!1;if(v){const wt=Qe.map((pt=>this.projectAndGetPerspectiveRatio(pt.x,pt.y,m,V,$)));xt=wt.some((pt=>!pt.isOccluded)),Qe=wt.map((pt=>new l.P(pt.x,pt.y)))}else xt=!0;return{box:l.aA(Qe),allPointsOccluded:!xt}}}class Zr{constructor(t,u,p,m){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?u:-u))):m&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ps{constructor(t,u,p,m,v){this.text=new Zr(t?t.text:null,u,p,v),this.icon=new Zr(t?t.icon:null,u,m,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class zn{constructor(t,u,p){this.text=t,this.icon=u,this.skipFade=p}}class Zs{constructor(t,u,p,m,v){this.bucketInstanceId=t,this.featureIndex=u,this.sourceLayerIndex=p,this.bucketIndex=m,this.tileID=v}}class Te{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const u=++this.maxGroupID;this.collisionGroups[t]={ID:u,predicate:p=>p.collisionGroupID===u}}return this.collisionGroups[t]}}function U(g,t,u,p,m){const{horizontalAlign:v,verticalAlign:E}=l.aH(g);return new l.P(-(v-.5)*t+p[0]*m,-(E-.5)*u+p[1]*m)}class te{constructor(t,u,p,m,v){this.transform=t.clone(),this.terrain=u,this.collisionIndex=new Mi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Te(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const u=this.terrain;return u?(p,m)=>u.getElevation(t,p,m):null}getBucketParts(t,u,p,m){const v=p.getBucket(u),E=p.latestFeatureIndex;if(!v||!E||u.id!==v.layerIds[0])return;const T=p.collisionBoxArray,k=v.layers[0].layout,V=v.layers[0].paint,N=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),$=p.tileSize/l.$,K=p.tileID.toUnwrapped(),X=k.get("text-rotation-alignment")==="map",re=l.aC(p,1,this.transform.zoom),le=l.aD(this.collisionIndex.transform,p,V.get("text-translate"),V.get("text-translate-anchor")),ue=l.aD(this.collisionIndex.transform,p,V.get("icon-translate"),V.get("icon-translate-anchor")),ce=jr(X,this.transform,re);this.retainedQueryData[v.bucketInstanceId]=new Zs(v.bucketInstanceId,E,v.sourceLayerIndex,v.index,p.tileID);const be={bucket:v,layout:k,translationText:le,translationIcon:ue,unwrappedTileID:K,pitchedLabelPlaneMatrix:ce,scale:N,textPixelRatio:$,holdingForFade:p.holdingForSymbolFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:l.an(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(m)for(const Ee of v.sortKeyRanges){const{sortKey:xe,symbolInstanceStart:Pe,symbolInstanceEnd:Ue}=Ee;t.push({sortKey:xe,symbolInstanceStart:Pe,symbolInstanceEnd:Ue,parameters:be})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:be})}attemptAnchorPlacement(t,u,p,m,v,E,T,k,V,N,$,K,X,re,le,ue,ce,be,Ee,xe){const Pe=l.aE[t.textAnchor],Ue=[t.textOffset0,t.textOffset1],Ae=U(Pe,p,m,Ue,v),Fe=this.collisionIndex.placeCollisionBox(u,K,k,V,N,T,E,ue,$.predicate,Ee,Ae,xe);if((!be||this.collisionIndex.placeCollisionBox(be,K,k,V,N,T,E,ce,$.predicate,Ee,Ae,xe).placeable)&&Fe.placeable){let it;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(it=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:Ue,width:p,height:m,anchor:Pe,textBoxScale:v,prevAnchor:it},this.markUsedJustification(re,Pe,X,le),re.allowVerticalPlacement&&(this.markUsedOrientation(re,le,X),this.placedOrientations[X.crossTileID]=le),{shift:Ae,placedGlyphBoxes:Fe}}}placeLayerBucketPart(t,u,p){const{bucket:m,layout:v,translationText:E,translationIcon:T,unwrappedTileID:k,pitchedLabelPlaneMatrix:V,textPixelRatio:N,holdingForFade:$,collisionBoxArray:K,partiallyEvaluatedTextSize:X,collisionGroup:re}=t.parameters,le=v.get("text-optional"),ue=v.get("icon-optional"),ce=l.aF(v,"text-overlap","text-allow-overlap"),be=ce==="always",Ee=l.aF(v,"icon-overlap","icon-allow-overlap"),xe=Ee==="always",Pe=v.get("text-rotation-alignment")==="map",Ue=v.get("text-pitch-alignment")==="map",Ae=v.get("icon-text-fit")!=="none",Fe=v.get("symbol-z-order")==="viewport-y",it=be&&(xe||!m.hasIconData()||ue),Xe=xe&&(be||!m.hasTextData()||le);!m.collisionArrays&&K&&m.deserializeCollisionBoxes(K);const Je=this.retainedQueryData[m.bucketInstanceId].tileID,Qe=this._getTerrainElevationFunc(Je),xt=this.transform.getFastPathSimpleProjectionMatrix(Je),wt=(pt,jt,fr)=>{var Yr,Jr;if(u[pt.crossTileID])return;if($)return void(this.placements[pt.crossTileID]=new zn(!1,!1,!1));let ii=!1,xi=!1,di=!0,Vr=null,gi={box:null,placeable:!1,offscreen:null,occluded:!1},pn={placeable:!1},Oi=null,Vi=null,Cn=null,jo=0,Ps=0,No=0;jt.textFeatureIndex?jo=jt.textFeatureIndex:pt.useRuntimeCollisionCircles&&(jo=pt.featureIndex),jt.verticalTextFeatureIndex&&(Ps=jt.verticalTextFeatureIndex);const Ra=jt.textBox;if(Ra){const Wn=Di=>{let Ki=l.ao.horizontal;if(m.allowVerticalPlacement&&!Di&&this.prevPlacement){const Jn=this.prevPlacement.placedOrientations[pt.crossTileID];Jn&&(this.placedOrientations[pt.crossTileID]=Jn,Ki=Jn,this.markUsedOrientation(m,Ki,pt))}return Ki},Ys=(Di,Ki)=>{if(m.allowVerticalPlacement&&pt.numVerticalGlyphVertices>0&&jt.verticalTextBox){for(const Jn of m.writingModes)if(Jn===l.ao.vertical?(gi=Ki(),pn=gi):gi=Di(),gi&&gi.placeable)break}else gi=Di()},Js=pt.textAnchorOffsetStartIndex,Yn=pt.textAnchorOffsetEndIndex;if(Yn===Js){const Di=(Ki,Jn)=>{const Qi=this.collisionIndex.placeCollisionBox(Ki,ce,N,Je,k,Ue,Pe,E,re.predicate,Qe,void 0,xt);return Qi&&Qi.placeable&&(this.markUsedOrientation(m,Jn,pt),this.placedOrientations[pt.crossTileID]=Jn),Qi};Ys((()=>Di(Ra,l.ao.horizontal)),(()=>{const Ki=jt.verticalTextBox;return m.allowVerticalPlacement&&pt.numVerticalGlyphVertices>0&&Ki?Di(Ki,l.ao.vertical):{box:null,offscreen:null}})),Wn(gi&&gi.placeable)}else{let Di=l.aE[(Jr=(Yr=this.prevPlacement)===null||Yr===void 0?void 0:Yr.variableOffsets[pt.crossTileID])===null||Jr===void 0?void 0:Jr.anchor];const Ki=(Qi,Bf,Ru)=>{const Sa=Qi.x2-Qi.x1,fo=Qi.y2-Qi.y1,Ls=pt.textBoxScale,Fo=Ae&&Ee==="never"?Bf:null;let qo=null,Mf=ce==="never"?1:2,zf="never";Di&&Mf++;for(let Ko=0;Ko<Mf;Ko++){for(let Of=Js;Of<Yn;Of++){const Vf=m.textAnchorOffsets.get(Of);if(Di&&Vf.textAnchor!==Di)continue;const Su=this.attemptAnchorPlacement(Vf,Qi,Sa,fo,Ls,Pe,Ue,N,Je,k,re,zf,pt,m,Ru,E,T,Fo,Qe);if(Su&&(qo=Su.placedGlyphBoxes,qo&&qo.placeable))return ii=!0,Vr=Su.shift,qo}Di?Di=null:zf=ce}return p&&!qo&&(qo={box:this.collisionIndex.placeCollisionBox(Ra,"always",N,Je,k,Ue,Pe,E,re.predicate,Qe,void 0,xt).box,offscreen:!1,placeable:!1,occluded:!1}),qo};Ys((()=>Ki(Ra,jt.iconBox,l.ao.horizontal)),(()=>{const Qi=jt.verticalTextBox;return m.allowVerticalPlacement&&(!gi||!gi.placeable)&&pt.numVerticalGlyphVertices>0&&Qi?Ki(Qi,jt.verticalIconBox,l.ao.vertical):{box:null,occluded:!0,offscreen:null}})),gi&&(ii=gi.placeable,di=gi.offscreen);const Jn=Wn(gi&&gi.placeable);if(!ii&&this.prevPlacement){const Qi=this.prevPlacement.variableOffsets[pt.crossTileID];Qi&&(this.variableOffsets[pt.crossTileID]=Qi,this.markUsedJustification(m,Qi.anchor,pt,Jn))}}}if(Oi=gi,ii=Oi&&Oi.placeable,di=Oi&&Oi.offscreen,pt.useRuntimeCollisionCircles&&pt.centerJustifiedTextSymbolIndex>=0){const Wn=m.text.placedSymbolArray.get(pt.centerJustifiedTextSymbolIndex),Ys=l.ap(m.textSizeData,X,Wn),Js=v.get("text-padding");Vi=this.collisionIndex.placeCollisionCircles(ce,Wn,m.lineVertexArray,m.glyphOffsetArray,Ys,k,V,p,Ue,re.predicate,pt.collisionCircleDiameter,Js,E,Qe),Vi.circles.length&&Vi.collisionDetected&&!p&&l.w("Collisions detected, but collision boxes are not shown"),ii=be||Vi.circles.length>0&&!Vi.collisionDetected,di=di&&Vi.offscreen}if(jt.iconFeatureIndex&&(No=jt.iconFeatureIndex),jt.iconBox){const Wn=Ys=>this.collisionIndex.placeCollisionBox(Ys,Ee,N,Je,k,Ue,Pe,T,re.predicate,Qe,Ae&&Vr?Vr:void 0,xt);pn&&pn.placeable&&jt.verticalIconBox?(Cn=Wn(jt.verticalIconBox),xi=Cn.placeable):(Cn=Wn(jt.iconBox),xi=Cn.placeable),di=di&&Cn.offscreen}const ld=le||pt.numHorizontalGlyphVertices===0&&pt.numVerticalGlyphVertices===0,ml=ue||pt.numIconVertices===0;ld||ml?ml?ld||(xi=xi&&ii):ii=xi&&ii:xi=ii=xi&&ii;const po=xi&&Cn.placeable;if(ii&&Oi.placeable&&this.collisionIndex.insertCollisionBox(Oi.box,ce,v.get("text-ignore-placement"),m.bucketInstanceId,pn&&pn.placeable&&Ps?Ps:jo,re.ID),po&&this.collisionIndex.insertCollisionBox(Cn.box,Ee,v.get("icon-ignore-placement"),m.bucketInstanceId,No,re.ID),Vi&&ii&&this.collisionIndex.insertCollisionCircles(Vi.circles,ce,v.get("text-ignore-placement"),m.bucketInstanceId,jo,re.ID),p&&this.storeCollisionData(m.bucketInstanceId,fr,jt,Oi,Cn,Vi),pt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(m.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[pt.crossTileID]=new zn((ii||it)&&!Oi?.occluded,(xi||Xe)&&!Cn?.occluded,di||m.justReloaded),u[pt.crossTileID]=!0};if(Fe){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const pt=m.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let jt=pt.length-1;jt>=0;--jt){const fr=pt[jt];wt(m.symbolInstances.get(fr),m.collisionArrays[fr],fr)}}else for(let pt=t.symbolInstanceStart;pt<t.symbolInstanceEnd;pt++)wt(m.symbolInstances.get(pt),m.collisionArrays[pt],pt);m.justReloaded=!1}storeCollisionData(t,u,p,m,v,E){if(p.textBox||p.iconBox){let T,k;this.collisionBoxArrays.has(t)?T=this.collisionBoxArrays.get(t):(T=new Map,this.collisionBoxArrays.set(t,T)),T.has(u)?k=T.get(u):(k={text:null,icon:null},T.set(u,k)),p.textBox&&(k.text=m.box),p.iconBox&&(k.icon=v.box)}if(E){let T=this.collisionCircleArrays[t];T===void 0&&(T=this.collisionCircleArrays[t]=[]);for(let k=0;k<E.circles.length;k+=4)T.push(E.circles[k+0]-ui),T.push(E.circles[k+1]-ui),T.push(E.circles[k+2]),T.push(E.collisionDetected?1:0)}}markUsedJustification(t,u,p,m){let v;v=m===l.ao.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[l.aG(u)];const E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const T of E)T>=0&&(t.text.placedSymbolArray.get(T).crossTileID=v>=0&&T!==v?0:p.crossTileID)}markUsedOrientation(t,u,p){const m=u===l.ao.horizontal||u===l.ao.horizontalOnly?u:0,v=u===l.ao.vertical?u:0,E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const T of E)t.text.placedSymbolArray.get(T).placedOrientation=m;p.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let p=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const m=u?u.symbolFadeChange(t):1,v=u?u.opacities:{},E=u?u.variableOffsets:{},T=u?u.placedOrientations:{};for(const k in this.placements){const V=this.placements[k],N=v[k];N?(this.opacities[k]=new ps(N,m,V.text,V.icon),p=p||V.text!==N.text.placed||V.icon!==N.icon.placed):(this.opacities[k]=new ps(null,m,V.text,V.icon,V.skipFade),p=p||V.text||V.icon)}for(const k in v){const V=v[k];if(!this.opacities[k]){const N=new ps(V,m,!1,!1);N.isHidden()||(this.opacities[k]=N,p=p||V.text.placed||V.icon.placed)}}for(const k in E)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=E[k]);for(const k in T)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=T[k]);if(u&&u.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:t)}updateLayerOpacities(t,u){const p={};for(const m of u){const v=m.getBucket(t);v&&m.latestFeatureIndex&&t.id===v.layerIds[0]&&this.updateBucketOpacities(v,m.tileID,p,m.collisionBoxArray)}}updateBucketOpacities(t,u,p,m){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const v=t.layers[0],E=v.layout,T=new ps(null,0,!1,!1,!0),k=E.get("text-allow-overlap"),V=E.get("icon-allow-overlap"),N=v._unevaluatedLayout.hasValue("text-variable-anchor")||v._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$=E.get("text-rotation-alignment")==="map",K=E.get("text-pitch-alignment")==="map",X=E.get("icon-text-fit")!=="none",re=new ps(null,0,k&&(V||!t.hasIconData()||E.get("icon-optional")),V&&(k||!t.hasTextData()||E.get("text-optional")),!0);!t.collisionArrays&&m&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(m);const le=(ce,be,Ee)=>{for(let xe=0;xe<be/4;xe++)ce.opacityVertexArray.emplaceBack(Ee);ce.hasVisibleVertices=ce.hasVisibleVertices||Ee!==Rn},ue=this.collisionBoxArrays.get(t.bucketInstanceId);for(let ce=0;ce<t.symbolInstances.length;ce++){const be=t.symbolInstances.get(ce),{numHorizontalGlyphVertices:Ee,numVerticalGlyphVertices:xe,crossTileID:Pe}=be;let Ue=this.opacities[Pe];p[Pe]?Ue=T:Ue||(Ue=re,this.opacities[Pe]=Ue),p[Pe]=!0;const Ae=be.numIconVertices>0,Fe=this.placedOrientations[be.crossTileID],it=Fe===l.ao.vertical,Xe=Fe===l.ao.horizontal||Fe===l.ao.horizontalOnly;if(Ee>0||xe>0){const Qe=zi(Ue.text);le(t.text,Ee,it?Rn:Qe),le(t.text,xe,Xe?Rn:Qe);const xt=Ue.text.isHidden();[be.rightJustifiedTextSymbolIndex,be.centerJustifiedTextSymbolIndex,be.leftJustifiedTextSymbolIndex].forEach((jt=>{jt>=0&&(t.text.placedSymbolArray.get(jt).hidden=xt||it?1:0)})),be.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(be.verticalPlacedTextSymbolIndex).hidden=xt||Xe?1:0);const wt=this.variableOffsets[be.crossTileID];wt&&this.markUsedJustification(t,wt.anchor,be,Fe);const pt=this.placedOrientations[be.crossTileID];pt&&(this.markUsedJustification(t,"left",be,pt),this.markUsedOrientation(t,pt,be))}if(Ae){const Qe=zi(Ue.icon),xt=!(X&&be.verticalPlacedIconSymbolIndex&&it);be.placedIconSymbolIndex>=0&&(le(t.icon,be.numIconVertices,xt?Qe:Rn),t.icon.placedSymbolArray.get(be.placedIconSymbolIndex).hidden=Ue.icon.isHidden()),be.verticalPlacedIconSymbolIndex>=0&&(le(t.icon,be.numVerticalIconVertices,xt?Rn:Qe),t.icon.placedSymbolArray.get(be.verticalPlacedIconSymbolIndex).hidden=Ue.icon.isHidden())}const Je=ue&&ue.has(ce)?ue.get(ce):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Qe=t.collisionArrays[ce];if(Qe){let xt=new l.P(0,0);if(Qe.textBox||Qe.verticalTextBox){let wt=!0;if(N){const pt=this.variableOffsets[Pe];pt?(xt=U(pt.anchor,pt.width,pt.height,pt.textOffset,pt.textBoxScale),$&&xt._rotate(K?-this.transform.bearingInRadians:this.transform.bearingInRadians)):wt=!1}if(Qe.textBox||Qe.verticalTextBox){let pt;Qe.textBox&&(pt=it),Qe.verticalTextBox&&(pt=Xe),oe(t.textCollisionBox.collisionVertexArray,Ue.text.placed,!wt||pt,Je.text,xt.x,xt.y)}}if(Qe.iconBox||Qe.verticalIconBox){const wt=!!(!Xe&&Qe.verticalIconBox);let pt;Qe.iconBox&&(pt=wt),Qe.verticalIconBox&&(pt=!wt),oe(t.iconCollisionBox.collisionVertexArray,Ue.icon.placed,pt,Je.icon,X?xt.x:0,X?xt.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,u){const p=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*p>t}setStale(){this.stale=!0}}function oe(g,t,u,p,m,v){p&&p.length!==0||(p=[0,0,0,0]);const E=p[0]-ui,T=p[1]-ui,k=p[2]-ui,V=p[3]-ui;g.emplaceBack(t?1:0,u?1:0,m||0,v||0,E,T),g.emplaceBack(t?1:0,u?1:0,m||0,v||0,k,T),g.emplaceBack(t?1:0,u?1:0,m||0,v||0,k,V),g.emplaceBack(t?1:0,u?1:0,m||0,v||0,E,V)}const ke=Math.pow(2,25),De=Math.pow(2,24),Et=Math.pow(2,17),ft=Math.pow(2,16),$t=Math.pow(2,9),Wt=Math.pow(2,8),vr=Math.pow(2,1);function zi(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const t=g.placed?1:0,u=Math.floor(127*g.opacity);return u*ke+t*De+u*Et+t*ft+u*$t+t*Wt+u*vr+t}const Rn=0;class Bt{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,u,p,m,v){const E=this._bucketParts;for(;this._currentTileIndex<t.length;)if(u.getBucketParts(E,m,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort(((T,k)=>T.sortKey-k.sortKey)));this._currentPartIndex<E.length;)if(u.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,v())return!0;return!1}}class P{constructor(t,u,p,m,v,E,T,k){this.placement=new te(t,u,E,T,k),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(t,u,p){const m=I.now(),v=()=>!this._forceFullPlacement&&I.now()-m>2;for(;this._currentPlacementIndex>=0;){const E=u[t[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=T)&&(!E.maxzoom||E.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Bt(E)),this._inProgressLayer.continuePlacement(p[E.source],this.placement,this._showCollisionBoxes,E,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const B=512/l.$/2;class Ve{constructor(t,u,p){this.tileID=t,this.bucketInstanceId=p,this._symbolsByKey={};const m=new Map;for(let v=0;v<u.length;v++){const E=u.get(v),T=E.key,k=m.get(T);k?k.push(E):m.set(T,[E])}for(const[v,E]of m){const T={positions:E.map((k=>({x:Math.floor(k.anchorX*B),y:Math.floor(k.anchorY*B)}))),crossTileIDs:E.map((k=>k.crossTileID))};if(T.positions.length>128){const k=new l.aI(T.positions.length,16,Uint16Array);for(const{x:V,y:N}of T.positions)k.add(V,N);k.finish(),delete T.positions,T.index=k}this._symbolsByKey[v]=T}}getScaledCoordinates(t,u){const{x:p,y:m,z:v}=this.tileID.canonical,{x:E,y:T,z:k}=u.canonical,V=B/Math.pow(2,k-v),N=(T*l.$+t.anchorY)*V,$=m*l.$*B;return{x:Math.floor((E*l.$+t.anchorX)*V-p*l.$*B),y:Math.floor(N-$)}}findMatches(t,u,p){const m=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let v=0;v<t.length;v++){const E=t.get(v);if(E.crossTileID)continue;const T=this._symbolsByKey[E.key];if(!T)continue;const k=this.getScaledCoordinates(E,u);if(T.index){const V=T.index.range(k.x-m,k.y-m,k.x+m,k.y+m).sort();for(const N of V){const $=T.crossTileIDs[N];if(!p[$]){p[$]=!0,E.crossTileID=$;break}}}else if(T.positions)for(let V=0;V<T.positions.length;V++){const N=T.positions[V],$=T.crossTileIDs[V];if(Math.abs(N.x-k.x)<=m&&Math.abs(N.y-k.y)<=m&&!p[$]){p[$]=!0,E.crossTileID=$;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:t})=>t))}}class ut{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class _r{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const u=Math.round((t-this.lng)/360);if(u!==0)for(const p in this.indexes){const m=this.indexes[p],v={};for(const E in m){const T=m[E];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+u),v[T.tileID.key]=T}this.indexes[p]=v}this.lng=t}addBucket(t,u,p){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let v=0;v<u.symbolInstances.length;v++)u.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const m=this.usedCrossTileIDs[t.overscaledZ];for(const v in this.indexes){const E=this.indexes[v];if(Number(v)>t.overscaledZ)for(const T in E){const k=E[T];k.tileID.isChildOf(t)&&k.findMatches(u.symbolInstances,t,m)}else{const T=E[t.scaledTo(Number(v)).key];T&&T.findMatches(u.symbolInstances,t,m)}}for(let v=0;v<u.symbolInstances.length;v++){const E=u.symbolInstances.get(v);E.crossTileID||(E.crossTileID=p.generate(),m[E.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Ve(t,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(t,u){for(const p of u.getCrossTileIDsLists())for(const m of p)delete this.usedCrossTileIDs[t][m]}removeStaleBuckets(t){let u=!1;for(const p in this.indexes){const m=this.indexes[p];for(const v in m)t[m[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,m[v]),delete m[v],u=!0)}return u}}class Do{constructor(){this.layerIndexes={},this.crossTileIDs=new ut,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,u,p){let m=this.layerIndexes[t.id];m===void 0&&(m=this.layerIndexes[t.id]=new _r);let v=!1;const E={};m.handleWrapJump(p);for(const T of u){const k=T.getBucket(t);k&&t.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(T.tileID,k,this.crossTileIDs)&&(v=!0),E[k.bucketInstanceId]=!0)}return m.removeStaleBuckets(E)&&(v=!0),v}pruneUnusedLayers(t){const u={};t.forEach((p=>{u[p]=!0}));for(const p in this.layerIndexes)u[p]||delete this.layerIndexes[p]}}var Ql="void main() {fragColor=vec4(1.0);}";const ln={prelude:kr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:kr("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:kr("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:kr(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:kr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:kr(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:kr(Ql,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:kr(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:kr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:kr("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:kr("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:kr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:kr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:kr(Ql,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:kr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:kr(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:kr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:kr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:kr(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:kr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:kr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:kr(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:kr(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:kr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:kr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:kr(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:kr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:kr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:kr(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:kr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:kr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:kr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:kr("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:kr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:kr("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:kr(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:kr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function kr(g,t){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=t.match(/in ([\w]+) ([\w]+)/g),m=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=v?v.concat(m):m,T={};return{fragmentSource:g=g.replace(u,((k,V,N,$,K)=>(T[K]=!0,V==="define"?`
#ifndef HAS_UNIFORM_u_${K}
in ${N} ${$} ${K};
#else
uniform ${N} ${$} u_${K};
#endif
`:`
#ifdef HAS_UNIFORM_u_${K}
    ${N} ${$} ${K} = u_${K};
#endif
`))),vertexSource:t=t.replace(u,((k,V,N,$,K)=>{const X=$==="float"?"vec2":"vec4",re=K.match(/color/)?"color":X;return T[K]?V==="define"?`
#ifndef HAS_UNIFORM_u_${K}
uniform lowp float u_${K}_t;
in ${N} ${X} a_${K};
out ${N} ${$} ${K};
#else
uniform ${N} ${$} u_${K};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${K}
    ${K} = a_${K};
#else
    ${N} ${$} ${K} = u_${K};
#endif
`:`
#ifndef HAS_UNIFORM_u_${K}
    ${K} = unpack_mix_${re}(a_${K}, u_${K}_t);
#else
    ${N} ${$} ${K} = u_${K};
#endif
`:V==="define"?`
#ifndef HAS_UNIFORM_u_${K}
uniform lowp float u_${K}_t;
in ${N} ${X} a_${K};
#else
uniform ${N} ${$} u_${K};
#endif
`:re==="vec4"?`
#ifndef HAS_UNIFORM_u_${K}
    ${N} ${$} ${K} = a_${K};
#else
    ${N} ${$} ${K} = u_${K};
#endif
`:`
#ifndef HAS_UNIFORM_u_${K}
    ${N} ${$} ${K} = unpack_mix_${re}(a_${K}, u_${K}_t);
#else
    ${N} ${$} ${K} = u_${K};
#endif
`})),staticAttributes:p,staticUniforms:E}}class Io{constructor(t,u,p){this.vertexBuffer=t,this.indexBuffer=u,this.segments=p}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var un=l.aJ([{name:"a_pos",type:"Int16",components:2}]);const Hs="#define PROJECTION_MERCATOR",Rr="mercator";class ca{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Rr}get shaderDefine(){return Hs}get shaderPreludeCode(){return ln.projectionMercator}get vertexShaderPreludeCode(){return ln.projectionMercator.vertexSource}get subdivisionGranularity(){return l.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,u,p,m,v){if(this._cachedMesh)return this._cachedMesh;const E=new l.aL;E.emplaceBack(0,0),E.emplaceBack(l.$,0),E.emplaceBack(0,l.$),E.emplaceBack(l.$,l.$);const T=t.createVertexBuffer(E,un.members),k=l.aM.simpleSegment(0,0,4,2),V=new l.aN;V.emplaceBack(1,0,2),V.emplaceBack(1,2,3);const N=t.createIndexBuffer(V);return this._cachedMesh=new Io(T,N,k),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}class $e{constructor(t=0,u=0,p=0,m=0){if(isNaN(t)||t<0||isNaN(u)||u<0||isNaN(p)||p<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=u,this.left=p,this.right=m}interpolate(t,u,p){return u.top!=null&&t.top!=null&&(this.top=l.C.number(t.top,u.top,p)),u.bottom!=null&&t.bottom!=null&&(this.bottom=l.C.number(t.bottom,u.bottom,p)),u.left!=null&&t.left!=null&&(this.left=l.C.number(t.left,u.left,p)),u.right!=null&&t.right!=null&&(this.right=l.C.number(t.right,u.right,p)),this}getCenter(t,u){const p=l.ah((this.left+t-this.right)/2,0,t),m=l.ah((this.top+u-this.bottom)/2,0,u);return new l.P(p,m)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new $e(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Za(g,t){if(!g.renderWorldCopies||g.lngRange)return;const u=t.lng-g.center.lng;t.lng+=u>180?-360:u<-180?360:0}function On(g){return Math.max(0,Math.floor(g))}class cn{constructor(t,u,p,m,v,E){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=u||0,this._maxZoom=p||22,this._minPitch=m??0,this._maxPitch=v??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new l.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=On(this._zoom),this._scale=l.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new $e,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,u,p){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=On(this._zoom),this._scale=l.af(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new $e(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!p&&t.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const u=l.aO(t,-180,180)*Math.PI/180;var p,m,v,E,T,k,V,N,$;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=w(),p=this._rotationMatrix,v=-this._bearingInRadians,E=(m=this._rotationMatrix)[0],T=m[1],k=m[2],V=m[3],N=Math.sin(v),$=Math.cos(v),p[0]=E*$+k*N,p[1]=T*$+V*N,p[2]=E*-N+k*$,p[3]=T*-N+V*$)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const u=l.ah(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const u=t/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return l.aP(this._fovInRadians)}setFov(t){t=l.ah(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=l.ae(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const u=this.getConstrained(this._center,t).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=l.af(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,u){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,u,p){this._unmodified=!1,this._edgeInsets.interpolate(t,u,p),this._constrain(),this._calcMatrices()}resize(t,u,p=!0){this._width=t,this._height=u,p&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new gr([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-l.ai,l.ai])}getConstrained(t,u){return this._callbacks.getConstrained(t,u)}getCameraQueryGeometry(t,u){if(u.length===1)return[u[0],t];{const{minX:p,minY:m,maxX:v,maxY:E}=l.a2.fromPoints(u).extend(t);return[new l.P(p,m),new l.P(v,m),new l.P(v,E),new l.P(p,E),new l.P(p,m)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:u,zoom:p}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(p),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=l.ag(new Float64Array(16));l.N(t,t,[this._width/2,-this._height/2,1]),l.M(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=l.ag(new Float64Array(16)),l.N(t,t,[1,-1,1]),l.M(t,t,[-1,-1,0]),l.N(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,u,p,m){const v=p!==void 0?p:this.bearing,E=m=m!==void 0?m:this.pitch,T=l.a1.fromLngLat(t,u),k=-Math.cos(l.ae(E)),V=Math.sin(l.ae(E)),N=V*Math.sin(l.ae(v)),$=-V*Math.cos(l.ae(v));let K=this.elevation;const X=u-K;let re;k*X>=0||Math.abs(k)<.1?(re=1e4,K=u+re*k):re=-X/k;let le,ue,ce=l.aQ(1,T.y),be=0;do{if(be+=1,be>10)break;ue=re/ce,le=new l.a1(T.x+N*ue,T.y+$*ue),ce=1/le.meterInMercatorCoordinateUnits()}while(Math.abs(re-ue*ce)>1e-12);return{center:le.toLngLat(),elevation:K,zoom:l.ak(this.height/2/Math.tan(this.fovInRadians/2)/ue/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const u=l.aj(1,this.center.lat)*this.worldSize,p=this.cameraToCenterDistance/u,m=l.a1.fromLngLat(this.center,this.elevation),v=Ye(this.center,this.elevation,this.pitch,this.bearing,p);this._elevation=t;const E=this.calculateCenterFromCameraLngLatAlt(v.toLngLat(),l.aQ(v.z,m.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=l.aj(1,this.center.lat)*this.worldSize;return Ye(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const u=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/u,t.canonical.y/u,1/u/l.$,1/u/l.$]}}class Wi{constructor(t,u){this.min=t,this.max=u,this.center=l.aR([],l.aS([],this.min,this.max),.5)}quadrant(t){const u=[t%2==0,t<2],p=l.aT(this.min),m=l.aT(this.max);for(let v=0;v<u.length;v++)p[v]=u[v]?this.min[v]:this.center[v],m[v]=u[v]?this.center[v]:this.max[v];return m[2]=this.max[2],new Wi(p,m)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let u=!0;for(let p=0;p<t.planes.length;p++){const m=this.intersectsPlane(t.planes[p]);if(m===0)return 0;m===1&&(u=!1)}return u?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let u=t[3],p=t[3];for(let m=0;m<3;m++)t[m]>0?(u+=t[m]*this.min[m],p+=t[m]*this.max[m]):(p+=t[m]*this.min[m],u+=t[m]*this.max[m]);return u>=0?2:p<0?0:1}}class dn{distanceToTile2d(t,u,p,m){const v=m.distanceX([t,u]),E=m.distanceY([t,u]);return Math.hypot(v,E)}getWrap(t,u,p){return p}getTileBoundingVolume(t,u,p,m){var v,E;let T=0,k=0;if(m?.terrain){const N=new l.Z(t.z,u,t.z,t.x,t.y),$=m.terrain.getMinMaxElevation(N);T=(v=$.minElevation)!==null&&v!==void 0?v:Math.min(0,p),k=(E=$.maxElevation)!==null&&E!==void 0?E:Math.max(0,p)}const V=1<<t.z;return new Wi([u+t.x/V,t.y/V,T],[u+(t.x+1)/V,(t.y+1)/V,k])}allowVariableZoom(t,u){const p=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,m=l.ah(78.5-p/2,0,60);return!!u.terrain||t.pitch>m}allowWorldCopies(){return!0}prepareNextFrame(){}}class hi{constructor(t,u,p){this.points=t,this.planes=u,this.aabb=p}static fromInvProjectionMatrix(t,u=1,p=0,m,v){const E=v?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],T=Math.pow(2,p),k=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((K=>(function(X,re,le,ue){const ce=l.aw([],X,re),be=1/ce[3]/le*ue;return l.aY(ce,ce,[be,be,1/ce[3],be])})(K,t,u,T)));m&&(function(K,X,re,le){const ue=le?4:0,ce=le?0:4;let be=0;const Ee=[],xe=[];for(let Ae=0;Ae<4;Ae++){const Fe=l.aU([],K[Ae+ce],K[Ae+ue]),it=l.aZ(Fe);l.aR(Fe,Fe,1/it),Ee.push(it),xe.push(Fe)}for(let Ae=0;Ae<4;Ae++){const Fe=l.a_(K[Ae+ue],xe[Ae],re);be=Fe!==null&&Fe>=0?Math.max(be,Fe):Math.max(be,Ee[Ae])}const Pe=(function(Ae,Fe){const it=l.aU([],Ae[Fe[0]],Ae[Fe[1]]),Xe=l.aU([],Ae[Fe[2]],Ae[Fe[1]]),Je=[0,0,0,0];return l.aV(Je,l.aW([],it,Xe)),Je[3]=-l.aX(Je,Ae[Fe[0]]),Je})(K,X),Ue=(function(Ae,Fe){const it=l.a$(Ae),Xe=l.b0([],Ae,1/it),Je=l.aU([],Fe,l.aR([],Xe,l.aX(Fe,Xe))),Qe=l.a$(Je);if(Qe>0){const xt=Math.sqrt(1-Xe[3]*Xe[3]),wt=l.aR([],Xe,-Xe[3]),pt=l.aS([],wt,l.aR([],Je,xt/Qe));return l.b1(Fe,pt)}return null})(re,Pe);if(Ue!==null){const Ae=Ue/l.aX(xe[0],Pe);be=Math.min(be,Ae)}for(let Ae=0;Ae<4;Ae++){const Fe=Math.min(be,Ee[Ae]);K[Ae+ce]=[K[Ae+ue][0]+xe[Ae][0]*Fe,K[Ae+ue][1]+xe[Ae][1]*Fe,K[Ae+ue][2]+xe[Ae][2]*Fe,1]}})(k,E[0],m,v);const V=E.map((K=>{const X=l.aU([],k[K[0]],k[K[1]]),re=l.aU([],k[K[2]],k[K[1]]),le=l.aV([],l.aW([],X,re)),ue=-l.aX(le,k[K[1]]);return le.concat(ue)})),N=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],$=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const K of k)for(let X=0;X<3;X++)N[X]=Math.min(N[X],K[X]),$[X]=Math.max($[X],K[X]);return new hi(k,V,new Wi(N,$))}}class Ha{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,u,p){return this._helper.interpolatePadding(t,u,p)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,u,p=!0){this._helper.resize(t,u,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,u){this._helper.overrideNearFarZ(t,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,u){}constructor(t,u,p,m,v){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new cn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(E,T)=>this.getConstrained(E,T)},t,u,p,m,v),this._coveringTilesDetailsProvider=new dn}clone(){const t=new Ha;return t.apply(this),t}apply(t,u,p){this._helper.apply(t,u,p)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const u=[new l.b2(0,t)];if(this._helper._renderWorldCopies){const p=this.screenPointToMercatorCoordinate(new l.P(0,0)),m=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,0)),v=this.screenPointToMercatorCoordinate(new l.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new l.P(0,this._helper._height)),T=Math.floor(Math.min(p.x,m.x,v.x,E.x)),k=Math.floor(Math.max(p.x,m.x,v.x,E.x)),V=1;for(let N=T-V;N<=k+V;N++)N!==0&&u.push(new l.b2(N,t))}return u}getCameraFrustum(){return hi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const u=this.screenPointToLocation(this.centerPoint,t),p=t?t.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(p)}setLocationAtPoint(t,u){const p=l.aj(this.elevation,this.center.lat),m=this.screenPointToMercatorCoordinateAtZ(u,p),v=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,p),E=l.a1.fromLngLat(t),T=new l.a1(E.x-(m.x-v.x),E.y-(m.y-v.y));this.setCenter(T?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,u){return u?this.coordinatePoint(l.a1.fromLngLat(t),u.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(l.a1.fromLngLat(t))}screenPointToLocation(t,u){var p;return(p=this.screenPointToMercatorCoordinate(t,u))===null||p===void 0?void 0:p.toLngLat()}screenPointToMercatorCoordinate(t,u){if(u){const p=u.pointCoordinate(t);if(p!=null)return p}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,u){const p=u||0,m=[t.x,t.y,0,1],v=[t.x,t.y,1,1];l.aw(m,m,this._pixelMatrixInverse),l.aw(v,v,this._pixelMatrixInverse);const E=m[3],T=v[3],k=m[1]/E,V=v[1]/T,N=m[2]/E,$=v[2]/T,K=N===$?0:(p-N)/($-N);return new l.a1(l.C.number(m[0]/E,v[0]/T,K)/this.worldSize,l.C.number(k,V,K)/this.worldSize,p)}coordinatePoint(t,u=0,p=this._pixelMatrix){const m=[t.x*this.worldSize,t.y*this.worldSize,u,1];return l.aw(m,m,p),new l.P(m[0]/m[3],m[1]/m[3])}getBounds(){const t=Math.max(0,this._helper._height/2-Ge(this));return new gr().extend(this.screenPointToLocation(new l.P(0,t))).extend(this.screenPointToLocation(new l.P(this._helper._width,t))).extend(this.screenPointToLocation(new l.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new l.P(0,this._helper._height)))}isPointOnMapSurface(t,u){return u?u.pointCoordinate(t)!=null:t.y>this.height/2-Ge(this)}calculatePosMatrix(t,u=!1,p){var m;const v=(m=t.key)!==null&&m!==void 0?m:l.b3(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),E=u?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(v)){const V=E.get(v);return p?V.f32:V.f64}const T=Ne(t,this.worldSize);l.O(T,u?this._alignedProjMatrix:this._viewProjMatrix,T);const k={f64:T,f32:new Float32Array(T)};return E.set(v,k),p?k.f32:k.f64}calculateFogMatrix(t){const u=t.key,p=this._fogMatrixCacheF32;if(p.has(u))return p.get(u);const m=Ne(t,this.worldSize);return l.O(m,this._fogMatrix,m),p.set(u,new Float32Array(m)),p.get(u)}getConstrained(t,u){u=l.ah(+u,this.minZoom,this.maxZoom);const p={center:new l.S(t.lng,t.lat),zoom:u};let m=this._helper._lngRange;if(!this._helper._renderWorldCopies&&m===null){const Ee=179.9999999999;m=[-Ee,Ee]}const v=this.tileSize*l.af(p.zoom);let E=0,T=v,k=0,V=v,N=0,$=0;const{x:K,y:X}=this.size;if(this._helper._latRange){const Ee=this._helper._latRange;E=l.U(Ee[1])*v,T=l.U(Ee[0])*v,T-E<X&&(N=X/(T-E))}m&&(k=l.aO(l.V(m[0])*v,0,v),V=l.aO(l.V(m[1])*v,0,v),V<k&&(V+=v),V-k<K&&($=K/(V-k)));const{x:re,y:le}=Re(v,t);let ue,ce;const be=Math.max($||0,N||0);if(be){const Ee=new l.P($?(V+k)/2:re,N?(T+E)/2:le);return p.center=je(v,Ee).wrap(),p.zoom+=l.ak(be),p}if(this._helper._latRange){const Ee=X/2;le-Ee<E&&(ce=E+Ee),le+Ee>T&&(ce=T-Ee)}if(m){const Ee=(k+V)/2;let xe=re;this._helper._renderWorldCopies&&(xe=l.aO(re,Ee-v/2,Ee+v/2));const Pe=K/2;xe-Pe<k&&(ue=k+Pe),xe+Pe>V&&(ue=V-Pe)}if(ue!==void 0||ce!==void 0){const Ee=new l.P(ue??re,ce??le);p.center=je(v,Ee).wrap()}return p}calculateCenterFromCameraLngLatAlt(t,u,p,m){return this._helper.calculateCenterFromCameraLngLatAlt(t,u,p,m)}_calculateNearFarZIfNeeded(t,u,p){if(!this._helper.autoCalculateNearFarZ)return;const m=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),v=t-m*this._helper._pixelPerMeter/Math.cos(u),E=m<0?v:t,T=Math.PI/2+this.pitchInRadians,k=l.ae(this.fov)*(Math.abs(Math.cos(l.ae(this.roll)))*this.height+Math.abs(Math.sin(l.ae(this.roll)))*this.width)/this.height*(.5+p.y/this.height),V=Math.sin(k)*E/Math.sin(l.ah(Math.PI-T-k,.01,Math.PI-.01)),N=Ge(this),$=Math.atan(N/this._helper.cameraToCenterDistance),K=l.ae(.75),X=$>K?2*$*(.5+p.y/(2*N)):K,re=Math.sin(X)*E/Math.sin(l.ah(Math.PI-T-X,.01,Math.PI-.01)),le=Math.min(V,re);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*le+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,u=Re(this.worldSize,this.center),p=u.x,m=u.y;this._helper._pixelPerMeter=l.aj(1,this.center.lat)*this.worldSize;const v=l.ae(Math.min(this.pitch,_e)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(v));let T;this._calculateNearFarZIfNeeded(E,v,t),T=new Float64Array(16),l.b4(T,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),l.aq(this._invProjMatrix,T),T[8]=2*-t.x/this._helper._width,T[9]=2*t.y/this._helper._height,this._projectionMatrix=l.b5(T),l.N(T,T,[1,-1,1]),l.M(T,T,[0,0,-this._helper.cameraToCenterDistance]),l.b6(T,T,-this.rollInRadians),l.b7(T,T,this.pitchInRadians),l.b6(T,T,-this.bearingInRadians),l.M(T,T,[-p,-m,0]),this._mercatorMatrix=l.N([],T,[this.worldSize,this.worldSize,this.worldSize]),l.N(T,T,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=l.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,T),l.M(T,T,[0,0,-this.elevation]),this._viewProjMatrix=T,this._invViewProjMatrix=l.aq([],T);const k=[0,0,-1,1];l.aw(k,k,this._invViewProjMatrix),this._cameraPosition=[k[0]/k[3],k[1]/k[3],k[2]/k[3]],this._fogMatrix=new Float64Array(16),l.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,l.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),l.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),l.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),l.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),l.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),l.M(this._fogMatrix,this._fogMatrix,[-p,-m,0]),l.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),l.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=l.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,T);const V=this._helper._width%2/2,N=this._helper._height%2/2,$=Math.cos(this.bearingInRadians),K=Math.sin(-this.bearingInRadians),X=p-Math.round(p)+$*V+K*N,re=m-Math.round(m)+$*N+K*V,le=new Float64Array(T);if(l.M(le,le,[X>.5?X-1:X,re>.5?re-1:re,0]),this._alignedProjMatrix=le,T=l.aq(new Float64Array(16),this._pixelMatrix),!T)throw new Error("failed to invert matrix");this._pixelMatrixInverse=T,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new l.P(0,0)),u=[t.x*this.worldSize,t.y*this.worldSize,0,1];return l.aw(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=l.aj(1,this.center.lat)*this.worldSize;return Ye(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,u){const p=l.a1.fromLngLat(t),m=[p.x*this.worldSize,p.y*this.worldSize,u,1];return l.aw(m,m,this._viewProjMatrix),m[2]/m[3]}getProjectionData(t){const{overscaledTileID:u,aligned:p,applyTerrainMatrix:m}=t,v=this._helper.getMercatorTileCoordinates(u),E=u?this.calculatePosMatrix(u,p,!0):null;let T;return T=u&&u.terrainRttPosMatrix32f&&m?u.terrainRttPosMatrix32f:E||l.b8(),{mainMatrix:T,tileMercatorCoords:v,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:T}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,u,p){return 1}transformLightDirection(t){return l.aT(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,u,p,m){const v=this.calculatePosMatrix(p);let E;m?(E=[t,u,m(t,u),1],l.aw(E,E,v)):(E=[t,u,0,1],Mn(E,E,v));const T=E[3];return{point:new l.P(E[0]/T,E[1]/T),signedDistanceFromCamera:T,isOccluded:!1}}populateCache(t){for(const u of t)this.calculatePosMatrix(u)}getMatrixForModel(t,u){const p=l.a1.fromLngLat(t,u),m=p.meterInMercatorCoordinateUnits(),v=l.b9();return l.M(v,v,[p.x,p.y,p.z]),l.b6(v,v,Math.PI),l.b7(v,v,Math.PI/2),l.N(v,v,[-m,m,m]),v}getProjectionDataForCustomLayer(t=!0){const u=new l.Z(0,0,0,0,0),p=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:t}),m=Ne(u,this.worldSize);l.O(m,this._viewProjMatrix,m),p.tileMercatorCoords=[0,0,1,1];const v=[l.$,l.$,this.worldSize/this._helper.pixelsPerMeter],E=l.ba();return l.N(E,m,v),p.fallbackMatrix=E,p.mainMatrix=E,p}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function Sn(){l.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Xn(g){if(g.useSlerp)if(g.k<1){const t=l.bb(g.startEulerAngles.roll,g.startEulerAngles.pitch,g.startEulerAngles.bearing),u=l.bb(g.endEulerAngles.roll,g.endEulerAngles.pitch,g.endEulerAngles.bearing),p=new Float64Array(4);l.bc(p,t,u,g.k);const m=l.bd(p);g.tr.setRoll(m.roll),g.tr.setPitch(m.pitch),g.tr.setBearing(m.bearing)}else g.tr.setRoll(g.endEulerAngles.roll),g.tr.setPitch(g.endEulerAngles.pitch),g.tr.setBearing(g.endEulerAngles.bearing);else g.tr.setRoll(l.C.number(g.startEulerAngles.roll,g.endEulerAngles.roll,g.k)),g.tr.setPitch(l.C.number(g.startEulerAngles.pitch,g.endEulerAngles.pitch,g.k)),g.tr.setBearing(l.C.number(g.startEulerAngles.bearing,g.endEulerAngles.bearing,g.k))}function Vn(g,t,u,p,m){const v=m.padding,E=Re(m.worldSize,u.getNorthWest()),T=Re(m.worldSize,u.getNorthEast()),k=Re(m.worldSize,u.getSouthEast()),V=Re(m.worldSize,u.getSouthWest()),N=l.ae(-p),$=E.rotate(N),K=T.rotate(N),X=k.rotate(N),re=V.rotate(N),le=new l.P(Math.max($.x,K.x,re.x,X.x),Math.max($.y,K.y,re.y,X.y)),ue=new l.P(Math.min($.x,K.x,re.x,X.x),Math.min($.y,K.y,re.y,X.y)),ce=le.sub(ue),be=(m.width-(v.left+v.right+t.left+t.right))/ce.x,Ee=(m.height-(v.top+v.bottom+t.top+t.bottom))/ce.y;if(Ee<0||be<0)return void Sn();const xe=Math.min(l.ak(m.scale*Math.min(be,Ee)),g.maxZoom),Pe=l.P.convert(g.offset),Ue=new l.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(l.ae(p)),Ae=Pe.add(Ue).mult(m.scale/l.af(xe));return{center:je(m.worldSize,E.add(k).div(2).sub(Ae)),zoom:xe,bearing:p}}class eu{get useGlobeControls(){return!1}handlePanInertia(t,u){const p=t.mag(),m=Math.abs(Ge(u));return{easingOffset:t.mult(Math.min(.75*m/p,1)),easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(t,u){t.bearingDelta&&u.setBearing(u.bearing+t.bearingDelta),t.pitchDelta&&u.setPitch(u.pitch+t.pitchDelta),t.rollDelta&&u.setRoll(u.roll+t.rollDelta),t.zoomDelta&&u.setZoom(u.zoom+t.zoomDelta)}handleMapControlsPan(t,u,p){t.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(p,t.around)}cameraForBoxAndBearing(t,u,p,m,v){return Vn(t,u,p,m,v)}handleJumpToCenterZoom(t,u){t.zoom!==(u.zoom!==void 0?+u.zoom:t.zoom)&&t.setZoom(+u.zoom),u.center!==void 0&&t.setCenter(l.S.convert(u.center))}handleEaseTo(t,u){const p=t.zoom,m=t.padding,v={roll:t.roll,pitch:t.pitch,bearing:t.bearing},E={roll:u.roll===void 0?t.roll:u.roll,pitch:u.pitch===void 0?t.pitch:u.pitch,bearing:u.bearing===void 0?t.bearing:u.bearing},T=u.zoom!==void 0,k=!t.isPaddingEqual(u.padding);let V=!1;const N=T?+u.zoom:t.zoom;let $=t.centerPoint.add(u.offsetAsPoint);const K=t.screenPointToLocation($),{center:X,zoom:re}=t.getConstrained(l.S.convert(u.center||K),N??p);Za(t,X);const le=Re(t.worldSize,K),ue=Re(t.worldSize,X).sub(le),ce=l.af(re-p);return V=re!==p,{easeFunc:be=>{if(V&&t.setZoom(l.C.number(p,re,be)),l.be(v,E)||Xn({startEulerAngles:v,endEulerAngles:E,tr:t,k:be,useSlerp:v.roll!=E.roll}),k&&(t.interpolatePadding(m,u.padding,be),$=t.centerPoint.add(u.offsetAsPoint)),u.around)t.setLocationAtPoint(u.around,u.aroundPoint);else{const Ee=l.af(t.zoom-p),xe=re>p?Math.min(2,ce):Math.max(.5,ce),Pe=Math.pow(xe,1-be),Ue=je(t.worldSize,le.add(ue.mult(be*Pe)).mult(Ee));t.setLocationAtPoint(t.renderWorldCopies?Ue.wrap():Ue,$)}},isZooming:V,elevationCenter:X}}handleFlyTo(t,u){const p=u.zoom!==void 0,m=t.zoom,v=t.getConstrained(l.S.convert(u.center||u.locationAtOffset),p?+u.zoom:m),E=v.center,T=v.zoom;Za(t,E);const k=Re(t.worldSize,u.locationAtOffset),V=Re(t.worldSize,E).sub(k),N=V.mag(),$=l.af(T-m);let K;if(u.minZoom!==void 0){const X=Math.min(+u.minZoom,m,T),re=t.getConstrained(E,X).zoom;K=l.af(re-m)}return{easeFunc:(X,re,le,ue)=>{t.setZoom(X===1?T:m+l.ak(re));const ce=X===1?E:je(t.worldSize,k.add(V.mult(le)).mult(re));t.setLocationAtPoint(t.renderWorldCopies?ce.wrap():ce,ue)},scaleOfZoom:$,targetCenter:E,scaleOfMinZoom:K,pixelPathLength:N}}}class ri{constructor(t,u,p){this.blendFunction=t,this.blendColor=u,this.mask=p}}ri.Replace=[1,0],ri.disabled=new ri(ri.Replace,l.bf.transparent,[!1,!1,!1,!1]),ri.unblended=new ri(ri.Replace,l.bf.transparent,[!0,!0,!0,!0]),ri.alphaBlended=new ri([1,771],l.bf.transparent,[!0,!0,!0,!0]);const Ri=2305;class Br{constructor(t,u,p){this.enable=t,this.mode=u,this.frontFace=p}}Br.disabled=new Br(!1,1029,Ri),Br.backCCW=new Br(!0,1029,Ri),Br.frontCCW=new Br(!0,1028,Ri);class pr{constructor(t,u,p){this.func=t,this.mask=u,this.range=p}}pr.ReadOnly=!1,pr.ReadWrite=!0,pr.disabled=new pr(519,pr.ReadOnly,[0,1]);const Xa=7680;class xr{constructor(t,u,p,m,v,E){this.test=t,this.ref=u,this.mask=p,this.fail=m,this.depthFail=v,this.pass=E}}xr.disabled=new xr({func:519,mask:0},0,0,Xa,Xa,Xa);const xc=new WeakMap;function gn(g){var t;if(xc.has(g))return xc.get(g);{const u=(t=g.getParameter(g.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return xc.set(g,u),u}}class Xp{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const u=t.context,p=u.gl;this._texFormat=p.RGBA,this._texType=p.UNSIGNED_BYTE;const m=new l.aL;m.emplaceBack(-1,-1),m.emplaceBack(2,-1),m.emplaceBack(-1,2);const v=new l.aN;v.emplaceBack(0,1,2),this._fullscreenTriangle=new Io(u.createVertexBuffer(m,un.members),u.createIndexBuffer(v),l.aM.simpleSegment(0,0,m.length,v.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(p.TEXTURE1);const E=p.createTexture();p.bindTexture(p.TEXTURE_2D,E),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texImage2D(p.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),gn(p)&&(this._pbo=p.createBuffer(),p.bindBuffer(p.PIXEL_PACK_BUFFER,this._pbo),p.bufferData(p.PIXEL_PACK_BUFFER,4,p.STREAM_READ),p.bindBuffer(p.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,u){const p=this._updateCount;return this._readbackQueue?p>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():p>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,u=t.gl;t.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,u){const p=this._cachedRenderContext.context,m=p.gl;if(this._bindFramebuffer(),p.viewport.set([0,0,this._texWidth,this._texHeight]),p.clear({color:l.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(p,m.TRIANGLES,pr.disabled,xr.disabled,ri.unblended,Br.disabled,((v,E)=>({u_input:v,u_output_expected:E}))(t,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&gn(m)){m.bindBuffer(m.PIXEL_PACK_BUFFER,this._pbo),m.readBuffer(m.COLOR_ATTACHMENT0),m.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),m.bindBuffer(m.PIXEL_PACK_BUFFER,null);const v=m.fenceSync(m.SYNC_GPU_COMMANDS_COMPLETE,0);m.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:v}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&gn(t)){const u=t.clientWaitSync(this._readbackQueue.sync,0,0);if(u===t.WAIT_FAILED)return l.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Xp._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let u=0;return u+=t[0]/256,u+=t[1]/65536,u+=t[2]/16777216,t[3]<127&&(u=-u),u/128}}const tu=l.$/128;function ru(g,t){const u=g.granularity!==void 0?Math.max(g.granularity,1):1,p=u+(g.generateBorders?2:0),m=u+(g.extendToNorthPole||g.generateBorders?1:0)+(g.extendToSouthPole||g.generateBorders?1:0),v=p+1,E=m+1,T=g.generateBorders?-1:0,k=g.generateBorders||g.extendToNorthPole?-1:0,V=u+(g.generateBorders?1:0),N=u+(g.generateBorders||g.extendToSouthPole?1:0),$=v*E,K=p*m*6,X=v*E>65536;if(X&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const re=X||t==="32bit",le=new Int16Array(2*$);let ue=0;for(let Ee=k;Ee<=N;Ee++)for(let xe=T;xe<=V;xe++){let Pe=xe/u*l.$;xe===-1&&(Pe=-tu),xe===u+1&&(Pe=l.$+tu);let Ue=Ee/u*l.$;Ee===-1&&(Ue=g.extendToNorthPole?l.bh:-tu),Ee===u+1&&(Ue=g.extendToSouthPole?l.bi:l.$+tu),le[ue++]=Pe,le[ue++]=Ue}const ce=re?new Uint32Array(K):new Uint16Array(K);let be=0;for(let Ee=0;Ee<m;Ee++)for(let xe=0;xe<p;xe++){const Pe=xe+1+Ee*v,Ue=xe+(Ee+1)*v,Ae=xe+1+(Ee+1)*v;ce[be++]=xe+Ee*v,ce[be++]=Ue,ce[be++]=Pe,ce[be++]=Pe,ce[be++]=Ue,ce[be++]=Ae}return{vertices:le.buffer.slice(0),indices:ce.buffer.slice(0),uses32bitIndices:re}}const Wa=new l.aK({fill:new l.bj(128,2),line:new l.bj(512,0),tile:new l.bj(128,32),stencil:new l.bj(128,1),circle:3});class iu{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return ln.projectionGlobe}get vertexShaderPreludeCode(){return ln.projectionMercator.vertexSource}get subdivisionGranularity(){return Wa}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new Xp(t));const u=l.U(this._errorQueryLatitudeDegrees),p=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,m=this._errorMeasurement.updateErrorLoop(u,p),v=I.now();m!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=m,this._errorMeasurementLastChangeTime=v);const E=Math.min(Math.max((v-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=l.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,l.bl(E))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,u,p,m,v){const E=(v==="stencil"?Wa.stencil:Wa.tile).getGranularityForZoomLevel(u.z);return this._getMesh(t,{granularity:E,generateBorders:p,extendToNorthPole:u.y===0&&m,extendToSouthPole:u.y===(1<<u.z)-1&&m})}_getMesh(t,u){const p=this._getMeshKey(u);if(p in this._tileMeshCache)return this._tileMeshCache[p];const m=(function(v,E){const T=ru(E,"16bit"),k=l.aL.deserialize({arrayBuffer:T.vertices,length:T.vertices.byteLength/2/2}),V=l.aN.deserialize({arrayBuffer:T.indices,length:T.indices.byteLength/2/3});return new Io(v.createVertexBuffer(k,un.members),v.createIndexBuffer(V),l.aM.simpleSegment(0,0,k.length,V.length))})(t,u);return this._tileMeshCache[p]=m,m}recalculate(t){}hasTransition(){const t=I.now();let u=!1;return u=u||(t-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const Wp=new l.r({type:new l.D(l.v.projection.type)});class wc extends l.E{constructor(t){super(),this._transitionable=new l.t(Wp,void 0),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new l.F(0)),this._mercatorProjection=new ca,this._verticalPerspectiveProjection=new iu}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof l.bm){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,u,p,m,v){return this.currentProjection.getMeshFromTileID(t,u,p,m,v)}setProjection(t){this._transitionable.setValue("type",t?.type||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function nu(g){const t=da(g.worldSize,g.center.lat);return 2*Math.PI*t}function Xs(g,t,u,p,m){const v=1/(1<<m),E=t/l.$*v+p*v,T=l.bo((g/l.$*v+u*v)*Math.PI*2+Math.PI,2*Math.PI),k=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,V=Math.cos(k),N=new Float64Array(3);return N[0]=Math.sin(T)*V,N[1]=Math.sin(k),N[2]=Math.cos(T)*V,N}function Yi(g){return(function(t,u){const p=Math.cos(u),m=new Float64Array(3);return m[0]=Math.sin(t)*p,m[1]=Math.sin(u),m[2]=Math.cos(t)*p,m})(g.lng*Math.PI/180,g.lat*Math.PI/180)}function da(g,t){return g/(2*Math.PI)/Math.cos(t*Math.PI/180)}function su(g){const t=Math.asin(g[1])/Math.PI*180,u=Math.sqrt(g[0]*g[0]+g[2]*g[2]);if(u>1e-6){const p=g[0]/u,m=Math.acos(g[2]/u),v=(p>0?m:-m)/Math.PI*180;return new l.S(l.aO(v,-180,180),t)}return new l.S(0,t)}function Bo(g){return Math.cos(g*Math.PI/180)}function Ji(g,t){const u=Bo(g),p=Bo(t);return l.ak(p/u)}function Ec(g,t){const u=g.rotate(t.bearingInRadians),p=t.zoom+Ji(t.center.lat,0),m=l.bk(1/Bo(t.center.lat),1/Bo(Math.min(Math.abs(t.center.lat),60)),l.bn(p,7,3,0,1)),v=360/nu({worldSize:t.worldSize,center:{lat:t.center.lat}});return new l.S(t.center.lng-u.x*v*m,l.ah(t.center.lat+u.y*v,-l.ai,l.ai))}function Ac(g){const t=.5*g,u=Math.sin(t),p=Math.cos(t);return Math.log(u+p)-Math.log(p-u)}function hm(g,t,u,p){const m=g.lat+u*p;if(Math.abs(u)>1){const v=(Math.sign(g.lat+u)!==Math.sign(g.lat)?-Math.abs(g.lat):Math.abs(g.lat))*Math.PI/180,E=Math.abs(g.lat+u)*Math.PI/180,T=Ac(v+p*(E-v)),k=Ac(v),V=Ac(E);return new l.S(g.lng+t*((T-k)/(V-k)),m)}return new l.S(g.lng+t*p,m)}class cv{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=t}swapBuffers(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(t,u,p,m){const v=`${t.z}_${t.x}_${t.y}_${m?.terrain?"t":""}`,E=this._cache.get(v);if(E)return E;const T=this._cachePrevious.get(v);if(T)return this._cache.set(v,T),T;const k=this._boundingVolumeFactory(t,u,p,m);return this._cache.set(v,k),this._hadAnyChanges=!0,k}}class qi{constructor(t,u,p,m){this.min=p,this.max=m,this.points=t,this.planes=u}static fromAabb(t,u){const p=[];for(let m=0;m<8;m++)p.push([1&~m?t[0]:u[0],(m>>1&1)==1?u[1]:t[1],(m>>2&1)==1?u[2]:t[2]]);return new qi(p,[[-1,0,0,u[0]],[1,0,0,-t[0]],[0,-1,0,u[1]],[0,1,0,-t[1]],[0,0,-1,u[2]],[0,0,1,-t[2]]],t,u)}static fromCenterSizeAngles(t,u,p){const m=l.br([],p[0],p[1],p[2]),v=l.bs([],[u[0],0,0],m),E=l.bs([],[0,u[1],0],m),T=l.bs([],[0,0,u[2]],m),k=[...t],V=[...t];for(let $=0;$<8;$++)for(let K=0;K<3;K++){const X=t[K]+v[K]*(1&~$?-1:1)+E[K]*(($>>1&1)==1?1:-1)+T[K]*(($>>2&1)==1?1:-1);k[K]=Math.min(k[K],X),V[K]=Math.max(V[K],X)}const N=[];for(let $=0;$<8;$++){const K=[...t];l.aS(K,K,l.aR([],v,1&~$?-1:1)),l.aS(K,K,l.aR([],E,($>>1&1)==1?1:-1)),l.aS(K,K,l.aR([],T,($>>2&1)==1?1:-1)),N.push(K)}return new qi(N,[[...v,-l.aX(v,N[0])],[...E,-l.aX(E,N[0])],[...T,-l.aX(T,N[0])],[-v[0],-v[1],-v[2],-l.aX(v,N[7])],[-E[0],-E[1],-E[2],-l.aX(E,N[7])],[-T[0],-T[1],-T[2],-l.aX(T,N[7])]],k,V)}intersectsFrustum(t){let u=!0;const p=this.points.length,m=this.planes.length,v=t.planes.length,E=t.points.length;for(let T=0;T<v;T++){const k=t.planes[T];let V=0;for(let N=0;N<p;N++){const $=this.points[N];k[0]*$[0]+k[1]*$[1]+k[2]*$[2]+k[3]>=0&&V++}if(V===0)return 0;V<p&&(u=!1)}if(u)return 2;for(let T=0;T<m;T++){const k=this.planes[T];let V=0;for(let N=0;N<E;N++){const $=t.points[N];k[0]*$[0]+k[1]*$[1]+k[2]*$[2]+k[3]>=0&&V++}if(V===0)return 0}return 1}intersectsPlane(t){const u=this.points.length;let p=0;for(let m=0;m<u;m++){const v=this.points[m];t[0]*v[0]+t[1]*v[1]+t[2]*v[2]+t[3]>=0&&p++}return p===u?2:p===0?0:1}}function Ya(g,t,u){const p=g-t;return p<0?-p:Math.max(0,p-u)}function fs(g,t,u,p,m){const v=g-u;let E;return E=v<0?Math.min(-v,1+v-m):v>1?Math.min(Math.max(v-m,0),1-v):0,Math.max(E,Ya(t,p,m))}class Rc{constructor(){this._boundingVolumeCache=new cv(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(t,u,p,m){const v=1<<p.z,E=1/v,T=p.x/v,k=p.y/v;let V=2;return V=Math.min(V,fs(t,u,T,k,E)),V=Math.min(V,fs(t,u,T+.5,-k-E,E)),V=Math.min(V,fs(t,u,T+.5,2-k-E,E)),V}getWrap(t,u,p){const m=1<<u.z,v=1/m,E=u.x/m,T=Ya(t.x,E,v),k=Ya(t.x,E-1,v),V=Ya(t.x,E+1,v),N=Math.min(T,k,V);return N===V?1:N===k?-1:0}allowVariableZoom(t,u){return Ke(t,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(t,u,p,m){return this._boundingVolumeCache.getTileBoundingVolume(t,u,p,m)}_computeTileBoundingVolume(t,u,p,m){var v,E;let T=0,k=0;if(m?.terrain){const V=new l.Z(t.z,u,t.z,t.x,t.y),N=m.terrain.getMinMaxElevation(V);T=(v=N.minElevation)!==null&&v!==void 0?v:Math.min(0,p),k=(E=N.maxElevation)!==null&&E!==void 0?E:Math.max(0,p)}if(T/=l.bu,k/=l.bu,T+=1,k+=1,t.z<=0)return qi.fromAabb([-k,-k,-k],[k,k,k]);if(t.z===1)return qi.fromAabb([t.x===0?-k:0,t.y===0?0:-k,-k],[t.x===0?0:k,t.y===0?k:0,k]);{const V=[Xs(0,0,t.x,t.y,t.z),Xs(l.$,0,t.x,t.y,t.z),Xs(l.$,l.$,t.x,t.y,t.z),Xs(0,l.$,t.x,t.y,t.z)],N=[];for(const Je of V)N.push(l.aR([],Je,k));if(k!==T)for(const Je of V)N.push(l.aR([],Je,T));t.y===0&&N.push([0,1,0]),t.y===(1<<t.z)-1&&N.push([0,-1,0]);const $=[1,1,1],K=[-1,-1,-1];for(const Je of N)for(let Qe=0;Qe<3;Qe++)$[Qe]=Math.min($[Qe],Je[Qe]),K[Qe]=Math.max(K[Qe],Je[Qe]);const X=Xs(l.$/2,l.$/2,t.x,t.y,t.z),re=l.aW([],[0,1,0],X);l.aV(re,re);const le=l.aW([],X,re);l.aV(le,le);const ue=l.aW([],V[2],V[1]);l.aV(ue,ue);const ce=l.aW([],V[0],V[3]);l.aV(ce,ce),N.push(l.aR([],X,k)),t.y>=(1<<t.z)/2&&N.push(l.aR([],Xs(l.$/2,0,t.x,t.y,t.z),k)),t.y<(1<<t.z)/2&&N.push(l.aR([],Xs(l.$/2,l.$,t.x,t.y,t.z),k));const be=Yp(X,N),Ee=Yp(le,N),xe=[-X[0],-X[1],-X[2],be.max],Pe=[X[0],X[1],X[2],-be.min],Ue=[-le[0],-le[1],-le[2],Ee.max],Ae=[le[0],le[1],le[2],-Ee.min],Fe=[...ue,0],it=[...ce,0],Xe=[];return t.y===0?Xe.push(l.bt(it,Fe,xe),l.bt(it,Fe,Pe)):Xe.push(l.bt(Ue,Fe,xe),l.bt(Ue,Fe,Pe),l.bt(Ue,it,xe),l.bt(Ue,it,Pe)),t.y===(1<<t.z)-1?Xe.push(l.bt(it,Fe,xe),l.bt(it,Fe,Pe)):Xe.push(l.bt(Ae,Fe,xe),l.bt(Ae,Fe,Pe),l.bt(Ae,it,xe),l.bt(Ae,it,Pe)),new qi(Xe,[xe,Pe,Ue,Ae,Fe,it],$,K)}}}function Yp(g,t){let u=1/0,p=-1/0;for(const m of t){const v=l.aX(g,m);u=Math.min(u,v),p=Math.max(p,v)}return{min:u,max:p}}class ou{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,u,p){return this._helper.interpolatePadding(t,u,p)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,u){this._helper.resize(t,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,u){this._helper.overrideNearFarZ(t,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=l.bv(),this._projectionMatrix=l.b9(),this._globeViewProjMatrix32f=l.b8(),this._globeViewProjMatrixNoCorrection=l.b9(),this._globeViewProjMatrixNoCorrectionInverted=l.b9(),this._globeProjMatrixInverted=l.b9(),this._cameraPosition=l.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new cn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,u)=>this.getConstrained(t,u)}),this._coveringTilesDetailsProvider=new Rc}clone(){const t=new ou;return t.apply(this),t}apply(t,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=l.bp();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:u,applyGlobeMatrix:p}=t,m=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:m,clippingPlane:this._cachedClippingPlane,projectionTransition:p?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const u=this.pitchInRadians,p=this.cameraToCenterDistance/t,m=Math.sin(u)*p,v=Math.cos(u)*p+1,E=1/Math.sqrt(m*m+v*v)*1;let T=-m,k=v;const V=Math.sqrt(T*T+k*k);T/=V,k/=V;const N=[0,T,k];l.bw(N,N,[0,0,0],-this.bearingInRadians),l.bx(N,N,[0,0,0],-1*this.center.lat*Math.PI/180),l.by(N,N,[0,0,0],this.center.lng*Math.PI/180);const $=1/l.aZ(N);return l.aR(N,N,$),[...N,-E*$]}isLocationOccluded(t){return!this.isSurfacePointVisible(Yi(t))}transformLightDirection(t){const u=this._helper._center.lng*Math.PI/180,p=this._helper._center.lat*Math.PI/180,m=Math.cos(p),v=[Math.sin(u)*m,Math.sin(p),Math.cos(u)*m],E=[v[2],0,-v[0]],T=[0,0,0];l.aW(T,E,v),l.aV(E,E),l.aV(T,T);const k=[0,0,0];return l.aV(k,[E[0]*t[0]+T[0]*t[1]+v[0]*t[2],E[1]*t[0]+T[1]*t[1]+v[1]*t[2],E[2]*t[0]+T[2]*t[1]+v[2]*t[2]]),k}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,u,p){const m=(function(T,k,V){const N=1/(1<<V.z);return new l.a1(T/l.$*N+V.x*N,k/l.$*N+V.y*N)})(t,u,p.canonical),v=(E=m.y,[l.bo(m.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(v[1])}projectTileCoordinates(t,u,p,m){const v=p.canonical,E=Xs(t,u,v.x,v.y,v.z),T=1+(m?m(t,u):0)/l.bu,k=[E[0]*T,E[1]*T,E[2]*T,1];l.aw(k,k,this._globeViewProjMatrixNoCorrection);const V=this._cachedClippingPlane,N=V[0]*E[0]+V[1]*E[1]+V[2]*E[2]+V[3]<0;return{point:new l.P(k[0]/k[3],k[1]/k[3]),signedDistanceFromCamera:k[3],isOccluded:N}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=da(this.worldSize,this.center.lat),u=l.ba(),p=l.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),l.b4(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const m=this.centerOffset;u[8]=2*-m.x/this._helper._width,u[9]=2*m.y/this._helper._height,this._projectionMatrix=l.b5(u),this._globeProjMatrixInverted=l.ba(),l.aq(this._globeProjMatrixInverted,u),l.M(u,u,[0,0,-this.cameraToCenterDistance]),l.b6(u,u,this.rollInRadians),l.b7(u,u,-this.pitchInRadians),l.b6(u,u,this.bearingInRadians),l.M(u,u,[0,0,-t]);const v=l.bp();v[0]=t,v[1]=t,v[2]=t,l.b7(p,u,this.center.lat*Math.PI/180),l.bz(p,p,-this.center.lng*Math.PI/180),l.N(p,p,v),this._globeViewProjMatrixNoCorrection=p,l.b7(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),l.bz(u,u,-this.center.lng*Math.PI/180),l.N(u,u,v),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=l.ba(),l.aq(this._globeViewProjMatrixNoCorrectionInverted,p);const E=l.bp();this._cameraPosition=l.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/t,l.bw(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),l.bx(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),l.bw(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),l.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),l.bx(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),l.by(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const T=l.b5(this._globeViewProjMatrixNoCorrectionInverted);l.N(T,T,[1,1,-1]),this._cachedFrustum=hi.fromInvProjectionMatrix(T,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(t){l.w("calculateFogMatrix is not supported on globe projection.");const u=l.ba();return l.ag(u),u}getVisibleUnwrappedCoordinates(t){return[new l.b2(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&l.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const p=Yi(t);l.aR(p,p,1+u/l.bu);const m=l.bv();return l.aw(m,[p[0],p[1],p[2],1],this._globeViewProjMatrixNoCorrection),m[2]/m[3]}populateCache(t){}getBounds(){const t=.5*this.width,u=.5*this.height,p=[new l.P(0,0),new l.P(t,0),new l.P(this.width,0),new l.P(this.width,u),new l.P(this.width,this.height),new l.P(t,this.height),new l.P(0,this.height),new l.P(0,u)],m=[];for(const $ of p)m.push(this.unprojectScreenPoint($));let v=0,E=0,T=0,k=0;const V=this.center;for(const $ of m){const K=l.bA(V.lng,$.lng),X=l.bA(V.lat,$.lat);K<E&&(E=K),K>v&&(v=K),X<k&&(k=X),X>T&&(T=X)}const N=[V.lng+E,V.lat+k,V.lng+v,V.lat+T];return this.isSurfacePointOnScreen([0,1,0])&&(N[3]=90,N[0]=-180,N[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(N[1]=-90,N[0]=-180,N[2]=180),new gr(N)}getConstrained(t,u){const p=l.ah(t.lat,-l.ai,l.ai),m=l.ah(+u,this.minZoom+Ji(0,p),this.maxZoom);return{center:new l.S(t.lng,p),zoom:m}}calculateCenterFromCameraLngLatAlt(t,u,p,m){return this._helper.calculateCenterFromCameraLngLatAlt(t,u,p,m)}setLocationAtPoint(t,u){const p=Yi(this.unprojectScreenPoint(u)),m=Yi(t),v=l.bp();l.bB(v);const E=l.bp();l.by(E,p,v,-this.center.lng*Math.PI/180),l.bx(E,E,v,this.center.lat*Math.PI/180);const T=m[0]*m[0]+m[2]*m[2],k=E[0]*E[0];if(T<k)return;const V=Math.sqrt(T-k),N=-V,$=l.bC(m[0],m[2],E[0],V),K=l.bC(m[0],m[2],E[0],N),X=l.bp();l.by(X,m,v,-$);const re=l.bC(X[1],X[2],E[1],E[2]),le=l.bp();l.by(le,m,v,-K);const ue=l.bC(le[1],le[2],E[1],E[2]),ce=.5*Math.PI,be=re>=-ce&&re<=ce,Ee=ue>=-ce&&ue<=ce;let xe,Pe;if(be&&Ee){const it=this.center.lng*Math.PI/180,Xe=this.center.lat*Math.PI/180;l.bD($,it)+l.bD(re,Xe)<l.bD(K,it)+l.bD(ue,Xe)?(xe=$,Pe=re):(xe=K,Pe=ue)}else if(be)xe=$,Pe=re;else{if(!Ee)return;xe=K,Pe=ue}const Ue=xe/Math.PI*180,Ae=Pe/Math.PI*180,Fe=this.center.lat;this.setCenter(new l.S(Ue,l.ah(Ae,-90,90))),this.setZoom(this.zoom+Ji(Fe,this.center.lat))}locationToScreenPoint(t,u){const p=Yi(t);if(u){const m=u.getElevationForLngLatZoom(t,this._helper._tileZoom);l.aR(p,p,1+m/l.bu)}return this._projectSurfacePointToScreen(p)}_projectSurfacePointToScreen(t){const u=l.bv();return l.aw(u,[...t,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new l.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,u){if(u){const p=u.pointCoordinate(t);if(p)return p}return l.a1.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,u){var p;return(p=this.screenPointToMercatorCoordinate(t,u))===null||p===void 0?void 0:p.toLngLat()}isPointOnMapSurface(t,u){const p=this._cameraPosition,m=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(p,m)}getRayDirectionFromPixel(t){const u=l.bv();u[0]=t.x/this.width*2-1,u[1]=-1*(t.y/this.height*2-1),u[2]=1,u[3]=1,l.aw(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const p=l.bp();p[0]=u[0]-this._cameraPosition[0],p[1]=u[1]-this._cameraPosition[1],p[2]=u[2]-this._cameraPosition[2];const m=l.bp();return l.aV(m,p),m}isSurfacePointVisible(t){const u=this._cachedClippingPlane;return u[0]*t[0]+u[1]*t[1]+u[2]*t[2]+u[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const u=l.bv();return l.aw(u,[...t,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(t,u){const p=l.aX(t,u),m=l.bp(),v=l.bp();l.aR(v,u,p),l.aU(m,t,v);const E=1-l.aX(m,m);if(E<0)return null;const T=l.aX(t,t)-1,k=-p+(p<0?1:-1)*Math.sqrt(E),V=T/k,N=k;return{tMin:Math.min(V,N),tMax:Math.max(V,N)}}unprojectScreenPoint(t){const u=this._cameraPosition,p=this.getRayDirectionFromPixel(t),m=this.rayPlanetIntersection(u,p);if(m){const N=l.bp();l.aS(N,u,[p[0]*m.tMin,p[1]*m.tMin,p[2]*m.tMin]);const $=l.bp();return l.aV($,N),su($)}const v=this._cachedClippingPlane,E=v[0]*p[0]+v[1]*p[1]+v[2]*p[2],T=-l.b1(v,u)/E,k=l.bp();if(T>0)l.aS(k,u,[p[0]*T,p[1]*T,p[2]*T]);else{const N=l.bp();l.aS(N,u,[2*p[0],2*p[1],2*p[2]]);const $=l.b1(this._cachedClippingPlane,N);l.aU(k,N,[this._cachedClippingPlane[0]*$,this._cachedClippingPlane[1]*$,this._cachedClippingPlane[2]*$])}const V=(function(N){const $=l.bp();return $[0]=N[0]*-N[3],$[1]=N[1]*-N[3],$[2]=N[2]*-N[3],{center:$,radius:Math.sqrt(1-N[3]*N[3])}})(v);return su((function(N,$,K){const X=l.bp();l.aU(X,K,N);const re=l.bp();return l.bq(re,N,X,$/l.a$(X)),re})(V.center,V.radius,k))}getMatrixForModel(t,u){const p=l.S.convert(t),m=1/l.bu,v=l.b9();return l.bz(v,v,p.lng/180*Math.PI),l.b7(v,v,-p.lat/180*Math.PI),l.M(v,v,[0,0,1+u/l.bu]),l.b7(v,v,.5*Math.PI),l.N(v,v,[m,m,m]),v}getProjectionDataForCustomLayer(t=!0){const u=this.getProjectionData({overscaledTileID:new l.Z(0,0,0,0,0),applyGlobeMatrix:t});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(t){}}class lo{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,u,p){return this._helper.interpolatePadding(t,u,p)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,u,p=!0){this._helper.resize(t,u,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,u){this._helper.overrideNearFarZ(t,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,u){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new cn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,u)=>this.getConstrained(t,u)}),this._globeness=1,this._mercatorTransform=new Ha,this._verticalPerspectiveTransform=new ou}clone(){const t=new lo;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const u=this._mercatorTransform.getProjectionData(t),p=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?p.mainMatrix:u.mainMatrix,clippingPlane:p.clippingPlane,tileMercatorCoords:p.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return l.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return l.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,u,p){const m=this._mercatorTransform.getPitchedTextCorrection(t,u,p),v=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,u,p);return l.bk(m,v,this._globeness)}projectTileCoordinates(t,u,p,m){return this.currentTransform.projectTileCoordinates(t,u,p,m)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,u){return this.currentTransform.lngLatToCameraDepth(t,u)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,u){return this.currentTransform.getConstrained(t,u)}calculateCenterFromCameraLngLatAlt(t,u,p,m){return this._helper.calculateCenterFromCameraLngLatAlt(t,u,p,m)}setLocationAtPoint(t,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,u){return this.currentTransform.locationToScreenPoint(t,u)}screenPointToMercatorCoordinate(t,u){return this.currentTransform.screenPointToMercatorCoordinate(t,u)}screenPointToLocation(t,u){return this.currentTransform.screenPointToLocation(t,u)}isPointOnMapSurface(t,u){return this.currentTransform.isPointOnMapSurface(t,u)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,u){return this.currentTransform.getMatrixForModel(t,u)}getProjectionDataForCustomLayer(t=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return u;const p=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return p.fallbackMatrix=u.mainMatrix,p}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class Ss{get useGlobeControls(){return!0}handlePanInertia(t,u){const p=Ec(t,u);return Math.abs(p.lng-u.center.lng)>180&&(p.lng=u.center.lng+179.5*Math.sign(p.lng-u.center.lng)),{easingCenter:p,easingOffset:new l.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,u){const p=t.around,m=u.screenPointToLocation(p);t.bearingDelta&&u.setBearing(u.bearing+t.bearingDelta),t.pitchDelta&&u.setPitch(u.pitch+t.pitchDelta),t.rollDelta&&u.setRoll(u.roll+t.rollDelta);const v=u.zoom;t.zoomDelta&&u.setZoom(u.zoom+t.zoomDelta);const E=u.zoom-v;if(E===0)return;const T=l.bA(u.center.lng,m.lng),k=T/(Math.abs(T/180)+1),V=l.bA(u.center.lat,m.lat),N=u.getRayDirectionFromPixel(p),$=u.cameraPosition,K=-1*l.aX($,N),X=l.bp();l.aS(X,$,[N[0]*K,N[1]*K,N[2]*K]);const re=l.aZ(X)-1,le=Math.exp(.5*-Math.max(re-.3,0)),ue=da(u.worldSize,u.center.lat)/Math.min(u.width,u.height),ce=l.bn(ue,.9,.5,1,.25),be=(1-l.af(-E))*Math.min(le,ce),Ee=u.center.lat,xe=u.zoom,Pe=new l.S(u.center.lng+k*be,l.ah(u.center.lat+V*be,-l.ai,l.ai));u.setLocationAtPoint(m,p);const Ue=u.center,Ae=l.bn(Math.abs(T),45,85,0,1),Fe=l.bn(ue,.75,.35,0,1),it=Math.pow(Math.max(Ae,Fe),.25),Xe=l.bA(Ue.lng,Pe.lng),Je=l.bA(Ue.lat,Pe.lat);u.setCenter(new l.S(Ue.lng+Xe*it,Ue.lat+Je*it).wrap()),u.setZoom(xe+Ji(Ee,u.center.lat))}handleMapControlsPan(t,u,p){if(!t.panDelta)return;const m=u.center.lat,v=u.zoom;u.setCenter(Ec(t.panDelta,u).wrap()),u.setZoom(v+Ji(m,u.center.lat))}cameraForBoxAndBearing(t,u,p,m,v){const E=Vn(t,u,p,m,v),T=u.left/v.width*2-1,k=(v.width-u.right)/v.width*2-1,V=u.top/v.height*-2+1,N=(v.height-u.bottom)/v.height*-2+1,$=l.bA(p.getWest(),p.getEast())<0,K=$?p.getEast():p.getWest(),X=$?p.getWest():p.getEast(),re=Math.max(p.getNorth(),p.getSouth()),le=Math.min(p.getNorth(),p.getSouth()),ue=K+.5*l.bA(K,X),ce=re+.5*l.bA(re,le),be=v.clone();be.setCenter(E.center),be.setBearing(E.bearing),be.setPitch(0),be.setRoll(0),be.setZoom(E.zoom);const Ee=be.modelViewProjectionMatrix,xe=[Yi(p.getNorthWest()),Yi(p.getNorthEast()),Yi(p.getSouthWest()),Yi(p.getSouthEast()),Yi(new l.S(X,ce)),Yi(new l.S(K,ce)),Yi(new l.S(ue,re)),Yi(new l.S(ue,le))],Pe=Yi(E.center);let Ue=Number.POSITIVE_INFINITY;for(const Ae of xe)T<0&&(Ue=Ss.getLesserNonNegativeNonNull(Ue,Ss.solveVectorScale(Ae,Pe,Ee,"x",T))),k>0&&(Ue=Ss.getLesserNonNegativeNonNull(Ue,Ss.solveVectorScale(Ae,Pe,Ee,"x",k))),V>0&&(Ue=Ss.getLesserNonNegativeNonNull(Ue,Ss.solveVectorScale(Ae,Pe,Ee,"y",V))),N<0&&(Ue=Ss.getLesserNonNegativeNonNull(Ue,Ss.solveVectorScale(Ae,Pe,Ee,"y",N)));if(Number.isFinite(Ue)&&Ue!==0)return E.zoom=be.zoom+l.ak(Ue),E;Sn()}handleJumpToCenterZoom(t,u){const p=t.center.lat,m=t.getConstrained(u.center?l.S.convert(u.center):t.center,t.zoom).center;t.setCenter(m.wrap());const v=u.zoom!==void 0?+u.zoom:t.zoom+Ji(p,m.lat);t.zoom!==v&&t.setZoom(v)}handleEaseTo(t,u){const p=t.zoom,m=t.center,v=t.padding,E={roll:t.roll,pitch:t.pitch,bearing:t.bearing},T={roll:u.roll===void 0?t.roll:u.roll,pitch:u.pitch===void 0?t.pitch:u.pitch,bearing:u.bearing===void 0?t.bearing:u.bearing},k=u.zoom!==void 0,V=!t.isPaddingEqual(u.padding);let N=!1;const $=u.center?l.S.convert(u.center):m,K=t.getConstrained($,p).center;Za(t,K);const X=t.clone();X.setCenter(K),X.setZoom(k?+u.zoom:p+Ji(m.lat,$.lat)),X.setBearing(u.bearing);const re=new l.P(l.ah(t.centerPoint.x+u.offsetAsPoint.x,0,t.width),l.ah(t.centerPoint.y+u.offsetAsPoint.y,0,t.height));X.setLocationAtPoint(K,re);const le=(u.offset&&u.offsetAsPoint.mag())>0?X.center:K,ue=k?+u.zoom:p+Ji(m.lat,le.lat),ce=p+Ji(m.lat,0),be=ue+Ji(le.lat,0),Ee=l.bA(m.lng,le.lng),xe=l.bA(m.lat,le.lat),Pe=l.af(be-ce);return N=ue!==p,{easeFunc:Ue=>{if(l.be(E,T)||Xn({startEulerAngles:E,endEulerAngles:T,tr:t,k:Ue,useSlerp:E.roll!=T.roll}),V&&t.interpolatePadding(v,u.padding,Ue),u.around)l.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(u.around,u.aroundPoint);else{const Ae=be>ce?Math.min(2,Pe):Math.max(.5,Pe),Fe=Math.pow(Ae,1-Ue),it=hm(m,Ee,xe,Ue*Fe);t.setCenter(it.wrap())}if(N){const Ae=l.C.number(ce,be,Ue)+Ji(0,t.center.lat);t.setZoom(Ae)}},isZooming:N,elevationCenter:le}}handleFlyTo(t,u){const p=u.zoom!==void 0,m=t.center,v=t.zoom,E=t.padding,T=!t.isPaddingEqual(u.padding),k=t.getConstrained(l.S.convert(u.center||u.locationAtOffset),v).center,V=p?+u.zoom:t.zoom+Ji(t.center.lat,k.lat),N=t.clone();N.setCenter(k),N.setZoom(V),N.setBearing(u.bearing);const $=new l.P(l.ah(t.centerPoint.x+u.offsetAsPoint.x,0,t.width),l.ah(t.centerPoint.y+u.offsetAsPoint.y,0,t.height));N.setLocationAtPoint(k,$);const K=N.center;Za(t,K);const X=(function(xe,Pe,Ue){const Ae=Yi(Pe),Fe=Yi(Ue),it=l.aX(Ae,Fe),Xe=Math.acos(it),Je=nu(xe);return Xe/(2*Math.PI)*Je})(t,m,K),re=v+Ji(m.lat,0),le=V+Ji(K.lat,0),ue=l.af(le-re);let ce;if(typeof u.minZoom=="number"){const xe=+u.minZoom+Ji(K.lat,0),Pe=Math.min(xe,re,le)+Ji(0,K.lat),Ue=t.getConstrained(K,Pe).zoom+Ji(K.lat,0);ce=l.af(Ue-re)}const be=l.bA(m.lng,K.lng),Ee=l.bA(m.lat,K.lat);return{easeFunc:(xe,Pe,Ue,Ae)=>{const Fe=hm(m,be,Ee,Ue);T&&t.interpolatePadding(E,u.padding,xe);const it=xe===1?K:Fe;t.setCenter(it.wrap());const Xe=re+l.ak(Pe);t.setZoom(xe===1?V:Xe+Ji(0,it.lat))},scaleOfZoom:ue,targetCenter:K,scaleOfMinZoom:ce,pixelPathLength:X}}static solveVectorScale(t,u,p,m,v){const E=m==="x"?[p[0],p[4],p[8],p[12]]:[p[1],p[5],p[9],p[13]],T=[p[3],p[7],p[11],p[15]],k=t[0]*E[0]+t[1]*E[1]+t[2]*E[2],V=t[0]*T[0]+t[1]*T[1]+t[2]*T[2],N=u[0]*E[0]+u[1]*E[1]+u[2]*E[2],$=u[0]*T[0]+u[1]*T[1]+u[2]*T[2];return N+v*V===k+v*$||T[3]*(k-N)+E[3]*($-V)+k*$==N*V?null:(N+E[3]-v*$-v*T[3])/(N-k-v*$+v*V)}static getLesserNonNegativeNonNull(t,u){return u!==null&&u>=0&&u<t?u:t}}class mm{constructor(t){this._globe=t,this._mercatorCameraHelper=new eu,this._verticalPerspectiveCameraHelper=new Ss}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,u){return this.currentHelper.handlePanInertia(t,u)}handleMapControlsRollPitchBearingZoom(t,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,u)}handleMapControlsPan(t,u,p){this.currentHelper.handleMapControlsPan(t,u,p)}cameraForBoxAndBearing(t,u,p,m,v){return this.currentHelper.cameraForBoxAndBearing(t,u,p,m,v)}handleJumpToCenterZoom(t,u){this.currentHelper.handleJumpToCenterZoom(t,u)}handleEaseTo(t,u){return this.currentHelper.handleEaseTo(t,u)}handleFlyTo(t,u){return this.currentHelper.handleFlyTo(t,u)}}const Sc=(g,t)=>l.y(g,t&&t.filter((u=>u.identifier!=="source.canvas"))),dv=l.bE();class Jp extends l.E{constructor(t,u={}){var p,m;super(),this._rtlPluginLoaded=()=>{for(const E in this.sourceCaches){const T=this.sourceCaches[E].getSource().type;T!=="vector"&&T!=="geojson"||this.sourceCaches[E].reload()}},this.map=t,this.dispatcher=new er(kt(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",((E,T)=>this.getGlyphs(E,T))),this.dispatcher.registerMessageHandler("GI",((E,T)=>this.getImages(E,T))),this.dispatcher.registerMessageHandler("GDA",((E,T)=>this.getDashes(E,T))),this.imageManager=new gt,this.imageManager.setEventedParent(this);const v=((p=t._container)===null||p===void 0?void 0:p.lang)||typeof document<"u"&&((m=document.documentElement)===null||m===void 0?void 0:m.lang)||void 0;this.glyphManager=new ee(t._requestManager,u.localIdeographFontFamily,v),this.lineAtlas=new lt(256,512),this.crossTileSymbolIndex=new Do,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",l.bG()),vt().on(pi,this._rtlPluginLoaded),this.on("data",(E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const T=this.sourceCaches[E.sourceId];if(!T)return;const k=T.getSource();if(k&&k.vectorLayerIds)for(const V in this._layers){const N=this._layers[V];N.source===k.id&&this._validateLayer(N)}}))}setGlobalStateProperty(t,u){var p,m,v;this._checkLoaded();const E=u===null?(v=(m=(p=this.stylesheet.state)===null||p===void 0?void 0:p[t])===null||m===void 0?void 0:m.default)!==null&&v!==void 0?v:null:u;if(l.bH(E,this._globalState[t]))return this;this._globalState[t]=E,this._applyGlobalStateChanges([t])}getGlobalState(){return this._globalState}setGlobalState(t){this._checkLoaded();const u=[];for(const p in t)!l.bH(this._globalState[p],t[p].default)&&(u.push(p),this._globalState[p]=t[p].default);this._applyGlobalStateChanges(u)}_applyGlobalStateChanges(t){if(t.length===0)return;const u=new Set,p={};for(const m of t){p[m]=this._globalState[m];for(const v in this._layers){const E=this._layers[v],T=E.getLayoutAffectingGlobalStateRefs(),k=E.getPaintAffectingGlobalStateRefs();if(T.has(m)&&u.add(E.source),k.has(m))for(const{name:V,value:N}of k.get(m))this._updatePaintProperty(E,V,N)}}this.dispatcher.broadcast("UGS",p);for(const m in this.sourceCaches)u.has(m)&&(this._reloadSource(m),this._changed=!0)}loadURL(t,u={},p){this.fire(new l.l("dataloading",{dataType:"style"})),u.validate=typeof u.validate!="boolean"||u.validate;const m=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const v=this._loadStyleRequest;l.j(m,this._loadStyleRequest).then((E=>{this._loadStyleRequest=null,this._load(E.data,u,p)})).catch((E=>{this._loadStyleRequest=null,E&&!v.signal.aborted&&this.fire(new l.k(E))}))}loadJSON(t,u={},p){this.fire(new l.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,I.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,u.validate=u.validate!==!1,this._load(t,u,p)})).catch((()=>{}))}loadEmpty(){this.fire(new l.l("dataloading",{dataType:"style"})),this._load(dv,{validate:!1})}_load(t,u,p){var m,v;let E=u.transformStyle?u.transformStyle(p,t):t;if(!u.validate||!Sc(this,l.z(E))){E=Object.assign({},E),this._loaded=!0,this.stylesheet=E;for(const T in E.sources)this.addSource(T,E.sources[T],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new me(this.stylesheet.light),this._setProjectionInternal(((m=this.stylesheet.projection)===null||m===void 0?void 0:m.type)||"mercator"),this.sky=new yt(this.stylesheet.sky),this.map.setTerrain((v=this.stylesheet.terrain)!==null&&v!==void 0?v:null),this.fire(new l.l("data",{dataType:"style"})),this.fire(new l.l("style.load"))}}_createLayers(){var t,u,p;const m=l.bI(this.stylesheet.layers);this.setGlobalState((t=this.stylesheet.state)!==null&&t!==void 0?t:null),this.dispatcher.broadcast("SL",m),this._order=m.map((v=>v.id)),this._layers={},this._serializedLayers=null;for(const v of m){const E=l.bJ(v,this._globalState);if(E.setEventedParent(this,{layer:{id:v.id}}),this._layers[v.id]=E,l.bK(E)&&this.sourceCaches[E.source]){const T=(p=(u=v.paint)===null||u===void 0?void 0:u["raster-fade-duration"])!==null&&p!==void 0?p:E.paint.get("raster-fade-duration");this.sourceCaches[E.source].setRasterFadeDuration(T)}}}_loadSprite(t,u=!1,p=void 0){let m;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(v,E,T,k){return l._(this,void 0,void 0,(function*(){const V=we(v),N=T>1?"@2x":"",$={},K={};for(const{id:X,url:re}of V){const le=E.transformRequest(ze(re,N,".json"),"SpriteJSON");$[X]=l.j(le,k);const ue=E.transformRequest(ze(re,N,".png"),"SpriteImage");K[X]=Q.getImage(ue,k)}return yield Promise.all([...Object.values($),...Object.values(K)]),(function(X,re){return l._(this,void 0,void 0,(function*(){const le={};for(const ue in X){le[ue]={};const ce=I.getImageCanvasContext((yield re[ue]).data),be=(yield X[ue]).data;for(const Ee in be){const{width:xe,height:Pe,x:Ue,y:Ae,sdf:Fe,pixelRatio:it,stretchX:Xe,stretchY:Je,content:Qe,textFitWidth:xt,textFitHeight:wt}=be[Ee];le[ue][Ee]={data:null,pixelRatio:it,sdf:Fe,stretchX:Xe,stretchY:Je,content:Qe,textFitWidth:xt,textFitHeight:wt,spriteData:{width:xe,height:Pe,x:Ue,y:Ae,context:ce}}}}return le}))})($,K)}))})(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((v=>{if(this._spriteRequest=null,v)for(const E in v){this._spritesImagesIds[E]=[];const T=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter((k=>!(k in v))):[];for(const k of T)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(const k in v[E]){const V=E==="default"?k:`${E}:${k}`;this._spritesImagesIds[E].push(V),V in this.imageManager.images?this.imageManager.updateImage(V,v[E][k],!1):this.imageManager.addImage(V,v[E][k]),u&&(this._changedImages[V]=!0)}}})).catch((v=>{this._spriteRequest=null,m=v,this.fire(new l.k(m))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"})),p&&p(m)}))}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}_validateLayer(t){const u=this.sourceCaches[t.source];if(!u)return;const p=t.sourceLayer;if(!p)return;const m=u.getSource();(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(p)===-1)&&this.fire(new l.k(new Error(`Source layer "${p}" does not exist on source "${m.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,u=!1){const p=this._serializedAllLayers();if(!t||t.length===0)return Object.values(u?l.bL(p):p);const m=[];for(const v of t)if(p[v]){const E=u?l.bL(p[v]):p[v];m.push(E)}return m}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const u=Object.keys(this._layers);for(const p of u){const m=this._layers[p];m.type!=="custom"&&(t[p]=m.serialize())}return t}hasTransitions(){var t,u,p;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((u=this.sky)===null||u===void 0)&&u.hasTransition()||!((p=this.projection)===null||p===void 0)&&p.hasTransition())return!0;for(const m in this.sourceCaches)if(this.sourceCaches[m].hasTransition())return!0;for(const m in this._layers)if(this._layers[m].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const u=this._changed;if(u){const m=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(m.length||v.length)&&this._updateWorkerLayers(m,v);for(const E in this._updatedSources){const T=this._updatedSources[E];if(T==="reload")this._reloadSource(E);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const p={};for(const m in this.sourceCaches){const v=this.sourceCaches[m];p[m]=v.used,v.used=!1}for(const m of this._order){const v=this._layers[m];v.recalculate(t,this._availableImages),!v.isHidden(t.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const m in p){const v=this.sourceCaches[m];!!p[m]!=!!v.used&&v.fire(new l.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:m}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,u&&this.fire(new l.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,u={}){var p;this._checkLoaded();const m=this.serialize();if(t=u.transformStyle?u.transformStyle(m,t):t,((p=u.validate)===null||p===void 0||p)&&Sc(this,l.z(t)))return!1;(t=l.bL(t)).layers=l.bI(t.layers);const v=l.bM(m,t),E=this._getOperationsToPerform(v);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const T of E.operations)T();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const u=[],p=[];for(const m of t)switch(m.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push((()=>this.addLayer.apply(this,m.args)));break;case"removeLayer":u.push((()=>this.removeLayer.apply(this,m.args)));break;case"setPaintProperty":u.push((()=>this.setPaintProperty.apply(this,m.args)));break;case"setLayoutProperty":u.push((()=>this.setLayoutProperty.apply(this,m.args)));break;case"setFilter":u.push((()=>this.setFilter.apply(this,m.args)));break;case"addSource":u.push((()=>this.addSource.apply(this,m.args)));break;case"removeSource":u.push((()=>this.removeSource.apply(this,m.args)));break;case"setLayerZoomRange":u.push((()=>this.setLayerZoomRange.apply(this,m.args)));break;case"setLight":u.push((()=>this.setLight.apply(this,m.args)));break;case"setGeoJSONSourceData":u.push((()=>this.setGeoJSONSourceData.apply(this,m.args)));break;case"setGlyphs":u.push((()=>this.setGlyphs.apply(this,m.args)));break;case"setSprite":u.push((()=>this.setSprite.apply(this,m.args)));break;case"setTerrain":u.push((()=>this.map.setTerrain.apply(this,m.args)));break;case"setSky":u.push((()=>this.setSky.apply(this,m.args)));break;case"setProjection":this.setProjection.apply(this,m.args);break;case"setGlobalState":u.push((()=>this.setGlobalState.apply(this,m.args)));break;case"setTransition":u.push((()=>{}));break;default:p.push(m.command)}return{operations:u,unimplemented:p}}addImage(t,u){if(this.getImage(t))return this.fire(new l.k(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,u),this._afterImageUpdated(t)}updateImage(t,u){this.imageManager.updateImage(t,u)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new l.k(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,u,p={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(l.z.source,`sources.${t}`,u,null,p))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const m=this.sourceCaches[t]=new Ot(t,u,this.dispatcher);m.style=this,m.setEventedParent(this,(()=>({isSourceLoaded:m.loaded(),source:m.serialize(),sourceId:t}))),m.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===t)return this.fire(new l.k(new Error(`Source "${t}" cannot be removed while layer "${p}" is using it.`)));const u=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],u.fire(new l.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,u){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const p=this.sourceCaches[t].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(u),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,u,p={}){this._checkLoaded();const m=t.id;if(this.getLayer(m))return void this.fire(new l.k(new Error(`Layer "${m}" already exists on this map.`)));let v;if(t.type==="custom"){if(Sc(this,l.bN(t)))return;v=l.bJ(t,this._globalState)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(m,t.source),t=l.bL(t),t=l.e(t,{source:m})),this._validate(l.z.layer,`layers.${m}`,t,{arrayIndex:-1},p))return;v=l.bJ(t,this._globalState),this._validateLayer(v),v.setEventedParent(this,{layer:{id:m}})}const E=u?this._order.indexOf(u):this._order.length;if(u&&E===-1)this.fire(new l.k(new Error(`Cannot add layer "${m}" before non-existing layer "${u}".`)));else{if(this._order.splice(E,0,m),this._layerOrderChanged=!0,this._layers[m]=v,this._removedLayers[m]&&v.source&&v.type!=="custom"){const T=this._removedLayers[m];delete this._removedLayers[m],T.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(t,u){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new l.k(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===u)return;const p=this._order.indexOf(t);this._order.splice(p,1);const m=u?this._order.indexOf(u):this._order.length;u&&m===-1?this.fire(new l.k(new Error(`Cannot move layer "${t}" before non-existing layer "${u}".`))):(this._order.splice(m,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const u=this._layers[t];if(!u)return void this.fire(new l.k(new Error(`Cannot remove non-existing layer "${t}".`)));u.setEventedParent(null);const p=this._order.indexOf(t);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=u,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],u.onRemove&&u.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,u,p){this._checkLoaded();const m=this.getLayer(t);m?m.minzoom===u&&m.maxzoom===p||(u!=null&&(m.minzoom=u),p!=null&&(m.maxzoom=p),this._updateLayer(m)):this.fire(new l.k(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,u,p={}){this._checkLoaded();const m=this.getLayer(t);if(m){if(!l.bH(m.filter,u))return u==null?(m.setFilter(void 0),void this._updateLayer(m)):void(this._validate(l.z.filter,`layers.${m.id}.filter`,u,null,p)||(m.setFilter(l.bL(u)),this._updateLayer(m)))}else this.fire(new l.k(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return l.bL(this.getLayer(t).filter)}setLayoutProperty(t,u,p,m={}){this._checkLoaded();const v=this.getLayer(t);v?l.bH(v.getLayoutProperty(u),p)||(v.setLayoutProperty(u,p,m),this._updateLayer(v)):this.fire(new l.k(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,u){const p=this.getLayer(t);if(p)return p.getLayoutProperty(u);this.fire(new l.k(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,u,p,m={}){this._checkLoaded();const v=this.getLayer(t);v?l.bH(v.getPaintProperty(u),p)||this._updatePaintProperty(v,u,p,m):this.fire(new l.k(new Error(`Cannot style non-existing layer "${t}".`)))}_updatePaintProperty(t,u,p,m={}){t.setPaintProperty(u,p,m)&&this._updateLayer(t),l.bK(t)&&u==="raster-fade-duration"&&this.sourceCaches[t.source].setRasterFadeDuration(p),this._changed=!0,this._updatedPaintProps[t.id]=!0,this._serializedLayers=null}getPaintProperty(t,u){return this.getLayer(t).getPaintProperty(u)}setFeatureState(t,u){this._checkLoaded();const p=t.source,m=t.sourceLayer,v=this.sourceCaches[p];if(v===void 0)return void this.fire(new l.k(new Error(`The source '${p}' does not exist in the map's style.`)));const E=v.getSource().type;E==="geojson"&&m?this.fire(new l.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||m?(t.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),v.setFeatureState(m,t.id,u)):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,u){this._checkLoaded();const p=t.source,m=this.sourceCaches[p];if(m===void 0)return void this.fire(new l.k(new Error(`The source '${p}' does not exist in the map's style.`)));const v=m.getSource().type,E=v==="vector"?t.sourceLayer:void 0;v!=="vector"||E?u&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new l.k(new Error("A feature id is required to remove its specific state property."))):m.removeFeatureState(E,t.id,u):this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const u=t.source,p=t.sourceLayer,m=this.sourceCaches[u];if(m!==void 0)return m.getSource().type!=="vector"||p?(t.id===void 0&&this.fire(new l.k(new Error("The feature id parameter must be provided."))),m.getFeatureState(p,t.id)):void this.fire(new l.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new l.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return l.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=l.bO(this.sourceCaches,(v=>v.serialize())),u=this._serializeByIds(this._order,!0),p=this.map.getTerrain()||void 0,m=this.stylesheet;return l.bP({version:m.version,name:m.name,metadata:m.metadata,light:m.light,sky:m.sky,center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,sprite:m.sprite,glyphs:m.glyphs,transition:m.transition,projection:m.projection,sources:t,layers:u,terrain:p},(v=>v!==void 0))}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const u=E=>this._layers[E].type==="fill-extrusion",p={},m=[];for(let E=this._order.length-1;E>=0;E--){const T=this._order[E];if(u(T)){p[T]=E;for(const k of t){const V=k[T];if(V)for(const N of V)m.push(N)}}}m.sort(((E,T)=>T.intersectionZ-E.intersectionZ));const v=[];for(let E=this._order.length-1;E>=0;E--){const T=this._order[E];if(u(T))for(let k=m.length-1;k>=0;k--){const V=m[k].feature;if(p[V.layer.id]<E)break;v.push(V),m.pop()}else for(const k of t){const V=k[T];if(V)for(const N of V)v.push(N.feature)}}return v}queryRenderedFeatures(t,u,p){u&&u.filter&&this._validate(l.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const m={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new l.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const V of u.layers){const N=this._layers[V];if(!N)return this.fire(new l.k(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];m[N.source]=!0}}const v=[];u.availableImages=this._availableImages;const E=this._serializedAllLayers(),T=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,k=Object.assign(Object.assign({},u),{layers:T,globalState:this._globalState});for(const V in this.sourceCaches)u.layers&&!m[V]||v.push(Sr(this.sourceCaches[V],this._layers,E,t,k,p,this.map.terrain?(N,$,K)=>this.map.terrain.getElevation(N,$,K):void 0));return this.placement&&v.push((function(V,N,$,K,X,re,le){const ue={},ce=re.queryRenderedSymbols(K),be=[];for(const Ee of Object.keys(ce).map(Number))be.push(le[Ee]);be.sort(Ar);for(const Ee of be){const xe=Ee.featureIndex.lookupSymbolFeatures(ce[Ee.bucketInstanceId],N,Ee.bucketIndex,Ee.sourceLayerIndex,{filterSpec:X.filter,globalState:X.globalState},X.layers,X.availableImages,V);for(const Pe in xe){const Ue=ue[Pe]=ue[Pe]||[],Ae=xe[Pe];Ae.sort(((Fe,it)=>{const Xe=Ee.featureSortOrder;if(Xe){const Je=Xe.indexOf(Fe.featureIndex);return Xe.indexOf(it.featureIndex)-Je}return it.featureIndex-Fe.featureIndex}));for(const Fe of Ae)Ue.push(Fe)}}return(function(Ee,xe,Pe){for(const Ue in Ee)for(const Ae of Ee[Ue])Nr(Ae,Pe[xe[Ue].source]);return Ee})(ue,V,$)})(this._layers,E,this.sourceCaches,t,k,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(t,u){u?.filter&&this._validate(l.z.filter,"querySourceFeatures.filter",u.filter,null,u);const p=this.sourceCaches[t];return p?(function(m,v){const E=m.getRenderableIds().map((V=>m.getTileByID(V))),T=[],k={};for(let V=0;V<E.length;V++){const N=E[V],$=N.tileID.canonical.key;k[$]||(k[$]=!0,N.querySourceFeatures(T,v))}return T})(p,u?Object.assign(Object.assign({},u),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(t,u={}){this._checkLoaded();const p=this.light.getLight();let m=!1;for(const E in t)if(!l.bH(t[E],p[E])){m=!0;break}if(!m)return;const v={now:I.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,u),this.light.updateTransitions(v)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,u={}){this._checkLoaded();const p=this.getSky();let m=!1;if(!t&&!p)return;if(t&&!p)m=!0;else if(!t&&p)m=!0;else for(const E in t)if(!l.bH(t[E],p[E])){m=!0;break}if(!m)return;const v={now:I.now(),transition:l.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,u),this.sky.updateTransitions(v)}_setProjectionInternal(t){const u=(function(p){if(Array.isArray(p)){const m=new wc({type:p});return{projection:m,transform:new lo,cameraHelper:new mm(m)}}switch(p){case"mercator":return{projection:new ca,transform:new Ha,cameraHelper:new eu};case"globe":{const m=new wc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:m,transform:new lo,cameraHelper:new mm(m)}}case"vertical-perspective":return{projection:new iu,transform:new ou,cameraHelper:new Ss};default:return l.w(`Unknown projection name: ${p}. Falling back to mercator projection.`),{projection:new ca,transform:new Ha,cameraHelper:new eu}}})(t);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const p in this.sourceCaches)this.sourceCaches[p].reload()}_validate(t,u,p,m,v={}){return(!v||v.validate!==!1)&&Sc(this,t.call(l.z,l.e({key:u,style:this.serialize(),value:p,styleSpec:l.v},m)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),vt().off(pi,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const p=this.sourceCaches[u];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const u in this.sourceCaches)this.sourceCaches[u].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,u,p,m,v=!1){let E=!1,T=!1;const k={};for(const V of this._order){const N=this._layers[V];if(N.type!=="symbol")continue;if(!k[N.source]){const K=this.sourceCaches[N.source];k[N.source]=K.getRenderableIds(!0).map((X=>K.getTileByID(X))).sort(((X,re)=>re.tileID.overscaledZ-X.tileID.overscaledZ||(X.tileID.isLessThan(re.tileID)?-1:1)))}const $=this.crossTileSymbolIndex.addLayer(N,k[N.source],t.center.lng);E=E||$}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(I.now(),t.zoom))&&(this.pauseablePlacement=new P(t,this.map.terrain,this._order,v,u,p,m,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(I.now()),T=!0),E&&this.pauseablePlacement.placement.setStale()),T||E)for(const V of this._order){const N=this._layers[V];N.type==="symbol"&&this.placement.updateLayerOpacities(N,k[N.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(I.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,u){return l._(this,void 0,void 0,(function*(){const p=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const m=this.sourceCaches[u.source];return m&&m.setDependencies(u.tileID.key,u.type,u.icons),p}))}getGlyphs(t,u){return l._(this,void 0,void 0,(function*(){const p=yield this.glyphManager.getGlyphs(u.stacks),m=this.sourceCaches[u.source];return m&&m.setDependencies(u.tileID.key,u.type,[""]),p}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,u={}){this._checkLoaded(),t&&this._validate(l.z.glyphs,"glyphs",t,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}getDashes(t,u){return l._(this,void 0,void 0,(function*(){const p={};for(const[m,v]of Object.entries(u.dashes))p[m]=this.lineAtlas.getDash(v.dasharray,v.round);return p}))}addSprite(t,u,p={},m){this._checkLoaded();const v=[{id:t,url:u}],E=[...we(this.stylesheet.sprite),...v];this._validate(l.z.sprite,"sprite",E,null,p)||(this.stylesheet.sprite=E,this._loadSprite(v,!0,m))}removeSprite(t){this._checkLoaded();const u=we(this.stylesheet.sprite);if(u.find((p=>p.id===t))){if(this._spritesImagesIds[t])for(const p of this._spritesImagesIds[t])this.imageManager.removeImage(p),this._changedImages[p]=!0;u.splice(u.findIndex((p=>p.id===t)),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new l.l("data",{dataType:"style"}))}else this.fire(new l.k(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return we(this.stylesheet.sprite)}setSprite(t,u={},p){this._checkLoaded(),t&&this._validate(l.z.sprite,"sprite",t,null,u)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,p):(this._unloadSprite(),p&&p(null)))}}var pv=l.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Tc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,u,p,m,v,E,T,k,V){this.context=t;let N=this.boundPaintVertexBuffers.length!==m.length;for(let $=0;!N&&$<m.length;$++)this.boundPaintVertexBuffers[$]!==m[$]&&(N=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==p||N||this.boundIndexBuffer!==v||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==V?this.freshBind(u,p,m,v,E,T,k,V):(t.bindVertexArray.set(this.vao),T&&T.bind(),v&&v.dynamicDraw&&v.bind(),k&&k.bind(),V&&V.bind())}freshBind(t,u,p,m,v,E,T,k){const V=t.numAttributes,N=this.context,$=N.gl;this.vao&&this.destroy(),this.vao=N.createVertexArray(),N.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=m,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=k,u.enableAttributes($,t);for(const K of p)K.enableAttributes($,t);E&&E.enableAttributes($,t),T&&T.enableAttributes($,t),k&&k.enableAttributes($,t),u.bind(),u.setVertexAttribPointers($,t,v);for(const K of p)K.bind(),K.setVertexAttribPointers($,t,v);E&&(E.bind(),E.setVertexAttribPointers($,t,v)),m&&m.bind(),T&&(T.bind(),T.setVertexAttribPointers($,t,v)),k&&(k.bind(),k.setVertexAttribPointers($,t,v)),N.currentNumAttributes=V}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Qp=(g,t,u,p,m)=>({u_texture:0,u_ele_delta:g,u_fog_matrix:t,u_fog_color:u?u.properties.get("fog-color"):l.bf.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:m?0:u?u.calculateFogBlendOpacity(p):0,u_horizon_color:u?u.properties.get("horizon-color"):l.bf.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:m?1:0}),Cc={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Ja(g){const t=[];for(let u=0;u<g.length;u++){if(g[u]===null)continue;const p=g[u].split(" ");t.push(p.pop())}return t}class ef{constructor(t,u,p,m,v,E,T,k,V=[]){const N=t.gl;this.program=N.createProgram();const $=Ja(u.staticAttributes),K=p?p.getBinderAttributes():[],X=$.concat(K),re=ln.prelude.staticUniforms?Ja(ln.prelude.staticUniforms):[],le=T.staticUniforms?Ja(T.staticUniforms):[],ue=u.staticUniforms?Ja(u.staticUniforms):[],ce=p?p.getBinderUniforms():[],be=re.concat(le).concat(ue).concat(ce),Ee=[];for(const Xe of be)Ee.indexOf(Xe)<0&&Ee.push(Xe);const xe=p?p.defines():[];gn(N)&&xe.unshift("#version 300 es"),v&&xe.push("#define OVERDRAW_INSPECTOR;"),E&&xe.push("#define TERRAIN3D;"),k&&xe.push(k),V&&xe.push(...V);let Pe=xe.concat(ln.prelude.fragmentSource,T.fragmentSource,u.fragmentSource).join(`
`),Ue=xe.concat(ln.prelude.vertexSource,T.vertexSource,u.vertexSource).join(`
`);gn(N)||(Pe=(function(Xe){return Xe.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(Pe),Ue=(function(Xe){return Xe.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(Ue));const Ae=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(Ae,Pe),N.compileShader(Ae),!N.getShaderParameter(Ae,N.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${N.getShaderInfoLog(Ae)}`);N.attachShader(this.program,Ae);const Fe=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(Fe,Ue),N.compileShader(Fe),!N.getShaderParameter(Fe,N.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${N.getShaderInfoLog(Fe)}`);N.attachShader(this.program,Fe),this.attributes={};const it={};this.numAttributes=X.length;for(let Xe=0;Xe<this.numAttributes;Xe++)X[Xe]&&(N.bindAttribLocation(this.program,Xe,X[Xe]),this.attributes[X[Xe]]=Xe);if(N.linkProgram(this.program),!N.getProgramParameter(this.program,N.LINK_STATUS))throw new Error(`Program failed to link: ${N.getProgramInfoLog(this.program)}`);N.deleteShader(Fe),N.deleteShader(Ae);for(let Xe=0;Xe<Ee.length;Xe++){const Je=Ee[Xe];if(Je&&!it[Je]){const Qe=N.getUniformLocation(this.program,Je);Qe&&(it[Je]=Qe)}}this.fixedUniforms=m(t,it),this.terrainUniforms=((Xe,Je)=>({u_depth:new l.bQ(Xe,Je.u_depth),u_terrain:new l.bQ(Xe,Je.u_terrain),u_terrain_dim:new l.bg(Xe,Je.u_terrain_dim),u_terrain_matrix:new l.bS(Xe,Je.u_terrain_matrix),u_terrain_unpack:new l.bT(Xe,Je.u_terrain_unpack),u_terrain_exaggeration:new l.bg(Xe,Je.u_terrain_exaggeration)}))(t,it),this.projectionUniforms=((Xe,Je)=>({u_projection_matrix:new l.bS(Xe,Je.u_projection_matrix),u_projection_tile_mercator_coords:new l.bT(Xe,Je.u_projection_tile_mercator_coords),u_projection_clipping_plane:new l.bT(Xe,Je.u_projection_clipping_plane),u_projection_transition:new l.bg(Xe,Je.u_projection_transition),u_projection_fallback_matrix:new l.bS(Xe,Je.u_projection_fallback_matrix)}))(t,it),this.binderUniforms=p?p.getUniforms(t,it):[]}draw(t,u,p,m,v,E,T,k,V,N,$,K,X,re,le,ue,ce,be,Ee){const xe=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(p),t.setStencilMode(m),t.setColorMode(v),t.setCullFace(E),k){t.activeTexture.set(xe.TEXTURE2),xe.bindTexture(xe.TEXTURE_2D,k.depthTexture),t.activeTexture.set(xe.TEXTURE3),xe.bindTexture(xe.TEXTURE_2D,k.texture);for(const Ue in this.terrainUniforms)this.terrainUniforms[Ue].set(k[Ue])}if(V)for(const Ue in V)this.projectionUniforms[Cc[Ue]].set(V[Ue]);if(T)for(const Ue in this.fixedUniforms)this.fixedUniforms[Ue].set(T[Ue]);ue&&ue.setUniforms(t,this.binderUniforms,re,{zoom:le});let Pe=0;switch(u){case xe.LINES:Pe=2;break;case xe.TRIANGLES:Pe=3;break;case xe.LINE_STRIP:Pe=1}for(const Ue of X.get()){const Ae=Ue.vaos||(Ue.vaos={});(Ae[N]||(Ae[N]=new Tc)).bind(t,this,$,ue?ue.getPaintVertexBuffers():[],K,Ue.vertexOffset,ce,be,Ee),xe.drawElements(u,Ue.primitiveLength*Pe,xe.UNSIGNED_SHORT,Ue.primitiveOffset*Pe*2)}}}function Ts(g,t,u){const p=1/l.aC(u,1,t.transform.tileZoom),m=Math.pow(2,u.tileID.overscaledZ),v=u.tileSize*Math.pow(2,t.transform.tileZoom)/m,E=v*(u.tileID.canonical.x+u.tileID.wrap*m),T=v*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[p,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[E>>16,T>>16],u_pixel_coord_lower:[65535&E,65535&T]}}const ym=(g,t,u,p)=>{const m=g.style.light,v=m.properties.get("position"),E=[v.x,v.y,v.z],T=l.bW();m.properties.get("anchor")==="viewport"&&l.bX(T,g.transform.bearingInRadians),l.bY(E,E,T);const k=g.transform.transformLightDirection(E),V=m.properties.get("color");return{u_lightpos:E,u_lightpos_globe:k,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_vertical_gradient:+t,u_opacity:u,u_fill_translate:p}},tf=(g,t,u,p,m,v,E)=>l.e(ym(g,t,u,p),Ts(v,g,E),{u_height_factor:-Math.pow(2,m.overscaledZ)/E.tileSize/8}),Qa=(g,t,u,p)=>l.e(Ts(t,g,u),{u_fill_translate:p}),au=(g,t)=>({u_world:g,u_fill_translate:t}),fv=(g,t,u,p,m)=>l.e(Qa(g,t,u,m),{u_world:p}),kc=(g,t,u,p,m)=>{const v=g.transform;let E,T,k=0;if(u.paint.get("circle-pitch-alignment")==="map"){const V=l.aC(t,1,v.zoom);E=!0,T=[V,V],k=V/(l.$*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*m}else E=!1,T=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:T,u_globe_extrude_scale:k,u_translate:p}},hv=g=>({u_pixel_extrude_scale:[1/g.width,1/g.height]}),el=g=>({u_viewport_size:[g.width,g.height]}),gm=(g,t=1)=>({u_color:g,u_overlay:0,u_overlay_scale:t}),rf=(g,t,u,p)=>{const m=l.aC(g,1,t)/(l.$*Math.pow(2,g.tileID.overscaledZ))*2*Math.PI*p;return{u_extrude_scale:l.aC(g,1,t),u_intensity:u,u_globe_extrude_scale:m}},_m=(g,t,u,p)=>{const m=l.L();l.bZ(m,0,g.width,g.height,0,0,1);const v=g.context.gl;return{u_matrix:m,u_world:[v.drawingBufferWidth,v.drawingBufferHeight],u_image:u,u_color_ramp:p,u_opacity:t.paint.get("heatmap-opacity")}},bm=(g,t,u)=>{const p=u.paint.get("hillshade-accent-color");let m;switch(u.paint.get("hillshade-method")){case"basic":m=4;break;case"combined":m=1;break;case"igor":m=2;break;case"multidirectional":m=3;break;default:m=0}const v=u.getIlluminationProperties();for(let E=0;E<v.directionRadians.length;E++)u.paint.get("hillshade-illumination-anchor")==="viewport"&&(v.directionRadians[E]+=g.transform.bearingInRadians);return{u_image:0,u_latrange:vm(0,t.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:v.altitudeRadians,u_azimuths:v.directionRadians,u_accent:p,u_method:m,u_highlights:v.highlightColor,u_shadows:v.shadowColor}},nf=(g,t)=>{const u=t.stride,p=l.L();return l.bZ(p,0,l.$,-l.$,0,0,1),l.M(p,p,[0,-l.$,0]),{u_matrix:p,u_image:1,u_dimension:[u,u],u_zoom:g.overscaledZ,u_unpack:t.getUnpackVector()}};function vm(g,t){const u=Math.pow(2,t.canonical.z),p=t.canonical.y;return[new l.a1(0,p/u).toLngLat().lat,new l.a1(0,(p+1)/u).toLngLat().lat]}const xm=(g,t,u=0)=>({u_image:0,u_unpack:t.getUnpackVector(),u_dimension:[t.stride,t.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:g.paint.get("color-relief-opacity")}),lu=(g,t,u,p)=>{const m=g.transform;return{u_translation:Rm(g,t,u),u_ratio:p/l.aC(t,1,m.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},wm=(g,t,u,p,m)=>l.e(lu(g,t,u,p),{u_image:0,u_image_height:m}),pa=(g,t,u,p,m)=>{const v=g.transform,E=fa(t,v);return{u_translation:Rm(g,t,u),u_texsize:t.imageAtlasTexture.size,u_ratio:p/l.aC(t,1,v.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[E,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Em=(g,t,u,p,m)=>{const v=fa(t,g.transform);return l.e(lu(g,t,u,p),{u_tileratio:v,u_crossfade_from:m.fromScale,u_crossfade_to:m.toScale,u_image:0,u_mix:m.t,u_lineatlas_width:g.lineAtlas.width,u_lineatlas_height:g.lineAtlas.height})},Am=(g,t,u,p,m,v)=>{const E=fa(t,g.transform);return l.e(lu(g,t,u,p),{u_image:0,u_image_height:v,u_tileratio:E,u_crossfade_from:m.fromScale,u_crossfade_to:m.toScale,u_image_dash:1,u_mix:m.t,u_lineatlas_width:g.lineAtlas.width,u_lineatlas_height:g.lineAtlas.height})};function fa(g,t){return 1/l.aC(g,1,t.tileZoom)}function Rm(g,t,u){return l.aD(g.transform,t,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const Pc=(g,t,u,p,m)=>{return{u_tl_parent:g,u_scale_parent:t,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(E=p.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(v=p.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:mv(p.paint.get("raster-hue-rotate")),u_coords_top:[m[0].x,m[0].y,m[1].x,m[1].y],u_coords_bottom:[m[3].x,m[3].y,m[2].x,m[2].y]};var v,E};function mv(g){g*=Math.PI/180;const t=Math.sin(g),u=Math.cos(g);return[(2*u+1)/3,(-Math.sqrt(3)*t-u+1)/3,(Math.sqrt(3)*t-u+1)/3]}const Sm=(g,t,u,p,m,v,E,T,k,V,N,$,K)=>{const X=E.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:X.cameraToCenterDistance,u_pitch:X.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:X.width/X.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:T,u_coord_matrix:k,u_is_text:+N,u_pitch_with_map:+p,u_is_along_line:m,u_is_variable_anchor:v,u_texsize:$,u_texture:0,u_translation:V,u_pitched_scale:K}},sf=(g,t,u,p,m,v,E,T,k,V,N,$,K,X)=>{const re=E.transform;return l.e(Sm(g,t,u,p,m,v,E,T,k,V,N,$,X),{u_gamma_scale:p?Math.cos(re.pitch*Math.PI/180)*re.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},Tm=(g,t,u,p,m,v,E,T,k,V,N,$,K)=>l.e(sf(g,t,u,p,m,v,E,T,k,V,!0,N,0,K),{u_texsize_icon:$,u_texture_icon:1}),Cm=(g,t)=>({u_opacity:g,u_color:t}),of=(g,t,u,p,m)=>l.e((function(v,E,T,k){const V=T.imageManager.getPattern(v.from.toString()),N=T.imageManager.getPattern(v.to.toString()),{width:$,height:K}=T.imageManager.getPixelSize(),X=Math.pow(2,k.tileID.overscaledZ),re=k.tileSize*Math.pow(2,T.transform.tileZoom)/X,le=re*(k.tileID.canonical.x+k.tileID.wrap*X),ue=re*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:V.tl,u_pattern_br_a:V.br,u_pattern_tl_b:N.tl,u_pattern_br_b:N.br,u_texsize:[$,K],u_mix:E.t,u_pattern_size_a:V.displaySize,u_pattern_size_b:N.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/l.aC(k,1,T.transform.tileZoom),u_pixel_coord_upper:[le>>16,ue>>16],u_pixel_coord_lower:[65535&le,65535&ue]}})(u,m,t,p),{u_opacity:g}),af=(g,t)=>{},Lc={fillExtrusion:(g,t)=>({u_lightpos:new l.bU(g,t.u_lightpos),u_lightpos_globe:new l.bU(g,t.u_lightpos_globe),u_lightintensity:new l.bg(g,t.u_lightintensity),u_lightcolor:new l.bU(g,t.u_lightcolor),u_vertical_gradient:new l.bg(g,t.u_vertical_gradient),u_opacity:new l.bg(g,t.u_opacity),u_fill_translate:new l.bV(g,t.u_fill_translate)}),fillExtrusionPattern:(g,t)=>({u_lightpos:new l.bU(g,t.u_lightpos),u_lightpos_globe:new l.bU(g,t.u_lightpos_globe),u_lightintensity:new l.bg(g,t.u_lightintensity),u_lightcolor:new l.bU(g,t.u_lightcolor),u_vertical_gradient:new l.bg(g,t.u_vertical_gradient),u_height_factor:new l.bg(g,t.u_height_factor),u_opacity:new l.bg(g,t.u_opacity),u_fill_translate:new l.bV(g,t.u_fill_translate),u_image:new l.bQ(g,t.u_image),u_texsize:new l.bV(g,t.u_texsize),u_pixel_coord_upper:new l.bV(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bV(g,t.u_pixel_coord_lower),u_scale:new l.bU(g,t.u_scale),u_fade:new l.bg(g,t.u_fade)}),fill:(g,t)=>({u_fill_translate:new l.bV(g,t.u_fill_translate)}),fillPattern:(g,t)=>({u_image:new l.bQ(g,t.u_image),u_texsize:new l.bV(g,t.u_texsize),u_pixel_coord_upper:new l.bV(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bV(g,t.u_pixel_coord_lower),u_scale:new l.bU(g,t.u_scale),u_fade:new l.bg(g,t.u_fade),u_fill_translate:new l.bV(g,t.u_fill_translate)}),fillOutline:(g,t)=>({u_world:new l.bV(g,t.u_world),u_fill_translate:new l.bV(g,t.u_fill_translate)}),fillOutlinePattern:(g,t)=>({u_world:new l.bV(g,t.u_world),u_image:new l.bQ(g,t.u_image),u_texsize:new l.bV(g,t.u_texsize),u_pixel_coord_upper:new l.bV(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bV(g,t.u_pixel_coord_lower),u_scale:new l.bU(g,t.u_scale),u_fade:new l.bg(g,t.u_fade),u_fill_translate:new l.bV(g,t.u_fill_translate)}),circle:(g,t)=>({u_camera_to_center_distance:new l.bg(g,t.u_camera_to_center_distance),u_scale_with_map:new l.bQ(g,t.u_scale_with_map),u_pitch_with_map:new l.bQ(g,t.u_pitch_with_map),u_extrude_scale:new l.bV(g,t.u_extrude_scale),u_device_pixel_ratio:new l.bg(g,t.u_device_pixel_ratio),u_globe_extrude_scale:new l.bg(g,t.u_globe_extrude_scale),u_translate:new l.bV(g,t.u_translate)}),collisionBox:(g,t)=>({u_pixel_extrude_scale:new l.bV(g,t.u_pixel_extrude_scale)}),collisionCircle:(g,t)=>({u_viewport_size:new l.bV(g,t.u_viewport_size)}),debug:(g,t)=>({u_color:new l.bR(g,t.u_color),u_overlay:new l.bQ(g,t.u_overlay),u_overlay_scale:new l.bg(g,t.u_overlay_scale)}),depth:af,clippingMask:af,heatmap:(g,t)=>({u_extrude_scale:new l.bg(g,t.u_extrude_scale),u_intensity:new l.bg(g,t.u_intensity),u_globe_extrude_scale:new l.bg(g,t.u_globe_extrude_scale)}),heatmapTexture:(g,t)=>({u_matrix:new l.bS(g,t.u_matrix),u_world:new l.bV(g,t.u_world),u_image:new l.bQ(g,t.u_image),u_color_ramp:new l.bQ(g,t.u_color_ramp),u_opacity:new l.bg(g,t.u_opacity)}),hillshade:(g,t)=>({u_image:new l.bQ(g,t.u_image),u_latrange:new l.bV(g,t.u_latrange),u_exaggeration:new l.bg(g,t.u_exaggeration),u_altitudes:new l.b$(g,t.u_altitudes),u_azimuths:new l.b$(g,t.u_azimuths),u_accent:new l.bR(g,t.u_accent),u_method:new l.bQ(g,t.u_method),u_shadows:new l.b_(g,t.u_shadows),u_highlights:new l.b_(g,t.u_highlights)}),hillshadePrepare:(g,t)=>({u_matrix:new l.bS(g,t.u_matrix),u_image:new l.bQ(g,t.u_image),u_dimension:new l.bV(g,t.u_dimension),u_zoom:new l.bg(g,t.u_zoom),u_unpack:new l.bT(g,t.u_unpack)}),colorRelief:(g,t)=>({u_image:new l.bQ(g,t.u_image),u_unpack:new l.bT(g,t.u_unpack),u_dimension:new l.bV(g,t.u_dimension),u_elevation_stops:new l.bQ(g,t.u_elevation_stops),u_color_stops:new l.bQ(g,t.u_color_stops),u_color_ramp_size:new l.bQ(g,t.u_color_ramp_size),u_opacity:new l.bg(g,t.u_opacity)}),line:(g,t)=>({u_translation:new l.bV(g,t.u_translation),u_ratio:new l.bg(g,t.u_ratio),u_device_pixel_ratio:new l.bg(g,t.u_device_pixel_ratio),u_units_to_pixels:new l.bV(g,t.u_units_to_pixels)}),lineGradient:(g,t)=>({u_translation:new l.bV(g,t.u_translation),u_ratio:new l.bg(g,t.u_ratio),u_device_pixel_ratio:new l.bg(g,t.u_device_pixel_ratio),u_units_to_pixels:new l.bV(g,t.u_units_to_pixels),u_image:new l.bQ(g,t.u_image),u_image_height:new l.bg(g,t.u_image_height)}),linePattern:(g,t)=>({u_translation:new l.bV(g,t.u_translation),u_texsize:new l.bV(g,t.u_texsize),u_ratio:new l.bg(g,t.u_ratio),u_device_pixel_ratio:new l.bg(g,t.u_device_pixel_ratio),u_image:new l.bQ(g,t.u_image),u_units_to_pixels:new l.bV(g,t.u_units_to_pixels),u_scale:new l.bU(g,t.u_scale),u_fade:new l.bg(g,t.u_fade)}),lineSDF:(g,t)=>({u_translation:new l.bV(g,t.u_translation),u_ratio:new l.bg(g,t.u_ratio),u_device_pixel_ratio:new l.bg(g,t.u_device_pixel_ratio),u_units_to_pixels:new l.bV(g,t.u_units_to_pixels),u_image:new l.bQ(g,t.u_image),u_mix:new l.bg(g,t.u_mix),u_tileratio:new l.bg(g,t.u_tileratio),u_crossfade_from:new l.bg(g,t.u_crossfade_from),u_crossfade_to:new l.bg(g,t.u_crossfade_to),u_lineatlas_width:new l.bg(g,t.u_lineatlas_width),u_lineatlas_height:new l.bg(g,t.u_lineatlas_height)}),lineGradientSDF:(g,t)=>({u_translation:new l.bV(g,t.u_translation),u_ratio:new l.bg(g,t.u_ratio),u_device_pixel_ratio:new l.bg(g,t.u_device_pixel_ratio),u_units_to_pixels:new l.bV(g,t.u_units_to_pixels),u_image:new l.bQ(g,t.u_image),u_image_height:new l.bg(g,t.u_image_height),u_tileratio:new l.bg(g,t.u_tileratio),u_crossfade_from:new l.bg(g,t.u_crossfade_from),u_crossfade_to:new l.bg(g,t.u_crossfade_to),u_image_dash:new l.bQ(g,t.u_image_dash),u_mix:new l.bg(g,t.u_mix),u_lineatlas_width:new l.bg(g,t.u_lineatlas_width),u_lineatlas_height:new l.bg(g,t.u_lineatlas_height)}),raster:(g,t)=>({u_tl_parent:new l.bV(g,t.u_tl_parent),u_scale_parent:new l.bg(g,t.u_scale_parent),u_buffer_scale:new l.bg(g,t.u_buffer_scale),u_fade_t:new l.bg(g,t.u_fade_t),u_opacity:new l.bg(g,t.u_opacity),u_image0:new l.bQ(g,t.u_image0),u_image1:new l.bQ(g,t.u_image1),u_brightness_low:new l.bg(g,t.u_brightness_low),u_brightness_high:new l.bg(g,t.u_brightness_high),u_saturation_factor:new l.bg(g,t.u_saturation_factor),u_contrast_factor:new l.bg(g,t.u_contrast_factor),u_spin_weights:new l.bU(g,t.u_spin_weights),u_coords_top:new l.bT(g,t.u_coords_top),u_coords_bottom:new l.bT(g,t.u_coords_bottom)}),symbolIcon:(g,t)=>({u_is_size_zoom_constant:new l.bQ(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bQ(g,t.u_is_size_feature_constant),u_size_t:new l.bg(g,t.u_size_t),u_size:new l.bg(g,t.u_size),u_camera_to_center_distance:new l.bg(g,t.u_camera_to_center_distance),u_pitch:new l.bg(g,t.u_pitch),u_rotate_symbol:new l.bQ(g,t.u_rotate_symbol),u_aspect_ratio:new l.bg(g,t.u_aspect_ratio),u_fade_change:new l.bg(g,t.u_fade_change),u_label_plane_matrix:new l.bS(g,t.u_label_plane_matrix),u_coord_matrix:new l.bS(g,t.u_coord_matrix),u_is_text:new l.bQ(g,t.u_is_text),u_pitch_with_map:new l.bQ(g,t.u_pitch_with_map),u_is_along_line:new l.bQ(g,t.u_is_along_line),u_is_variable_anchor:new l.bQ(g,t.u_is_variable_anchor),u_texsize:new l.bV(g,t.u_texsize),u_texture:new l.bQ(g,t.u_texture),u_translation:new l.bV(g,t.u_translation),u_pitched_scale:new l.bg(g,t.u_pitched_scale)}),symbolSDF:(g,t)=>({u_is_size_zoom_constant:new l.bQ(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bQ(g,t.u_is_size_feature_constant),u_size_t:new l.bg(g,t.u_size_t),u_size:new l.bg(g,t.u_size),u_camera_to_center_distance:new l.bg(g,t.u_camera_to_center_distance),u_pitch:new l.bg(g,t.u_pitch),u_rotate_symbol:new l.bQ(g,t.u_rotate_symbol),u_aspect_ratio:new l.bg(g,t.u_aspect_ratio),u_fade_change:new l.bg(g,t.u_fade_change),u_label_plane_matrix:new l.bS(g,t.u_label_plane_matrix),u_coord_matrix:new l.bS(g,t.u_coord_matrix),u_is_text:new l.bQ(g,t.u_is_text),u_pitch_with_map:new l.bQ(g,t.u_pitch_with_map),u_is_along_line:new l.bQ(g,t.u_is_along_line),u_is_variable_anchor:new l.bQ(g,t.u_is_variable_anchor),u_texsize:new l.bV(g,t.u_texsize),u_texture:new l.bQ(g,t.u_texture),u_gamma_scale:new l.bg(g,t.u_gamma_scale),u_device_pixel_ratio:new l.bg(g,t.u_device_pixel_ratio),u_is_halo:new l.bQ(g,t.u_is_halo),u_translation:new l.bV(g,t.u_translation),u_pitched_scale:new l.bg(g,t.u_pitched_scale)}),symbolTextAndIcon:(g,t)=>({u_is_size_zoom_constant:new l.bQ(g,t.u_is_size_zoom_constant),u_is_size_feature_constant:new l.bQ(g,t.u_is_size_feature_constant),u_size_t:new l.bg(g,t.u_size_t),u_size:new l.bg(g,t.u_size),u_camera_to_center_distance:new l.bg(g,t.u_camera_to_center_distance),u_pitch:new l.bg(g,t.u_pitch),u_rotate_symbol:new l.bQ(g,t.u_rotate_symbol),u_aspect_ratio:new l.bg(g,t.u_aspect_ratio),u_fade_change:new l.bg(g,t.u_fade_change),u_label_plane_matrix:new l.bS(g,t.u_label_plane_matrix),u_coord_matrix:new l.bS(g,t.u_coord_matrix),u_is_text:new l.bQ(g,t.u_is_text),u_pitch_with_map:new l.bQ(g,t.u_pitch_with_map),u_is_along_line:new l.bQ(g,t.u_is_along_line),u_is_variable_anchor:new l.bQ(g,t.u_is_variable_anchor),u_texsize:new l.bV(g,t.u_texsize),u_texsize_icon:new l.bV(g,t.u_texsize_icon),u_texture:new l.bQ(g,t.u_texture),u_texture_icon:new l.bQ(g,t.u_texture_icon),u_gamma_scale:new l.bg(g,t.u_gamma_scale),u_device_pixel_ratio:new l.bg(g,t.u_device_pixel_ratio),u_is_halo:new l.bQ(g,t.u_is_halo),u_translation:new l.bV(g,t.u_translation),u_pitched_scale:new l.bg(g,t.u_pitched_scale)}),background:(g,t)=>({u_opacity:new l.bg(g,t.u_opacity),u_color:new l.bR(g,t.u_color)}),backgroundPattern:(g,t)=>({u_opacity:new l.bg(g,t.u_opacity),u_image:new l.bQ(g,t.u_image),u_pattern_tl_a:new l.bV(g,t.u_pattern_tl_a),u_pattern_br_a:new l.bV(g,t.u_pattern_br_a),u_pattern_tl_b:new l.bV(g,t.u_pattern_tl_b),u_pattern_br_b:new l.bV(g,t.u_pattern_br_b),u_texsize:new l.bV(g,t.u_texsize),u_mix:new l.bg(g,t.u_mix),u_pattern_size_a:new l.bV(g,t.u_pattern_size_a),u_pattern_size_b:new l.bV(g,t.u_pattern_size_b),u_scale_a:new l.bg(g,t.u_scale_a),u_scale_b:new l.bg(g,t.u_scale_b),u_pixel_coord_upper:new l.bV(g,t.u_pixel_coord_upper),u_pixel_coord_lower:new l.bV(g,t.u_pixel_coord_lower),u_tile_units_to_pixels:new l.bg(g,t.u_tile_units_to_pixels)}),terrain:(g,t)=>({u_texture:new l.bQ(g,t.u_texture),u_ele_delta:new l.bg(g,t.u_ele_delta),u_fog_matrix:new l.bS(g,t.u_fog_matrix),u_fog_color:new l.bR(g,t.u_fog_color),u_fog_ground_blend:new l.bg(g,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new l.bg(g,t.u_fog_ground_blend_opacity),u_horizon_color:new l.bR(g,t.u_horizon_color),u_horizon_fog_blend:new l.bg(g,t.u_horizon_fog_blend),u_is_globe_mode:new l.bg(g,t.u_is_globe_mode)}),terrainDepth:(g,t)=>({u_ele_delta:new l.bg(g,t.u_ele_delta)}),terrainCoords:(g,t)=>({u_texture:new l.bQ(g,t.u_texture),u_terrain_coords_id:new l.bg(g,t.u_terrain_coords_id),u_ele_delta:new l.bg(g,t.u_ele_delta)}),projectionErrorMeasurement:(g,t)=>({u_input:new l.bg(g,t.u_input),u_output_expected:new l.bg(g,t.u_output_expected)}),atmosphere:(g,t)=>({u_sun_pos:new l.bU(g,t.u_sun_pos),u_atmosphere_blend:new l.bg(g,t.u_atmosphere_blend),u_globe_position:new l.bU(g,t.u_globe_position),u_globe_radius:new l.bg(g,t.u_globe_radius),u_inv_proj_matrix:new l.bS(g,t.u_inv_proj_matrix)}),sky:(g,t)=>({u_sky_color:new l.bR(g,t.u_sky_color),u_horizon_color:new l.bR(g,t.u_horizon_color),u_horizon:new l.bV(g,t.u_horizon),u_horizon_normal:new l.bV(g,t.u_horizon_normal),u_sky_horizon_blend:new l.bg(g,t.u_sky_horizon_blend),u_sky_blend:new l.bg(g,t.u_sky_blend)})};class uo{constructor(t,u,p){this.context=t;const m=t.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const lf={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class uf{constructor(t,u,p,m){this.length=u.length,this.attributes=p,this.itemSize=u.bytesPerElement,this.dynamicDraw=m,this.context=t;const v=t.gl;this.buffer=v.createBuffer(),t.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,u){for(let p=0;p<this.attributes.length;p++){const m=u.attributes[this.attributes[p].name];m!==void 0&&t.enableVertexAttribArray(m)}}setVertexAttribPointers(t,u,p){for(let m=0;m<this.attributes.length;m++){const v=this.attributes[m],E=u.attributes[v.name];E!==void 0&&t.vertexAttribPointer(E,v.components,t[lf[v.type]],!1,this.itemSize,v.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Kr{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class km extends Kr{getDefault(){return l.bf.transparent}set(t){const u=this.current;(t.r!==u.r||t.g!==u.g||t.b!==u.b||t.a!==u.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class cf extends Kr{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class ha extends Kr{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class df extends Kr{getDefault(){return[!0,!0,!0,!0]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||t[2]!==u[2]||t[3]!==u[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class yv extends Kr{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class gv extends Kr{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class _v extends Kr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const u=this.current;(t.func!==u.func||t.ref!==u.ref||t.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class bv extends Kr{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||t[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Pm extends Kr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=t,this.dirty=!1}}class vv extends Kr{getDefault(){return[0,1]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Lm extends Kr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=t,this.dirty=!1}}class Dc extends Kr{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Ic extends Kr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.BLEND):u.disable(u.BLEND),this.current=t,this.dirty=!1}}class Bc extends Kr{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class pf extends Kr{getDefault(){return l.bf.transparent}set(t){const u=this.current;(t.r!==u.r||t.g!==u.g||t.b!==u.b||t.a!==u.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class ma extends Kr{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class uu extends Kr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;t?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=t,this.dirty=!1}}class tl extends Kr{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class hs extends Kr{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Dm extends Kr{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class Im extends Kr{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class ff extends Kr{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const u=this.current;(t[0]!==u[0]||t[1]!==u[1]||t[2]!==u[2]||t[3]!==u[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ya extends Kr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Mc extends Kr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class zc extends Kr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class cu extends Kr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Oc extends Kr{getDefault(){return null}set(t){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Bm extends Kr{getDefault(){return null}set(t){var u;if(t===this.current&&!this.dirty)return;const p=this.gl;gn(p)?p.bindVertexArray(t):(u=p.getExtension("OES_vertex_array_object"))===null||u===void 0||u.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class rl extends Kr{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class il extends Kr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Mm extends Kr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class du extends Kr{constructor(t,u){super(t),this.context=t,this.parent=u}getDefault(){return null}}class Dr extends du{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Vc extends du{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class xv extends du{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const hf="Framebuffer is not complete";class pu{constructor(t,u,p,m,v){this.context=t,this.width=u,this.height=p;const E=t.gl,T=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new Dr(t,T),m)this.depthAttachment=v?new xv(t,T):new Vc(t,T);else if(v)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(hf)}destroy(){const t=this.context.gl,u=this.colorAttachment.get();if(u&&t.deleteTexture(u),this.depthAttachment){const p=this.depthAttachment.get();p&&t.deleteRenderbuffer(p)}t.deleteFramebuffer(this.framebuffer)}}class wv{constructor(t){var u,p;if(this.gl=t,this.clearColor=new km(this),this.clearDepth=new cf(this),this.clearStencil=new ha(this),this.colorMask=new df(this),this.depthMask=new yv(this),this.stencilMask=new gv(this),this.stencilFunc=new _v(this),this.stencilOp=new bv(this),this.stencilTest=new Pm(this),this.depthRange=new vv(this),this.depthTest=new Lm(this),this.depthFunc=new Dc(this),this.blend=new Ic(this),this.blendFunc=new Bc(this),this.blendColor=new pf(this),this.blendEquation=new ma(this),this.cullFace=new uu(this),this.cullFaceSide=new tl(this),this.frontFace=new hs(this),this.program=new Dm(this),this.activeTexture=new Im(this),this.viewport=new ff(this),this.bindFramebuffer=new ya(this),this.bindRenderbuffer=new Mc(this),this.bindTexture=new zc(this),this.bindVertexBuffer=new cu(this),this.bindElementBuffer=new Oc(this),this.bindVertexArray=new Bm(this),this.pixelStoreUnpack=new rl(this),this.pixelStoreUnpackPremultiplyAlpha=new il(this),this.pixelStoreUnpackFlipY=new Mm(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),gn(t)){this.HALF_FLOAT=t.HALF_FLOAT;const m=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(u=t.RGBA16F)!==null&&u!==void 0?u:m?.RGBA16F_EXT,this.RGB16F=(p=t.RGB16F)!==null&&p!==void 0?p:m?.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const m=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=m?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,u){return new uo(this,t,u)}createVertexBuffer(t,u,p){return new uf(this,t,u,p)}createRenderbuffer(t,u,p){const m=this.gl,v=m.createRenderbuffer();return this.bindRenderbuffer.set(v),m.renderbufferStorage(m.RENDERBUFFER,t,u,p),this.bindRenderbuffer.set(null),v}createFramebuffer(t,u,p,m){return new pu(this,t,u,p,m)}clear({color:t,depth:u,stencil:p}){const m=this.gl;let v=0;t&&(v|=m.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),u!==void 0&&(v|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),p!==void 0&&(v|=m.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),m.clear(v)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){l.bH(t.blendFunction,ri.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return gn(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var u;return gn(this.gl)?this.gl.deleteVertexArray(t):(u=this.gl.getExtension("OES_vertex_array_object"))===null||u===void 0?void 0:u.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let Uc;function mf(g,t,u,p,m){const v=g.context,E=g.transform,T=v.gl,k=g.useProgram("collisionBox"),V=[];let N=0,$=0;for(let ce=0;ce<p.length;ce++){const be=p[ce],Ee=t.getTile(be).getBucket(u);if(!Ee)continue;const xe=m?Ee.textCollisionBox:Ee.iconCollisionBox,Pe=Ee.collisionCircleArray;Pe.length>0&&(V.push({circleArray:Pe,circleOffset:$,coord:be}),N+=Pe.length/4,$=N),xe&&k.draw(v,T.LINES,pr.disabled,xr.disabled,g.colorModeForRenderPass(),Br.disabled,hv(g.transform),g.style.map.terrain&&g.style.map.terrain.getTerrainData(be),E.getProjectionData({overscaledTileID:be,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,null,g.transform.zoom,null,null,xe.collisionVertexBuffer)}if(!m||!V.length)return;const K=g.useProgram("collisionCircle"),X=new l.c0;X.resize(4*N),X._trim();let re=0;for(const ce of V)for(let be=0;be<ce.circleArray.length/4;be++){const Ee=4*be,xe=ce.circleArray[Ee+0],Pe=ce.circleArray[Ee+1],Ue=ce.circleArray[Ee+2],Ae=ce.circleArray[Ee+3];X.emplace(re++,xe,Pe,Ue,Ae,0),X.emplace(re++,xe,Pe,Ue,Ae,1),X.emplace(re++,xe,Pe,Ue,Ae,2),X.emplace(re++,xe,Pe,Ue,Ae,3)}(!Uc||Uc.length<2*N)&&(Uc=(function(ce){const be=2*ce,Ee=new l.c2;Ee.resize(be),Ee._trim();for(let xe=0;xe<be;xe++){const Pe=6*xe;Ee.uint16[Pe+0]=4*xe+0,Ee.uint16[Pe+1]=4*xe+1,Ee.uint16[Pe+2]=4*xe+2,Ee.uint16[Pe+3]=4*xe+2,Ee.uint16[Pe+4]=4*xe+3,Ee.uint16[Pe+5]=4*xe+0}return Ee})(N));const le=v.createIndexBuffer(Uc,!0),ue=v.createVertexBuffer(X,l.c1.members,!0);for(const ce of V){const be=el(g.transform);K.draw(v,T.TRIANGLES,pr.disabled,xr.disabled,g.colorModeForRenderPass(),Br.disabled,be,g.style.map.terrain&&g.style.map.terrain.getTerrainData(ce.coord),null,u.id,ue,le,l.aM.simpleSegment(0,2*ce.circleOffset,ce.circleArray.length,ce.circleArray.length/2),null,g.transform.zoom,null,null,null)}ue.destroy(),le.destroy()}const Ev=l.ag(new Float32Array(16));function yf(g,t,u,p,m,v){const{horizontalAlign:E,verticalAlign:T}=l.aH(g);return new l.P((-(E-.5)*t/m+p[0])*v,(-(T-.5)*u/m+p[1])*v)}function jc(g,t,u,p,m,v){const E=t.tileAnchorPoint.add(new l.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let T=p.mult(v);u||(T=T.rotate(-m));const k=E.add(T);return dt(k.x,k.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(u){const T=an(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(g),k=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return g.add(p.rotate(k))}return g.add(p)}function Nc(g,t,u,p,m,v,E,T,k,V,N,$){const K=g.text.placedSymbolArray,X=g.text.dynamicLayoutVertexArray,re=g.icon.dynamicLayoutVertexArray,le={};X.clear();for(let ue=0;ue<K.length;ue++){const ce=K.get(ue),be=ce.hidden||!ce.crossTileID||g.allowVerticalPlacement&&!ce.placedOrientation?null:p[ce.crossTileID];if(be){const Ee=new l.P(ce.anchorX,ce.anchorY),xe={getElevation:$,width:m.width,height:m.height,pitchedLabelPlaneMatrix:v,pitchWithMap:u,transform:m,tileAnchorPoint:Ee,translation:V,unwrappedTileID:N},Pe=u?ur(Ee.x,Ee.y,xe):an(Ee.x,Ee.y,xe),Ue=Bi(m.cameraToCenterDistance,Pe.signedDistanceFromCamera);let Ae=l.ap(g.textSizeData,T,ce)*Ue/l.aB;u&&(Ae*=g.tilePixelRatio/E);const{width:Fe,height:it,anchor:Xe,textOffset:Je,textBoxScale:Qe}=be,xt=yf(Xe,Fe,it,Je,Qe,Ae),wt=m.getPitchedTextCorrection(Ee.x+V[0],Ee.y+V[1],N),pt=jc(Pe.point,xe,t,xt,-m.bearingInRadians,wt),jt=g.allowVerticalPlacement&&ce.placedOrientation===l.ao.vertical?Math.PI/2:0;for(let fr=0;fr<ce.numGlyphs;fr++)l.av(X,pt,jt);k&&ce.associatedIconIndex>=0&&(le[ce.associatedIconIndex]={shiftedAnchor:pt,angle:jt})}else Xi(ce.numGlyphs,X)}if(k){re.clear();const ue=g.icon.placedSymbolArray;for(let ce=0;ce<ue.length;ce++){const be=ue.get(ce);if(be.hidden)Xi(be.numGlyphs,re);else{const Ee=le[ce];if(Ee)for(let xe=0;xe<be.numGlyphs;xe++)l.av(re,Ee.shiftedAnchor,Ee.angle);else Xi(be.numGlyphs,re)}}g.icon.dynamicLayoutVertexBuffer.updateData(re)}g.text.dynamicLayoutVertexBuffer.updateData(X)}function Fc(g,t,u){return u.iconsInText&&t?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function qc(g,t,u,p,m,v,E,T,k,V,N,$,K){const X=g.context,re=X.gl,le=g.transform,ue=T==="map",ce=k==="map",be=T!=="viewport"&&u.layout.get("symbol-placement")!=="point",Ee=ue&&!ce&&!be,xe=!u.layout.get("symbol-sort-key").isConstant();let Pe=!1;const Ue=g.getDepthModeForSublayer(0,pr.ReadOnly),Ae=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Fe=[],it=le.getCircleRadiusCorrection();for(const Xe of p){const Je=t.getTile(Xe),Qe=Je.getBucket(u);if(!Qe)continue;const xt=m?Qe.text:Qe.icon;if(!xt||!xt.segments.get().length||!xt.hasVisibleVertices)continue;const wt=xt.programConfigurations.get(u.id),pt=m||Qe.sdfIcons,jt=m?Qe.textSizeData:Qe.iconSizeData,fr=ce||le.pitch!==0,Yr=g.useProgram(Fc(pt,m,Qe),wt),Jr=l.an(jt,le.zoom),ii=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Xe);let xi,di,Vr,gi,pn=[0,0],Oi=null;if(m)di=Je.glyphAtlasTexture,Vr=re.LINEAR,xi=Je.glyphAtlasTexture.size,Qe.iconsInText&&(pn=Je.imageAtlasTexture.size,Oi=Je.imageAtlasTexture,gi=fr||g.options.rotating||g.options.zooming||jt.kind==="composite"||jt.kind==="camera"?re.LINEAR:re.NEAREST);else{const Di=u.layout.get("icon-size").constantOr(0)!==1||Qe.iconsNeedLinear;di=Je.imageAtlasTexture,Vr=pt||g.options.rotating||g.options.zooming||Di||fr?re.LINEAR:re.NEAREST,xi=Je.imageAtlasTexture.size}const Vi=l.aC(Je,1,g.transform.zoom),Cn=jr(ue,g.transform,Vi),jo=l.L();l.aq(jo,Cn);const Ps=ei(ce,ue,g.transform,Vi),No=l.aD(le,Je,v,E),Ra=le.getProjectionData({overscaledTileID:Xe,applyGlobeMatrix:!K,applyTerrainMatrix:!0}),ld=Ae&&Qe.hasTextData(),ml=u.layout.get("icon-text-fit")!=="none"&&ld&&Qe.hasIconData();if(be){const Di=g.style.map.terrain?(Jn,Qi)=>g.style.map.terrain.getElevation(Xe,Jn,Qi):null,Ki=u.layout.get("text-rotation-alignment")==="map";ki(Qe,g,m,Cn,jo,ce,V,Ki,Xe.toUnwrapped(),le.width,le.height,No,Di)}const po=m&&Ae||ml,Wn=be||po?Ev:ce?Cn:g.transform.clipSpaceToPixelsMatrix,Ys=pt&&u.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Js;Js=pt?Qe.iconsInText?Tm(jt.kind,Jr,Ee,ce,be,po,g,Wn,Ps,No,xi,pn,it):sf(jt.kind,Jr,Ee,ce,be,po,g,Wn,Ps,No,m,xi,0,it):Sm(jt.kind,Jr,Ee,ce,be,po,g,Wn,Ps,No,m,xi,it);const Yn={program:Yr,buffers:xt,uniformValues:Js,projectionData:Ra,atlasTexture:di,atlasTextureIcon:Oi,atlasInterpolation:Vr,atlasInterpolationIcon:gi,isSDF:pt,hasHalo:Ys};if(xe&&Qe.canOverlap){Pe=!0;const Di=xt.segments.get();for(const Ki of Di)Fe.push({segments:new l.aM([Ki]),sortKey:Ki.sortKey,state:Yn,terrainData:ii})}else Fe.push({segments:xt.segments,sortKey:0,state:Yn,terrainData:ii})}Pe&&Fe.sort(((Xe,Je)=>Xe.sortKey-Je.sortKey));for(const Xe of Fe){const Je=Xe.state;if(X.activeTexture.set(re.TEXTURE0),Je.atlasTexture.bind(Je.atlasInterpolation,re.CLAMP_TO_EDGE),Je.atlasTextureIcon&&(X.activeTexture.set(re.TEXTURE1),Je.atlasTextureIcon&&Je.atlasTextureIcon.bind(Je.atlasInterpolationIcon,re.CLAMP_TO_EDGE)),Je.isSDF){const Qe=Je.uniformValues;Je.hasHalo&&(Qe.u_is_halo=1,gf(Je.buffers,Xe.segments,u,g,Je.program,Ue,N,$,Qe,Je.projectionData,Xe.terrainData)),Qe.u_is_halo=0}gf(Je.buffers,Xe.segments,u,g,Je.program,Ue,N,$,Je.uniformValues,Je.projectionData,Xe.terrainData)}}function gf(g,t,u,p,m,v,E,T,k,V,N){const $=p.context;m.draw($,$.gl.TRIANGLES,v,E,T,Br.backCCW,k,N,V,u.id,g.layoutVertexBuffer,g.indexBuffer,t,u.paint,p.transform.zoom,g.programConfigurations.get(u.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function Kc(g,t,u,p,m){const v=g.context,E=v.gl,T=xr.disabled,k=new ri([E.ONE,E.ONE],l.bf.transparent,[!0,!0,!0,!0]),V=t.getBucket(u);if(!V)return;const N=p.key;let $=u.heatmapFbos.get(N);$||($=fu(v,t.tileSize,t.tileSize),u.heatmapFbos.set(N,$)),v.bindFramebuffer.set($.framebuffer),v.viewport.set([0,0,t.tileSize,t.tileSize]),v.clear({color:l.bf.transparent});const K=V.programConfigurations.get(u.id),X=g.useProgram("heatmap",K,!m),re=g.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),le=g.style.map.terrain.getTerrainData(p);X.draw(v,E.TRIANGLES,pr.disabled,T,k,Br.disabled,rf(t,g.transform.zoom,u.paint.get("heatmap-intensity"),1),le,re,u.id,V.layoutVertexBuffer,V.indexBuffer,V.segments,u.paint,g.transform.zoom,K)}function Gc(g,t,u,p,m){const v=g.context,E=v.gl,T=g.transform;v.setColorMode(g.colorModeForRenderPass());const k=ga(v,t),V=u.key,N=t.heatmapFbos.get(V);if(!N)return;v.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,N.colorAttachment.get()),v.activeTexture.set(E.TEXTURE1),k.bind(E.LINEAR,E.CLAMP_TO_EDGE);const $=T.getProjectionData({overscaledTileID:u,applyTerrainMatrix:m,applyGlobeMatrix:!p});g.useProgram("heatmapTexture").draw(v,E.TRIANGLES,pr.disabled,xr.disabled,g.colorModeForRenderPass(),Br.disabled,_m(g,t,0,1),null,$,t.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,t.paint,T.zoom),N.destroy(),t.heatmapFbos.delete(V)}function fu(g,t,u){var p,m;const v=g.gl,E=v.createTexture();v.bindTexture(v.TEXTURE_2D,E),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,v.LINEAR),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,v.LINEAR);const T=(p=g.HALF_FLOAT)!==null&&p!==void 0?p:v.UNSIGNED_BYTE,k=(m=g.RGBA16F)!==null&&m!==void 0?m:v.RGBA;v.texImage2D(v.TEXTURE_2D,0,k,t,u,0,v.RGBA,T,null);const V=g.createFramebuffer(t,u,!1,!1);return V.colorAttachment.set(E),V}function ga(g,t){return t.colorRampTexture||(t.colorRampTexture=new l.T(g,t.colorRamp,g.gl.RGBA)),t.colorRampTexture}function $c(g,t,u,p,m,v,E,T){let k=256;if(m.stepInterpolant){const V=t.getSource().maxzoom,N=E.canonical.z===V?Math.ceil(1<<g.transform.maxZoom-E.canonical.z):1;k=l.ah(l.c4(v.maxLineLength/l.$*1024*N),256,u.maxTextureSize)}return T.gradient=l.c5({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:k,image:T.gradient||void 0,clips:v.lineClipsArray}),T.texture?T.texture.update(T.gradient):T.texture=new l.T(u,T.gradient,p.RGBA),T.version=m.gradientVersion,T.texture}function Av(g,t,u,p,m){g.activeTexture.set(t.TEXTURE0),u.imageAtlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE),p.updatePaintBuffers(m)}function hu(g,t,u,p,m,v){(m||g.lineAtlas.dirty)&&(t.activeTexture.set(u.TEXTURE0),g.lineAtlas.bind(t)),p.updatePaintBuffers(v)}function Rv(g,t,u,p,m,v,E){const T=v.gradients[m.id];let k=T.texture;m.gradientVersion!==T.version&&(k=$c(g,t,u,p,m,v,E,T)),u.activeTexture.set(p.TEXTURE0),k.bind(m.stepInterpolant?p.NEAREST:p.LINEAR,p.CLAMP_TO_EDGE)}function zm(g,t,u,p,m,v,E,T,k){const V=v.gradients[m.id];let N=V.texture;m.gradientVersion!==V.version&&(N=$c(g,t,u,p,m,v,E,V)),u.activeTexture.set(p.TEXTURE0),N.bind(m.stepInterpolant?p.NEAREST:p.LINEAR,p.CLAMP_TO_EDGE),u.activeTexture.set(p.TEXTURE1),g.lineAtlas.bind(u),T.updatePaintBuffers(k)}function mu(g,t,u,p,m){if(!u||!p||!p.imageAtlas)return;const v=p.imageAtlas.patternPositions;let E=v[u.to.toString()],T=v[u.from.toString()];if(!E&&T&&(E=T),!T&&E&&(T=E),!E||!T){const k=m.getPaintProperty(t);E=v[k],T=v[k]}E&&T&&g.setConstantPatternPositions(E,T)}function Zc(g,t,u,p,m,v,E,T){const k=g.context.gl,V="fill-pattern",N=u.paint.get(V),$=N&&N.constantOr(1),K=u.getCrossfadeParameters();let X,re,le,ue,ce;const be=g.transform,Ee=u.paint.get("fill-translate"),xe=u.paint.get("fill-translate-anchor");E?(re=$&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",X=k.LINES):(re=$?"fillPattern":"fill",X=k.TRIANGLES);const Pe=N.constantOr(null);for(const Ue of p){const Ae=t.getTile(Ue);if($&&!Ae.patternsLoaded())continue;const Fe=Ae.getBucket(u);if(!Fe)continue;const it=Fe.programConfigurations.get(u.id),Xe=g.useProgram(re,it),Je=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ue);$&&(g.context.activeTexture.set(k.TEXTURE0),Ae.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),it.updatePaintBuffers(K)),mu(it,V,Pe,Ae,u);const Qe=be.getProjectionData({overscaledTileID:Ue,applyGlobeMatrix:!T,applyTerrainMatrix:!0}),xt=l.aD(be,Ae,Ee,xe);if(E){ue=Fe.indexBuffer2,ce=Fe.segments2;const pt=[k.drawingBufferWidth,k.drawingBufferHeight];le=re==="fillOutlinePattern"&&$?fv(g,K,Ae,pt,xt):au(pt,xt)}else ue=Fe.indexBuffer,ce=Fe.segments,le=$?Qa(g,K,Ae,xt):{u_fill_translate:xt};const wt=g.stencilModeForClipping(Ue);Xe.draw(g.context,X,m,wt,v,Br.backCCW,le,Je,Qe,u.id,Fe.layoutVertexBuffer,ue,ce,u.paint,g.transform.zoom,it)}}function Hc(g,t,u,p,m,v,E,T){const k=g.context,V=k.gl,N="fill-extrusion-pattern",$=u.paint.get(N),K=$.constantOr(1),X=u.getCrossfadeParameters(),re=u.paint.get("fill-extrusion-opacity"),le=$.constantOr(null),ue=g.transform;for(const ce of p){const be=t.getTile(ce),Ee=be.getBucket(u);if(!Ee)continue;const xe=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ce),Pe=Ee.programConfigurations.get(u.id),Ue=g.useProgram(K?"fillExtrusionPattern":"fillExtrusion",Pe);K&&(g.context.activeTexture.set(V.TEXTURE0),be.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),Pe.updatePaintBuffers(X));const Ae=ue.getProjectionData({overscaledTileID:ce,applyGlobeMatrix:!T,applyTerrainMatrix:!0});mu(Pe,N,le,be,u);const Fe=l.aD(ue,be,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),it=u.paint.get("fill-extrusion-vertical-gradient"),Xe=K?tf(g,it,re,Fe,ce,X,be):ym(g,it,re,Fe);Ue.draw(k,k.gl.TRIANGLES,m,v,E,Br.backCCW,Xe,xe,Ae,u.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,u.paint,g.transform.zoom,Pe,g.style.map.terrain&&Ee.centroidVertexBuffer)}}function Xc(g,t,u,p,m,v,E,T,k){var V;const N=g.style.projection,$=g.context,K=g.transform,X=$.gl,re=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],le=g.useProgram("hillshade",null,!1,re),ue=!g.options.moving;for(const ce of p){const be=t.getTile(ce),Ee=be.fbo;if(!Ee)continue;const xe=N.getMeshFromTileID($,ce.canonical,T,!0,"raster"),Pe=(V=g.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(ce);$.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,Ee.colorAttachment.get());const Ue=K.getProjectionData({overscaledTileID:ce,aligned:ue,applyGlobeMatrix:!k,applyTerrainMatrix:!0});le.draw($,X.TRIANGLES,v,m[ce.overscaledZ],E,Br.backCCW,bm(g,be,u),Pe,Ue,u.id,xe.vertexBuffer,xe.indexBuffer,xe.segments)}}function nl(g,t,u,p,m,v,E,T,k){var V;const N=g.style.projection,$=g.context,K=g.transform,X=$.gl,re=g.useProgram("colorRelief"),le=!g.options.moving;let ue=!0,ce=0;for(const be of p){const Ee=t.getTile(be),xe=Ee.dem;if(ue){const Xe=X.getParameter(X.MAX_TEXTURE_SIZE),{elevationTexture:Je,colorTexture:Qe}=u.getColorRampTextures($,Xe,xe.getUnpackVector());$.activeTexture.set(X.TEXTURE1),Je.bind(X.NEAREST,X.CLAMP_TO_EDGE),$.activeTexture.set(X.TEXTURE4),Qe.bind(X.LINEAR,X.CLAMP_TO_EDGE),ue=!1,ce=Je.size[0]}if(!xe||!xe.data)continue;const Pe=xe.stride,Ue=xe.getPixels();if($.activeTexture.set(X.TEXTURE0),$.pixelStoreUnpackPremultiplyAlpha.set(!1),Ee.demTexture=Ee.demTexture||g.getTileTexture(Pe),Ee.demTexture){const Xe=Ee.demTexture;Xe.update(Ue,{premultiply:!1}),Xe.bind(X.LINEAR,X.CLAMP_TO_EDGE)}else Ee.demTexture=new l.T($,Ue,X.RGBA,{premultiply:!1}),Ee.demTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE);const Ae=N.getMeshFromTileID($,be.canonical,T,!0,"raster"),Fe=(V=g.style.map.terrain)===null||V===void 0?void 0:V.getTerrainData(be),it=K.getProjectionData({overscaledTileID:be,aligned:le,applyGlobeMatrix:!k,applyTerrainMatrix:!0});re.draw($,X.TRIANGLES,v,m[be.overscaledZ],E,Br.backCCW,xm(u,Ee.dem,ce),Fe,it,u.id,Ae.vertexBuffer,Ae.indexBuffer,Ae.segments)}}const yu=[new l.P(0,0),new l.P(l.$,0),new l.P(l.$,l.$),new l.P(0,l.$)];function Wc(g,t,u,p,m,v,E,T,k=!1,V=!1){const N=p[p.length-1].overscaledZ,$=g.context,K=$.gl,X=g.useProgram("raster"),re=g.transform,le=g.style.projection,ue=g.colorModeForRenderPass(),ce=!g.options.moving,be=u.paint.get("raster-opacity"),Ee=u.paint.get("raster-resampling"),xe=u.paint.get("raster-fade-duration"),Pe=!!g.style.map.terrain;for(const Ue of p){const Ae=g.getDepthModeForSublayer(Ue.overscaledZ-N,be===1?pr.ReadWrite:pr.ReadOnly,K.LESS),Fe=t.getTile(Ue),it=Ee==="nearest"?K.NEAREST:K.LINEAR;$.activeTexture.set(K.TEXTURE0),Fe.texture.bind(it,K.CLAMP_TO_EDGE,K.LINEAR_MIPMAP_NEAREST),$.activeTexture.set(K.TEXTURE1);const{parentTile:Xe,parentScaleBy:Je,parentTopLeft:Qe,fadeValues:xt}=Om(Fe,t,xe,Pe);Fe.fadeOpacity=xt.tileOpacity,Xe?(Xe.fadeOpacity=xt.parentTileOpacity,Xe.texture.bind(it,K.CLAMP_TO_EDGE,K.LINEAR_MIPMAP_NEAREST)):Fe.texture.bind(it,K.CLAMP_TO_EDGE,K.LINEAR_MIPMAP_NEAREST),Fe.texture.useMipmap&&$.extTextureFilterAnisotropic&&g.transform.pitch>20&&K.texParameterf(K.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const wt=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ue),pt=re.getProjectionData({overscaledTileID:Ue,aligned:ce,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),jt=Pc(Qe,Je,xt.fadeMix,u,T),fr=le.getMeshFromTileID($,Ue.canonical,v,E,"raster");X.draw($,K.TRIANGLES,Ae,m?m[Ue.overscaledZ]:xr.disabled,ue,k?Br.frontCCW:Br.backCCW,jt,wt,pt,u.id,fr.vertexBuffer,fr.indexBuffer,fr.segments)}}function Om(g,t,u,p){const m={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(u===0||p)return m;if(g.fadingParentID){const v=t._getLoadedTile(g.fadingParentID);if(!v)return m;const E=Math.pow(2,v.tileID.overscaledZ-g.tileID.overscaledZ),T=[g.tileID.canonical.x*E%1,g.tileID.canonical.y*E%1],k=(function(V,N,$){const K=I.now(),X=(K-N.timeAdded)/$,re=V.fadingDirection===ve.Incoming,le=l.ah((K-V.timeAdded)/$,0,1),ue=l.ah(1-X,0,1),ce=re?le:ue;return{tileOpacity:ce,parentTileOpacity:re?ue:le,fadeMix:{opacity:1,mix:1-ce}}})(g,v,u);return{parentTile:v,parentScaleBy:E,parentTopLeft:T,fadeValues:k}}if(g.selfFading){const v=(function(E,T){const k=I.now(),V=l.ah((k-E.timeAdded)/T,0,1);return{tileOpacity:V,fadeMix:{opacity:V,mix:0}}})(g,u);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:v}}return m}const Pi=new l.bf(1,0,0,1),_a=new l.bf(0,1,0,1),ms=new l.bf(0,0,1,1),_f=new l.bf(1,0,1,1),Yc=new l.bf(0,1,1,1);function bf(g,t,u,p){sl(g,0,t+u/2,g.transform.width,u,p)}function ba(g,t,u,p){sl(g,t-u/2,0,u,g.transform.height,p)}function sl(g,t,u,p,m,v){const E=g.context,T=E.gl;T.enable(T.SCISSOR_TEST),T.scissor(t*g.pixelRatio,u*g.pixelRatio,p*g.pixelRatio,m*g.pixelRatio),E.clear({color:v}),T.disable(T.SCISSOR_TEST)}function gu(g,t,u){const p=g.context,m=p.gl,v=g.useProgram("debug"),E=pr.disabled,T=xr.disabled,k=g.colorModeForRenderPass(),V="$debug",N=g.style.map.terrain&&g.style.map.terrain.getTerrainData(u);p.activeTexture.set(m.TEXTURE0);const $=t.getTileByID(u.key).latestRawTileData,K=Math.floor(($&&$.byteLength||0)/1024),X=t.getTile(u).tileSize,re=512/Math.min(X,512)*(u.overscaledZ/g.transform.zoom)*.5;let le=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(le+=` => ${u.overscaledZ}`),(function(ce,be){ce.initDebugOverlayCanvas();const Ee=ce.debugOverlayCanvas,xe=ce.context.gl,Pe=ce.debugOverlayCanvas.getContext("2d");Pe.clearRect(0,0,Ee.width,Ee.height),Pe.shadowColor="white",Pe.shadowBlur=2,Pe.lineWidth=1.5,Pe.strokeStyle="white",Pe.textBaseline="top",Pe.font="bold 36px Open Sans, sans-serif",Pe.fillText(be,5,5),Pe.strokeText(be,5,5),ce.debugOverlayTexture.update(Ee),ce.debugOverlayTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE)})(g,`${le} ${K}kB`);const ue=g.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});v.draw(p,m.TRIANGLES,E,T,ri.alphaBlended,Br.disabled,gm(l.bf.transparent,re),null,ue,V,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),v.draw(p,m.LINE_STRIP,E,T,k,Br.disabled,gm(l.bf.red),N,ue,V,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function Jc(g,t,u,p){const{isRenderingGlobe:m}=p,v=g.context,E=v.gl,T=g.transform,k=g.colorModeForRenderPass(),V=g.getDepthModeFor3D(),N=g.useProgram("terrain");v.bindFramebuffer.set(null),v.viewport.set([0,0,g.width,g.height]);for(const $ of u){const K=t.getTerrainMesh($.tileID),X=g.renderToTexture.getTexture($),re=t.getTerrainData($.tileID);v.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,X.texture);const le=t.getMeshFrameDelta(T.zoom),ue=T.calculateFogMatrix($.tileID.toUnwrapped()),ce=Qp(le,ue,g.style.sky,T.pitch,m),be=T.getProjectionData({overscaledTileID:$.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});N.draw(v,E.TRIANGLES,V,xr.disabled,k,Br.backCCW,ce,re,be,"terrain",K.vertexBuffer,K.indexBuffer,K.segments)}}function vf(g,t){if(!t.mesh){const u=new l.aL;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const p=new l.aN;p.emplaceBack(0,1,2),p.emplaceBack(0,2,3),t.mesh=new Io(g.createVertexBuffer(u,un.members),g.createIndexBuffer(p),l.aM.simpleSegment(0,0,u.length,p.length))}return t.mesh}class Vm{constructor(t,u){this.context=new wv(t),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:l.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Ot.maxUnderzooming+Ot.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Do}resize(t,u,p){if(this.width=Math.floor(t*p),this.height=Math.floor(u*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style._order)this.style._layers[m].resize()}setup(){const t=this.context,u=new l.aL;u.emplaceBack(0,0),u.emplaceBack(l.$,0),u.emplaceBack(0,l.$),u.emplaceBack(l.$,l.$),this.tileExtentBuffer=t.createVertexBuffer(u,un.members),this.tileExtentSegments=l.aM.simpleSegment(0,0,4,2);const p=new l.aL;p.emplaceBack(0,0),p.emplaceBack(l.$,0),p.emplaceBack(0,l.$),p.emplaceBack(l.$,l.$),this.debugBuffer=t.createVertexBuffer(p,un.members),this.debugSegments=l.aM.simpleSegment(0,0,4,5);const m=new l.c7;m.emplaceBack(0,0,0,0),m.emplaceBack(l.$,0,l.$,0),m.emplaceBack(0,l.$,0,l.$),m.emplaceBack(l.$,l.$,l.$,l.$),this.rasterBoundsBuffer=t.createVertexBuffer(m,pv.members),this.rasterBoundsSegments=l.aM.simpleSegment(0,0,4,2);const v=new l.aL;v.emplaceBack(0,0),v.emplaceBack(l.$,0),v.emplaceBack(0,l.$),v.emplaceBack(l.$,l.$),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(v,un.members),this.rasterBoundsSegmentsPosOnly=l.aM.simpleSegment(0,0,4,5);const E=new l.aL;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(E,un.members),this.viewportSegments=l.aM.simpleSegment(0,0,4,2);const T=new l.c8;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(T);const k=new l.aN;k.emplaceBack(1,0,2),k.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(k);const V=this.context.gl;this.stencilClearMode=new xr({func:V.ALWAYS,mask:0},0,255,V.ZERO,V.ZERO,V.ZERO),this.tileExtentMesh=new Io(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,u=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=l.L();l.bZ(p,0,this.width,this.height,0,0,1),l.N(p,p,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const m={mainMatrix:p,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:p};this.useProgram("clippingMask",null,!0).draw(t,u.TRIANGLES,pr.disabled,this.stencilClearMode,ri.disabled,Br.disabled,null,null,m,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,u,p){if(this.currentStencilSource===t.source||!t.isTileClipped()||!u||!u.length)return;this.currentStencilSource=t.source,this.nextStencilID+u.length>256&&this.clearStencil();const m=this.context;m.setColorMode(ri.disabled),m.setDepthMode(pr.disabled);const v={};for(const E of u)v[E.key]=this.nextStencilID++;this._renderTileMasks(v,u,p,!0),this._renderTileMasks(v,u,p,!1),this._tileClippingMaskIDs=v}_renderTileMasks(t,u,p,m){const v=this.context,E=v.gl,T=this.style.projection,k=this.transform,V=this.useProgram("clippingMask");for(const N of u){const $=t[N.key],K=this.style.map.terrain&&this.style.map.terrain.getTerrainData(N),X=T.getMeshFromTileID(this.context,N.canonical,m,!0,"stencil"),re=k.getProjectionData({overscaledTileID:N,applyGlobeMatrix:!p,applyTerrainMatrix:!0});V.draw(v,E.TRIANGLES,pr.disabled,new xr({func:E.ALWAYS,mask:0},$,255,E.KEEP,E.KEEP,E.REPLACE),ri.disabled,p?Br.disabled:Br.backCCW,null,K,re,"$clipping",X.vertexBuffer,X.indexBuffer,X.segments)}}_renderTilesDepthBuffer(){const t=this.context,u=t.gl,p=this.style.projection,m=this.transform,v=this.useProgram("depth"),E=this.getDepthModeFor3D(),T=hr(m,{tileSize:m.tileSize});for(const k of T){const V=this.style.map.terrain&&this.style.map.terrain.getTerrainData(k),N=p.getMeshFromTileID(this.context,k.canonical,!0,!0,"raster"),$=m.getProjectionData({overscaledTileID:k,applyGlobeMatrix:!0,applyTerrainMatrix:!0});v.draw(t,u.TRIANGLES,E,xr.disabled,ri.disabled,Br.backCCW,null,V,$,"$clipping",N.vertexBuffer,N.indexBuffer,N.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,u=this.context.gl;return new xr({func:u.NOTEQUAL,mask:255},t,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(t){const u=this.context.gl;return new xr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const u=this.context.gl,p=t.sort(((E,T)=>T.overscaledZ-E.overscaledZ)),m=p[p.length-1].overscaledZ,v=p[0].overscaledZ-m+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const E={};for(let T=0;T<v;T++)E[T+m]=new xr({func:u.GEQUAL,mask:255},T+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=v,[E,p]}return[{[m]:xr.disabled},p]}stencilConfigForOverlapTwoPass(t){const u=this.context.gl,p=t.sort(((E,T)=>T.overscaledZ-E.overscaledZ)),m=p[p.length-1].overscaledZ,v=p[0].overscaledZ-m+1;if(this.clearStencil(),v>1){const E={},T={};for(let k=0;k<v;k++)E[k+m]=new xr({func:u.GREATER,mask:255},v+1+k,255,u.KEEP,u.KEEP,u.REPLACE),T[k+m]=new xr({func:u.GREATER,mask:255},1+k,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*v+1,[E,T,p]}return this.nextStencilID=3,[{[m]:new xr({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[m]:new xr({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},p]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new ri([t.CONSTANT_COLOR,t.ONE],new l.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ri.unblended:ri.alphaBlended}getDepthModeForSublayer(t,u,p){if(!this.opaquePassEnabledForLayer())return pr.disabled;const m=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new pr(p||this.context.gl.LEQUAL,u,[m,m])}getDepthModeFor3D(){return new pr(this.context.gl.LEQUAL,pr.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,u){var p,m;this.style=t,this.options=u,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(I.now()),this.imageManager.beginFrame();const v=this.style._order,E=this.style.sourceCaches,T={},k={},V={},N={isRenderingToTexture:!1,isRenderingGlobe:((p=t.projection)===null||p===void 0?void 0:p.transitionState)>0};for(const K in E){const X=E[K];X.used&&X.prepare(this.context),T[K]=X.getVisibleCoordinates(!1),k[K]=T[K].slice().reverse(),V[K]=X.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let K=0;K<v.length;K++)if(this.style._layers[v[K]].is3D()){this.opaquePassCutoff=K;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const K of v){const X=this.style._layers[K];if(!X.hasOffscreenPass()||X.isHidden(this.transform.zoom))continue;const re=k[X.source];(X.type==="custom"||re.length)&&this.renderLayer(this,E[X.source],X,re,N)}if((m=this.style.projection)===null||m===void 0||m.updateGPUdependent({context:this.context,useProgram:K=>this.useProgram(K)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?l.bf.black:l.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(K,X){const re=K.context,le=re.gl,ue=((Ue,Ae,Fe)=>{const it=Math.cos(Ae.rollInRadians),Xe=Math.sin(Ae.rollInRadians),Je=Ge(Ae),Qe=Ae.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Ue.properties.get("sky-color"),u_horizon_color:Ue.properties.get("horizon-color"),u_horizon:[(Ae.width/2-Je*Xe)*Fe,(Ae.height/2+Je*it)*Fe],u_horizon_normal:[-Xe,it],u_sky_horizon_blend:Ue.properties.get("sky-horizon-blend")*Ae.height/2*Fe,u_sky_blend:Qe}})(X,K.style.map.transform,K.pixelRatio),ce=new pr(le.LEQUAL,pr.ReadWrite,[0,1]),be=xr.disabled,Ee=K.colorModeForRenderPass(),xe=K.useProgram("sky"),Pe=vf(re,X);xe.draw(re,le.TRIANGLES,ce,be,Ee,Br.disabled,ue,null,void 0,"sky",Pe.vertexBuffer,Pe.indexBuffer,Pe.segments)})(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){const K=this.style._layers[v[this.currentLayer]],X=E[K.source],re=T[K.source];this._renderTileClippingMasks(K,re,!1),this.renderLayer(this,X,K,re,N)}this.renderPass="translucent";let $=!1;for(this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){const K=this.style._layers[v[this.currentLayer]],X=E[K.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(K,N))continue;this.opaquePassEnabledForLayer()||$||($=!0,N.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const re=(K.type==="symbol"?V:k)[K.source];this._renderTileClippingMasks(K,T[K.source],!!this.renderToTexture),this.renderLayer(this,X,K,re,N)}if(N.isRenderingGlobe&&(function(K,X,re){const le=K.context,ue=le.gl,ce=K.useProgram("atmosphere"),be=new pr(ue.LEQUAL,pr.ReadOnly,[0,1]),Ee=K.transform,xe=(function(Qe,xt){const wt=Qe.properties.get("position"),pt=[-wt.x,-wt.y,-wt.z],jt=l.ag(new Float64Array(16));return Qe.properties.get("anchor")==="map"&&(l.b6(jt,jt,xt.rollInRadians),l.b7(jt,jt,-xt.pitchInRadians),l.b6(jt,jt,xt.bearingInRadians),l.b7(jt,jt,xt.center.lat*Math.PI/180),l.bz(jt,jt,-xt.center.lng*Math.PI/180)),l.c6(pt,pt,jt),pt})(re,K.transform),Pe=Ee.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Ue=X.properties.get("atmosphere-blend")*Pe.projectionTransition;if(Ue===0)return;const Ae=da(Ee.worldSize,Ee.center.lat),Fe=Ee.inverseProjectionMatrix,it=new Float64Array(4);it[3]=1,l.aw(it,it,Ee.modelViewProjectionMatrix),it[0]/=it[3],it[1]/=it[3],it[2]/=it[3],it[3]=1,l.aw(it,it,Fe),it[0]/=it[3],it[1]/=it[3],it[2]/=it[3],it[3]=1;const Xe=((Qe,xt,wt,pt,jt)=>({u_sun_pos:Qe,u_atmosphere_blend:xt,u_globe_position:wt,u_globe_radius:pt,u_inv_proj_matrix:jt}))(xe,Ue,[it[0],it[1],it[2]],Ae,Fe),Je=vf(le,X);ce.draw(le,ue.TRIANGLES,be,xr.disabled,ri.alphaBlended,Br.disabled,Xe,null,null,"atmosphere",Je.vertexBuffer,Je.indexBuffer,Je.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const K=(function(X,re){let le=null;const ue=Object.values(X._layers).flatMap((xe=>xe.source&&!xe.isHidden(re)?[X.sourceCaches[xe.source]]:[])),ce=ue.filter((xe=>xe.getSource().type==="vector")),be=ue.filter((xe=>xe.getSource().type!=="vector")),Ee=xe=>{(!le||le.getSource().maxzoom<xe.getSource().maxzoom)&&(le=xe)};return ce.forEach((xe=>Ee(xe))),le||be.forEach((xe=>Ee(xe))),le})(this.style,this.transform.zoom);K&&(function(X,re,le){for(let ue=0;ue<le.length;ue++)gu(X,re,le[ue])})(this,K,K.getVisibleCoordinates())}this.options.showPadding&&(function(K){const X=K.transform.padding;bf(K,K.transform.height-(X.top||0),3,Pi),bf(K,X.bottom||0,3,_a),ba(K,X.left||0,3,ms),ba(K,K.transform.width-(X.right||0),3,_f);const re=K.transform.centerPoint;(function(le,ue,ce,be){sl(le,ue-1,ce-10,2,20,be),sl(le,ue-10,ce-1,20,2,be)})(K,re.x,K.transform.height-re.y,Yc)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,p=this.transform.modelViewProjectionMatrix;let m=this.terrainFacilitator.dirty;m||(m=t?!l.c9(u,p):!l.ca(u,p)),m||(m=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),m&&(l.cb(u,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(v,E){const T=v.context,k=T.gl,V=v.transform,N=ri.unblended,$=new pr(k.LEQUAL,pr.ReadWrite,[0,1]),K=E.sourceCache.getRenderableTiles(),X=v.useProgram("terrainDepth");T.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),T.clear({color:l.bf.transparent,depth:1});for(const re of K){const le=E.getTerrainMesh(re.tileID),ue=E.getTerrainData(re.tileID),ce=V.getProjectionData({overscaledTileID:re.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),be={u_ele_delta:E.getMeshFrameDelta(V.zoom)};X.draw(T,k.TRIANGLES,$,xr.disabled,N,Br.backCCW,be,ue,ce,"terrain",le.vertexBuffer,le.indexBuffer,le.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,v.width,v.height])})(this,this.style.map.terrain),(function(v,E){const T=v.context,k=T.gl,V=v.transform,N=ri.unblended,$=new pr(k.LEQUAL,pr.ReadWrite,[0,1]),K=E.getCoordsTexture(),X=E.sourceCache.getRenderableTiles(),re=v.useProgram("terrainCoords");T.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,v.width/devicePixelRatio,v.height/devicePixelRatio]),T.clear({color:l.bf.transparent,depth:1}),E.coordsIndex=[];for(const le of X){const ue=E.getTerrainMesh(le.tileID),ce=E.getTerrainData(le.tileID);T.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,K.texture);const be={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta(V.zoom)},Ee=V.getProjectionData({overscaledTileID:le.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});re.draw(T,k.TRIANGLES,$,xr.disabled,N,Br.backCCW,be,ce,Ee,"terrain",ue.vertexBuffer,ue.indexBuffer,ue.segments),E.coordsIndex.push(le.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,v.width,v.height])})(this,this.style.map.terrain))}renderLayer(t,u,p,m,v){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="custom"||(m||[]).length)&&(this.id=p.id,l.cc(p)?(function(E,T,k,V,N,$){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:K}=$,X=xr.disabled,re=E.colorModeForRenderPass();(k._unevaluatedLayout.hasValue("text-variable-anchor")||k._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(le,ue,ce,be,Ee,xe,Pe,Ue,Ae){const Fe=ue.transform,it=ue.style.map.terrain,Xe=Ee==="map",Je=xe==="map";for(const Qe of le){const xt=be.getTile(Qe),wt=xt.getBucket(ce);if(!wt||!wt.text||!wt.text.segments.get().length)continue;const pt=l.an(wt.textSizeData,Fe.zoom),jt=l.aC(xt,1,ue.transform.zoom),fr=jr(Xe,ue.transform,jt),Yr=ce.layout.get("icon-text-fit")!=="none"&&wt.hasIconData();if(pt){const Jr=Math.pow(2,Fe.zoom-xt.tileID.overscaledZ),ii=it?(xi,di)=>it.getElevation(Qe,xi,di):null;Nc(wt,Xe,Je,Ae,Fe,fr,Jr,pt,Yr,l.aD(Fe,xt,Pe,Ue),Qe.toUnwrapped(),ii)}}})(V,E,k,T,k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),N),k.paint.get("icon-opacity").constantOr(1)!==0&&qc(E,T,k,V,!1,k.paint.get("icon-translate"),k.paint.get("icon-translate-anchor"),k.layout.get("icon-rotation-alignment"),k.layout.get("icon-pitch-alignment"),k.layout.get("icon-keep-upright"),X,re,K),k.paint.get("text-opacity").constantOr(1)!==0&&qc(E,T,k,V,!0,k.paint.get("text-translate"),k.paint.get("text-translate-anchor"),k.layout.get("text-rotation-alignment"),k.layout.get("text-pitch-alignment"),k.layout.get("text-keep-upright"),X,re,K),T.map.showCollisionBoxes&&(mf(E,T,k,V,!0),mf(E,T,k,V,!1))})(t,u,p,m,this.style.placement.variableOffsets,v):l.cd(p)?(function(E,T,k,V,N){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=N,K=k.paint.get("circle-opacity"),X=k.paint.get("circle-stroke-width"),re=k.paint.get("circle-stroke-opacity"),le=!k.layout.get("circle-sort-key").isConstant();if(K.constantOr(1)===0&&(X.constantOr(1)===0||re.constantOr(1)===0))return;const ue=E.context,ce=ue.gl,be=E.transform,Ee=E.getDepthModeForSublayer(0,pr.ReadOnly),xe=xr.disabled,Pe=E.colorModeForRenderPass(),Ue=[],Ae=be.getCircleRadiusCorrection();for(let Fe=0;Fe<V.length;Fe++){const it=V[Fe],Xe=T.getTile(it),Je=Xe.getBucket(k);if(!Je)continue;const Qe=k.paint.get("circle-translate"),xt=k.paint.get("circle-translate-anchor"),wt=l.aD(be,Xe,Qe,xt),pt=Je.programConfigurations.get(k.id),jt=E.useProgram("circle",pt),fr=Je.layoutVertexBuffer,Yr=Je.indexBuffer,Jr=E.style.map.terrain&&E.style.map.terrain.getTerrainData(it),ii={programConfiguration:pt,program:jt,layoutVertexBuffer:fr,indexBuffer:Yr,uniformValues:kc(E,Xe,k,wt,Ae),terrainData:Jr,projectionData:be.getProjectionData({overscaledTileID:it,applyGlobeMatrix:!$,applyTerrainMatrix:!0})};if(le){const xi=Je.segments.get();for(const di of xi)Ue.push({segments:new l.aM([di]),sortKey:di.sortKey,state:ii})}else Ue.push({segments:Je.segments,sortKey:0,state:ii})}le&&Ue.sort(((Fe,it)=>Fe.sortKey-it.sortKey));for(const Fe of Ue){const{programConfiguration:it,program:Xe,layoutVertexBuffer:Je,indexBuffer:Qe,uniformValues:xt,terrainData:wt,projectionData:pt}=Fe.state;Xe.draw(ue,ce.TRIANGLES,Ee,xe,Pe,Br.backCCW,xt,wt,pt,k.id,Je,Qe,Fe.segments,k.paint,E.transform.zoom,it)}})(t,u,p,m,v):l.ce(p)?(function(E,T,k,V,N){if(k.paint.get("heatmap-opacity")===0)return;const $=E.context,{isRenderingToTexture:K,isRenderingGlobe:X}=N;if(E.style.map.terrain){for(const re of V){const le=T.getTile(re);T.hasRenderableParent(re)||(E.renderPass==="offscreen"?Kc(E,le,k,re,X):E.renderPass==="translucent"&&Gc(E,k,re,K,X))}$.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?(function(re,le,ue,ce){const be=re.context,Ee=be.gl,xe=re.transform,Pe=xr.disabled,Ue=new ri([Ee.ONE,Ee.ONE],l.bf.transparent,[!0,!0,!0,!0]);(function(Ae,Fe,it){const Xe=Ae.gl;Ae.activeTexture.set(Xe.TEXTURE1),Ae.viewport.set([0,0,Fe.width/4,Fe.height/4]);let Je=it.heatmapFbos.get(l.c3);Je?(Xe.bindTexture(Xe.TEXTURE_2D,Je.colorAttachment.get()),Ae.bindFramebuffer.set(Je.framebuffer)):(Je=fu(Ae,Fe.width/4,Fe.height/4),it.heatmapFbos.set(l.c3,Je))})(be,re,ue),be.clear({color:l.bf.transparent});for(let Ae=0;Ae<ce.length;Ae++){const Fe=ce[Ae];if(le.hasRenderableParent(Fe))continue;const it=le.getTile(Fe),Xe=it.getBucket(ue);if(!Xe)continue;const Je=Xe.programConfigurations.get(ue.id),Qe=re.useProgram("heatmap",Je),xt=xe.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),wt=xe.getCircleRadiusCorrection();Qe.draw(be,Ee.TRIANGLES,pr.disabled,Pe,Ue,Br.backCCW,rf(it,xe.zoom,ue.paint.get("heatmap-intensity"),wt),null,xt,ue.id,Xe.layoutVertexBuffer,Xe.indexBuffer,Xe.segments,ue.paint,xe.zoom,Je)}be.viewport.set([0,0,re.width,re.height])})(E,T,k,V):E.renderPass==="translucent"&&(function(re,le){const ue=re.context,ce=ue.gl;ue.setColorMode(re.colorModeForRenderPass());const be=le.heatmapFbos.get(l.c3);be&&(ue.activeTexture.set(ce.TEXTURE0),ce.bindTexture(ce.TEXTURE_2D,be.colorAttachment.get()),ue.activeTexture.set(ce.TEXTURE1),ga(ue,le).bind(ce.LINEAR,ce.CLAMP_TO_EDGE),re.useProgram("heatmapTexture").draw(ue,ce.TRIANGLES,pr.disabled,xr.disabled,re.colorModeForRenderPass(),Br.disabled,_m(re,le,0,1),null,null,le.id,re.viewportBuffer,re.quadTriangleIndexBuffer,re.viewportSegments,le.paint,re.transform.zoom))})(E,k)})(t,u,p,m,v):l.cf(p)?(function(E,T,k,V,N){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=N,K=k.paint.get("line-opacity"),X=k.paint.get("line-width");if(K.constantOr(1)===0||X.constantOr(1)===0)return;const re=E.getDepthModeForSublayer(0,pr.ReadOnly),le=E.colorModeForRenderPass(),ue=k.paint.get("line-dasharray"),ce=ue.constantOr(1),be=k.paint.get("line-pattern"),Ee=be.constantOr(1),xe=k.paint.get("line-gradient"),Pe=k.getCrossfadeParameters();let Ue;Ue=Ee?"linePattern":ce&&xe?"lineGradientSDF":ce?"lineSDF":xe?"lineGradient":"line";const Ae=E.context,Fe=Ae.gl,it=E.transform;let Xe=!0;for(const Je of V){const Qe=T.getTile(Je);if(Ee&&!Qe.patternsLoaded())continue;const xt=Qe.getBucket(k);if(!xt)continue;const wt=xt.programConfigurations.get(k.id),pt=E.context.program.get(),jt=E.useProgram(Ue,wt),fr=Xe||jt.program!==pt,Yr=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Je),Jr=be.constantOr(null),ii=ue&&ue.constantOr(null);if(Jr&&Qe.imageAtlas){const pn=Qe.imageAtlas,Oi=pn.patternPositions[Jr.to.toString()],Vi=pn.patternPositions[Jr.from.toString()];Oi&&Vi&&wt.setConstantPatternPositions(Oi,Vi)}else if(ii){const pn=k.layout.get("line-cap")==="round",Oi=E.lineAtlas.getDash(ii.to,pn),Vi=E.lineAtlas.getDash(ii.from,pn);wt.setConstantDashPositions(Oi,Vi)}const xi=it.getProjectionData({overscaledTileID:Je,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),di=it.getPixelScale();let Vr;Ee?(Vr=pa(E,Qe,k,di,Pe),Av(Ae,Fe,Qe,wt,Pe)):ce&&xe?(Vr=Am(E,Qe,k,di,Pe,xt.lineClipsArray.length),zm(E,T,Ae,Fe,k,xt,Je,wt,Pe)):ce?(Vr=Em(E,Qe,k,di,Pe),hu(E,Ae,Fe,wt,fr,Pe)):xe?(Vr=wm(E,Qe,k,di,xt.lineClipsArray.length),Rv(E,T,Ae,Fe,k,xt,Je)):Vr=lu(E,Qe,k,di);const gi=E.stencilModeForClipping(Je);jt.draw(Ae,Fe.TRIANGLES,re,gi,le,Br.disabled,Vr,Yr,xi,k.id,xt.layoutVertexBuffer,xt.indexBuffer,xt.segments,k.paint,E.transform.zoom,wt,xt.layoutVertexBuffer2),Xe=!1}})(t,u,p,m,v):l.cg(p)?(function(E,T,k,V,N){const $=k.paint.get("fill-color"),K=k.paint.get("fill-opacity");if(K.constantOr(1)===0)return;const{isRenderingToTexture:X}=N,re=E.colorModeForRenderPass(),le=k.paint.get("fill-pattern"),ue=E.opaquePassEnabledForLayer()&&!le.constantOr(1)&&$.constantOr(l.bf.transparent).a===1&&K.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===ue){const ce=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?pr.ReadWrite:pr.ReadOnly);Zc(E,T,k,V,ce,re,!1,X)}if(E.renderPass==="translucent"&&k.paint.get("fill-antialias")){const ce=E.getDepthModeForSublayer(k.getPaintProperty("fill-outline-color")?2:0,pr.ReadOnly);Zc(E,T,k,V,ce,re,!0,X)}})(t,u,p,m,v):l.ch(p)?(function(E,T,k,V,N){const $=k.paint.get("fill-extrusion-opacity");if($===0)return;const{isRenderingToTexture:K}=N;if(E.renderPass==="translucent"){const X=new pr(E.context.gl.LEQUAL,pr.ReadWrite,E.depthRangeFor3D);if($!==1||k.paint.get("fill-extrusion-pattern").constantOr(1))Hc(E,T,k,V,X,xr.disabled,ri.disabled,K),Hc(E,T,k,V,X,E.stencilModeFor3D(),E.colorModeForRenderPass(),K);else{const re=E.colorModeForRenderPass();Hc(E,T,k,V,X,xr.disabled,re,K)}}})(t,u,p,m,v):l.ci(p)?(function(E,T,k,V,N){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:$}=N,K=E.context,X=E.style.projection.useSubdivision,re=E.getDepthModeForSublayer(0,pr.ReadOnly),le=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(ue,ce,be,Ee,xe,Pe,Ue){const Ae=ue.context,Fe=Ae.gl;for(const it of be){const Xe=ce.getTile(it),Je=Xe.dem;if(!Je||!Je.data||!Xe.needsHillshadePrepare)continue;const Qe=Je.dim,xt=Je.stride,wt=Je.getPixels();if(Ae.activeTexture.set(Fe.TEXTURE1),Ae.pixelStoreUnpackPremultiplyAlpha.set(!1),Xe.demTexture=Xe.demTexture||ue.getTileTexture(xt),Xe.demTexture){const jt=Xe.demTexture;jt.update(wt,{premultiply:!1}),jt.bind(Fe.NEAREST,Fe.CLAMP_TO_EDGE)}else Xe.demTexture=new l.T(Ae,wt,Fe.RGBA,{premultiply:!1}),Xe.demTexture.bind(Fe.NEAREST,Fe.CLAMP_TO_EDGE);Ae.activeTexture.set(Fe.TEXTURE0);let pt=Xe.fbo;if(!pt){const jt=new l.T(Ae,{width:Qe,height:Qe,data:null},Fe.RGBA);jt.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE),pt=Xe.fbo=Ae.createFramebuffer(Qe,Qe,!0,!1),pt.colorAttachment.set(jt.texture)}Ae.bindFramebuffer.set(pt.framebuffer),Ae.viewport.set([0,0,Qe,Qe]),ue.useProgram("hillshadePrepare").draw(Ae,Fe.TRIANGLES,xe,Pe,Ue,Br.disabled,nf(Xe.tileID,Je),null,null,Ee.id,ue.rasterBoundsBuffer,ue.quadTriangleIndexBuffer,ue.rasterBoundsSegments),Xe.needsHillshadePrepare=!1}})(E,T,V,k,re,xr.disabled,le),K.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(X){const[ue,ce,be]=E.stencilConfigForOverlapTwoPass(V);Xc(E,T,k,be,ue,re,le,!1,$),Xc(E,T,k,be,ce,re,le,!0,$)}else{const[ue,ce]=E.getStencilConfigForOverlapAndUpdateStencilID(V);Xc(E,T,k,ce,ue,re,le,!1,$)}})(t,u,p,m,v):l.cj(p)?(function(E,T,k,V,N){if(E.renderPass!=="translucent"||!V.length)return;const{isRenderingToTexture:$}=N,K=E.style.projection.useSubdivision,X=E.getDepthModeForSublayer(0,pr.ReadOnly),re=E.colorModeForRenderPass();if(K){const[le,ue,ce]=E.stencilConfigForOverlapTwoPass(V);nl(E,T,k,ce,le,X,re,!1,$),nl(E,T,k,ce,ue,X,re,!0,$)}else{const[le,ue]=E.getStencilConfigForOverlapAndUpdateStencilID(V);nl(E,T,k,ue,le,X,re,!1,$)}})(t,u,p,m,v):l.bK(p)?(function(E,T,k,V,N){if(E.renderPass!=="translucent"||k.paint.get("raster-opacity")===0||!V.length)return;const{isRenderingToTexture:$}=N,K=T.getSource(),X=E.style.projection.useSubdivision;if(K instanceof Qt)Wc(E,T,k,V,null,!1,!1,K.tileCoords,K.flippedWindingOrder,$);else if(X){const[re,le,ue]=E.stencilConfigForOverlapTwoPass(V);Wc(E,T,k,ue,re,!1,!0,yu,!1,$),Wc(E,T,k,ue,le,!0,!0,yu,!1,$)}else{const[re,le]=E.getStencilConfigForOverlapAndUpdateStencilID(V);Wc(E,T,k,le,re,!1,!0,yu,!1,$)}})(t,u,p,m,v):l.ck(p)?(function(E,T,k,V,N){const $=k.paint.get("background-color"),K=k.paint.get("background-opacity");if(K===0)return;const{isRenderingToTexture:X}=N,re=E.context,le=re.gl,ue=E.style.projection,ce=E.transform,be=ce.tileSize,Ee=k.paint.get("background-pattern");if(E.isPatternMissing(Ee))return;const xe=!Ee&&$.a===1&&K===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==xe)return;const Pe=xr.disabled,Ue=E.getDepthModeForSublayer(0,xe==="opaque"?pr.ReadWrite:pr.ReadOnly),Ae=E.colorModeForRenderPass(),Fe=E.useProgram(Ee?"backgroundPattern":"background"),it=V||hr(ce,{tileSize:be,terrain:E.style.map.terrain});Ee&&(re.activeTexture.set(le.TEXTURE0),E.imageManager.bind(E.context));const Xe=k.getCrossfadeParameters();for(const Je of it){const Qe=ce.getProjectionData({overscaledTileID:Je,applyGlobeMatrix:!X,applyTerrainMatrix:!0}),xt=Ee?of(K,E,Ee,{tileID:Je,tileSize:be},Xe):Cm(K,$),wt=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Je),pt=ue.getMeshFromTileID(re,Je.canonical,!1,!0,"raster");Fe.draw(re,le.TRIANGLES,Ue,Pe,Ae,Br.backCCW,xt,wt,Qe,k.id,pt.vertexBuffer,pt.indexBuffer,pt.segments)}})(t,0,p,m,v):l.cl(p)&&(function(E,T,k,V){const{isRenderingGlobe:N}=V,$=E.context,K=k.implementation,X=E.style.projection,re=E.transform,le=re.getProjectionDataForCustomLayer(N),ue={farZ:re.farZ,nearZ:re.nearZ,fov:re.fov*Math.PI/180,modelViewProjectionMatrix:re.modelViewProjectionMatrix,projectionMatrix:re.projectionMatrix,shaderData:{variantName:X.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${X.shaderPreludeCode.vertexSource}`,define:X.shaderDefine},defaultProjectionData:le},ce=K.renderingMode?K.renderingMode:"2d";if(E.renderPass==="offscreen"){const be=K.prerender;be&&(E.setCustomLayerDefaults(),$.setColorMode(E.colorModeForRenderPass()),be.call(K,$.gl,ue),$.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),$.setColorMode(E.colorModeForRenderPass()),$.setStencilMode(xr.disabled);const be=ce==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,pr.ReadOnly);$.setDepthMode(be),K.render($.gl,ue),$.setDirty(),E.setBaseState(),$.bindFramebuffer.set(null)}})(t,0,p,v))}saveTileTexture(t){const u=this._tileTextures[t.size[0]];u?u.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const u=this._tileTextures[t];return u&&u.length>0?u.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const u=this.imageManager.getPattern(t.from.toString()),p=this.imageManager.getPattern(t.to.toString());return!u||!p}useProgram(t,u,p=!1,m=[]){this.cache=this.cache||{};const v=!!this.style.map.terrain,E=this.style.projection,T=p?ln.projectionMercator:E.shaderPreludeCode,k=p?Hs:E.shaderDefine,V=t+(u?u.cacheKey:"")+`/${p?Rr:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(v?"/terrain":"")+(m?`/${m.join("/")}`:"");return this.cache[V]||(this.cache[V]=new ef(this.context,ln[t],u,Lc[t],this._showOverdrawInspector,v,T,k,m)),this.cache[V]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:u}=this.context.gl;return this.width!==t||this.height!==u}}function xf(g,t){let u,p=!1,m=null,v=null;const E=()=>{m=null,p&&(g.apply(v,u),m=setTimeout(E,t),p=!1)};return(...T)=>(p=!0,v=this,u=T,m||E(),m)}class wf{constructor(t){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let p;return u.split("&").map((m=>m.split("="))).forEach((m=>{m[0]===this._hashName&&(p=m)})),(p&&p[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:p,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(u.length===0)return;const p=u.join("/");let m=p;m.split("&").length>0&&(m=m.split("&")[0]),this._hashName&&(m=`${this._hashName}=${p}`);let v=window.location.hash.replace(m,"");v.startsWith("#&")?v=v.slice(0,1)+v.slice(2):v==="#"&&(v="");let E=window.location.href.replace(/(#.+)?$/,v);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=xf(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const u=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,m=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,m),E=Math.round(u.lng*v)/v,T=Math.round(u.lat*v)/v,k=this._map.getBearing(),V=this._map.getPitch();let N="";if(N+=t?`/${E}/${T}/${p}`:`${p}/${T}/${E}`,(k||V)&&(N+="/"+Math.round(10*k)/10),V&&(N+=`/${Math.round(V)}`),this._hashName){const $=this._hashName;let K=!1;const X=window.location.hash.slice(1).split("&").map((re=>{const le=re.split("=")[0];return le===$?(K=!0,`${le}=${N}`):re})).filter((re=>re));return K||X.push(`${$}=${N}`),`#${X.join("&")}`}return`#${N}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new l.S(+t[2],+t[1])}catch{return!1}const u=+t[0],p=+(t[3]||0),m=+(t[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&p>=-180&&p<=180&&m>=this._map.getMinPitch()&&m<=this._map.getMaxPitch()}}const ol={linearity:.3,easing:l.cm(0,0,.3,1)},va=l.e({deceleration:2500,maxSpeed:1400},ol),Um=l.e({deceleration:20,maxSpeed:1400},ol),jm=l.e({deceleration:1e3,maxSpeed:360},ol),Nm=l.e({deceleration:1e3,maxSpeed:90},ol),Fm=l.e({deceleration:1e3,maxSpeed:360},ol);class qm{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:I.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,u=I.now();for(;t.length>0&&u-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new l.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)u.zoom+=v.zoomDelta||0,u.bearing+=v.bearingDelta||0,u.pitch+=v.pitchDelta||0,u.roll+=v.rollDelta||0,v.panDelta&&u.pan._add(v.panDelta),v.around&&(u.around=v.around),v.pinchAround&&(u.pinchAround=v.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,m={};if(u.pan.mag()){const v=ll(u.pan.mag(),p,l.e({},va,t||{})),E=u.pan.mult(v.amount/u.pan.mag()),T=this._map.cameraHelper.handlePanInertia(E,this._map.transform);m.center=T.easingCenter,m.offset=T.easingOffset,al(m,v)}if(u.zoom){const v=ll(u.zoom,p,Um);m.zoom=this._map.transform.zoom+v.amount,al(m,v)}if(u.bearing){const v=ll(u.bearing,p,jm);m.bearing=this._map.transform.bearing+l.ah(v.amount,-179,179),al(m,v)}if(u.pitch){const v=ll(u.pitch,p,Nm);m.pitch=this._map.transform.pitch+v.amount,al(m,v)}if(u.roll){const v=ll(u.roll,p,Fm);m.roll=this._map.transform.roll+l.ah(v.amount,-179,179),al(m,v)}if(m.zoom||m.bearing){const v=u.pinchAround===void 0?u.around:u.pinchAround;m.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),l.e(m,{noMoveStart:!0})}}function al(g,t){(!g.duration||g.duration<t.duration)&&(g.duration=t.duration,g.easing=t.easing)}function ll(g,t,u){const{maxSpeed:p,linearity:m,deceleration:v}=u,E=l.ah(g*m/(t/1e3),-p,p),T=Math.abs(E)/(v*m);return{easing:u.easing,duration:1e3*T,amount:E*(T/2)}}class Un extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,u,p,m={}){p=p instanceof MouseEvent?p:new MouseEvent(t,p);const v=L.mousePos(u.getCanvas(),p),E=u.unproject(v);super(t,l.e({point:v,lngLat:E,originalEvent:p},m)),this._defaultPrevented=!1,this.target=u}}class Mo extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,u,p){const m=t==="touchend"?p.changedTouches:p.touches,v=L.touchPos(u.getCanvasContainer(),m),E=v.map((k=>u.unproject(k))),T=v.reduce(((k,V,N,$)=>k.add(V.div($.length))),new l.P(0,0));super(t,{points:v,point:T,lngLats:E,lngLat:u.unproject(T),originalEvent:p}),this._defaultPrevented=!1}}class Ef extends l.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,u,p){super(t,{originalEvent:p}),this._defaultPrevented=!1}}class ys{constructor(t,u){this._map=t,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Ef(t.type,this._map,t))}mousedown(t,u){return this._mousedownPos=u,this._firePreventable(new Un(t.type,this._map,t))}mouseup(t){this._map.fire(new Un(t.type,this._map,t))}click(t,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new Un(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Un(t.type,this._map,t))}mouseover(t){this._map.fire(new Un(t.type,this._map,t))}mouseout(t){this._map.fire(new Un(t.type,this._map,t))}touchstart(t){return this._firePreventable(new Mo(t.type,this._map,t))}touchmove(t){this._map.fire(new Mo(t.type,this._map,t))}touchend(t){this._map.fire(new Mo(t.type,this._map,t))}touchcancel(t){this._map.fire(new Mo(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Cs{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Un(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Un("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Un(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ul{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(l.P.convert(t),this._map.terrain)}}class gs{constructor(t,u){this._map=t,this._tr=new ul(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,u){this.isEnabled()&&t.shiftKey&&t.button===0&&(L.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(t,u){if(!this._active)return;const p=u;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const m=this._startPos;this._lastPos=p,this._box||(this._box=L.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const v=Math.min(m.x,p.x),E=Math.max(m.x,p.x),T=Math.min(m.y,p.y),k=Math.max(m.y,p.y);L.setTransform(this._box,`translate(${v}px,${T}px)`),this._box.style.width=E-v+"px",this._box.style.height=k-T+"px"}mouseupWindow(t,u){if(!this._active||t.button!==0)return;const p=this._startPos,m=u;if(this.reset(),L.suppressClick(),p.x!==m.x||p.y!==m.y)return this._map.fire(new l.l("boxzoomend",{originalEvent:t})),{cameraAnimation:v=>v.fitScreenCoordinates(p,m,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(L.remove(this._box),this._box=null),L.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,u){return this._map.fire(new l.l(t,{originalEvent:u}))}}function zo(g,t){if(g.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${t.length}`);const u={};for(let p=0;p<g.length;p++)u[g[p].identifier]=t[p];return u}class Sv{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,u,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),p.length===this.numTouches&&(this.centroid=(function(m){const v=new l.P(0,0);for(const E of m)v._add(E);return v.div(m.length)})(u),this.touches=zo(p,u)))}touchmove(t,u,p){if(this.aborted||!this.centroid)return;const m=zo(p,u);for(const v in this.touches){const E=m[v];(!E||E.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(t,u,p){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const m=!this.aborted&&this.centroid;if(this.reset(),m)return m}}}class Af{constructor(t){this.singleTap=new Sv(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,u,p){this.singleTap.touchstart(t,u,p)}touchmove(t,u,p){this.singleTap.touchmove(t,u,p)}touchend(t,u,p){const m=this.singleTap.touchend(t,u,p);if(m){const v=t.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(m)<30;if(v&&E||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}}}class Tv{constructor(t){this._tr=new ul(t),this._zoomIn=new Af({numTouches:1,numTaps:2}),this._zoomOut=new Af({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,u,p){this._zoomIn.touchstart(t,u,p),this._zoomOut.touchstart(t,u,p)}touchmove(t,u,p){this._zoomIn.touchmove(t,u,p),this._zoomOut.touchmove(t,u,p)}touchend(t,u,p){const m=this._zoomIn.touchend(t,u,p),v=this._zoomOut.touchend(t,u,p),E=this._tr;return m?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(m)},{originalEvent:t})}):v?(this._active=!0,t.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(v)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _u{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const u=this._moveFunction(...t);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(t,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,u){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const m=Array.isArray(u)?u[0]:u;return!this._moved&&m.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=m,this._move(p,m))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&L.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Km=0,bu=2,co={[Km]:1,[bu]:2};class It{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const u=L.mouseButton(t);this._eventButton=u}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!(function(u,p){const m=co[p];return u.buttons===void 0||(u.buttons&m)!==m})(t,this._eventButton)}isValidEndEvent(t){return L.mouseButton(t)===this._eventButton}}class Gm{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class Rf{constructor(t=new It({checkCorrectEvent:()=>!0}),u=new Gm){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(t,u,p){return t instanceof MouseEvent?u(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?p(t):void 0}startMove(t){this._executeRelevantHandler(t,(u=>this.mouseMoveStateManager.startMove(u)),(u=>this.oneFingerTouchMoveStateManager.startMove(u)))}endMove(t){this._executeRelevantHandler(t,(u=>this.mouseMoveStateManager.endMove(u)),(u=>this.oneFingerTouchMoveStateManager.endMove(u)))}isValidStartEvent(t){return this._executeRelevantHandler(t,(u=>this.mouseMoveStateManager.isValidStartEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u)))}isValidMoveEvent(t){return this._executeRelevantHandler(t,(u=>this.mouseMoveStateManager.isValidMoveEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u)))}isValidEndEvent(t){return this._executeRelevantHandler(t,(u=>this.mouseMoveStateManager.isValidEndEvent(u)),(u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u)))}}const vu=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=t=>{t.preventDefault()}};class xu{constructor(t,u){this._clickTolerance=t.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,u,p){return this._calculateTransform(t,u,p)}touchmove(t,u,p){if(this._active){if(!this._shouldBePrevented(p.length))return t.preventDefault(),this._calculateTransform(t,u,p);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,u,p){this._calculateTransform(t,u,p),this._active&&this._shouldBePrevented(p.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,u,p){p.length>0&&(this._active=!0);const m=zo(p,u),v=new l.P(0,0),E=new l.P(0,0);let T=0;for(const V in m){const N=m[V],$=this._touches[V];$&&(v._add(N),E._add(N.sub($)),T++,m[V]=N)}if(this._touches=m,this._shouldBePrevented(T)||!E.mag())return;const k=E.div(T);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(T),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xa{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,u,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([u[0],u[1]]))}touchmove(t,u,p){if(!this._firstTwoTouches)return;t.preventDefault();const[m,v]=this._firstTwoTouches,E=cl(p,u,m),T=cl(p,u,v);if(!E||!T)return;const k=this._aroundCenter?null:E.add(T).div(2);return this._move([E,T],k,t)}touchend(t,u,p){if(!this._firstTwoTouches)return;const[m,v]=this._firstTwoTouches,E=cl(p,u,m),T=cl(p,u,v);E&&T||(this._active&&L.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function cl(g,t,u){for(let p=0;p<g.length;p++)if(g[p].identifier===u)return t[p]}function Ir(g,t){return Math.log(g/t)/Math.LN2}class Qc extends xa{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,u){const p=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ir(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ir(this._distance,p),pinchAround:u}}}function $m(g,t){return 180*g.angleWith(t)/Math.PI}class ed extends xa{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,u,p){const m=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:$m(this._vector,m),pinchAround:u}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const u=25/(Math.PI*this._minDiameter)*360,p=$m(t,this._startVector);return Math.abs(p)<u}}function Sf(g){return Math.abs(g.y)>Math.abs(g.x)}class Zm extends xa{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,u,p){super.touchstart(t,u,p),this._currentTouchCount=p.length}_start(t){this._lastPoints=t,Sf(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,u,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const m=t[0].sub(this._lastPoints[0]),v=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(m,v,p.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(m.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(t,u,p){if(this._valid!==void 0)return this._valid;const m=t.mag()>=2,v=u.mag()>=2;if(!m&&!v)return;if(!m||!v)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=t.y>0==u.y>0;return Sf(t)&&Sf(u)&&E}}const Hm={panStep:100,bearingStep:15,pitchStep:10};class td{constructor(t){this._tr=new ul(t);const u=Hm;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let u=0,p=0,m=0,v=0,E=0;switch(t.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:t.shiftKey?p=-1:(t.preventDefault(),v=-1);break;case 39:t.shiftKey?p=1:(t.preventDefault(),v=1);break;case 38:t.shiftKey?m=1:(t.preventDefault(),E=-1);break;case 40:t.shiftKey?m=-1:(t.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,m=0),{cameraAnimation:T=>{const k=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:Xm,zoom:u?Math.round(k.zoom)+u*(t.shiftKey?2:1):k.zoom,bearing:k.bearing+p*this._bearingStep,pitch:k.pitch+m*this._pitchStep,offset:[-v*this._panStep,-E*this._panStep],center:k.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Xm(g){return g*(2-g)}const Wm=4.000244140625,Ym=1/450;class Jm{constructor(t,u){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=t,this._tr=new ul(t),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Ym}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let u=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const p=I.now(),m=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,u!==0&&u%Wm==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(m*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),t.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=t,this._delta-=u,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=L.mousePos(this._map.getCanvas(),t),p=this._tr;this._aroundPoint=this._aroundCenter?p.transform.locationToScreenPoint(l.S.convert(p.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const T=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=T),typeof this._targetZoom=="number"&&(this._targetZoom+=T)}if(this._delta!==0){const T=this._type==="wheel"&&Math.abs(this._delta)>Wm?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&k!==0&&(k=1/k);const V=typeof this._targetZoom!="number"?t.scale:l.af(this._targetZoom);this._targetZoom=t.getConstrained(t.getCameraLngLat(),l.ak(V*k)).zoom,this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,p=this._startZoom,m=this._easing;let v,E=!1;if(this._type==="wheel"&&p&&m){const T=I.now()-this._lastWheelEventTime,k=Math.min((T+5)/200,1),V=m(k);v=l.C.number(p,u,V),k<1?this._frameId||(this._frameId=!0):E=!0}else v=u,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=v,{noInertia:!0,needsRenderFrame:!E,zoomDelta:v-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let u=l.co;if(this._prevEase){const p=this._prevEase,m=(I.now()-p.start)/p.duration,v=p.easing(m+.01)-p.easing(m),E=.27/Math.sqrt(v*v+1e-4)*.01,T=Math.sqrt(.0729-E*E);u=l.cm(E,T,.25,1)}return this._prevEase={start:I.now(),duration:t,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Qm{constructor(t,u){this._clickZoom=t,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Oo{constructor(t){this._tr=new ul(t),this.reset()}reset(){this._active=!1}dblclick(t,u){return t.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ci{constructor(){this._tap=new Af({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,u,p){if(!this._swipePoint)if(this._tapTime){const m=u[0],v=t.timeStamp-this._tapTime<500,E=this._tapPoint.dist(m)<30;v&&E?p.length>0&&(this._swipePoint=m,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(t,u,p)}touchmove(t,u,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const m=u[0],v=m.y-this._swipePoint.y;return this._swipePoint=m,t.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(t,u,p)}touchend(t,u,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const m=this._tap.touchend(t,u,p);m&&(this._tapTime=t.timeStamp,this._tapPoint=m)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ey{constructor(t,u,p){this._el=t,this._mousePan=u,this._touchPan=p}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class wu{constructor(t,u,p,m){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=u,this._mousePitch=p,this._mouseRoll=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class rd{constructor(t,u,p,m){this._el=t,this._touchZoom=u,this._touchRotate=p,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Tf{constructor(t,u){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=L.create("div","maplibregl-cooperative-gesture-screen",t);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),m=document.createElement("div");m.className="maplibregl-desktop-message",m.textContent=u,this._container.appendChild(m);const v=document.createElement("div");v.className="maplibregl-mobile-message",v.textContent=p,this._container.appendChild(v),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(L.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,u){this._enabled&&(this._map.fire(new l.l("cooperativegestureprevented",{gestureType:t,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Eu=g=>g.zoom||g.drag||g.roll||g.pitch||g.rotate;class ty extends l.l{}function Cf(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta||g.rollDelta}class Ws{constructor(t,u){this.handleWindowEvent=m=>{this.handleEvent(m,`${m.type}Window`)},this.handleEvent=(m,v)=>{if(m.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=m.type==="renderFrame"?void 0:m,T={needsRenderFrame:!1},k={},V={};for(const{handlerName:K,handler:X,allowed:re}of this._handlers){if(!X.isEnabled())continue;let le;if(this._blockedByActive(V,re,K))X.reset();else if(X[v||m.type]){if(l.cp(m,v||m.type)){const ue=L.mousePos(this._map.getCanvas(),m);le=X[v||m.type](m,ue)}else if(l.cq(m,v||m.type)){const ue=this._getMapTouches(m.touches),ce=L.touchPos(this._map.getCanvas(),ue);le=X[v||m.type](m,ce,ue)}else l.cr(v||m.type)||(le=X[v||m.type](m));this.mergeHandlerResult(T,k,le,K,E),le&&le.needsRenderFrame&&this._triggerRenderFrame()}(le||X.isActive())&&(V[K]=X)}const N={};for(const K in this._previousActiveHandlers)V[K]||(N[K]=E);this._previousActiveHandlers=V,(Object.keys(N).length||Cf(T))&&(this._changes.push([T,k,N]),this._triggerRenderFrame()),(Object.keys(V).length||Cf(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=T;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qm(t),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[m,v,E]of this._listeners)L.addEventListener(m,v,m===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[t,u,p]of this._listeners)L.removeEventListener(t,u,t===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(t){const u=this._map,p=u.getCanvasContainer();this._add("mapEvent",new ys(u,t));const m=u.boxZoom=new gs(u,t);this._add("boxZoom",m),t.interactive&&t.boxZoom&&m.enable();const v=u.cooperativeGestures=new Tf(u,t.cooperativeGestures);this._add("cooperativeGestures",v),t.cooperativeGestures&&v.enable();const E=new Tv(u),T=new Oo(u);u.doubleClickZoom=new Qm(T,E),this._add("tapZoom",E),this._add("clickZoom",T),t.interactive&&t.doubleClickZoom&&u.doubleClickZoom.enable();const k=new ci;this._add("tapDragZoom",k);const V=u.touchPitch=new Zm(u);this._add("touchPitch",V),t.interactive&&t.touchPitch&&u.touchPitch.enable(t.touchPitch);const N=()=>u.project(u.getCenter()),$=(function({enable:xe,clickTolerance:Pe,aroundCenter:Ue=!0,minPixelCenterThreshold:Ae=100,rotateDegreesPerPixelMoved:Fe=.8},it){const Xe=new It({checkCorrectEvent:Je=>L.mouseButton(Je)===0&&Je.ctrlKey||L.mouseButton(Je)===2&&!Je.ctrlKey});return new _u({clickTolerance:Pe,move:(Je,Qe)=>{const xt=it();if(Ue&&Math.abs(xt.y-Je.y)>Ae)return{bearingDelta:l.cn(new l.P(Je.x,Qe.y),Qe,xt)};let wt=(Qe.x-Je.x)*Fe;return Ue&&Qe.y<xt.y&&(wt=-wt),{bearingDelta:wt}},moveStateManager:Xe,enable:xe,assignEvents:vu})})(t,N),K=(function({enable:xe,clickTolerance:Pe,pitchDegreesPerPixelMoved:Ue=-.5}){const Ae=new It({checkCorrectEvent:Fe=>L.mouseButton(Fe)===0&&Fe.ctrlKey||L.mouseButton(Fe)===2});return new _u({clickTolerance:Pe,move:(Fe,it)=>({pitchDelta:(it.y-Fe.y)*Ue}),moveStateManager:Ae,enable:xe,assignEvents:vu})})(t),X=(function({enable:xe,clickTolerance:Pe,rollDegreesPerPixelMoved:Ue=.3},Ae){const Fe=new It({checkCorrectEvent:it=>L.mouseButton(it)===2&&it.ctrlKey});return new _u({clickTolerance:Pe,move:(it,Xe)=>{const Je=Ae();let Qe=(Xe.x-it.x)*Ue;return Xe.y<Je.y&&(Qe=-Qe),{rollDelta:Qe}},moveStateManager:Fe,enable:xe,assignEvents:vu})})(t,N);u.dragRotate=new wu(t,$,K,X),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",K,["mouseRotate","mouseRoll"]),this._add("mouseRoll",X,["mousePitch"]),t.interactive&&t.dragRotate&&u.dragRotate.enable();const re=(function({enable:xe,clickTolerance:Pe}){const Ue=new It({checkCorrectEvent:Ae=>L.mouseButton(Ae)===0&&!Ae.ctrlKey});return new _u({clickTolerance:Pe,move:(Ae,Fe)=>({around:Fe,panDelta:Fe.sub(Ae)}),activateOnStart:!0,moveStateManager:Ue,enable:xe,assignEvents:vu})})(t),le=new xu(t,u);u.dragPan=new ey(p,re,le),this._add("mousePan",re),this._add("touchPan",le,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&u.dragPan.enable(t.dragPan);const ue=new ed,ce=new Qc;u.touchZoomRotate=new rd(p,ce,ue,k),this._add("touchRotate",ue,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&u.touchZoomRotate.enable(t.touchZoomRotate);const be=u.scrollZoom=new Jm(u,(()=>this._triggerRenderFrame()));this._add("scrollZoom",be,["mousePan"]),t.interactive&&t.scrollZoom&&u.scrollZoom.enable(t.scrollZoom);const Ee=u.keyboard=new td(u);this._add("keyboard",Ee),t.interactive&&t.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new Cs(u))}_add(t,u,p){this._handlers.push({handlerName:t,handler:u,allowed:p}),this._handlersById[t]=u}stop(t){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Eu(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,u,p){for(const m in t)if(m!==p&&(!u||u.indexOf(m)<0))return!0;return!1}_getMapTouches(t){const u=[];for(const p of t)this._el.contains(p.target)&&u.push(p);return u}mergeHandlerResult(t,u,p,m,v){if(!p)return;l.e(t,p);const E={handlerName:m,originalEvent:p.originalEvent||v};p.zoomDelta!==void 0&&(u.zoom=E),p.panDelta!==void 0&&(u.drag=E),p.rollDelta!==void 0&&(u.roll=E),p.pitchDelta!==void 0&&(u.pitch=E),p.bearingDelta!==void 0&&(u.rotate=E)}_applyChanges(){const t={},u={},p={};for(const[m,v,E]of this._changes)m.panDelta&&(t.panDelta=(t.panDelta||new l.P(0,0))._add(m.panDelta)),m.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+m.zoomDelta),m.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+m.bearingDelta),m.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+m.pitchDelta),m.rollDelta&&(t.rollDelta=(t.rollDelta||0)+m.rollDelta),m.around!==void 0&&(t.around=m.around),m.pinchAround!==void 0&&(t.pinchAround=m.pinchAround),m.noInertia&&(t.noInertia=m.noInertia),l.e(u,v),l.e(p,E);this._updateMapTransform(t,u,p),this._changes=[]}_updateMapTransform(t,u,p){const m=this._map,v=m._getTransformForUpdate(),E=m.terrain;if(!(Cf(t)||E&&this._terrainMovement))return this._fireEvents(u,p,!0);m._stop(!0);let{panDelta:T,zoomDelta:k,bearingDelta:V,pitchDelta:N,rollDelta:$,around:K,pinchAround:X}=t;X!==void 0&&(K=X),K=K||m.transform.centerPoint,E&&!v.isPointOnMapSurface(K)&&(K=v.centerPoint);const re={panDelta:T,zoomDelta:k,rollDelta:$,pitchDelta:N,bearingDelta:V,around:K};this._map.cameraHelper.useGlobeControls&&!v.isPointOnMapSurface(K)&&(K=v.centerPoint);const le=K.distSqr(v.centerPoint)<.01?v.center:v.screenPointToLocation(T?K.sub(T):K);this._handleMapControls({terrain:E,tr:v,deltasForHelper:re,preZoomAroundLoc:le,combinedEventsInProgress:u,panDelta:T}),m._applyUpdatedTransform(v),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(u,p,!0)}_handleMapControls({terrain:t,tr:u,deltasForHelper:p,preZoomAroundLoc:m,combinedEventsInProgress:v,panDelta:E}){const T=this._map.cameraHelper;if(T.handleMapControlsRollPitchBearingZoom(p,u),t)return T.useGlobeControls?(this._terrainMovement||!v.drag&&!v.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void T.handleMapControlsPan(p,u,m)):this._terrainMovement||!v.drag&&!v.zoom?void(v.drag&&this._terrainMovement&&E?u.setCenter(u.screenPointToLocation(u.centerPoint.sub(E))):T.handleMapControlsPan(p,u,m)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void T.handleMapControlsPan(p,u,m));T.handleMapControlsPan(p,u,m)}_fireEvents(t,u,p){const m=Eu(this._eventsInProgress),v=Eu(t),E={};for(const $ in t){const{originalEvent:K}=t[$];this._eventsInProgress[$]||(E[`${$}start`]=K),this._eventsInProgress[$]=t[$]}!m&&v&&this._fireEvent("movestart",v.originalEvent);for(const $ in E)this._fireEvent($,E[$]);v&&this._fireEvent("move",v.originalEvent);for(const $ in t){const{originalEvent:K}=t[$];this._fireEvent($,K)}const T={};let k;for(const $ in this._eventsInProgress){const{handlerName:K,originalEvent:X}=this._eventsInProgress[$];this._handlersById[K].isActive()||(delete this._eventsInProgress[$],k=u[K]||X,T[`${$}end`]=k)}for(const $ in T)this._fireEvent($,T[$]);const V=Eu(this._eventsInProgress),N=(m||v)&&!V;if(N&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const $=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&$.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform($)}if(p&&N){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),K=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;!$||!$.essential&&I.prefersReducedMotion?(this._map.fire(new l.l("moveend",{originalEvent:k})),K(this._map.getBearing())&&this._map.resetNorth()):(K($.bearing||this._map.getBearing())&&($.bearing=0),$.freezeElevation=!0,this._map.easeTo($,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(t,u){this._map.fire(new l.l(t,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((t=>{delete this._frameId,this.handleEvent(new ty("renderFrame",{timeStamp:t})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class id extends l.E{constructor(t,u,p){super(),this._renderFrameCallback=()=>{const m=Math.min((I.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(m)),m<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=p.bearingSnap,this.cameraHelper=u,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(t,u){t.apply(this.transform),this.transform=t,this.cameraHelper=u}getCenter(){return new l.S(this.transform.center.lng,this.transform.center.lat)}setCenter(t,u){return this.jumpTo({center:t},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,u){return this.jumpTo({elevation:t},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,u,p){return t=l.P.convert(t).mult(-1),this.panTo(this.transform.center,l.e({offset:t},u),p)}panTo(t,u,p){return this.easeTo(l.e({center:t},u),p)}getZoom(){return this.transform.zoom}setZoom(t,u){return this.jumpTo({zoom:t},u),this}zoomTo(t,u,p){return this.easeTo(l.e({zoom:t},u),p)}zoomIn(t,u){return this.zoomTo(this.getZoom()+1,t,u),this}zoomOut(t,u){return this.zoomTo(this.getZoom()-1,t,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,u){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new l.l("movestart",u)).fire(new l.l("move",u)).fire(new l.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(t,u){return this.jumpTo({bearing:t},u),this}getPadding(){return this.transform.padding}setPadding(t,u){return this.jumpTo({padding:t},u),this}rotateTo(t,u,p){return this.easeTo(l.e({bearing:t},u),p)}resetNorth(t,u){return this.rotateTo(0,l.e({duration:1e3},t),u),this}resetNorthPitch(t,u){return this.easeTo(l.e({bearing:0,pitch:0,roll:0,duration:1e3},t),u),this}snapToNorth(t,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,u):this}getPitch(){return this.transform.pitch}setPitch(t,u){return this.jumpTo({pitch:t},u),this}getRoll(){return this.transform.roll}setRoll(t,u){return this.jumpTo({roll:t},u),this}cameraForBounds(t,u){t=gr.convert(t).adjustAntiMeridian();const p=u&&u.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),p,u)}_cameraForBoxAndBearing(t,u,p,m){const v={top:0,bottom:0,right:0,left:0};if(typeof(m=l.e({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding=="number"){const V=m.padding;m.padding={top:V,bottom:V,right:V,left:V}}const E=l.e(v,m.padding);m.padding=E;const T=this.transform,k=new gr(t,u);return this.cameraHelper.cameraForBoxAndBearing(m,E,k,p,T)}fitBounds(t,u,p){return this._fitInternal(this.cameraForBounds(t,u),u,p)}fitScreenCoordinates(t,u,p,m,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(l.P.convert(t)),this.transform.screenPointToLocation(l.P.convert(u)),p,m),m,v)}_fitInternal(t,u,p){return t?(delete(u=l.e(t,u)).padding,u.linear?this.easeTo(u,p):this.flyTo(u,p)):this}jumpTo(t,u){this.stop();const p=this._getTransformForUpdate();let m=!1,v=!1,E=!1;const T=p.zoom;this.cameraHelper.handleJumpToCenterZoom(p,t);const k=p.zoom!==T;return"elevation"in t&&p.elevation!==+t.elevation&&p.setElevation(+t.elevation),"bearing"in t&&p.bearing!==+t.bearing&&(m=!0,p.setBearing(+t.bearing)),"pitch"in t&&p.pitch!==+t.pitch&&(v=!0,p.setPitch(+t.pitch)),"roll"in t&&p.roll!==+t.roll&&(E=!0,p.setRoll(+t.roll)),t.padding==null||p.isPaddingEqual(t.padding)||p.setPadding(t.padding),this._applyUpdatedTransform(p),this.fire(new l.l("movestart",u)).fire(new l.l("move",u)),k&&this.fire(new l.l("zoomstart",u)).fire(new l.l("zoom",u)).fire(new l.l("zoomend",u)),m&&this.fire(new l.l("rotatestart",u)).fire(new l.l("rotate",u)).fire(new l.l("rotateend",u)),v&&this.fire(new l.l("pitchstart",u)).fire(new l.l("pitch",u)).fire(new l.l("pitchend",u)),E&&this.fire(new l.l("rollstart",u)).fire(new l.l("roll",u)).fire(new l.l("rollend",u)),this.fire(new l.l("moveend",u))}calculateCameraOptionsFromTo(t,u,p,m=0){const v=l.a1.fromLngLat(t,u),E=l.a1.fromLngLat(p,m),T=E.x-v.x,k=E.y-v.y,V=E.z-v.z,N=Math.hypot(T,k,V);if(N===0)throw new Error("Can't calculate camera options with same From and To");const $=Math.hypot(T,k),K=l.ak(this.transform.cameraToCenterDistance/N/this.transform.tileSize),X=180*Math.atan2(T,-k)/Math.PI;let re=180*Math.acos($/N)/Math.PI;return re=V<0?90-re:90+re,{center:E.toLngLat(),elevation:m,zoom:K,pitch:re,bearing:X}}calculateCameraOptionsFromCameraLngLatAltRotation(t,u,p,m,v){const E=this.transform.calculateCenterFromCameraLngLatAlt(t,u,p,m);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:p,pitch:m,roll:v}}easeTo(t,u){this._stop(!1,t.easeId),((t=l.e({offset:[0,0],duration:500,easing:l.co},t)).animate===!1||!t.essential&&I.prefersReducedMotion)&&(t.duration=0);const p=this._getTransformForUpdate(),m=this.getBearing(),v=p.pitch,E=p.roll,T="bearing"in t?this._normalizeBearing(t.bearing,m):m,k="pitch"in t?+t.pitch:v,V="roll"in t?this._normalizeBearing(t.roll,E):E,N="padding"in t?t.padding:p.padding,$=l.P.convert(t.offset);let K,X;t.around&&(K=l.S.convert(t.around),X=p.locationToScreenPoint(K));const re={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},le=this.cameraHelper.handleEaseTo(p,{bearing:T,pitch:k,roll:V,padding:N,around:K,aroundPoint:X,offsetAsPoint:$,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||m!==T,this._pitching=this._pitching||k!==v,this._rolling=this._rolling||V!==E,this._padding=!p.isPaddingEqual(N),this._zooming=this._zooming||le.isZooming,this._easeId=t.easeId,this._prepareEase(u,t.noMoveStart,re),this.terrain&&this._prepareElevation(le.elevationCenter),this._ease((ue=>{le.easeFunc(ue),this.terrain&&!t.freezeElevation&&this._updateElevation(ue),this._applyUpdatedTransform(p),this._fireMoveEvents(u)}),(ue=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(u,ue)}),t),this}_prepareEase(t,u,p={}){this._moving=!0,u||p.moving||this.fire(new l.l("movestart",t)),this._zooming&&!p.zooming&&this.fire(new l.l("zoomstart",t)),this._rotating&&!p.rotating&&this.fire(new l.l("rotatestart",t)),this._pitching&&!p.pitching&&this.fire(new l.l("pitchstart",t)),this._rolling&&!p.rolling&&this.fire(new l.l("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&u!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(p-(u-(p*t+this._elevationStart))/(1-t)),this._elevationTarget=u}this.transform.setElevation(l.C.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const u=t.getCameraLngLat(),p=t.getCameraAltitude(),m=this.terrain?this.terrain.getElevationForLngLatZoom(u,t.zoom):0;if(p<m){const v=this.calculateCameraOptionsFromTo(u,m,t.center,t.elevation);return{pitch:v.pitch,zoom:v.zoom}}return{}}_applyUpdatedTransform(t){const u=[];if(u.push((m=>this._elevateCameraIfInsideTerrain(m))),this.transformCameraUpdate&&u.push((m=>this.transformCameraUpdate(m))),!u.length)return;const p=t.clone();for(const m of u){const v=p.clone(),{center:E,zoom:T,roll:k,pitch:V,bearing:N,elevation:$}=m(v);E&&v.setCenter(E),$!==void 0&&v.setElevation($),T!==void 0&&v.setZoom(T),k!==void 0&&v.setRoll(k),V!==void 0&&v.setPitch(V),N!==void 0&&v.setBearing(N),p.apply(v)}this.transform.apply(p)}_fireMoveEvents(t){this.fire(new l.l("move",t)),this._zooming&&this.fire(new l.l("zoom",t)),this._rotating&&this.fire(new l.l("rotate",t)),this._pitching&&this.fire(new l.l("pitch",t)),this._rolling&&this.fire(new l.l("roll",t))}_afterEase(t,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const p=this._zooming,m=this._rotating,v=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,p&&this.fire(new l.l("zoomend",t)),m&&this.fire(new l.l("rotateend",t)),v&&this.fire(new l.l("pitchend",t)),E&&this.fire(new l.l("rollend",t)),this.fire(new l.l("moveend",t))}flyTo(t,u){if(!t.essential&&I.prefersReducedMotion){const Qe=l.Q(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Qe,u)}this.stop(),t=l.e({offset:[0,0],speed:1.2,curve:1.42,easing:l.co},t);const p=this._getTransformForUpdate(),m=p.bearing,v=p.pitch,E=p.roll,T=p.padding,k="bearing"in t?this._normalizeBearing(t.bearing,m):m,V="pitch"in t?+t.pitch:v,N="roll"in t?this._normalizeBearing(t.roll,E):E,$="padding"in t?t.padding:p.padding,K=l.P.convert(t.offset);let X=p.centerPoint.add(K);const re=p.screenPointToLocation(X),le=this.cameraHelper.handleFlyTo(p,{bearing:k,pitch:V,roll:N,padding:$,locationAtOffset:re,offsetAsPoint:K,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let ue=t.curve;const ce=Math.max(p.width,p.height),be=ce/le.scaleOfZoom,Ee=le.pixelPathLength;typeof le.scaleOfMinZoom=="number"&&(ue=Math.sqrt(ce/le.scaleOfMinZoom/Ee*2));const xe=ue*ue;function Pe(Qe){const xt=(be*be-ce*ce+(Qe?-1:1)*xe*xe*Ee*Ee)/(2*(Qe?be:ce)*xe*Ee);return Math.log(Math.sqrt(xt*xt+1)-xt)}function Ue(Qe){return(Math.exp(Qe)-Math.exp(-Qe))/2}function Ae(Qe){return(Math.exp(Qe)+Math.exp(-Qe))/2}const Fe=Pe(!1);let it=function(Qe){return Ae(Fe)/Ae(Fe+ue*Qe)},Xe=function(Qe){return ce*((Ae(Fe)*(Ue(xt=Fe+ue*Qe)/Ae(xt))-Ue(Fe))/xe)/Ee;var xt},Je=(Pe(!0)-Fe)/ue;if(Math.abs(Ee)<2e-6||!isFinite(Je)){if(Math.abs(ce-be)<1e-6)return this.easeTo(t,u);const Qe=be<ce?-1:1;Je=Math.abs(Math.log(be/ce))/ue,Xe=()=>0,it=xt=>Math.exp(Qe*ue*xt)}return t.duration="duration"in t?+t.duration:1e3*Je/("screenSpeed"in t?+t.screenSpeed/ue:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=m!==k,this._pitching=V!==v,this._rolling=N!==E,this._padding=!p.isPaddingEqual($),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(le.targetCenter),this._ease((Qe=>{const xt=Qe*Je,wt=1/it(xt),pt=Xe(xt);this._rotating&&p.setBearing(l.C.number(m,k,Qe)),this._pitching&&p.setPitch(l.C.number(v,V,Qe)),this._rolling&&p.setRoll(l.C.number(E,N,Qe)),this._padding&&(p.interpolatePadding(T,$,Qe),X=p.centerPoint.add(K)),le.easeFunc(Qe,wt,pt,X),this.terrain&&!t.freezeElevation&&this._updateElevation(Qe),this._applyUpdatedTransform(p),this._fireMoveEvents(u)}),(()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(u)}),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,u){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,u)}return t||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(t,u,p){p.animate===!1||p.duration===0?(t(1),u()):(this._easeStart=I.now(),this._easeOptions=p,this._onEaseFrame=t,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,u){t=l.aO(t,-180,180);const p=Math.abs(t-u);return Math.abs(t-360-u)<p&&(t-=360),Math.abs(t+360-u)<p&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(l.S.convert(t),this.transform.tileZoom):null}}const qt={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class tr{constructor(t=qt){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"&&u.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=L.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=L.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){L.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,u){const p=this._map._getUIString(`AttributionControl.${u}`);t.title=p,t.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map((m=>typeof m!="string"?"":m))):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}const u=this._map.style.sourceCaches;for(const m in u){const v=u[m];if(v.used||v.usedForTerrain){const E=v.getSource();E.attribution&&t.indexOf(E.attribution)<0&&t.push(E.attribution)}}t=t.filter((m=>String(m).trim())),t.sort(((m,v)=>m.length-v.length)),t=t.filter(((m,v)=>{for(let E=v+1;E<t.length;E++)if(t[E].indexOf(m)>=0)return!1;return!0}));const p=t.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,t.length?(this._innerContainer.innerHTML=L.sanitize(p),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class dl{constructor(t={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const p=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=L.create("div","maplibregl-ctrl");const u=L.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){L.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class ry{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const u=++this._id;return this._queue.push({callback:t,id:u,cancelled:!1}),u}remove(t){const u=this._currentlyRunning,p=u?this._queue.concat(u):this._queue;for(const m of p)if(m.id===t)return void(m.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const p of u)if(!p.cancelled&&(p.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var nd=l.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Tn extends l.E{constructor(t){super(),this._lastTilesetChange=I.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,u){this.sourceCache.update(t,u),this._renderableTilesKeys=[];const p={};for(const m of hr(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))p[m.key]=!0,this._renderableTilesKeys.push(m.key),this._tiles[m.key]||(m.terrainRttPosMatrix32f=new Float64Array(16),l.bZ(m.terrainRttPosMatrix32f,0,l.$,l.$,0,0,1),this._tiles[m.key]=new W(m,this.tileSize),this._lastTilesetChange=I.now());for(const m in this._tiles)p[m]||delete this._tiles[m]}freeRtt(t){for(const u in this._tiles){const p=this._tiles[u];(!t||p.tileID.equals(t)||p.tileID.isChildOf(t)||t.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((t=>this.getTileByID(t)))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t,u){return u?this._getTerrainCoordsForTileRanges(t,u):this._getTerrainCoordsForRegularTile(t)}_getTerrainCoordsForRegularTile(t){const u={};for(const p of this._renderableTilesKeys){const m=this._tiles[p].tileID,v=t.clone(),E=l.ba();if(m.canonical.equals(t.canonical))l.bZ(E,0,l.$,l.$,0,0,1);else if(m.canonical.isChildOf(t.canonical)){const T=m.canonical.z-t.canonical.z,k=m.canonical.x-(m.canonical.x>>T<<T),V=m.canonical.y-(m.canonical.y>>T<<T),N=l.$>>T;l.bZ(E,0,N,N,0,0,1),l.M(E,E,[-k*N,-V*N,0])}else{if(!t.canonical.isChildOf(m.canonical))continue;{const T=t.canonical.z-m.canonical.z,k=t.canonical.x-(t.canonical.x>>T<<T),V=t.canonical.y-(t.canonical.y>>T<<T),N=l.$>>T;l.bZ(E,0,l.$,l.$,0,0,1),l.M(E,E,[k*N,V*N,0]),l.N(E,E,[1/2**T,1/2**T,0])}}v.terrainRttPosMatrix32f=new Float32Array(E),u[p]=v}return u}_getTerrainCoordsForTileRanges(t,u){const p={};for(const m of this._renderableTilesKeys){const v=this._tiles[m].tileID;if(!this._isWithinTileRanges(v,u))continue;const E=t.clone(),T=l.ba();if(v.canonical.z===t.canonical.z){const k=t.canonical.x-v.canonical.x,V=t.canonical.y-v.canonical.y;l.bZ(T,0,l.$,l.$,0,0,1),l.M(T,T,[k*l.$,V*l.$,0])}else if(v.canonical.z>t.canonical.z){const k=v.canonical.z-t.canonical.z,V=v.canonical.x-(v.canonical.x>>k<<k),N=v.canonical.y-(v.canonical.y>>k<<k),$=t.canonical.x-(v.canonical.x>>k),K=t.canonical.y-(v.canonical.y>>k),X=l.$>>k;l.bZ(T,0,X,X,0,0,1),l.M(T,T,[-V*X+$*l.$,-N*X+K*l.$,0])}else{const k=t.canonical.z-v.canonical.z,V=t.canonical.x-(t.canonical.x>>k<<k),N=t.canonical.y-(t.canonical.y>>k<<k),$=(t.canonical.x>>k)-v.canonical.x,K=(t.canonical.y>>k)-v.canonical.y,X=l.$<<k;l.bZ(T,0,X,X,0,0,1),l.M(T,T,[V*l.$+$*X,N*l.$+K*X,0])}E.terrainRttPosMatrix32f=new Float32Array(T),p[m]=E}return p}getSourceTile(t,u){const p=this.sourceCache._source;let m=t.overscaledZ-this.deltaZoom;if(m>p.maxzoom&&(m=p.maxzoom),m<p.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(m).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!v||!v.dem)&&u)for(;m>=p.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(t.scaledTo(m--).key);return v}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}_isWithinTileRanges(t,u){return u[t.canonical.z]&&t.canonical.x>=u[t.canonical.z].minTileX&&t.canonical.x<=u[t.canonical.z].maxTileX&&t.canonical.y>=u[t.canonical.z].minTileY&&t.canonical.y<=u[t.canonical.z].maxTileY}}class iy{constructor(t,u,p){this._meshCache={},this.painter=t,this.sourceCache=new Tn(u),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,u,p,m=l.$){var v;if(!(u>=0&&u<m&&p>=0&&p<m))return 0;const E=this.getTerrainData(t),T=(v=E.tile)===null||v===void 0?void 0:v.dem;if(!T)return 0;const k=l.cs([],[u/m*l.$,p/m*l.$],E.u_terrain_matrix),V=[k[0]*T.dim,k[1]*T.dim],N=Math.floor(V[0]),$=Math.floor(V[1]),K=V[0]-N,X=V[1]-$;return T.get(N,$)*(1-K)*(1-X)+T.get(N+1,$)*K*(1-X)+T.get(N,$+1)*(1-K)*X+T.get(N+1,$+1)*K*X}getElevationForLngLatZoom(t,u){if(!l.ct(u,t.wrap()))return 0;const{tileID:p,mercatorX:m,mercatorY:v}=this._getOverscaledTileIDFromLngLatZoom(t,u);return this.getElevation(p,m%l.$,v%l.$,l.$)}getElevation(t,u,p,m=l.$){return this.getDEMElevation(t,u,p,m)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const m=this.painter.context,v=new l.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new l.T(m,v,m.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new l.T(m,new l.R({width:1,height:1}),m.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=l.ag([])}const u=this.sourceCache.getSourceTile(t,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const m=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new l.T(m,u.dem.getPixels(),m.gl.RGBA,{premultiply:!1}),u.demTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const p=u&&u+u.tileID.key+t.key;if(p&&!this._demMatrixCache[p]){const m=this.sourceCache.sourceCache._source.maxzoom;let v=t.canonical.z-u.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=m?v=t.canonical.z-m:l.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=t.canonical.x-(t.canonical.x>>v<<v),T=t.canonical.y-(t.canonical.y>>v<<v),k=l.cu(new Float64Array(16),[1/(l.$<<v),1/(l.$<<v),0]);l.M(k,k,[E*l.$,T*l.$,0]),this._demMatrixCache[t.key]={matrix:k,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(t){const u=this.painter,p=u.width/devicePixelRatio,m=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===m||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new l.T(u.context,{width:p,height:m,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new l.T(u.context,{width:p,height:m,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(p,m,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,p,m))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,E=0;v<this._coordsTextureSize;v++)for(let T=0;T<this._coordsTextureSize;T++,E+=4)u[E+0]=255&T,u[E+1]=255&v,u[E+2]=T>>8<<4|v>>8,u[E+3]=0;const p=new l.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),m=new l.T(t,p,t.gl.RGBA,{premultiply:!1});return m.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=m,m}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),p=this.painter.context,m=p.gl,v=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),m.readPixels(v,T-E-1,1,1,m.RGBA,m.UNSIGNED_BYTE,u),p.bindFramebuffer.set(null);const k=u[0]+(u[2]>>4<<8),V=u[1]+((15&u[2])<<8),N=this.coordsIndex[255-u[3]],$=N&&this.sourceCache.getTileByID(N);if(!$)return null;const K=this._coordsTextureSize,X=(1<<$.tileID.canonical.z)*K;return new l.a1(($.tileID.canonical.x*K+k)/X+$.tileID.wrap,($.tileID.canonical.y*K+V)/X,this.getElevation($.tileID,k,V,K))}depthAtPoint(t){const u=new Uint8Array(4),p=this.painter.context,m=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),m.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,m.RGBA,m.UNSIGNED_BYTE,u),p.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(t){var u;const p=((u=this.painter.style.projection)===null||u===void 0?void 0:u.transitionState)>0,m=p&&t.canonical.y===0,v=p&&t.canonical.y===(1<<t.canonical.z)-1,E=`m_${m?"n":""}_${v?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const T=this.painter.context,k=new l.cv,V=new l.aN,N=this.meshSize,$=l.$/N,K=N*N;for(let Ae=0;Ae<=N;Ae++)for(let Fe=0;Fe<=N;Fe++)k.emplaceBack(Fe*$,Ae*$,0);for(let Ae=0;Ae<K;Ae+=N+1)for(let Fe=0;Fe<N;Fe++)V.emplaceBack(Fe+Ae,N+Fe+Ae+1,N+Fe+Ae+2),V.emplaceBack(Fe+Ae,N+Fe+Ae+2,Fe+Ae+1);const X=k.length,re=X+(N+1),le=(N+1)*N,ue=m?l.bh:0,ce=m?0:1,be=v?l.bi:l.$,Ee=v?0:1;for(let Ae=0;Ae<=N;Ae++)k.emplaceBack(Ae*$,ue,ce);for(let Ae=0;Ae<=N;Ae++)k.emplaceBack(Ae*$,be,Ee);for(let Ae=0;Ae<N;Ae++)V.emplaceBack(le+Ae,re+Ae,re+Ae+1),V.emplaceBack(le+Ae,re+Ae+1,le+Ae+1),V.emplaceBack(0+Ae,X+Ae+1,X+Ae),V.emplaceBack(0+Ae,0+Ae+1,X+Ae+1);const xe=k.length,Pe=xe+2*(N+1);for(const Ae of[0,1])for(let Fe=0;Fe<=N;Fe++)for(const it of[0,1])k.emplaceBack(Ae*l.$,Fe*$,it);for(let Ae=0;Ae<2*N;Ae+=2)V.emplaceBack(xe+Ae,xe+Ae+1,xe+Ae+3),V.emplaceBack(xe+Ae,xe+Ae+3,xe+Ae+2),V.emplaceBack(Pe+Ae,Pe+Ae+3,Pe+Ae+1),V.emplaceBack(Pe+Ae,Pe+Ae+2,Pe+Ae+3);const Ue=new Io(T.createVertexBuffer(k,nd.members),T.createIndexBuffer(V),l.aM.simpleSegment(0,0,k.length,V.length));return this._meshCache[E]=Ue,Ue}getMeshFrameDelta(t){return 2*Math.PI*l.bu/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,u){var p;const{tileID:m}=this._getOverscaledTileIDFromLngLatZoom(t,u);return(p=this.getMinMaxElevation(m).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(t){const u=this.getTerrainData(t).tile,p={minElevation:null,maxElevation:null};return u&&u.dem&&(p.minElevation=u.dem.min*this.exaggeration,p.maxElevation=u.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(t,u){const p=l.a1.fromLngLat(t.wrap()),m=(1<<u)*l.$,v=p.x*m,E=p.y*m,T=Math.floor(v/l.$),k=Math.floor(E/l.$);return{tileID:new l.Z(u,0,u,T,k),mercatorX:v,mercatorY:E}}}class ks{constructor(t,u,p){this._context=t,this._size=u,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new l.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(p.texture),{id:t,fbo:u,texture:p,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((u=>t.id!==u)),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((t=>!t.inUse))===!1}}const wa={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Cv{constructor(t,u){this.painter=t,this.terrain=u,this.pool=new ks(t.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter((p=>!t._layers[p].isHidden(u))),this._coordsAscending={};for(const p in t.sourceCaches){this._coordsAscending[p]={};const m=t.sourceCaches[p].getVisibleCoordinates(),v=t.sourceCaches[p].getSource(),E=v instanceof Qt?v.terrainTileRanges:null;for(const T of m){const k=this.terrain.sourceCache.getTerrainCoords(T,E);for(const V in k)this._coordsAscending[p][V]||(this._coordsAscending[p][V]=[]),this._coordsAscending[p][V].push(k[V])}}this._coordsAscendingStr={};for(const p of t._order){const m=t._layers[p],v=m.source;if(wa[m.type]&&!this._coordsAscendingStr[v]){this._coordsAscendingStr[v]={};for(const E in this._coordsAscending[v])this._coordsAscendingStr[v][E]=this._coordsAscending[v][E].map((T=>T.key)).sort().join()}}for(const p of this._renderableTiles)for(const m in this._coordsAscendingStr){const v=this._coordsAscendingStr[m][p.tileID.key];v&&v!==p.rttCoords[m]&&(p.rtt=[])}}renderLayer(t,u){if(t.isHidden(this.painter.transform.zoom))return!1;const p=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),m=t.type,v=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(wa[m]&&(this._prevType&&wa[this._prevType]||this._stacks.push([]),this._prevType=m,this._stacks[this._stacks.length-1].push(t.id),!E))return!0;if(wa[this._prevType]||wa[m]&&E){this._prevType=m;const T=this._stacks.length-1,k=this._stacks[T]||[];for(const V of this._renderableTiles){if(this.pool.isFull()&&(Jc(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(V),V.rtt[T]){const $=this.pool.getObjectForId(V.rtt[T].id);if($.stamp===V.rtt[T].stamp){this.pool.useObject($);continue}}const N=this.pool.getOrCreateFreeObject();this.pool.useObject(N),this.pool.stampObject(N),V.rtt[T]={id:N.id,stamp:N.stamp},v.context.bindFramebuffer.set(N.fbo.framebuffer),v.context.clear({color:l.bf.transparent,stencil:0}),v.currentStencilSource=void 0;for(let $=0;$<k.length;$++){const K=v.style._layers[k[$]],X=K.source?this._coordsAscending[K.source][V.tileID.key]:[V.tileID];v.context.viewport.set([0,0,N.fbo.width,N.fbo.height]),v._renderTileClippingMasks(K,X,!0),v.renderLayer(v,v.style.sourceCaches[K.source],K,X,p),K.source&&(V.rttCoords[K.source]=this._coordsAscendingStr[K.source][V.tileID.key])}}return Jc(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects(),wa[m]}return!1}}const kv={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Pv=_,pl={hash:!1,interactive:!0,bearingSnap:7,attributionControl:qt,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:l.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},vi={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Li{constructor(t,u,p=!1){this.mousedown=v=>{this.startMove(v,L.mousePos(this.element,v)),L.addEventListener(window,"mousemove",this.mousemove),L.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=v=>{this.move(v,L.mousePos(this.element,v))},this.mouseup=v=>{this._rotatePitchHandler.dragEnd(v),this.offTemp()},this.touchstart=v=>{v.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=L.touchPos(this.element,v.targetTouches)[0],this.startMove(v,this._startPos),L.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.addEventListener(window,"touchend",this.touchend))},this.touchmove=v=>{v.targetTouches.length!==1?this.reset():(this._lastPos=L.touchPos(this.element,v.targetTouches)[0],this.move(v,this._lastPos))},this.touchend=v=>{v.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const m=new Rf;this._rotatePitchHandler=new _u({clickTolerance:3,move:(v,E)=>{const T=u.getBoundingClientRect(),k=new l.P((T.bottom-T.top)/2,(T.right-T.left)/2);return{bearingDelta:l.cn(new l.P(v.x,E.y),E,k),pitchDelta:p?-.5*(E.y-v.y):void 0}},moveStateManager:m,enable:!0,assignEvents:()=>{}}),this.map=t,L.addEventListener(u,"mousedown",this.mousedown),L.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),L.addEventListener(u,"touchcancel",this.reset)}startMove(t,u){this._rotatePitchHandler.dragStart(t,u),L.disableDrag()}move(t,u){const p=this.map,{bearingDelta:m,pitchDelta:v}=this._rotatePitchHandler.dragMove(t,u)||{};m&&p.setBearing(p.getBearing()+m),v&&p.setPitch(p.getPitch()+v)}off(){const t=this.element;L.removeEventListener(t,"mousedown",this.mousedown),L.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),L.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.removeEventListener(window,"touchend",this.touchend),L.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){L.enableDrag(),L.removeEventListener(window,"mousemove",this.mousemove),L.removeEventListener(window,"mouseup",this.mouseup),L.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),L.removeEventListener(window,"touchend",this.touchend)}}let Vo;function fl(g,t,u,p=!1){if(p||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return g?.wrap();const m=new l.S(g.lng,g.lat);if(g=new l.S(g.lng,g.lat),t){const v=new l.S(g.lng-360,g.lat),E=new l.S(g.lng+360,g.lat),T=u.locationToScreenPoint(g).distSqr(t);u.locationToScreenPoint(v).distSqr(t)<T?g=v:u.locationToScreenPoint(E).distSqr(t)<T&&(g=E)}for(;Math.abs(g.lng-u.center.lng)>180;){const v=u.locationToScreenPoint(g);if(v.x>=0&&v.y>=0&&v.x<=u.width&&v.y<=u.height)break;g.lng>u.center.lng?g.lng-=360:g.lng+=360}return g.lng!==m.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(g))?g:m}const hl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function sd(g,t,u){const p=g.classList;for(const m in hl)p.remove(`maplibregl-${u}-anchor-${m}`);p.add(`maplibregl-${u}-anchor-${t}`)}class Au extends l.E{constructor(t){if(super(),this._onKeyPress=u=>{const p=u.code,m=u.charCode||u.keyCode;p!=="Space"&&p!=="Enter"&&m!==32&&m!==13||this.togglePopup()},this._onMapClick=u=>{const p=u.originalEvent.target,m=this._element;this._popup&&(p===m||m.contains(p))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();(u?.type==="terrain"||u?.type==="render"&&!p)&&this._map.once("render",this._update),this._lngLat=fl(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let v="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?v="rotateX(0deg)":this._pitchAlignment==="map"&&(v=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&u.type!=="moveend"||(this._pos=this._pos.round()),L.setTransform(this._element,`${hl[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${v} ${m}`),I.frameAsync(new AbortController).then((()=>{this._updateOpacity(u&&u.type==="moveend")})).catch((()=>{}))},this._onMove=u=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new l.l("dragstart"))),this.fire(new l.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new l.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(t?.opacity,t?.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=l.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=L.create("div");const u=L.createNS("http://www.w3.org/2000/svg","svg"),p=41,m=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${p}px`),u.setAttributeNS(null,"width",`${m}px`),u.setAttributeNS(null,"viewBox",`0 0 ${m} ${p}`);const v=L.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"stroke","none"),v.setAttributeNS(null,"stroke-width","1"),v.setAttributeNS(null,"fill","none"),v.setAttributeNS(null,"fill-rule","evenodd");const E=L.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const T=L.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ce of k){const be=L.createNS("http://www.w3.org/2000/svg","ellipse");be.setAttributeNS(null,"opacity","0.04"),be.setAttributeNS(null,"cx","10.5"),be.setAttributeNS(null,"cy","5.80029008"),be.setAttributeNS(null,"rx",ce.rx),be.setAttributeNS(null,"ry",ce.ry),T.appendChild(be)}const V=L.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"fill",this._color);const N=L.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),V.appendChild(N);const $=L.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"opacity","0.25"),$.setAttributeNS(null,"fill","#000000");const K=L.createNS("http://www.w3.org/2000/svg","path");K.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$.appendChild(K);const X=L.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const re=L.createNS("http://www.w3.org/2000/svg","g");re.setAttributeNS(null,"transform","translate(8.0, 8.0)");const le=L.createNS("http://www.w3.org/2000/svg","circle");le.setAttributeNS(null,"fill","#000000"),le.setAttributeNS(null,"opacity","0.25"),le.setAttributeNS(null,"cx","5.5"),le.setAttributeNS(null,"cy","5.5"),le.setAttributeNS(null,"r","5.4999962");const ue=L.createNS("http://www.w3.org/2000/svg","circle");ue.setAttributeNS(null,"fill","#FFFFFF"),ue.setAttributeNS(null,"cx","5.5"),ue.setAttributeNS(null,"cy","5.5"),ue.setAttributeNS(null,"r","5.4999962"),re.appendChild(le),re.appendChild(ue),E.appendChild(T),E.appendChild(V),E.appendChild($),E.appendChild(X),E.appendChild(re),u.appendChild(E),u.setAttributeNS(null,"height",p*this._scale+"px"),u.setAttributeNS(null,"width",m*this._scale+"px"),this._element.appendChild(u),this._offset=l.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(u=>{u.preventDefault()})),this._element.addEventListener("mousedown",(u=>{u.preventDefault()})),sd(this._element,this._anchor,"marker"),t&&t.className)for(const u of t.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),L.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=l.S.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const m=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(38.1-13.5+m)],"bottom-right":[-m,-1*(38.1-13.5+m)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var u,p;const m=(u=this._map)===null||u===void 0?void 0:u.terrain,v=this._map.transform.isLocationOccluded(this._lngLat);if(!m||v){const X=v?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==X&&(this._element.style.opacity=X))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const E=this._map,T=E.terrain.depthAtPoint(this._pos),k=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,k)-T<.006)return void(this._element.style.opacity=this._opacity);const V=-this._offset.y/E.transform.pixelsPerMeter,N=Math.sin(E.getPitch()*Math.PI/180)*V,$=E.terrain.depthAtPoint(new l.P(this._pos.x,this._pos.y-this._offset.y)),K=E.transform.lngLatToCameraDepth(this._lngLat,k+N)-$>.006;!((p=this._popup)===null||p===void 0)&&p.isOpen()&&K&&this._popup.remove(),this._element.style.opacity=K?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=l.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,u){return(this._opacity===void 0||t===void 0&&u===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),u!==void 0&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const kf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Uo=0,Ea=!1;const Pf={maxWidth:100,unit:"metric"};function od(g,t,u){const p=u&&u.maxWidth||100,m=g._container.clientHeight/2,v=g._container.clientWidth/2,E=g.unproject([v-p/2,m]),T=g.unproject([v+p/2,m]),k=Math.round(g.project(T).x-g.project(E).x),V=Math.min(p,k,g._container.clientWidth),N=E.distanceTo(T);if(u&&u.unit==="imperial"){const $=3.2808*N;$>5280?Aa(t,V,$/5280,g._getUIString("ScaleControl.Miles")):Aa(t,V,$,g._getUIString("ScaleControl.Feet"))}else u&&u.unit==="nautical"?Aa(t,V,N/1852,g._getUIString("ScaleControl.NauticalMiles")):N>=1e3?Aa(t,V,N/1e3,g._getUIString("ScaleControl.Kilometers")):Aa(t,V,N,g._getUIString("ScaleControl.Meters"))}function Aa(g,t,u,p){const m=(function(v){const E=Math.pow(10,`${Math.floor(v)}`.length-1);let T=v/E;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:(function(k){const V=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*V)/V})(T),E*T})(u);g.style.width=t*(m/u)+"px",g.innerHTML=`${m}&nbsp;${p}`}const Lf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Df=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ad(g){if(g){if(typeof g=="number"){const t=Math.round(Math.abs(g)/Math.SQRT2);return{center:new l.P(0,0),top:new l.P(0,g),"top-left":new l.P(t,t),"top-right":new l.P(-t,t),bottom:new l.P(0,-g),"bottom-left":new l.P(t,-t),"bottom-right":new l.P(-t,-t),left:new l.P(g,0),right:new l.P(-g,0)}}if(g instanceof l.P||Array.isArray(g)){const t=l.P.convert(g);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:l.P.convert(g.center||[0,0]),top:l.P.convert(g.top||[0,0]),"top-left":l.P.convert(g["top-left"]||[0,0]),"top-right":l.P.convert(g["top-right"]||[0,0]),bottom:l.P.convert(g.bottom||[0,0]),"bottom-left":l.P.convert(g["bottom-left"]||[0,0]),"bottom-right":l.P.convert(g["bottom-right"]||[0,0]),left:l.P.convert(g.left||[0,0]),right:l.P.convert(g.right||[0,0])}}return ad(new l.P(0,0))}const If=_;e.AJAXError=l.cz,e.Event=l.l,e.Evented=l.E,e.LngLat=l.S,e.MercatorCoordinate=l.a1,e.Point=l.P,e.addProtocol=l.cA,e.config=l.a,e.removeProtocol=l.cB,e.AttributionControl=tr,e.BoxZoomHandler=gs,e.CanvasSource=Tr,e.CooperativeGesturesHandler=Tf,e.DoubleClickZoomHandler=Qm,e.DragPanHandler=ey,e.DragRotateHandler=wu,e.EdgeInsets=$e,e.FullscreenControl=class extends l.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var t;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=u?.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:l.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){L.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=L.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);L.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new l.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new l.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},e.GeoJSONSource=St,e.GeolocateControl=class extends l.E{constructor(g){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new l.l("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new l.l("geolocate",t)),this._finish()}},this._updateCamera=t=>{const u=new l.S(t.coords.longitude,t.coords.latitude),p=t.coords.accuracy,m=this._map.getBearing(),v=l.e({bearing:m},this.options.fitBoundsOptions),E=gr.fromLngLat(u,p);this._map.fitBounds(E,v,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const u=new l.S(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=t.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=t=>{if(this._map){if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Ea)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new l.l("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this._geolocateButton=L.create("button","maplibregl-ctrl-geolocate",this._container),L.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){l.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Au({element:this._dotElement}),this._circleElement=L.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Au({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(u=>{const p=u?.[0]instanceof ResizeObserverEntry;u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||p||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new l.l("trackuserlocationend")),this.fire(new l.l("userlocationlostfocus")))}))}},this.options=l.e({},kf,g)}onAdd(g){return this._map=g,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return l._(this,arguments,void 0,(function*(t=!1){if(Vo!==void 0&&!t)return Vo;if(window.navigator.permissions===void 0)return Vo=!!window.navigator.geolocation,Vo;try{Vo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Vo=!!window.navigator.geolocation}return Vo}))})().then((t=>this._finishSetupUI(t))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),L.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Uo=0,Ea=!1}_isOutOfMapMaxBounds(g){const t=this._map.getMaxBounds(),u=g.coords;return t&&(u.longitude<t.getWest()||u.longitude>t.getEast()||u.latitude<t.getSouth()||u.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const g=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&g))return;const t=this._map.project(g),u=this._map.unproject([t.x+100,t.y]),p=g.distanceTo(u)/100,m=2*this._accuracy/p;this._circleElement.style.width=`${m.toFixed(2)}px`,this._circleElement.style.height=`${m.toFixed(2)}px`}trigger(){if(!this._setup)return l.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Uo--,Ea=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new l.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.l("trackuserlocationstart")),this.fire(new l.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Uo++,Uo>1?(g={maximumAge:6e5,timeout:0},Ea=!0):(g=this.options.positionOptions,Ea=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},e.GlobeControl=class{constructor(){this._toggleProjection=()=>{var g;const t=(g=this._map.getProjection())===null||g===void 0?void 0:g.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var g;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((g=this._map.getProjection())===null||g===void 0?void 0:g.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(g){return this._map=g,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=L.create("button","maplibregl-ctrl-globe",this._container),L.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){L.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},e.Hash=wf,e.ImageSource=Qt,e.KeyboardHandler=td,e.LngLatBounds=gr,e.LogoControl=dl,e.Map=class extends id{constructor(g){var t,u;l.cw.mark(l.cx.create);const p=Object.assign(Object.assign(Object.assign({},pl),g),{canvasContextAttributes:Object.assign(Object.assign({},pl.canvasContextAttributes),g.canvasContextAttributes)});if(p.minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const m=new Ha,v=new eu;if(p.minZoom!==void 0&&m.setMinZoom(p.minZoom),p.maxZoom!==void 0&&m.setMaxZoom(p.maxZoom),p.minPitch!==void 0&&m.setMinPitch(p.minPitch),p.maxPitch!==void 0&&m.setMaxPitch(p.maxPitch),p.renderWorldCopies!==void 0&&m.setRenderWorldCopies(p.renderWorldCopies),super(m,v,{bearingSnap:p.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new ry,this._controls=[],this._mapId=l.a7(),this._contextLost=T=>{T.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new l.l("webglcontextlost",{originalEvent:T}))},this._contextRestored=T=>{this._setupPainter(),this.resize(),this._update(),this.fire(new l.l("webglcontextrestored",{originalEvent:T}))},this._onMapScroll=T=>{if(T.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},p.canvasContextAttributes),this._trackResize=p.trackResize===!0,this._bearingSnap=p.bearingSnap,this._centerClampedToGround=p.centerClampedToGround,this._refreshExpiredTiles=p.refreshExpiredTiles===!0,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions===!0,this._collectResourceTiming=p.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},kv),p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=p.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Q.addThrottleControl((()=>this.isMoving())),this._requestManager=new Be(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let T=!1;const k=xf((V=>{this._trackResize&&!this._removed&&(this.resize(V),this.redraw())}),50);this._resizeObserver=new ResizeObserver((V=>{T?k(V):T=!0})),this._resizeObserver.observe(this._container)}this.handlers=new Ws(this,p),this._hash=p.hash&&new wf(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,elevation:p.elevation,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,roll:p.roll}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,l.e({},p.fitBoundsOptions,{duration:0}))));const E=typeof p.style=="string"||((u=(t=p.style)===null||t===void 0?void 0:t.projection)===null||u===void 0?void 0:u.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new tr(typeof p.attributionControl=="boolean"?void 0:p.attributionControl)),p.maplibreLogo&&this.addControl(new dl,p.logoPosition),this.on("style.load",(()=>{if(E||this._resizeTransform(),this.transform.unmodified){const T=l.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(T)}})),this.on("data",(T=>{this._update(T.dataType==="style"),this.fire(new l.l(`${T.dataType}data`,T))})),this.on("dataloading",(T=>{this.fire(new l.l(`${T.dataType}dataloading`,T))})),this.on("dataabort",(T=>{this.fire(new l.l("sourcedataabort",T))}))}_getMapId(){return this._mapId}setGlobalStateProperty(g,t){return this.style.setGlobalStateProperty(g,t),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(g,t){if(t===void 0&&(t=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new l.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=g.onAdd(this);this._controls.push(g);const p=this._controlPositions[t];return t.indexOf("bottom")!==-1?p.insertBefore(u,p.firstChild):p.appendChild(u),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new l.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(g);return t>-1&&this._controls.splice(t,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}coveringTiles(g){return hr(this.transform,g)}calculateCameraOptionsFromTo(g,t,u,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,t,u,p)}resize(g,t=!0){const[u,p]=this._containerDimensions(),m=this._getClampedPixelRatio(u,p);if(this._resizeCanvas(u,p,m),this.painter.resize(u,p,m),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const T=this._getClampedPixelRatio(u,p);this._resizeCanvas(u,p,T),this.painter.resize(u,p,T)}this._resizeTransform(t);const v=!this._moving;return v&&(this.stop(),this.fire(new l.l("movestart",g)).fire(new l.l("move",g))),this.fire(new l.l("resize",g)),v&&this.fire(new l.l("moveend",g)),this}_resizeTransform(g=!0){var t;const[u,p]=this._containerDimensions();this.transform.resize(u,p,g),(t=this._requestedCameraState)===null||t===void 0||t.resize(u,p,g)}_getClampedPixelRatio(g,t){const{0:u,1:p}=this._maxCanvasSize,m=this.getPixelRatio(),v=g*m,E=t*m;return Math.min(v>u?u/v:1,E>p?p/E:1)*m}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(gr.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.setMinZoom(g),this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.setMaxZoom(g),this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.setMinPitch(g),this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(g>=this.transform.minPitch)return this.transform.setMaxPitch(g),this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.setRenderWorldCopies(g),this._update()}project(g){return this.transform.locationToScreenPoint(l.S.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.screenPointToLocation(l.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,t,u){if(g==="mouseenter"||g==="mouseover"){let p=!1;return{layers:t,listener:u,delegates:{mousemove:v=>{const E=t.filter((k=>this.getLayer(k))),T=E.length!==0?this.queryRenderedFeatures(v.point,{layers:E}):[];T.length?p||(p=!0,u.call(this,new Un(g,this,v.originalEvent,{features:T}))):p=!1},mouseout:()=>{p=!1}}}}if(g==="mouseleave"||g==="mouseout"){let p=!1;return{layers:t,listener:u,delegates:{mousemove:E=>{const T=t.filter((k=>this.getLayer(k)));(T.length!==0?this.queryRenderedFeatures(E.point,{layers:T}):[]).length?p=!0:p&&(p=!1,u.call(this,new Un(g,this,E.originalEvent)))},mouseout:E=>{p&&(p=!1,u.call(this,new Un(g,this,E.originalEvent)))}}}}{const p=m=>{const v=t.filter((T=>this.getLayer(T))),E=v.length!==0?this.queryRenderedFeatures(m.point,{layers:v}):[];E.length&&(m.features=E,u.call(this,m),delete m.features)};return{layers:t,listener:u,delegates:{[g]:p}}}}_saveDelegatedListener(g,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(t)}_removeDelegatedListener(g,t,u){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const p=this._delegatedListeners[g];for(let m=0;m<p.length;m++){const v=p[m];if(v.listener===u&&v.layers.length===t.length&&v.layers.every((E=>t.includes(E)))){for(const E in v.delegates)this.off(E,v.delegates[E]);return void p.splice(m,1)}}}on(g,t,u){if(u===void 0)return super.on(g,t);const p=typeof t=="string"?[t]:t,m=this._createDelegatedListener(g,p,u);this._saveDelegatedListener(g,m);for(const v in m.delegates)this.on(v,m.delegates[v]);return{unsubscribe:()=>{this._removeDelegatedListener(g,p,u)}}}once(g,t,u){if(u===void 0)return super.once(g,t);const p=typeof t=="string"?[t]:t,m=this._createDelegatedListener(g,p,u);for(const v in m.delegates){const E=m.delegates[v];m.delegates[v]=(...T)=>{this._removeDelegatedListener(g,p,u),E(...T)}}this._saveDelegatedListener(g,m);for(const v in m.delegates)this.once(v,m.delegates[v]);return this}off(g,t,u){return u===void 0?super.off(g,t):(this._removeDelegatedListener(g,typeof t=="string"?[t]:t,u),this)}queryRenderedFeatures(g,t){if(!this.style)return[];let u;const p=g instanceof l.P||Array.isArray(g),m=p?g:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(p?{}:g)||{},m instanceof l.P||typeof m[0]=="number")u=[l.P.convert(m)];else{const v=l.P.convert(m[0]),E=l.P.convert(m[1]);u=[v,new l.P(E.x,v.y),E,new l.P(v.x,E.y),v]}return this.style.queryRenderedFeatures(u,t,this.transform)}querySourceFeatures(g,t){return this.style.querySourceFeatures(g,t)}setStyle(g,t){return(t=l.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(g,t))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const t=this._locale[g];if(t==null)throw new Error(`Missing UI string '${g}'`);return t}_updateStyle(g,t){var u,p;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(g,t)));const m=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new Jp(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,t,m):this.style.loadJSON(g,t,m),this):((p=(u=this.style)===null||u===void 0?void 0:u.projection)===null||p===void 0||p.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Jp(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,t){if(typeof g=="string"){const u=this._requestManager.transformRequest(g,"Style");l.j(u,new AbortController).then((p=>{this._updateDiff(p.data,t)})).catch((p=>{p&&this.fire(new l.k(p))}))}else typeof g=="object"&&this._updateDiff(g,t)}_updateDiff(g,t){try{this.style.setState(g,t)&&this._update(!0)}catch(u){l.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(g,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.w("There is no style added to the map.")}addSource(g,t){return this._lazyInitEmptyStyle(),this.style.addSource(g,t),this._update(!0)}isSourceLoaded(g){const t=this.style&&this.style.sourceCaches[g];if(t!==void 0)return t.loaded();this.fire(new l.k(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const t=this.style.sourceCaches[g.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&t.reload();for(const u in this.style._layers){const p=this.style._layers[u];p.type==="hillshade"&&p.source===g.source&&l.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),p.type==="color-relief"&&p.source===g.source&&l.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new iy(this.painter,t,g),this.painter.renderToTexture=new Cv(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var p;u.dataType==="style"?this.terrain.sourceCache.freeRtt():u.dataType==="source"&&u.tile&&(u.sourceId!==g.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((p=u.source)===null||p===void 0?void 0:p.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new l.l("terrain",{terrain:g})),this}getTerrain(){var g,t;return(t=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const t in g){const u=g[t]._tiles;for(const p in u){const m=u[p];if(m.state!=="loaded"&&m.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}setSourceTileLodParams(g,t,u){if(u){const p=this.getSource(u);if(!p)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);p.calculateTileZoom=Mt(Math.max(1,g),Math.max(1,t))}else for(const p in this.style.sourceCaches)this.style.sourceCaches[p].getSource().calculateTileZoom=Mt(Math.max(1,g),Math.max(1,t));return this._update(!0),this}refreshTiles(g,t){const u=this.style.sourceCaches[g];if(!u)throw new Error(`There is no source cache with ID "${g}", cannot refresh tile`);t===void 0?u.reload(!0):u.refreshTiles(t.map((p=>new l.a4(p.z,p.x,p.y))))}addImage(g,t,u={}){const{pixelRatio:p=1,sdf:m=!1,stretchX:v,stretchY:E,content:T,textFitWidth:k,textFitHeight:V}=u;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||l.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:N,height:$,data:K}=t,X=t;return this.style.addImage(g,{data:new l.R({width:N,height:$},new Uint8Array(K)),pixelRatio:p,stretchX:v,stretchY:E,content:T,textFitWidth:k,textFitHeight:V,sdf:m,version:0,userImage:X}),X.onAdd&&X.onAdd(this,g),this}}{const{width:N,height:$,data:K}=I.getImageData(t);this.style.addImage(g,{data:new l.R({width:N,height:$},K),pixelRatio:p,stretchX:v,stretchY:E,content:T,textFitWidth:k,textFitHeight:V,sdf:m,version:0})}}updateImage(g,t){const u=this.style.getImage(g);if(!u)return this.fire(new l.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=t instanceof HTMLImageElement||l.b(t)?I.getImageData(t):t,{width:m,height:v,data:E}=p;if(m===void 0||v===void 0)return this.fire(new l.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(m!==u.data.width||v!==u.data.height)return this.fire(new l.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(t instanceof HTMLImageElement||l.b(t));return u.data.replace(E,T),this.style.updateImage(g,u),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new l.k(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return Q.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,t){return this._lazyInitEmptyStyle(),this.style.addLayer(g,t),this._update(!0)}moveLayer(g,t){return this.style.moveLayer(g,t),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,t,u){return this.style.setLayerZoomRange(g,t,u),this._update(!0)}setFilter(g,t,u={}){return this.style.setFilter(g,t,u),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,t,u,p={}){return this.style.setPaintProperty(g,t,u,p),this._update(!0)}getPaintProperty(g,t){return this.style.getPaintProperty(g,t)}setLayoutProperty(g,t,u,p={}){return this.style.setLayoutProperty(g,t,u,p),this._update(!0)}getLayoutProperty(g,t){return this.style.getLayoutProperty(g,t)}setGlyphs(g,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,t,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,t,u,(p=>{p||this._update(!0)})),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,t,(u=>{u||this._update(!0)})),this}setLight(g,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(g,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(g,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,t){return this.style.setFeatureState(g,t),this._update()}removeFeatureState(g,t){return this.style.removeFeatureState(g,t),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,t=0;return this._container&&(g=this._container.clientWidth||400,t=this._container.clientHeight||300),[g,t]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const t=this._canvasContainer=L.create("div","maplibregl-canvas-container",g);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=L.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),p=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],p);const m=this._controlContainer=L.create("div","maplibregl-control-container",g),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((E=>{v[E]=L.create("div",`maplibregl-ctrl-${E} `,m)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,t,u){this._canvas.width=Math.floor(u*g),this._canvas.height=Math.floor(u*t),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const g=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",(p=>{t={requestedAttributes:g},p&&(t.statusMessage=p.statusMessage,t.type=p.type)}),{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,g):this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g),!u){const p="Failed to initialize WebGL";throw t?(t.message=p,new Error(JSON.stringify(t))):new Error(p)}this.painter=new Vm(u,this.transform),O.testSupport(u)}migrateProjection(g,t){super.migrateProjection(g,t),this.painter.transform=g,this.fire(new l.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){var t,u,p,m,v;const E=this._idleTriggered?this._fadeDuration:0,T=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let k=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const $=this.transform.zoom,K=I.now();this.style.zoomHistory.update($,K);const X=new l.F($,{now:K,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),re=X.crossFadingFactor();re===1&&re===this._crossFadingFactor||(k=!0,this._crossFadingFactor=re),this.style.update(X)}const V=((u=this.style.projection)===null||u===void 0?void 0:u.transitionState)>0!==T;(p=this.style.projection)===null||p===void 0||p.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((m=this.style.projection)===null||m===void 0?void 0:m.transitionState,(v=this.style.projection)===null||v===void 0?void 0:v.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||V)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,V),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new l.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,l.cw.mark(l.cx.load),this.fire(new l.l("load"))),this.style&&(this.style.hasTransitions()||k)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const N=this._sourcesDirty||this._styleDirty||this._placementDirty;return N||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.l("idle")),!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,l.cw.mark(l.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Q.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t?.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),L.remove(this._canvasContainer),L.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),l.cw.clearMetrics(),this._removed=!0,this.fire(new l.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,I.frame(this._frameRequest,(g=>{l.cw.frame(g),this._frameRequest=null;try{this._render(g)}catch(t){if(!l.cy(t)&&!(function(u){return u.message===hf})(t))throw t}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return Pv}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(g){return this._lazyInitEmptyStyle(),this.style.setProjection(g),this._update(!0)}},e.MapMouseEvent=Un,e.MapTouchEvent=Mo,e.MapWheelEvent=Ef,e.Marker=Au,e.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const t=this._map.getZoom(),u=t===this._map.getMaxZoom(),p=t===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,u)=>{const p=this._map._getUIString(`NavigationControl.${u}`);t.title=p,t.setAttribute("aria-label",p)},this.options=l.e({},vi,g),this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(t=>t.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(t=>this._map.zoomIn({},{originalEvent:t}))),L.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(t=>this._map.zoomOut({},{originalEvent:t}))),L.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})})),this._compassIcon=L.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Li(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){L.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,t){const u=L.create("button",g,this._container);return u.type="button",u.addEventListener("click",t),u}},e.Popup=class extends l.E{constructor(g){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&L.remove(this._content),this._container&&(L.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new l.l("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=L.create("div","maplibregl-popup",this._map.getContainer()),this._tip=L.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=fl(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!t)return;const u=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let p=this.options.anchor;const m=ad(this.options.offset);if(!p){const E=this._container.offsetWidth,T=this._container.offsetHeight;let k;k=u.y+m.bottom.y<T?["top"]:u.y>this._map.transform.height-T?["bottom"]:[],u.x<E/2?k.push("left"):u.x>this._map.transform.width-E/2&&k.push("right"),p=k.length===0?"bottom":k.join("-")}let v=u.add(m[p]);this.options.subpixelPositioning||(v=v.round()),L.setTransform(this._container,`${hl[p]} translate(${v.x}px,${v.y}px)`),sd(this._container,p,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=l.e(Object.create(Lf),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new l.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=l.S.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const t=document.createDocumentFragment(),u=document.createElement("body");let p;for(u.innerHTML=g;p=u.firstChild,p;)t.appendChild(p);return this.setDOMContent(t)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=L.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=L.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(Df);g&&g.focus()}},e.RasterDEMTileSource=Pr,e.RasterTileSource=Vt,e.ScaleControl=class{constructor(g){this._onMove=()=>{od(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,od(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Pf),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){L.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},e.ScrollZoomHandler=Jm,e.Style=Jp,e.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=L.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=L.create("button","maplibregl-ctrl-terrain",this._container),L.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){L.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},e.TwoFingersTouchPitchHandler=Zm,e.TwoFingersTouchRotateHandler=ed,e.TwoFingersTouchZoomHandler=Qc,e.TwoFingersTouchZoomRotateHandler=rd,e.VectorTileSource=qr,e.VideoSource=nr,e.addSourceType=(g,t)=>l._(void 0,void 0,void 0,(function*(){if(bt(g))throw new Error(`A source type called "${g}" already exists.`);((u,p)=>{$r[u]=p})(g,t)})),e.clearPrewarmedResources=function(){const g=Ce;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(ge),Ce=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},e.createTileMesh=ru,e.getMaxParallelImageRequests=function(){return l.a.MAX_PARALLEL_IMAGE_REQUESTS},e.getRTLTextPluginStatus=function(){return vt().getRTLTextPluginStatus()},e.getVersion=function(){return If},e.getWorkerCount=function(){return Gt.workerCount},e.getWorkerUrl=function(){return l.a.WORKER_URL},e.importScriptInWorkers=function(g){return Ur().broadcast("IS",g)},e.prewarm=function(){kt().acquire(ge)},e.setMaxParallelImageRequests=function(g){l.a.MAX_PARALLEL_IMAGE_REQUESTS=g},e.setRTLTextPlugin=function(g,t){return vt().setRTLTextPlugin(g,t)},e.setWorkerCount=function(g){Gt.workerCount=g},e.setWorkerUrl=function(g){l.a.WORKER_URL=g}}));var y=a;return y}))})(Lb)),Lb.exports}var m3=h3();const Ks=sD(m3);function y3(i){return Object.fromEntries(Object.entries(i).filter(([n,a])=>a!=null))}Vx(["click"]);function g3(i,n){Gn(n,!0);const a=Xr(Gp),c=Xr(()=>Ie(a).map),f=Xr(()=>Ie(a).loaded);let y=Ct(n,"position",3,"top-left"),e=Ct(n,"container",3,void 0),l=ti(void 0),_=Xr(()=>typeof e()=="string"?document.querySelector(e())??void 0:e());bi(()=>{Ie(c)&&!Ie(l)&&(Ie(_)?dr(l,new Ks.FullscreenControl({container:Ie(_)}),!0):dr(l,new Ks.FullscreenControl,!0),Ie(c).addControl(Ie(l),y()))}),jp(()=>{Ie(f)&&Ie(l)&&Ie(c)?.removeControl(Ie(l))}),$n()}function _3(i,n){Gn(n,!0);const a=Xr(Gp),c=Xr(()=>Ie(a).map),f=Xr(()=>Ie(a).loaded);let y=Ct(n,"position",3,"top-left"),e=Ct(n,"positionOptions",3,void 0),l=Ct(n,"fitBoundsOptions",3,void 0),_=Ct(n,"trackUserLocation",3,!1),w=Ct(n,"showAccuracyCircle",3,!0),R=Ct(n,"showUserLocation",3,!0),C=Ct(n,"control",15);bi(()=>{Ie(c)&&!C()&&(C(new Ks.GeolocateControl({positionOptions:e(),fitBoundsOptions:l(),trackUserLocation:_(),showAccuracyCircle:w(),showUserLocation:R()})),Ie(c).addControl(C(),y()))}),jp(()=>{Ie(f)&&C()&&Ie(c)?.removeControl(C())}),$n()}function b3(i){let n=i.getCenter(),a=Math.round(i.getZoom()*100)/100,c=Math.ceil((a*Math.LN2+Math.log(512/360/.5))/Math.LN10),f=Math.pow(10,c),y=Math.round(n.lat*f)/f,e=Math.round(n.lng*f)/f,l=`${a}/${y}/${e}`,_=i.getBearing(),w=i.getPitch();return(_||w)&&(l+=`/${Math.round(_*10)/10}`),w&&(l+=`/${Math.round(w)}`),`#${l}`}function v3(i){const n=i.replace("#","").split("/").map(parseFloat);return n.some(isNaN)?[]:n}var ih=Nx;function Nx(i,n){return i===n||i!==i&&n!==n?!0:typeof i!=typeof n||{}.toString.call(i)!={}.toString.call(n)||i!==Object(i)||!i?!1:Array.isArray(i)?iE(i,n):{}.toString.call(i)=="[object Set]"?iE(Array.from(i),Array.from(n)):{}.toString.call(i)=="[object Object]"?w3(i,n):x3(i,n)}function x3(i,n){return i.toString()===n.toString()}function iE(i,n){var a=i.length;if(a!=n.length)return!1;for(var c=0;c<a;c++)if(!Nx(i[c],n[c]))return!1;return!0}function w3(i,n){var a=Object.keys(i),c=a.length;if(c!=Object.keys(n).length)return!1;for(var f=0;f<c;f++){var y=a[f];if(!(n.hasOwnProperty(y)&&Nx(i[y],n[y])))return!1}return!0}const{LngLatBounds:E3,LngLat:A3}=Ks;function Ry(i,n){return Math.abs(i-n)<1e-6}function R3(i,n){let a=E3.convert(i);if(!n)return{equal:!1,bounds:a};let c=a.getNorthEast(),f=n.getNorthEast();if(!Ry(c.lat,f.lat)||!Ry(c.wrap().lng,f.wrap().lng))return{equal:!1,bounds:a};let y=a.getSouthWest(),e=n.getSouthWest();return!Ry(y.lat,e.lat)||!Ry(y.wrap().lng,e.wrap().lng)?{equal:!1,bounds:a}:{equal:!0,bounds:a}}function S3(i,n){const a=i.getSouthWest(),c=i.getNorthEast();if(Array.isArray(n)){if(n.length===4)return[a.lng,a.lat,c.lng,c.lat];if(n.length===2)return n[0]instanceof A3?[a,c]:[[a.lng,a.lat],[c.lng,c.lat]]}return i}function T3(i,n){Gn(n,!0);const a=Xr(Gp),c=Xr(()=>Ie(a).map),f=Xr(()=>Ie(a).loaded);let y=Ct(n,"position",3,"top-left"),e=Ct(n,"showCompass",3,!0),l=Ct(n,"showZoom",3,!0),_=Ct(n,"visualizePitch",3,!1),w=ti(void 0);bi(()=>{Ie(c)&&!Ie(w)&&(dr(w,new Ks.NavigationControl({showCompass:e(),showZoom:l(),visualizePitch:_()}),!0),Ie(c).addControl(Ie(w),y()))}),jp(()=>{Ie(f)&&Ie(w)&&Ie(c)?.removeControl(Ie(w))}),$n()}function C3(i,n){Gn(n,!0);const a=Xr(Gp),c=Xr(()=>Ie(a).map),f=Xr(()=>Ie(a).loaded);let y=Ct(n,"position",3,"bottom-left"),e=Ct(n,"maxWidth",3,void 0),l=Ct(n,"unit",3,"metric"),_=ti(void 0);bi(()=>{Ie(c)&&!Ie(_)&&(dr(_,new Ks.ScaleControl({maxWidth:e(),unit:l()}),!0),Ie(c).addControl(Ie(_),y()))}),jp(()=>{Ie(f)&&Ie(_)&&Ie(c)?.removeControl(Ie(_))}),$n()}var k3=cs("<!> <!> <!> <!>",1),P3=cs("<!> <!>",1),L3=cs('<div data-testid="map-container"><!></div>');function D3(i,n){Gn(n,!0);let a=Ct(n,"map",15,void 0),c=Ct(n,"mapContainer",15,void 0),f=Ct(n,"class",3,void 0),y=Ct(n,"diffStyleUpdates",3,!1),e=Ct(n,"center",15,void 0),l=Ct(n,"zoom",15,void 0),_=Ct(n,"pitch",15,0),w=Ct(n,"bearing",15,0),R=Ct(n,"bearingSnap",3,7),C=Ct(n,"bounds",15,void 0),I=Ct(n,"fitBoundsOptions",19,()=>({})),L=Ct(n,"hash",3,!1),O=Ct(n,"projection",3,void 0),q=Ct(n,"updateHash",3,St=>{window.history.replaceState(window.history.state,"",St)}),G=Ct(n,"loaded",15,!1),j=Ct(n,"minZoom",3,0),ne=Ct(n,"maxZoom",3,22),he=Ct(n,"minPitch",3,0),Q=Ct(n,"maxPitch",3,60),Be=Ct(n,"renderWorldCopies",3,void 0),we=Ct(n,"dragPan",3,void 0),ze=Ct(n,"dragRotate",3,void 0),et=Ct(n,"pitchWithRotate",3,void 0),gt=Ct(n,"antialias",3,void 0),st=Ct(n,"zoomOnDoubleClick",3,!0),nt=Ct(n,"locale",3,void 0),rt=Ct(n,"interactive",3,!0),ee=Ct(n,"attributionControl",3,void 0),Le=Ct(n,"cooperativeGestures",3,!1),de=Ct(n,"preserveDrawingBuffer",3,!1),me=Ct(n,"maxBounds",3,void 0),tt=Ct(n,"images",19,()=>[]),yt=Ct(n,"standardControls",3,!1),lt=Ct(n,"filterLayers",3,void 0),ge=Ct(n,"transformRequest",3,void 0),Gt=Xr(()=>typeof yt()=="boolean"?void 0:yt());const Ut=u3();eD(new Ub(void 0));let Ce=ti(Oa(new Set));async function ar(St,Qt=!1){if(a()&&!(!a()?.loaded()&&!Qt))if("url"in St){Ie(Ce).add(St.id);try{let nr=await a().loadImage(St.url);a().addImage(St.id,nr.data,St.options),Ut.loadedImages.add(St.id)}catch(nr){n.onerror?n.onerror({error:nr}):console.error(nr)}finally{Ie(Ce).delete(St.id)}}else a().addImage(St.id,St.data,St.options),Ut.loadedImages.add(St.id)}bi(()=>{if(G()&&a()?.loaded())for(let St of tt())!Ut.loadedImages.has(St.id)&&!Ie(Ce).has(St.id)&&!a().hasImage(St.id)&&ar(St)});let kt=Xr(()=>tt().every(St=>Ut.loadedImages.has(St.id))),er=ti(void 0),Ur=ti(void 0),or=ti(void 0),Sr=ti(void 0);function Ar(St){n.onerror?n.onerror(St):St.error.name!=="AbortError"&&console.error(St.error)}function Nr(St){return gr(),a(Ut.map=new Ks.Map(y3({container:St,style:n.style,locale:nt(),center:e(),zoom:l(),pitch:_(),bearing:w(),bearingSnap:R(),minZoom:j(),maxZoom:ne(),minPitch:he(),maxPitch:Q(),renderWorldCopies:Be(),dragPan:we(),dragRotate:ze(),pitchWithRotate:et(),antialias:gt(),interactive:rt(),preserveDrawingBuffer:de(),maxBounds:me(),bounds:C(),attributionControl:ee(),transformRequest:ge(),cooperativeGestures:Le()}))),a().on("load",Qt=>{Qt.target.getContainer().setAttribute("data-testid","map"),Qt.target.getCanvas().setAttribute("data-testid","map-canvas"),n.onload&&n.onload(a()),Ut.loaded=!0,G(!0)}),a().on("error",Ar),n.onmovestart&&a().on("movestart",n.onmovestart),a().on("moveend",Qt=>{if(e(Qt.target.getCenter()),l(Qt.target.getZoom()),_(Qt.target.getPitch()),w(Qt.target.getBearing()),C(S3(Qt.target.getBounds(),C())),n.onmoveend?.(Qt),L()){let nr=new URL(window.location.href.replace(/(#.+)?$/,b3(Qt.target)));q()(nr)}}),n.onclick&&a().on("click",n.onclick),n.ondblclick&&a().on("dblclick",n.ondblclick),n.oncontextmenu&&a().on("contextmenu",n.oncontextmenu),n.onmousemove&&a().on("mousemove",n.onmousemove),n.onzoomstart&&a().on("zoomstart",n.onzoomstart),n.onzoom&&a().on("zoom",n.onzoom),n.onzoomend&&a().on("zoomend",n.onzoomend),n.onpitch&&a().on("pitch",n.onpitch),n.onrotate&&a().on("rotate",n.onrotate),n.onwheel&&a().on("wheel",n.onwheel),n.ondata&&a().on("data",n.ondata),n.onidle&&a().on("idle",n.onidle),a().on("style.load",Qt=>{if(a()){O()&&a().setProjection(O()),Ut.loaded=!0,G(!0);const nr=a().getStyle();if(dr(er,nr.layers.map(Tr=>Tr.id),!0),dr(Ur,Object.keys(nr.sources),!0),Ie(Sr))for(const[Tr,$r]of Object.entries(Ie(Sr)))a().addSource(Tr,$r);if(Ie(or))for(const Tr of Ie(or))a().addLayer(Tr);for(const Tr of tt())ar(Tr,!0);n.onstyleload?.(Qt)}}),a().on("styledata",Qt=>{if(a()&&lt()){const nr=a().getStyle().layers;if(nr)for(let Tr of nr)lt()(Tr)||a().setLayoutProperty(Tr.id,"visibility","none")}n.onstyledata?.(Qt)}),{destroy(){G(!1),Ut.loaded=!1,a()?.remove()}}}let rr=ti(Oa(n.style));bi(()=>{if(a()&&!ih(n.style,Ie(rr))){const St=a().getStyle();if(Ie(er)&&dr(or,St.layers.filter(Qt=>!Ie(er).includes(Qt.id)),!0),Ie(Ur)){const Qt=Object.keys(St.sources).filter(nr=>!Ie(Ur).includes(nr));dr(Sr,{},!0);for(const nr of Qt)Ie(Sr)[nr]=St.sources[nr]}dr(rr,n.style,!0),a().setStyle(n.style,{diff:y()}),Ut.loadedImages.clear(),dr(Ce,new Set,!0)}}),bi(()=>{if(a()){let St={};e()!=null&&!ih(e(),a().getCenter())&&(St.center=e()),l()!=null&&!ih(l(),a().getZoom())&&(St.zoom=l()),w()!=null&&!ih(w(),a().getBearing())&&(St.bearing=w()),_()!=null&&!ih(_(),a().getPitch())&&(St.pitch=_()),Object.keys(St).length&&a().easeTo(St)}}),bi(()=>{O()&&G()&&a()?.setProjection(O())}),bi(()=>{if(C()){const{equal:St,bounds:Qt}=R3(C(),a()?.getBounds());St||a()?.fitBounds(Qt,I())}}),bi(()=>{st()?a()?.doubleClickZoom.enable():a()?.doubleClickZoom.disable()});function gr(){if(L()){let St=v3(window.location.hash);St.length>=3&&(l(St[0]),e([St[2],St[1]])),St.length==5&&(w(St[3]),_(St[4]))}}var ir=L3();cc("hashchange",nx,gr);let qr;var Vt=ni(ir);{var Pr=St=>{var Qt=P3(),nr=Hr(Qt);{var Tr=bt=>{var pi=k3(),Ii=Hr(pi);T3(Ii,{get position(){return Ie(Gt)}});var Oe=yn(Ii,2);{let ve=Xr(()=>({...I(),maxZoom:12}));_3(Oe,{get position(){return Ie(Gt)},get fitBoundsOptions(){return Ie(ve)}})}var vt=yn(Oe,2);g3(vt,{get position(){return Ie(Gt)}});var Nt=yn(vt,2);C3(Nt,{get position(){return Ie(Gt)}}),wr(bt,pi)};wn(nr,bt=>{yt()&&bt(Tr)})}var $r=yn(nr,2);rm($r,()=>n.children??sm,()=>({map:a(),loaded:G(),loadedImages:Ut.loadedImages,allImagesLoaded:Ie(kt)})),wr(St,Qt)};wn(Vt,St=>{a()&&St(Pr)})}JL(ir,St=>c(St),()=>c()),ax(ir,St=>Nr?.(St)),ko(St=>qr=ZL(ir,1,$L(f()),"svelte-xbukvd",qr,St),[()=>({"expand-map":!f()})]),wr(i,ir),$n()}function I3(i,n){i.key===" "&&(i.preventDefault(),i.stopPropagation(),n("click"))}var B3=(i,n)=>{i.stopPropagation(),n("click")},M3=(i,n)=>{i.stopPropagation(),n("dblclick")},z3=(i,n)=>{i.stopPropagation(),i.preventDefault(),n("contextmenu")},O3=(i,n)=>n("mousemove"),V3=cs("<div><!></div>");function U3(i,n){Gn(n,!0);let a=Ct(n,"marker",15,void 0),c=Ct(n,"lngLat",15),f=Ct(n,"class",3,void 0),y=Ct(n,"interactive",3,!0),e=Ct(n,"asButton",3,!1),l=Ct(n,"draggable",3,!1),_=Ct(n,"feature",3,void 0),w=Ct(n,"offset",3,void 0),R=Ct(n,"zIndex",3,void 0),C=Ct(n,"rotation",3,0),I=Ct(n,"opacity",3,1),L=QL(n,["$$slots","$$events","$$legacy","marker","lngLat","class","interactive","asButton","draggable","feature","offset","zIndex","rotation","opacity","anchor","children"]);const O=Xr(Gp),q=Xr(()=>Ie(O).map),G=Xr(()=>Ie(O).markerClickManager),{layerEvent:j,marker:ne}=c3(),he=nt=>{const rt=()=>ze("dragstart"),ee=()=>{we(),ze("drag")},Le=()=>{we(),ze("dragend")};return bi(()=>{!Ie(q)||ne.value||(ne.value=new Ks.Marker({element:nt,rotation:C(),draggable:l(),offset:w(),anchor:n.anchor,opacity:I().toString()}).setLngLat(c()).addTo(Ie(q)),a(ne.value),l()&&(ne.value.on("dragstart",rt),ne.value.on("drag",ee),ne.value.on("dragend",Le)))}),{destroy:()=>{console.log("removing marker",ne.value),l()&&(ne.value?.off("dragstart",rt),ne.value?.off("drag",ee),ne.value?.off("dragend",Le)),a(void 0),ne.value?.remove()}}};function Q(nt,rt){const ee=nt.className;function Le(de){de?nt.className=`${ee} ${de}`:nt.className=ee}return Le(rt),{update:Le}}let Be=new Ub(c());o3(Be),bi(()=>{ne.value?.setLngLat(c()),Be.value=c()}),bi(()=>{w()&&ne.value?.setOffset(w())}),bi(()=>{ne.value?.setRotation(C())}),bi(()=>{ne.value?.setOpacity(I().toString())});function we(){let nt=ne.value?.getLngLat();nt&&(Array.isArray(c())?c([nt.lng,nt.lat]):c()&&"lon"in c()?c({lon:nt.lng,lat:nt.lat}):c(nt))}function ze(nt){if(!y())return;let rt=ne.value?.getLngLat();if(!rt)return;const ee=[rt.lng,rt.lat];let Le={map:Ie(q),marker:ne.value,lngLat:ee,features:[{type:"Feature",properties:_()?.properties??{},geometry:{type:"Point",coordinates:ee}}]};(nt==="click"||nt==="contextmenu")&&Ie(G).handleClick(Le),j.value={...Le,layerType:"marker",type:nt};const de=L["on"+nt];de?.(Le)}var et=V3();et.__click=[B3,ze],et.__dblclick=[M3,ze],et.__contextmenu=[z3,ze],et.__mousemove=[O3,ze],et.__keydown=[I3,ze];let gt;var st=ni(et);rm(st,()=>n.children??sm,()=>({marker:ne.value})),ax(et,nt=>he?.(nt)),ax(et,(nt,rt)=>Q?.(nt,rt),f),ko(nt=>{$l(et,"tabindex",e()?0:void 0),$l(et,"role",e()?"button":void 0),gt=HL(et,"",gt,nt)},[()=>({"z-index":R()})]),cc("mouseenter",et,()=>{ze("mouseenter")}),cc("mouseleave",et,()=>{ze("mouseleave")}),wr(i,et),$n()}Vx(["click","dblclick","contextmenu","mousemove","keydown"]);var j3=cs('<div class="sv-popup"><!></div>');function N3(i,n){Gn(n,!0);let a=Ct(n,"closeButton",3,void 0),c=Ct(n,"closeOnClickOutside",3,!0),f=Ct(n,"closeOnClickInside",3,!1),y=Ct(n,"closeOnMove",3,!1),e=Ct(n,"openOn",3,"click"),l=Ct(n,"openIfTopMost",3,!0),_=Ct(n,"focusAfterOpen",3,!0),w=Ct(n,"anchor",3,void 0),R=Ct(n,"offset",3,void 0),C=Ct(n,"popupClass",3,void 0),I=Ct(n,"maxWidth",3,void 0),L=Ct(n,"lngLat",15,void 0),O=Ct(n,"html",3,void 0),q=Ct(n,"open",15,!1),G=Ct(n,"onopen",3,void 0),j=Ct(n,"onclose",3,void 0),ne=Ct(n,"onhover",3,void 0),he=a3();const Q=Xr(Gp),Be=Xr(()=>Ie(Q).map),we=Xr(()=>Ie(Q).eventTopMost),ze=Xr(()=>Ie(Q).markerClickManager),et=Xr(()=>Ie(Q).loaded),gt=r3(),st=s3(),nt=n3(),rt=["click","dblclick","contextmenu"];let ee=ti(void 0),Le=ti(!1),de=ti(void 0);function me(){if(!Ie(ee))return;let Vt=Ie(ee).getElement();!Vt||Vt===Ie(de)||(dr(de,Vt,!0),e()==="hover"&&(Ie(de).style.pointerEvents="none"),Ie(de).addEventListener("mouseenter",()=>{dr(Le,!0)},{passive:!0}),Ie(de).addEventListener("mouseleave",()=>{dr(Le,!1)},{passive:!0}),Ie(de).addEventListener("click",()=>{f()&&q(!1)},{passive:!0}))}bi(()=>{Ie(Be)&&(Ie(Be).on("click",or),Ie(Be).on("contextmenu",or),Ie(ze).add(Sr),typeof nt?.value=="string"&&(Ie(Be).on("click",nt.value,Ut),Ie(Be).on("dblclick",nt.value,Ut),Ie(Be).on("contextmenu",nt.value,Ut),Ie(Be).on("mousemove",nt.value,Ur),Ie(Be).on("mouseleave",nt.value,er),Ie(Be).on("touchstart",nt.value,ar),Ie(Be).on("touchend",nt.value,kt)))}),jp(()=>{Ie(et)&&Ie(Be)&&(Ie(ee)?.remove(),Ie(Be).off("click",or),Ie(Be).off("contextmenu",or),Ie(ze).remove(Sr),nt?.value instanceof Ks.Marker?nt.value.getPopup()===Ie(ee)&&nt.value.setPopup(void 0):typeof nt?.value=="string"&&(Ie(Be).off("click",nt.value,Ut),Ie(Be).off("dblclick",nt.value,Ut),Ie(Be).off("contextmenu",nt.value,Ut),Ie(Be).off("mousemove",nt.value,Ur),Ie(Be).off("mouseleave",nt.value,er),Ie(Be).off("touchstart",nt.value,ar),Ie(Be).off("touchend",nt.value,kt)))});function tt(){if(n.canOpen&&!n.canOpen(Ie(lt))){q(!1);return}q(!0)}function yt(Vt){return l()?!("marker"in Vt)&&!d3(Vt)&&Ie(we)(Vt)!==gt?.value:!1}let lt=ti(void 0),ge=ti("normal");function Gt(Vt){"layerType"in Vt&&Vt.layerType==="deckgl"?(L(Vt.coordinate),dr(lt,Vt.object?[Vt.object]:void 0,!0)):(L(Vt.lngLat),dr(lt,Vt.features??[],!0))}function Ut(Vt){Vt.type!==e()||yt(Vt)||(Gt(Vt),setTimeout(tt))}let Ce;function ar(Vt){Ce=Vt.point}function kt(Vt){if(!Ce||e()!=="hover")return;let Pr=Ce.dist(Vt.point);Ce=void 0,Pr<3&&(L(Vt.lngLat),dr(lt,Vt.features??[],!0),Ie(ee)?.isOpen()?dr(ge,"justOpened"):(dr(ge,"opening"),tt()))}function er(Vt){e()!=="hover"||Ce||Ie(ge)!=="normal"||(q(!1),dr(lt,void 0))}function Ur(Vt){if(!(e()!=="hover"||Ce||Ie(ge)!=="normal")){if(yt(Vt)){q(!1),dr(lt,void 0);return}dr(lt,Vt.features??[],!0),L(Vt.lngLat),tt()}}function or(Vt){if(Ie(ge)==="justOpened"){dr(ge,"normal");return}if(!c())return;let Pr=[Ie(de),nt?.value instanceof Ks.Marker?nt.value?.getElement():void 0];q()&&Ie(ee)?.isOpen()&&!Pr.some(St=>St?.contains(Vt.originalEvent.target))&&(Vt.type==="contextmenu"&&e()==="contextmenu"||Vt.type!=="contextmenu")&&q(!1)}function Sr(Vt){c()&&q()&&Ie(ee)?.isOpen()&&Vt.marker!==nt?.value&&q(!1)}jp(()=>{Ie(et)&&Ie(ee)?.isOpen()&&Ie(ee).remove()});let Ar=ti(void 0),Nr=Xr(()=>a()??(!c()&&!f()));bi(()=>{if(!Ie(ee)){let Vt=C()?`${C()} sv-maplibregl-popup`:"sv-maplibregl-popup";dr(ee,new Ks.Popup({closeButton:Ie(Nr),closeOnClick:!1,closeOnMove:y(),focusAfterOpen:_(),maxWidth:I(),className:Vt,anchor:w(),offset:R()}),!0),dr(de,Ie(ee).getElement(),!0),Ie(ee).on("open",()=>{tt(),q()&&(me(),G()?.(Ie(ee)))}),Ie(ee).on("close",()=>{q(!1),j()?.(Ie(ee))}),ne()&&Ie(ee).on("hover",()=>{ne()?.(Ie(ee))})}}),bi(()=>{Ie(ee)&&nt?.value instanceof Ks.Marker&&(e()==="click"?nt.value.setPopup(Ie(ee)):nt.value.getPopup()===Ie(ee)&&nt.value.setPopup(void 0))}),bi(()=>{rt.includes(e())&&st.value?.type===e()&&(Ut(st.value),st.value=void 0)});let rr=Xr(()=>e()==="hover"&&(st.value?.type==="mousemove"||st.value?.type==="mouseenter"));bi(()=>{e()==="hover"&&st&&(Ie(rr)&&st.value&&Gt(st.value),Ie(rr)||Ie(Le)?tt():q(!1))}),bi(()=>{Ie(Ar)?Ie(ee)?.setDOMContent(Ie(Ar)):O()&&Ie(ee)?.setHTML(O())}),bi(()=>{let Vt=L()??he?.value??void 0;Vt&&Ie(ee)?.setLngLat(Vt)}),bi(()=>{if(Ie(Be)&&Ie(ee)){let Vt=Ie(ee).isOpen();q()&&!Vt?(Ie(ee).addTo(Ie(Be)),Ie(ge)==="opening"&&dr(ge,"justOpened")):!q()&&Vt&&Ie(ee).remove()}});var gr=yi(),ir=Hr(gr);{var qr=Vt=>{var Pr=j3(),St=ni(Pr);{var Qt=nr=>{var Tr=yi(),$r=Hr(Tr);rm($r,()=>n.children??sm,()=>({features:Ie(lt),data:Ie(lt)?.[0]??void 0,map:Ie(Be),close:()=>q(!1),isOpen:q()})),wr(nr,Tr)};wn(St,nr=>{(Ie(lt)?.length||nt?.value instanceof Ks.Marker||!nt&&q())&&nr(Qt)})}JL(Pr,nr=>dr(Ar,nr),()=>Ie(Ar)),wr(Vt,Pr)};wn(ir,Vt=>{n.children&&Vt(qr)})}wr(i,gr),$n()}var um=Uint8Array,lD=Uint16Array,F3=Int32Array,q3=new um([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),K3=new um([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uD=function(i,n){for(var a=new lD(31),c=0;c<31;++c)a[c]=n+=1<<i[c-1];for(var f=new F3(a[30]),c=1;c<30;++c)for(var y=a[c];y<a[c+1];++y)f[y]=y-a[c]<<5|c;return{b:a,r:f}},cD=uD(q3,2),G3=cD.b,$3=cD.r;G3[28]=258,$3[258]=28;uD(K3,0);var Z3=new lD(32768);for(si=0;si<32768;++si)ka=(si&43690)>>1|(si&21845)<<1,ka=(ka&52428)>>2|(ka&13107)<<2,ka=(ka&61680)>>4|(ka&3855)<<4,Z3[si]=((ka&65280)>>8|(ka&255)<<8)>>1;var ka,si,tv=new um(288);for(si=0;si<144;++si)tv[si]=8;var si;for(si=144;si<256;++si)tv[si]=9;var si;for(si=256;si<280;++si)tv[si]=7;var si;for(si=280;si<288;++si)tv[si]=8;var si,H3=new um(32);for(si=0;si<32;++si)H3[si]=5;var si,X3=new um(0),W3=typeof TextDecoder<"u"&&new TextDecoder,Y3=0;try{W3.decode(X3,{stream:!0}),Y3=1}catch{}/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 * ---
 * 
 * The MIT License (MIT) (for portions derived from Feather)
 * 
 * Copyright (c) 2013-2023 Cole Bemis
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const J3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Q3=Lz("<svg><!><!></svg>");function eO(i,n){const a=cx(n,["children","$$slots","$$events","$$legacy"]),c=cx(a,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);Gn(n,!1);let f=Ct(n,"name",8,void 0),y=Ct(n,"color",8,"currentColor"),e=Ct(n,"size",8,24),l=Ct(n,"strokeWidth",8,2),_=Ct(n,"absoluteStrokeWidth",8,!1),w=Ct(n,"iconNode",24,()=>[]);const R=(...O)=>O.filter((q,G,j)=>!!q&&j.indexOf(q)===G).join(" ");lm();var C=Q3();Bp(C,(O,q)=>({...J3,...c,width:e(),height:e(),stroke:y(),"stroke-width":O,class:q}),[()=>(qs(_()),qs(l()),qs(e()),us(()=>_()?Number(l())*24/Number(e()):l())),()=>(qs(f()),qs(a),us(()=>R("lucide-icon","lucide",f()?`lucide-${f()}`:"",a.class)))]);var I=ni(C);oc(I,1,w,sc,(O,q)=>{var G=Xr(()=>EM(Ie(q),2));let j=()=>Ie(G)[0],ne=()=>Ie(G)[1];var he=yi(),Q=Hr(he);Hh(Q,j,!0,(Be,we)=>{Bp(Be,()=>({...ne()}))}),wr(O,he)});var L=yn(I);qL(L,n,"default",{}),wr(i,C),$n()}function tO(i,n){const a=cx(n,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const c=[["path",{d:"M10 2v2"}],["path",{d:"M14 2v2"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1"}],["path",{d:"M6 2v2"}]];eO(i,dx({name:"coffee"},()=>a,{get iconNode(){return c},children:(f,y)=>{var e=yi(),l=Hr(e);qL(l,n,"default",{}),wr(f,e)},$$slots:{default:!0}}))}const dD=i=>{let n=ti(Oa(i));return{get current(){return Ie(n)},set current(a){dr(n,a,!0)}}},pD="components",rO=()=>yc(pD),iO=i=>gc(pD,i),nO="ast",sO=i=>gc(nO,i);var oO=Object.create,Fx=Object.defineProperty,aO=Object.getOwnPropertyDescriptor,fD=Object.getOwnPropertyNames,lO=Object.getPrototypeOf,uO=Object.prototype.hasOwnProperty,cO=(i,n)=>function(){return n||(0,i[fD(i)[0]])((n={exports:{}}).exports,n),n.exports},dO=(i,n)=>{for(var a in n)Fx(i,a,{get:n[a],enumerable:!0})},pO=(i,n,a,c)=>{if(n&&typeof n=="object"||typeof n=="function")for(let f of fD(n))!uO.call(i,f)&&f!==a&&Fx(i,f,{get:()=>n[f],enumerable:!(c=aO(n,f))||c.enumerable});return i},fO=(i,n,a)=>(a=i!=null?oO(lO(i)):{},pO(Fx(a,"default",{value:i,enumerable:!0}),i)),hO=cO({"node_modules/.pnpm/extend@3.0.2/node_modules/extend/index.js"(i,n){var a=Object.prototype.hasOwnProperty,c=Object.prototype.toString,f=Object.defineProperty,y=Object.getOwnPropertyDescriptor,e=function(C){return typeof Array.isArray=="function"?Array.isArray(C):c.call(C)==="[object Array]"},l=function(C){if(!C||c.call(C)!=="[object Object]")return!1;var I=a.call(C,"constructor"),L=C.constructor&&C.constructor.prototype&&a.call(C.constructor.prototype,"isPrototypeOf");if(C.constructor&&!I&&!L)return!1;var O;for(O in C);return typeof O>"u"||a.call(C,O)},_=function(C,I){f&&I.name==="__proto__"?f(C,I.name,{enumerable:!0,configurable:!0,value:I.newValue,writable:!0}):C[I.name]=I.newValue},w=function(C,I){if(I==="__proto__")if(a.call(C,I)){if(y)return y(C,I).value}else return;return C[I]};n.exports=function R(){var C,I,L,O,q,G,j=arguments[0],ne=1,he=arguments.length,Q=!1;for(typeof j=="boolean"&&(Q=j,j=arguments[1]||{},ne=2),(j==null||typeof j!="object"&&typeof j!="function")&&(j={});ne<he;++ne)if(C=arguments[ne],C!=null)for(I in C)L=w(j,I),O=w(C,I),j!==O&&(Q&&O&&(l(O)||(q=e(O)))?(q?(q=!1,G=L&&e(L)?L:[]):G=L&&l(L)?L:{},_(j,{name:I,newValue:R(Q,G,O)})):typeof O<"u"&&_(j,{name:I,newValue:O}));return j}}}),mO={};function yO(i,n){const a=mO,c=typeof a.includeImageAlt=="boolean"?a.includeImageAlt:!0,f=typeof a.includeHtml=="boolean"?a.includeHtml:!0;return hD(i,c,f)}function hD(i,n,a){if(gO(i)){if("value"in i)return i.type==="html"&&!a?"":i.value;if(n&&"alt"in i&&i.alt)return i.alt;if("children"in i)return nE(i.children,n,a)}return Array.isArray(i)?nE(i,n,a):""}function nE(i,n,a){const c=[];let f=-1;for(;++f<i.length;)c[f]=hD(i[f],n,a);return c.join("")}function gO(i){return!!(i&&typeof i=="object")}var sE={AElig:"Æ",AMP:"&",Aacute:"Á",Abreve:"Ă",Acirc:"Â",Acy:"А",Afr:"𝔄",Agrave:"À",Alpha:"Α",Amacr:"Ā",And:"⩓",Aogon:"Ą",Aopf:"𝔸",ApplyFunction:"⁡",Aring:"Å",Ascr:"𝒜",Assign:"≔",Atilde:"Ã",Auml:"Ä",Backslash:"∖",Barv:"⫧",Barwed:"⌆",Bcy:"Б",Because:"∵",Bernoullis:"ℬ",Beta:"Β",Bfr:"𝔅",Bopf:"𝔹",Breve:"˘",Bscr:"ℬ",Bumpeq:"≎",CHcy:"Ч",COPY:"©",Cacute:"Ć",Cap:"⋒",CapitalDifferentialD:"ⅅ",Cayleys:"ℭ",Ccaron:"Č",Ccedil:"Ç",Ccirc:"Ĉ",Cconint:"∰",Cdot:"Ċ",Cedilla:"¸",CenterDot:"·",Cfr:"ℭ",Chi:"Χ",CircleDot:"⊙",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",Colon:"∷",Colone:"⩴",Congruent:"≡",Conint:"∯",ContourIntegral:"∮",Copf:"ℂ",Coproduct:"∐",CounterClockwiseContourIntegral:"∳",Cross:"⨯",Cscr:"𝒞",Cup:"⋓",CupCap:"≍",DD:"ⅅ",DDotrahd:"⤑",DJcy:"Ђ",DScy:"Ѕ",DZcy:"Џ",Dagger:"‡",Darr:"↡",Dashv:"⫤",Dcaron:"Ď",Dcy:"Д",Del:"∇",Delta:"Δ",Dfr:"𝔇",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",Diamond:"⋄",DifferentialD:"ⅆ",Dopf:"𝔻",Dot:"¨",DotDot:"⃜",DotEqual:"≐",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",Downarrow:"⇓",Dscr:"𝒟",Dstrok:"Đ",ENG:"Ŋ",ETH:"Ð",Eacute:"É",Ecaron:"Ě",Ecirc:"Ê",Ecy:"Э",Edot:"Ė",Efr:"𝔈",Egrave:"È",Element:"∈",Emacr:"Ē",EmptySmallSquare:"◻",EmptyVerySmallSquare:"▫",Eogon:"Ę",Eopf:"𝔼",Epsilon:"Ε",Equal:"⩵",EqualTilde:"≂",Equilibrium:"⇌",Escr:"ℰ",Esim:"⩳",Eta:"Η",Euml:"Ë",Exists:"∃",ExponentialE:"ⅇ",Fcy:"Ф",Ffr:"𝔉",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",Fopf:"𝔽",ForAll:"∀",Fouriertrf:"ℱ",Fscr:"ℱ",GJcy:"Ѓ",GT:">",Gamma:"Γ",Gammad:"Ϝ",Gbreve:"Ğ",Gcedil:"Ģ",Gcirc:"Ĝ",Gcy:"Г",Gdot:"Ġ",Gfr:"𝔊",Gg:"⋙",Gopf:"𝔾",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",Gt:"≫",HARDcy:"Ъ",Hacek:"ˇ",Hat:"^",Hcirc:"Ĥ",Hfr:"ℌ",HilbertSpace:"ℋ",Hopf:"ℍ",HorizontalLine:"─",Hscr:"ℋ",Hstrok:"Ħ",HumpDownHump:"≎",HumpEqual:"≏",IEcy:"Е",IJlig:"Ĳ",IOcy:"Ё",Iacute:"Í",Icirc:"Î",Icy:"И",Idot:"İ",Ifr:"ℑ",Igrave:"Ì",Im:"ℑ",Imacr:"Ī",ImaginaryI:"ⅈ",Implies:"⇒",Int:"∬",Integral:"∫",Intersection:"⋂",InvisibleComma:"⁣",InvisibleTimes:"⁢",Iogon:"Į",Iopf:"𝕀",Iota:"Ι",Iscr:"ℐ",Itilde:"Ĩ",Iukcy:"І",Iuml:"Ï",Jcirc:"Ĵ",Jcy:"Й",Jfr:"𝔍",Jopf:"𝕁",Jscr:"𝒥",Jsercy:"Ј",Jukcy:"Є",KHcy:"Х",KJcy:"Ќ",Kappa:"Κ",Kcedil:"Ķ",Kcy:"К",Kfr:"𝔎",Kopf:"𝕂",Kscr:"𝒦",LJcy:"Љ",LT:"<",Lacute:"Ĺ",Lambda:"Λ",Lang:"⟪",Laplacetrf:"ℒ",Larr:"↞",Lcaron:"Ľ",Lcedil:"Ļ",Lcy:"Л",LeftAngleBracket:"⟨",LeftArrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",LeftRightArrow:"↔",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",Leftarrow:"⇐",Leftrightarrow:"⇔",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",LessLess:"⪡",LessSlantEqual:"⩽",LessTilde:"≲",Lfr:"𝔏",Ll:"⋘",Lleftarrow:"⇚",Lmidot:"Ŀ",LongLeftArrow:"⟵",LongLeftRightArrow:"⟷",LongRightArrow:"⟶",Longleftarrow:"⟸",Longleftrightarrow:"⟺",Longrightarrow:"⟹",Lopf:"𝕃",LowerLeftArrow:"↙",LowerRightArrow:"↘",Lscr:"ℒ",Lsh:"↰",Lstrok:"Ł",Lt:"≪",Map:"⤅",Mcy:"М",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",MinusPlus:"∓",Mopf:"𝕄",Mscr:"ℳ",Mu:"Μ",NJcy:"Њ",Nacute:"Ń",Ncaron:"Ň",Ncedil:"Ņ",Ncy:"Н",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,Nfr:"𝔑",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",Not:"⫬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",Nscr:"𝒩",Ntilde:"Ñ",Nu:"Ν",OElig:"Œ",Oacute:"Ó",Ocirc:"Ô",Ocy:"О",Odblac:"Ő",Ofr:"𝔒",Ograve:"Ò",Omacr:"Ō",Omega:"Ω",Omicron:"Ο",Oopf:"𝕆",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",Or:"⩔",Oscr:"𝒪",Oslash:"Ø",Otilde:"Õ",Otimes:"⨷",Ouml:"Ö",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",PartialD:"∂",Pcy:"П",Pfr:"𝔓",Phi:"Φ",Pi:"Π",PlusMinus:"±",Poincareplane:"ℌ",Popf:"ℙ",Pr:"⪻",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",Prime:"″",Product:"∏",Proportion:"∷",Proportional:"∝",Pscr:"𝒫",Psi:"Ψ",QUOT:'"',Qfr:"𝔔",Qopf:"ℚ",Qscr:"𝒬",RBarr:"⤐",REG:"®",Racute:"Ŕ",Rang:"⟫",Rarr:"↠",Rarrtl:"⤖",Rcaron:"Ř",Rcedil:"Ŗ",Rcy:"Р",Re:"ℜ",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",Rfr:"ℜ",Rho:"Ρ",RightAngleBracket:"⟩",RightArrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",Rightarrow:"⇒",Ropf:"ℝ",RoundImplies:"⥰",Rrightarrow:"⇛",Rscr:"ℛ",Rsh:"↱",RuleDelayed:"⧴",SHCHcy:"Щ",SHcy:"Ш",SOFTcy:"Ь",Sacute:"Ś",Sc:"⪼",Scaron:"Š",Scedil:"Ş",Scirc:"Ŝ",Scy:"С",Sfr:"𝔖",ShortDownArrow:"↓",ShortLeftArrow:"←",ShortRightArrow:"→",ShortUpArrow:"↑",Sigma:"Σ",SmallCircle:"∘",Sopf:"𝕊",Sqrt:"√",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",Sscr:"𝒮",Star:"⋆",Sub:"⋐",Subset:"⋐",SubsetEqual:"⊆",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",SuchThat:"∋",Sum:"∑",Sup:"⋑",Superset:"⊃",SupersetEqual:"⊇",Supset:"⋑",THORN:"Þ",TRADE:"™",TSHcy:"Ћ",TScy:"Ц",Tab:"	",Tau:"Τ",Tcaron:"Ť",Tcedil:"Ţ",Tcy:"Т",Tfr:"𝔗",Therefore:"∴",Theta:"Θ",ThickSpace:"  ",ThinSpace:" ",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",Topf:"𝕋",TripleDot:"⃛",Tscr:"𝒯",Tstrok:"Ŧ",Uacute:"Ú",Uarr:"↟",Uarrocir:"⥉",Ubrcy:"Ў",Ubreve:"Ŭ",Ucirc:"Û",Ucy:"У",Udblac:"Ű",Ufr:"𝔘",Ugrave:"Ù",Umacr:"Ū",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",Uopf:"𝕌",UpArrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",UpEquilibrium:"⥮",UpTee:"⊥",UpTeeArrow:"↥",Uparrow:"⇑",Updownarrow:"⇕",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",Upsilon:"Υ",Uring:"Ů",Uscr:"𝒰",Utilde:"Ũ",Uuml:"Ü",VDash:"⊫",Vbar:"⫫",Vcy:"В",Vdash:"⊩",Vdashl:"⫦",Vee:"⋁",Verbar:"‖",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",Vopf:"𝕍",Vscr:"𝒱",Vvdash:"⊪",Wcirc:"Ŵ",Wedge:"⋀",Wfr:"𝔚",Wopf:"𝕎",Wscr:"𝒲",Xfr:"𝔛",Xi:"Ξ",Xopf:"𝕏",Xscr:"𝒳",YAcy:"Я",YIcy:"Ї",YUcy:"Ю",Yacute:"Ý",Ycirc:"Ŷ",Ycy:"Ы",Yfr:"𝔜",Yopf:"𝕐",Yscr:"𝒴",Yuml:"Ÿ",ZHcy:"Ж",Zacute:"Ź",Zcaron:"Ž",Zcy:"З",Zdot:"Ż",ZeroWidthSpace:"​",Zeta:"Ζ",Zfr:"ℨ",Zopf:"ℤ",Zscr:"𝒵",aacute:"á",abreve:"ă",ac:"∾",acE:"∾̳",acd:"∿",acirc:"â",acute:"´",acy:"а",aelig:"æ",af:"⁡",afr:"𝔞",agrave:"à",alefsym:"ℵ",aleph:"ℵ",alpha:"α",amacr:"ā",amalg:"⨿",amp:"&",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",aogon:"ą",aopf:"𝕒",ap:"≈",apE:"⩰",apacir:"⩯",ape:"≊",apid:"≋",apos:"'",approx:"≈",approxeq:"≊",aring:"å",ascr:"𝒶",ast:"*",asymp:"≈",asympeq:"≍",atilde:"ã",auml:"ä",awconint:"∳",awint:"⨑",bNot:"⫭",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",barvee:"⊽",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",bcy:"б",bdquo:"„",becaus:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",beta:"β",beth:"ℶ",between:"≬",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bnot:"⌐",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxDL:"╗",boxDR:"╔",boxDl:"╖",boxDr:"╓",boxH:"═",boxHD:"╦",boxHU:"╩",boxHd:"╤",boxHu:"╧",boxUL:"╝",boxUR:"╚",boxUl:"╜",boxUr:"╙",boxV:"║",boxVH:"╬",boxVL:"╣",boxVR:"╠",boxVh:"╫",boxVl:"╢",boxVr:"╟",boxbox:"⧉",boxdL:"╕",boxdR:"╒",boxdl:"┐",boxdr:"┌",boxh:"─",boxhD:"╥",boxhU:"╨",boxhd:"┬",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxuL:"╛",boxuR:"╘",boxul:"┘",boxur:"└",boxv:"│",boxvH:"╪",boxvL:"╡",boxvR:"╞",boxvh:"┼",boxvl:"┤",boxvr:"├",bprime:"‵",breve:"˘",brvbar:"¦",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",bumpeq:"≏",cacute:"ć",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",caps:"∩︀",caret:"⁁",caron:"ˇ",ccaps:"⩍",ccaron:"č",ccedil:"ç",ccirc:"ĉ",ccups:"⩌",ccupssm:"⩐",cdot:"ċ",cedil:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",cfr:"𝔠",chcy:"ч",check:"✓",checkmark:"✓",chi:"χ",cir:"○",cirE:"⧃",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledR:"®",circledS:"Ⓢ",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",clubs:"♣",clubsuit:"♣",colon:":",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",conint:"∮",copf:"𝕔",coprod:"∐",copy:"©",copysr:"℗",crarr:"↵",cross:"✗",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cup:"∪",cupbrcap:"⩈",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dArr:"⇓",dHar:"⥥",dagger:"†",daleth:"ℸ",darr:"↓",dash:"‐",dashv:"⊣",dbkarow:"⤏",dblac:"˝",dcaron:"ď",dcy:"д",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",ddotseq:"⩷",deg:"°",delta:"δ",demptyv:"⦱",dfisht:"⥿",dfr:"𝔡",dharl:"⇃",dharr:"⇂",diam:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",dopf:"𝕕",dot:"˙",doteq:"≐",doteqdot:"≑",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",downarrow:"↓",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",dscr:"𝒹",dscy:"ѕ",dsol:"⧶",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",dzcy:"џ",dzigrarr:"⟿",eDDot:"⩷",eDot:"≑",eacute:"é",easter:"⩮",ecaron:"ě",ecir:"≖",ecirc:"ê",ecolon:"≕",ecy:"э",edot:"ė",ee:"ⅇ",efDot:"≒",efr:"𝔢",eg:"⪚",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",emacr:"ē",empty:"∅",emptyset:"∅",emptyv:"∅",emsp13:" ",emsp14:" ",emsp:" ",eng:"ŋ",ensp:" ",eogon:"ę",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",equals:"=",equest:"≟",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erDot:"≓",erarr:"⥱",escr:"ℯ",esdot:"≐",esim:"≂",eta:"η",eth:"ð",euml:"ë",euro:"€",excl:"!",exist:"∃",expectation:"ℰ",exponentiale:"ⅇ",fallingdotseq:"≒",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",ffr:"𝔣",filig:"ﬁ",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",fopf:"𝕗",forall:"∀",fork:"⋔",forkv:"⫙",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",gE:"≧",gEl:"⪌",gacute:"ǵ",gamma:"γ",gammad:"ϝ",gap:"⪆",gbreve:"ğ",gcirc:"ĝ",gcy:"г",gdot:"ġ",ge:"≥",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",gfr:"𝔤",gg:"≫",ggg:"⋙",gimel:"ℷ",gjcy:"ѓ",gl:"≷",glE:"⪒",gla:"⪥",glj:"⪤",gnE:"≩",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",gopf:"𝕘",grave:"`",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",hArr:"⇔",hairsp:" ",half:"½",hamilt:"ℋ",hardcy:"ъ",harr:"↔",harrcir:"⥈",harrw:"↭",hbar:"ℏ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",horbar:"―",hscr:"𝒽",hslash:"ℏ",hstrok:"ħ",hybull:"⁃",hyphen:"‐",iacute:"í",ic:"⁣",icirc:"î",icy:"и",iecy:"е",iexcl:"¡",iff:"⇔",ifr:"𝔦",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",ijlig:"ĳ",imacr:"ī",image:"ℑ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",int:"∫",intcal:"⊺",integers:"ℤ",intercal:"⊺",intlarhk:"⨗",intprod:"⨼",iocy:"ё",iogon:"į",iopf:"𝕚",iota:"ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",isin:"∈",isinE:"⋹",isindot:"⋵",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",itilde:"ĩ",iukcy:"і",iuml:"ï",jcirc:"ĵ",jcy:"й",jfr:"𝔧",jmath:"ȷ",jopf:"𝕛",jscr:"𝒿",jsercy:"ј",jukcy:"є",kappa:"κ",kappav:"ϰ",kcedil:"ķ",kcy:"к",kfr:"𝔨",kgreen:"ĸ",khcy:"х",kjcy:"ќ",kopf:"𝕜",kscr:"𝓀",lAarr:"⇚",lArr:"⇐",lAtail:"⤛",lBarr:"⤎",lE:"≦",lEg:"⪋",lHar:"⥢",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",lambda:"λ",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",laquo:"«",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",latail:"⤙",late:"⪭",lates:"⪭︀",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",lcaron:"ľ",lcedil:"ļ",lceil:"⌈",lcub:"{",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",leftarrow:"←",leftarrowtail:"↢",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",leftthreetimes:"⋋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",lessgtr:"≶",lesssim:"≲",lfisht:"⥼",lfloor:"⌊",lfr:"𝔩",lg:"≶",lgE:"⪑",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",ljcy:"љ",ll:"≪",llarr:"⇇",llcorner:"⌞",llhard:"⥫",lltri:"◺",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnE:"≨",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",longleftrightarrow:"⟷",longmapsto:"⟼",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",lstrok:"ł",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltrPar:"⦖",ltri:"◃",ltrie:"⊴",ltrif:"◂",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",mDDot:"∺",macr:"¯",male:"♂",malt:"✠",maltese:"✠",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",mcy:"м",mdash:"—",measuredangle:"∡",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",mopf:"𝕞",mp:"∓",mscr:"𝓂",mstpos:"∾",mu:"μ",multimap:"⊸",mumap:"⊸",nGg:"⋙̸",nGt:"≫⃒",nGtv:"≫̸",nLeftarrow:"⇍",nLeftrightarrow:"⇎",nLl:"⋘̸",nLt:"≪⃒",nLtv:"≪̸",nRightarrow:"⇏",nVDash:"⊯",nVdash:"⊮",nabla:"∇",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",ncaron:"ň",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",ncy:"н",ndash:"–",ne:"≠",neArr:"⇗",nearhk:"⤤",nearr:"↗",nearrow:"↗",nedot:"≐̸",nequiv:"≢",nesear:"⤨",nesim:"≂̸",nexist:"∄",nexists:"∄",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",ngsim:"≵",ngt:"≯",ngtr:"≯",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",njcy:"њ",nlArr:"⇍",nlE:"≦̸",nlarr:"↚",nldr:"‥",nle:"≰",nleftarrow:"↚",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nlsim:"≴",nlt:"≮",nltri:"⋪",nltrie:"⋬",nmid:"∤",nopf:"𝕟",not:"¬",notin:"∉",notinE:"⋹̸",notindot:"⋵̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",nu:"ν",num:"#",numero:"№",numsp:" ",nvDash:"⊭",nvHarr:"⤄",nvap:"≍⃒",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwArr:"⇖",nwarhk:"⤣",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",oS:"Ⓢ",oacute:"ó",oast:"⊛",ocir:"⊚",ocirc:"ô",ocy:"о",odash:"⊝",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",oelig:"œ",ofcir:"⦿",ofr:"𝔬",ogon:"˛",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",omacr:"ō",omega:"ω",omicron:"ο",omid:"⦶",ominus:"⊖",oopf:"𝕠",opar:"⦷",operp:"⦹",oplus:"⊕",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oscr:"ℴ",oslash:"ø",osol:"⊘",otilde:"õ",otimes:"⊗",otimesas:"⨶",ouml:"ö",ovbar:"⌽",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",pfr:"𝔭",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",pointint:"⨕",popf:"𝕡",pound:"£",pr:"≺",prE:"⪳",prap:"⪷",prcue:"≼",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",prime:"′",primes:"ℙ",prnE:"⪵",prnap:"⪹",prnsim:"⋨",prod:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",propto:"∝",prsim:"≾",prurel:"⊰",pscr:"𝓅",psi:"ψ",puncsp:" ",qfr:"𝔮",qint:"⨌",qopf:"𝕢",qprime:"⁗",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',rAarr:"⇛",rArr:"⇒",rAtail:"⤜",rBarr:"⤏",rHar:"⥤",race:"∽̱",racute:"ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",rarrtl:"↣",rarrw:"↝",ratail:"⤚",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",rcaron:"ř",rcedil:"ŗ",rceil:"⌉",rcub:"}",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",reg:"®",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",rhard:"⇁",rharu:"⇀",rharul:"⥬",rho:"ρ",rhov:"ϱ",rightarrow:"→",rightarrowtail:"↣",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",rightthreetimes:"⋌",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",rsaquo:"›",rscr:"𝓇",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",ruluhar:"⥨",rx:"℞",sacute:"ś",sbquo:"‚",sc:"≻",scE:"⪴",scap:"⪸",scaron:"š",sccue:"≽",sce:"⪰",scedil:"ş",scirc:"ŝ",scnE:"⪶",scnap:"⪺",scnsim:"⋩",scpolint:"⨓",scsim:"≿",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",seArr:"⇘",searhk:"⤥",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",sfr:"𝔰",sfrown:"⌢",sharp:"♯",shchcy:"щ",shcy:"ш",shortmid:"∣",shortparallel:"∥",shy:"­",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",square:"□",squarf:"▪",squf:"▪",srarr:"→",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",subE:"⫅",subdot:"⪽",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",sum:"∑",sung:"♪",sup1:"¹",sup2:"²",sup3:"³",sup:"⊃",supE:"⫆",supdot:"⪾",supdsub:"⫘",supe:"⊇",supedot:"⫄",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swArr:"⇙",swarhk:"⤦",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",target:"⌖",tau:"τ",tbrk:"⎴",tcaron:"ť",tcedil:"ţ",tcy:"т",tdot:"⃛",telrec:"⌕",tfr:"𝔱",there4:"∴",therefore:"∴",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",thinsp:" ",thkap:"≈",thksim:"∼",thorn:"þ",tilde:"˜",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",tscr:"𝓉",tscy:"ц",tshcy:"ћ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",uArr:"⇑",uHar:"⥣",uacute:"ú",uarr:"↑",ubrcy:"ў",ubreve:"ŭ",ucirc:"û",ucy:"у",udarr:"⇅",udblac:"ű",udhar:"⥮",ufisht:"⥾",ufr:"𝔲",ugrave:"ù",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",umacr:"ū",uml:"¨",uogon:"ų",uopf:"𝕦",uparrow:"↑",updownarrow:"↕",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",upsi:"υ",upsih:"ϒ",upsilon:"υ",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",uring:"ů",urtri:"◹",uscr:"𝓊",utdot:"⋰",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",uuml:"ü",uwangle:"⦧",vArr:"⇕",vBar:"⫨",vBarv:"⫩",vDash:"⊨",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vcy:"в",vdash:"⊢",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",verbar:"|",vert:"|",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",vopf:"𝕧",vprop:"∝",vrtri:"⊳",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",vzigzag:"⦚",wcirc:"ŵ",wedbar:"⩟",wedge:"∧",wedgeq:"≙",weierp:"℘",wfr:"𝔴",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",yacute:"ý",yacy:"я",ycirc:"ŷ",ycy:"ы",yen:"¥",yfr:"𝔶",yicy:"ї",yopf:"𝕪",yscr:"𝓎",yucy:"ю",yuml:"ÿ",zacute:"ź",zcaron:"ž",zcy:"з",zdot:"ż",zeetrf:"ℨ",zeta:"ζ",zfr:"𝔷",zhcy:"ж",zigrarr:"⇝",zopf:"𝕫",zscr:"𝓏",zwj:"‍",zwnj:"‌"},_O={}.hasOwnProperty;function qx(i){return _O.call(sE,i)?sE[i]:!1}function la(i,n,a,c){const f=i.length;let y=0,e;if(n<0?n=-n>f?0:f+n:n=n>f?f:n,a=a>0?a:0,c.length<1e4)e=Array.from(c),e.unshift(n,a),i.splice(...e);else for(a&&i.splice(n,a);y<c.length;)e=c.slice(y,y+1e4),e.unshift(n,0),i.splice(...e),y+=1e4,n+=1e4}function oo(i,n){return i.length>0?(la(i,i.length,0,n),i):n}var oE={}.hasOwnProperty;function bO(i){const n={};let a=-1;for(;++a<i.length;)vO(n,i[a]);return n}function vO(i,n){let a;for(a in n){const f=(oE.call(i,a)?i[a]:void 0)||(i[a]={}),y=n[a];let e;if(y)for(e in y){oE.call(f,e)||(f[e]=[]);const l=y[e];xO(f[e],Array.isArray(l)?l:l?[l]:[])}}}function xO(i,n){let a=-1;const c=[];for(;++a<n.length;)(n[a].add==="after"?i:c).push(n[a]);la(i,0,0,c)}function mD(i,n){const a=Number.parseInt(i,n);return a<9||a===11||a>13&&a<32||a>126&&a<160||a>55295&&a<57344||a>64975&&a<65008||(a&65535)===65535||(a&65535)===65534||a>1114111?"�":String.fromCodePoint(a)}function Op(i){return i.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}var na=Wl(/[A-Za-z]/),Gs=Wl(/[\dA-Za-z]/),wO=Wl(/[#-'*+\--9=?A-Z^-~]/);function fx(i){return i!==null&&(i<32||i===127)}var hx=Wl(/\d/),EO=Wl(/[\dA-Fa-f]/),AO=Wl(/[!-/:-@[-`{-~]/);function br(i){return i!==null&&i<-2}function As(i){return i!==null&&(i<0||i===32)}function oi(i){return i===-2||i===-1||i===32}var RO=Wl(new RegExp("\\p{P}|\\p{S}","u")),SO=Wl(/\s/);function Wl(i){return n;function n(a){return a!==null&&a>-1&&i.test(String.fromCharCode(a))}}function $p(i){const n=[];let a=-1,c=0,f=0;for(;++a<i.length;){const y=i.charCodeAt(a);let e="";if(y===37&&Gs(i.charCodeAt(a+1))&&Gs(i.charCodeAt(a+2)))f=2;else if(y<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(y))||(e=String.fromCharCode(y));else if(y>55295&&y<57344){const l=i.charCodeAt(a+1);y<56320&&l>56319&&l<57344?(e=String.fromCharCode(y,l),f=1):e="�"}else e=String.fromCharCode(y);e&&(n.push(i.slice(c,a),encodeURIComponent(e)),c=a+f+1,e=""),f&&(a+=f,f=0)}return n.join("")+i.slice(c)}function Ei(i,n,a,c){const f=c?c-1:Number.POSITIVE_INFINITY;let y=0;return e;function e(_){return oi(_)?(i.enter(a),l(_)):n(_)}function l(_){return oi(_)&&y++<f?(i.consume(_),l):(i.exit(a),n(_))}}var TO={tokenize:CO};function CO(i){const n=i.attempt(this.parser.constructs.contentInitial,c,f);let a;return n;function c(l){if(l===null){i.consume(l);return}return i.enter("lineEnding"),i.consume(l),i.exit("lineEnding"),Ei(i,n,"linePrefix")}function f(l){return i.enter("paragraph"),y(l)}function y(l){const _=i.enter("chunkText",{contentType:"text",previous:a});return a&&(a.next=_),a=_,e(l)}function e(l){if(l===null){i.exit("chunkText"),i.exit("paragraph"),i.consume(l);return}return br(l)?(i.consume(l),i.exit("chunkText"),y):(i.consume(l),e)}}var kO={tokenize:PO},aE={tokenize:LO};function PO(i){const n=this,a=[];let c=0,f,y,e;return l;function l(he){if(c<a.length){const Q=a[c];return n.containerState=Q[1],i.attempt(Q[0].continuation,_,w)(he)}return w(he)}function _(he){if(c++,n.containerState._closeFlow){n.containerState._closeFlow=void 0,f&&ne();const Q=n.events.length;let Be=Q,we;for(;Be--;)if(n.events[Be][0]==="exit"&&n.events[Be][1].type==="chunkFlow"){we=n.events[Be][1].end;break}j(c);let ze=Q;for(;ze<n.events.length;)n.events[ze][1].end={...we},ze++;return la(n.events,Be+1,0,n.events.slice(Q)),n.events.length=ze,w(he)}return l(he)}function w(he){if(c===a.length){if(!f)return I(he);if(f.currentConstruct&&f.currentConstruct.concrete)return O(he);n.interrupt=!!(f.currentConstruct&&!f._gfmTableDynamicInterruptHack)}return n.containerState={},i.check(aE,R,C)(he)}function R(he){return f&&ne(),j(c),I(he)}function C(he){return n.parser.lazy[n.now().line]=c!==a.length,e=n.now().offset,O(he)}function I(he){return n.containerState={},i.attempt(aE,L,O)(he)}function L(he){return c++,a.push([n.currentConstruct,n.containerState]),I(he)}function O(he){if(he===null){f&&ne(),j(0),i.consume(he);return}return f=f||n.parser.flow(n.now()),i.enter("chunkFlow",{_tokenizer:f,contentType:"flow",previous:y}),q(he)}function q(he){if(he===null){G(i.exit("chunkFlow"),!0),j(0),i.consume(he);return}return br(he)?(i.consume(he),G(i.exit("chunkFlow")),c=0,n.interrupt=void 0,l):(i.consume(he),q)}function G(he,Q){const Be=n.sliceStream(he);if(Q&&Be.push(null),he.previous=y,y&&(y.next=he),y=he,f.defineSkip(he.start),f.write(Be),n.parser.lazy[he.start.line]){let we=f.events.length;for(;we--;)if(f.events[we][1].start.offset<e&&(!f.events[we][1].end||f.events[we][1].end.offset>e))return;const ze=n.events.length;let et=ze,gt,st;for(;et--;)if(n.events[et][0]==="exit"&&n.events[et][1].type==="chunkFlow"){if(gt){st=n.events[et][1].end;break}gt=!0}for(j(c),we=ze;we<n.events.length;)n.events[we][1].end={...st},we++;la(n.events,et+1,0,n.events.slice(ze)),n.events.length=we}}function j(he){let Q=a.length;for(;Q-- >he;){const Be=a[Q];n.containerState=Be[1],Be[0].exit.call(n,i)}a.length=he}function ne(){f.write([null]),y=void 0,f=void 0,n.containerState._closeFlow=void 0}}function LO(i,n,a){return Ei(i,i.attempt(this.parser.constructs.document,n,a),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function lE(i){if(i===null||As(i)||SO(i))return 1;if(RO(i))return 2}function Kx(i,n,a){const c=[];let f=-1;for(;++f<i.length;){const y=i[f].resolveAll;y&&!c.includes(y)&&(n=y(n,a),c.push(y))}return n}var mx={name:"attention",resolveAll:DO,tokenize:IO};function DO(i,n){let a=-1,c,f,y,e,l,_,w,R;for(;++a<i.length;)if(i[a][0]==="enter"&&i[a][1].type==="attentionSequence"&&i[a][1]._close){for(c=a;c--;)if(i[c][0]==="exit"&&i[c][1].type==="attentionSequence"&&i[c][1]._open&&n.sliceSerialize(i[c][1]).charCodeAt(0)===n.sliceSerialize(i[a][1]).charCodeAt(0)){if((i[c][1]._close||i[a][1]._open)&&(i[a][1].end.offset-i[a][1].start.offset)%3&&!((i[c][1].end.offset-i[c][1].start.offset+i[a][1].end.offset-i[a][1].start.offset)%3))continue;_=i[c][1].end.offset-i[c][1].start.offset>1&&i[a][1].end.offset-i[a][1].start.offset>1?2:1;const C={...i[c][1].end},I={...i[a][1].start};uE(C,-_),uE(I,_),e={type:_>1?"strongSequence":"emphasisSequence",start:C,end:{...i[c][1].end}},l={type:_>1?"strongSequence":"emphasisSequence",start:{...i[a][1].start},end:I},y={type:_>1?"strongText":"emphasisText",start:{...i[c][1].end},end:{...i[a][1].start}},f={type:_>1?"strong":"emphasis",start:{...e.start},end:{...l.end}},i[c][1].end={...e.start},i[a][1].start={...l.end},w=[],i[c][1].end.offset-i[c][1].start.offset&&(w=oo(w,[["enter",i[c][1],n],["exit",i[c][1],n]])),w=oo(w,[["enter",f,n],["enter",e,n],["exit",e,n],["enter",y,n]]),w=oo(w,Kx(n.parser.constructs.insideSpan.null,i.slice(c+1,a),n)),w=oo(w,[["exit",y,n],["enter",l,n],["exit",l,n],["exit",f,n]]),i[a][1].end.offset-i[a][1].start.offset?(R=2,w=oo(w,[["enter",i[a][1],n],["exit",i[a][1],n]])):R=0,la(i,c-1,a-c+3,w),a=c+w.length-R-2;break}}for(a=-1;++a<i.length;)i[a][1].type==="attentionSequence"&&(i[a][1].type="data");return i}function IO(i,n){const a=this.parser.constructs.attentionMarkers.null,c=this.previous,f=lE(c);let y;return e;function e(_){return y=_,i.enter("attentionSequence"),l(_)}function l(_){if(_===y)return i.consume(_),l;const w=i.exit("attentionSequence"),R=lE(_),C=!R||R===2&&f||a.includes(_),I=!f||f===2&&R||a.includes(c);return w._open=!!(y===42?C:C&&(f||!I)),w._close=!!(y===42?I:I&&(R||!C)),n(_)}}function uE(i,n){i.column+=n,i.offset+=n,i._bufferIndex+=n}var BO={name:"autolink",tokenize:MO};function MO(i,n,a){let c=0;return f;function f(L){return i.enter("autolink"),i.enter("autolinkMarker"),i.consume(L),i.exit("autolinkMarker"),i.enter("autolinkProtocol"),y}function y(L){return na(L)?(i.consume(L),e):L===64?a(L):w(L)}function e(L){return L===43||L===45||L===46||Gs(L)?(c=1,l(L)):w(L)}function l(L){return L===58?(i.consume(L),c=0,_):(L===43||L===45||L===46||Gs(L))&&c++<32?(i.consume(L),l):(c=0,w(L))}function _(L){return L===62?(i.exit("autolinkProtocol"),i.enter("autolinkMarker"),i.consume(L),i.exit("autolinkMarker"),i.exit("autolink"),n):L===null||L===32||L===60||fx(L)?a(L):(i.consume(L),_)}function w(L){return L===64?(i.consume(L),R):wO(L)?(i.consume(L),w):a(L)}function R(L){return Gs(L)?C(L):a(L)}function C(L){return L===46?(i.consume(L),c=0,R):L===62?(i.exit("autolinkProtocol").type="autolinkEmail",i.enter("autolinkMarker"),i.consume(L),i.exit("autolinkMarker"),i.exit("autolink"),n):I(L)}function I(L){if((L===45||Gs(L))&&c++<63){const O=L===45?I:C;return i.consume(L),O}return a(L)}}var rv={partial:!0,tokenize:zO};function zO(i,n,a){return c;function c(y){return oi(y)?Ei(i,f,"linePrefix")(y):f(y)}function f(y){return y===null||br(y)?n(y):a(y)}}var yD={continuation:{tokenize:VO},exit:UO,name:"blockQuote",tokenize:OO};function OO(i,n,a){const c=this;return f;function f(e){if(e===62){const l=c.containerState;return l.open||(i.enter("blockQuote",{_container:!0}),l.open=!0),i.enter("blockQuotePrefix"),i.enter("blockQuoteMarker"),i.consume(e),i.exit("blockQuoteMarker"),y}return a(e)}function y(e){return oi(e)?(i.enter("blockQuotePrefixWhitespace"),i.consume(e),i.exit("blockQuotePrefixWhitespace"),i.exit("blockQuotePrefix"),n):(i.exit("blockQuotePrefix"),n(e))}}function VO(i,n,a){const c=this;return f;function f(e){return oi(e)?Ei(i,y,"linePrefix",c.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(e):y(e)}function y(e){return i.attempt(yD,n,a)(e)}}function UO(i){i.exit("blockQuote")}var gD={name:"characterEscape",tokenize:jO};function jO(i,n,a){return c;function c(y){return i.enter("characterEscape"),i.enter("escapeMarker"),i.consume(y),i.exit("escapeMarker"),f}function f(y){return AO(y)?(i.enter("characterEscapeValue"),i.consume(y),i.exit("characterEscapeValue"),i.exit("characterEscape"),n):a(y)}}var _D={name:"characterReference",tokenize:NO};function NO(i,n,a){const c=this;let f=0,y,e;return l;function l(C){return i.enter("characterReference"),i.enter("characterReferenceMarker"),i.consume(C),i.exit("characterReferenceMarker"),_}function _(C){return C===35?(i.enter("characterReferenceMarkerNumeric"),i.consume(C),i.exit("characterReferenceMarkerNumeric"),w):(i.enter("characterReferenceValue"),y=31,e=Gs,R(C))}function w(C){return C===88||C===120?(i.enter("characterReferenceMarkerHexadecimal"),i.consume(C),i.exit("characterReferenceMarkerHexadecimal"),i.enter("characterReferenceValue"),y=6,e=EO,R):(i.enter("characterReferenceValue"),y=7,e=hx,R(C))}function R(C){if(C===59&&f){const I=i.exit("characterReferenceValue");return e===Gs&&!qx(c.sliceSerialize(I))?a(C):(i.enter("characterReferenceMarker"),i.consume(C),i.exit("characterReferenceMarker"),i.exit("characterReference"),n)}return e(C)&&f++<y?(i.consume(C),R):a(C)}}var cE={partial:!0,tokenize:qO},dE={concrete:!0,name:"codeFenced",tokenize:FO};function FO(i,n,a){const c=this,f={partial:!0,tokenize:Be};let y=0,e=0,l;return _;function _(we){return w(we)}function w(we){const ze=c.events[c.events.length-1];return y=ze&&ze[1].type==="linePrefix"?ze[2].sliceSerialize(ze[1],!0).length:0,l=we,i.enter("codeFenced"),i.enter("codeFencedFence"),i.enter("codeFencedFenceSequence"),R(we)}function R(we){return we===l?(e++,i.consume(we),R):e<3?a(we):(i.exit("codeFencedFenceSequence"),oi(we)?Ei(i,C,"whitespace")(we):C(we))}function C(we){return we===null||br(we)?(i.exit("codeFencedFence"),c.interrupt?n(we):i.check(cE,q,Q)(we)):(i.enter("codeFencedFenceInfo"),i.enter("chunkString",{contentType:"string"}),I(we))}function I(we){return we===null||br(we)?(i.exit("chunkString"),i.exit("codeFencedFenceInfo"),C(we)):oi(we)?(i.exit("chunkString"),i.exit("codeFencedFenceInfo"),Ei(i,L,"whitespace")(we)):we===96&&we===l?a(we):(i.consume(we),I)}function L(we){return we===null||br(we)?C(we):(i.enter("codeFencedFenceMeta"),i.enter("chunkString",{contentType:"string"}),O(we))}function O(we){return we===null||br(we)?(i.exit("chunkString"),i.exit("codeFencedFenceMeta"),C(we)):we===96&&we===l?a(we):(i.consume(we),O)}function q(we){return i.attempt(f,Q,G)(we)}function G(we){return i.enter("lineEnding"),i.consume(we),i.exit("lineEnding"),j}function j(we){return y>0&&oi(we)?Ei(i,ne,"linePrefix",y+1)(we):ne(we)}function ne(we){return we===null||br(we)?i.check(cE,q,Q)(we):(i.enter("codeFlowValue"),he(we))}function he(we){return we===null||br(we)?(i.exit("codeFlowValue"),ne(we)):(i.consume(we),he)}function Q(we){return i.exit("codeFenced"),n(we)}function Be(we,ze,et){let gt=0;return st;function st(de){return we.enter("lineEnding"),we.consume(de),we.exit("lineEnding"),nt}function nt(de){return we.enter("codeFencedFence"),oi(de)?Ei(we,rt,"linePrefix",c.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(de):rt(de)}function rt(de){return de===l?(we.enter("codeFencedFenceSequence"),ee(de)):et(de)}function ee(de){return de===l?(gt++,we.consume(de),ee):gt>=e?(we.exit("codeFencedFenceSequence"),oi(de)?Ei(we,Le,"whitespace")(de):Le(de)):et(de)}function Le(de){return de===null||br(de)?(we.exit("codeFencedFence"),ze(de)):et(de)}}}function qO(i,n,a){const c=this;return f;function f(e){return e===null?a(e):(i.enter("lineEnding"),i.consume(e),i.exit("lineEnding"),y)}function y(e){return c.parser.lazy[c.now().line]?a(e):n(e)}}var x0={name:"codeIndented",tokenize:GO},KO={partial:!0,tokenize:$O};function GO(i,n,a){const c=this;return f;function f(w){return i.enter("codeIndented"),Ei(i,y,"linePrefix",5)(w)}function y(w){const R=c.events[c.events.length-1];return R&&R[1].type==="linePrefix"&&R[2].sliceSerialize(R[1],!0).length>=4?e(w):a(w)}function e(w){return w===null?_(w):br(w)?i.attempt(KO,e,_)(w):(i.enter("codeFlowValue"),l(w))}function l(w){return w===null||br(w)?(i.exit("codeFlowValue"),e(w)):(i.consume(w),l)}function _(w){return i.exit("codeIndented"),n(w)}}function $O(i,n,a){const c=this;return f;function f(e){return c.parser.lazy[c.now().line]?a(e):br(e)?(i.enter("lineEnding"),i.consume(e),i.exit("lineEnding"),f):Ei(i,y,"linePrefix",5)(e)}function y(e){const l=c.events[c.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?n(e):br(e)?f(e):a(e)}}var ZO={name:"codeText",previous:XO,resolve:HO,tokenize:WO};function HO(i){let n=i.length-4,a=3,c,f;if((i[a][1].type==="lineEnding"||i[a][1].type==="space")&&(i[n][1].type==="lineEnding"||i[n][1].type==="space")){for(c=a;++c<n;)if(i[c][1].type==="codeTextData"){i[a][1].type="codeTextPadding",i[n][1].type="codeTextPadding",a+=2,n-=2;break}}for(c=a-1,n++;++c<=n;)f===void 0?c!==n&&i[c][1].type!=="lineEnding"&&(f=c):(c===n||i[c][1].type==="lineEnding")&&(i[f][1].type="codeTextData",c!==f+2&&(i[f][1].end=i[c-1][1].end,i.splice(f+2,c-f-2),n-=c-f-2,c=f+2),f=void 0);return i}function XO(i){return i!==96||this.events[this.events.length-1][1].type==="characterEscape"}function WO(i,n,a){let c=0,f,y;return e;function e(C){return i.enter("codeText"),i.enter("codeTextSequence"),l(C)}function l(C){return C===96?(i.consume(C),c++,l):(i.exit("codeTextSequence"),_(C))}function _(C){return C===null?a(C):C===32?(i.enter("space"),i.consume(C),i.exit("space"),_):C===96?(y=i.enter("codeTextSequence"),f=0,R(C)):br(C)?(i.enter("lineEnding"),i.consume(C),i.exit("lineEnding"),_):(i.enter("codeTextData"),w(C))}function w(C){return C===null||C===32||C===96||br(C)?(i.exit("codeTextData"),_(C)):(i.consume(C),w)}function R(C){return C===96?(i.consume(C),f++,R):f===c?(i.exit("codeTextSequence"),i.exit("codeText"),n(C)):(y.type="codeTextData",w(C))}}var YO=class{constructor(i){this.left=i?[...i]:[],this.right=[]}get(i){if(i<0||i>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+i+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return i<this.left.length?this.left[i]:this.right[this.right.length-i+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(i,n){const a=n??Number.POSITIVE_INFINITY;return a<this.left.length?this.left.slice(i,a):i>this.left.length?this.right.slice(this.right.length-a+this.left.length,this.right.length-i+this.left.length).reverse():this.left.slice(i).concat(this.right.slice(this.right.length-a+this.left.length).reverse())}splice(i,n,a){const c=n||0;this.setCursor(Math.trunc(i));const f=this.right.splice(this.right.length-c,Number.POSITIVE_INFINITY);return a&&nh(this.left,a),f.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(i){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(i)}pushMany(i){this.setCursor(Number.POSITIVE_INFINITY),nh(this.left,i)}unshift(i){this.setCursor(0),this.right.push(i)}unshiftMany(i){this.setCursor(0),nh(this.right,i.reverse())}setCursor(i){if(!(i===this.left.length||i>this.left.length&&this.right.length===0||i<0&&this.left.length===0))if(i<this.left.length){const n=this.left.splice(i,Number.POSITIVE_INFINITY);nh(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-i,Number.POSITIVE_INFINITY);nh(this.left,n.reverse())}}};function nh(i,n){let a=0;if(n.length<1e4)i.push(...n);else for(;a<n.length;)i.push(...n.slice(a,a+1e4)),a+=1e4}function bD(i){const n={};let a=-1,c,f,y,e,l,_,w;const R=new YO(i);for(;++a<R.length;){for(;a in n;)a=n[a];if(c=R.get(a),a&&c[1].type==="chunkFlow"&&R.get(a-1)[1].type==="listItemPrefix"&&(_=c[1]._tokenizer.events,y=0,y<_.length&&_[y][1].type==="lineEndingBlank"&&(y+=2),y<_.length&&_[y][1].type==="content"))for(;++y<_.length&&_[y][1].type!=="content";)_[y][1].type==="chunkText"&&(_[y][1]._isInFirstContentOfListItem=!0,y++);if(c[0]==="enter")c[1].contentType&&(Object.assign(n,JO(R,a)),a=n[a],w=!0);else if(c[1]._container){for(y=a,f=void 0;y--;)if(e=R.get(y),e[1].type==="lineEnding"||e[1].type==="lineEndingBlank")e[0]==="enter"&&(f&&(R.get(f)[1].type="lineEndingBlank"),e[1].type="lineEnding",f=y);else if(!(e[1].type==="linePrefix"||e[1].type==="listItemIndent"))break;f&&(c[1].end={...R.get(f)[1].start},l=R.slice(f,a),l.unshift(c),R.splice(f,a-f+1,l))}}return la(i,0,Number.POSITIVE_INFINITY,R.slice(0)),!w}function JO(i,n){const a=i.get(n)[1],c=i.get(n)[2];let f=n-1;const y=[];let e=a._tokenizer;e||(e=c.parser[a.contentType](a.start),a._contentTypeTextTrailing&&(e._contentTypeTextTrailing=!0));const l=e.events,_=[],w={};let R,C,I=-1,L=a,O=0,q=0;const G=[q];for(;L;){for(;i.get(++f)[1]!==L;);y.push(f),L._tokenizer||(R=c.sliceStream(L),L.next||R.push(null),C&&e.defineSkip(L.start),L._isInFirstContentOfListItem&&(e._gfmTasklistFirstContentOfListItem=!0),e.write(R),L._isInFirstContentOfListItem&&(e._gfmTasklistFirstContentOfListItem=void 0)),C=L,L=L.next}for(L=a;++I<l.length;)l[I][0]==="exit"&&l[I-1][0]==="enter"&&l[I][1].type===l[I-1][1].type&&l[I][1].start.line!==l[I][1].end.line&&(q=I+1,G.push(q),L._tokenizer=void 0,L.previous=void 0,L=L.next);for(e.events=[],L?(L._tokenizer=void 0,L.previous=void 0):G.pop(),I=G.length;I--;){const j=l.slice(G[I],G[I+1]),ne=y.pop();_.push([ne,ne+j.length-1]),i.splice(ne,2,j)}for(_.reverse(),I=-1;++I<_.length;)w[O+_[I][0]]=O+_[I][1],O+=_[I][1]-_[I][0]-1;return w}var QO={resolve:tV,tokenize:rV},eV={partial:!0,tokenize:iV};function tV(i){return bD(i),i}function rV(i,n){let a;return c;function c(l){return i.enter("content"),a=i.enter("chunkContent",{contentType:"content"}),f(l)}function f(l){return l===null?y(l):br(l)?i.check(eV,e,y)(l):(i.consume(l),f)}function y(l){return i.exit("chunkContent"),i.exit("content"),n(l)}function e(l){return i.consume(l),i.exit("chunkContent"),a.next=i.enter("chunkContent",{contentType:"content",previous:a}),a=a.next,f}}function iV(i,n,a){const c=this;return f;function f(e){return i.exit("chunkContent"),i.enter("lineEnding"),i.consume(e),i.exit("lineEnding"),Ei(i,y,"linePrefix")}function y(e){if(e===null||br(e))return a(e);const l=c.events[c.events.length-1];return!c.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?n(e):i.interrupt(c.parser.constructs.flow,a,n)(e)}}function vD(i,n,a,c,f,y,e,l,_){const w=_||Number.POSITIVE_INFINITY;let R=0;return C;function C(j){return j===60?(i.enter(c),i.enter(f),i.enter(y),i.consume(j),i.exit(y),I):j===null||j===32||j===41||fx(j)?a(j):(i.enter(c),i.enter(e),i.enter(l),i.enter("chunkString",{contentType:"string"}),q(j))}function I(j){return j===62?(i.enter(y),i.consume(j),i.exit(y),i.exit(f),i.exit(c),n):(i.enter(l),i.enter("chunkString",{contentType:"string"}),L(j))}function L(j){return j===62?(i.exit("chunkString"),i.exit(l),I(j)):j===null||j===60||br(j)?a(j):(i.consume(j),j===92?O:L)}function O(j){return j===60||j===62||j===92?(i.consume(j),L):L(j)}function q(j){return!R&&(j===null||j===41||As(j))?(i.exit("chunkString"),i.exit(l),i.exit(e),i.exit(c),n(j)):R<w&&j===40?(i.consume(j),R++,q):j===41?(i.consume(j),R--,q):j===null||j===32||j===40||fx(j)?a(j):(i.consume(j),j===92?G:q)}function G(j){return j===40||j===41||j===92?(i.consume(j),q):q(j)}}function xD(i,n,a,c,f,y){const e=this;let l=0,_;return w;function w(L){return i.enter(c),i.enter(f),i.consume(L),i.exit(f),i.enter(y),R}function R(L){return l>999||L===null||L===91||L===93&&!_||L===94&&!l&&"_hiddenFootnoteSupport"in e.parser.constructs?a(L):L===93?(i.exit(y),i.enter(f),i.consume(L),i.exit(f),i.exit(c),n):br(L)?(i.enter("lineEnding"),i.consume(L),i.exit("lineEnding"),R):(i.enter("chunkString",{contentType:"string"}),C(L))}function C(L){return L===null||L===91||L===93||br(L)||l++>999?(i.exit("chunkString"),R(L)):(i.consume(L),_||(_=!oi(L)),L===92?I:C)}function I(L){return L===91||L===92||L===93?(i.consume(L),l++,C):C(L)}}function wD(i,n,a,c,f,y){let e;return l;function l(I){return I===34||I===39||I===40?(i.enter(c),i.enter(f),i.consume(I),i.exit(f),e=I===40?41:I,_):a(I)}function _(I){return I===e?(i.enter(f),i.consume(I),i.exit(f),i.exit(c),n):(i.enter(y),w(I))}function w(I){return I===e?(i.exit(y),_(e)):I===null?a(I):br(I)?(i.enter("lineEnding"),i.consume(I),i.exit("lineEnding"),Ei(i,w,"linePrefix")):(i.enter("chunkString",{contentType:"string"}),R(I))}function R(I){return I===e||I===null||br(I)?(i.exit("chunkString"),w(I)):(i.consume(I),I===92?C:R)}function C(I){return I===e||I===92?(i.consume(I),R):R(I)}}function Xh(i,n){let a;return c;function c(f){return br(f)?(i.enter("lineEnding"),i.consume(f),i.exit("lineEnding"),a=!0,c):oi(f)?Ei(i,c,a?"linePrefix":"lineSuffix")(f):n(f)}}var nV={name:"definition",tokenize:oV},sV={partial:!0,tokenize:aV};function oV(i,n,a){const c=this;let f;return y;function y(L){return i.enter("definition"),e(L)}function e(L){return xD.call(c,i,l,a,"definitionLabel","definitionLabelMarker","definitionLabelString")(L)}function l(L){return f=Op(c.sliceSerialize(c.events[c.events.length-1][1]).slice(1,-1)),L===58?(i.enter("definitionMarker"),i.consume(L),i.exit("definitionMarker"),_):a(L)}function _(L){return As(L)?Xh(i,w)(L):w(L)}function w(L){return vD(i,R,a,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(L)}function R(L){return i.attempt(sV,C,C)(L)}function C(L){return oi(L)?Ei(i,I,"whitespace")(L):I(L)}function I(L){return L===null||br(L)?(i.exit("definition"),c.parser.defined.push(f),n(L)):a(L)}}function aV(i,n,a){return c;function c(l){return As(l)?Xh(i,f)(l):a(l)}function f(l){return wD(i,y,a,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function y(l){return oi(l)?Ei(i,e,"whitespace")(l):e(l)}function e(l){return l===null||br(l)?n(l):a(l)}}var lV={name:"hardBreakEscape",tokenize:uV};function uV(i,n,a){return c;function c(y){return i.enter("hardBreakEscape"),i.consume(y),f}function f(y){return br(y)?(i.exit("hardBreakEscape"),n(y)):a(y)}}var cV={name:"headingAtx",resolve:dV,tokenize:pV};function dV(i,n){let a=i.length-2,c=3,f,y;return i[c][1].type==="whitespace"&&(c+=2),a-2>c&&i[a][1].type==="whitespace"&&(a-=2),i[a][1].type==="atxHeadingSequence"&&(c===a-1||a-4>c&&i[a-2][1].type==="whitespace")&&(a-=c+1===a?2:4),a>c&&(f={type:"atxHeadingText",start:i[c][1].start,end:i[a][1].end},y={type:"chunkText",start:i[c][1].start,end:i[a][1].end,contentType:"text"},la(i,c,a-c+1,[["enter",f,n],["enter",y,n],["exit",y,n],["exit",f,n]])),i}function pV(i,n,a){let c=0;return f;function f(R){return i.enter("atxHeading"),y(R)}function y(R){return i.enter("atxHeadingSequence"),e(R)}function e(R){return R===35&&c++<6?(i.consume(R),e):R===null||As(R)?(i.exit("atxHeadingSequence"),l(R)):a(R)}function l(R){return R===35?(i.enter("atxHeadingSequence"),_(R)):R===null||br(R)?(i.exit("atxHeading"),n(R)):oi(R)?Ei(i,l,"whitespace")(R):(i.enter("atxHeadingText"),w(R))}function _(R){return R===35?(i.consume(R),_):(i.exit("atxHeadingSequence"),l(R))}function w(R){return R===null||R===35||As(R)?(i.exit("atxHeadingText"),l(R)):(i.consume(R),w)}}var fV=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],pE=["pre","script","style","textarea"],hV={concrete:!0,name:"htmlFlow",resolveTo:gV,tokenize:_V},mV={partial:!0,tokenize:vV},yV={partial:!0,tokenize:bV};function gV(i){let n=i.length;for(;n--&&!(i[n][0]==="enter"&&i[n][1].type==="htmlFlow"););return n>1&&i[n-2][1].type==="linePrefix"&&(i[n][1].start=i[n-2][1].start,i[n+1][1].start=i[n-2][1].start,i.splice(n-2,2)),i}function _V(i,n,a){const c=this;let f,y,e,l,_;return w;function w(Ce){return R(Ce)}function R(Ce){return i.enter("htmlFlow"),i.enter("htmlFlowData"),i.consume(Ce),C}function C(Ce){return Ce===33?(i.consume(Ce),I):Ce===47?(i.consume(Ce),y=!0,q):Ce===63?(i.consume(Ce),f=3,c.interrupt?n:ge):na(Ce)?(i.consume(Ce),e=String.fromCharCode(Ce),G):a(Ce)}function I(Ce){return Ce===45?(i.consume(Ce),f=2,L):Ce===91?(i.consume(Ce),f=5,l=0,O):na(Ce)?(i.consume(Ce),f=4,c.interrupt?n:ge):a(Ce)}function L(Ce){return Ce===45?(i.consume(Ce),c.interrupt?n:ge):a(Ce)}function O(Ce){const ar="CDATA[";return Ce===ar.charCodeAt(l++)?(i.consume(Ce),l===ar.length?c.interrupt?n:rt:O):a(Ce)}function q(Ce){return na(Ce)?(i.consume(Ce),e=String.fromCharCode(Ce),G):a(Ce)}function G(Ce){if(Ce===null||Ce===47||Ce===62||As(Ce)){const ar=Ce===47,kt=e.toLowerCase();return!ar&&!y&&pE.includes(kt)?(f=1,c.interrupt?n(Ce):rt(Ce)):fV.includes(e.toLowerCase())?(f=6,ar?(i.consume(Ce),j):c.interrupt?n(Ce):rt(Ce)):(f=7,c.interrupt&&!c.parser.lazy[c.now().line]?a(Ce):y?ne(Ce):he(Ce))}return Ce===45||Gs(Ce)?(i.consume(Ce),e+=String.fromCharCode(Ce),G):a(Ce)}function j(Ce){return Ce===62?(i.consume(Ce),c.interrupt?n:rt):a(Ce)}function ne(Ce){return oi(Ce)?(i.consume(Ce),ne):st(Ce)}function he(Ce){return Ce===47?(i.consume(Ce),st):Ce===58||Ce===95||na(Ce)?(i.consume(Ce),Q):oi(Ce)?(i.consume(Ce),he):st(Ce)}function Q(Ce){return Ce===45||Ce===46||Ce===58||Ce===95||Gs(Ce)?(i.consume(Ce),Q):Be(Ce)}function Be(Ce){return Ce===61?(i.consume(Ce),we):oi(Ce)?(i.consume(Ce),Be):he(Ce)}function we(Ce){return Ce===null||Ce===60||Ce===61||Ce===62||Ce===96?a(Ce):Ce===34||Ce===39?(i.consume(Ce),_=Ce,ze):oi(Ce)?(i.consume(Ce),we):et(Ce)}function ze(Ce){return Ce===_?(i.consume(Ce),_=null,gt):Ce===null||br(Ce)?a(Ce):(i.consume(Ce),ze)}function et(Ce){return Ce===null||Ce===34||Ce===39||Ce===47||Ce===60||Ce===61||Ce===62||Ce===96||As(Ce)?Be(Ce):(i.consume(Ce),et)}function gt(Ce){return Ce===47||Ce===62||oi(Ce)?he(Ce):a(Ce)}function st(Ce){return Ce===62?(i.consume(Ce),nt):a(Ce)}function nt(Ce){return Ce===null||br(Ce)?rt(Ce):oi(Ce)?(i.consume(Ce),nt):a(Ce)}function rt(Ce){return Ce===45&&f===2?(i.consume(Ce),me):Ce===60&&f===1?(i.consume(Ce),tt):Ce===62&&f===4?(i.consume(Ce),Gt):Ce===63&&f===3?(i.consume(Ce),ge):Ce===93&&f===5?(i.consume(Ce),lt):br(Ce)&&(f===6||f===7)?(i.exit("htmlFlowData"),i.check(mV,Ut,ee)(Ce)):Ce===null||br(Ce)?(i.exit("htmlFlowData"),ee(Ce)):(i.consume(Ce),rt)}function ee(Ce){return i.check(yV,Le,Ut)(Ce)}function Le(Ce){return i.enter("lineEnding"),i.consume(Ce),i.exit("lineEnding"),de}function de(Ce){return Ce===null||br(Ce)?ee(Ce):(i.enter("htmlFlowData"),rt(Ce))}function me(Ce){return Ce===45?(i.consume(Ce),ge):rt(Ce)}function tt(Ce){return Ce===47?(i.consume(Ce),e="",yt):rt(Ce)}function yt(Ce){if(Ce===62){const ar=e.toLowerCase();return pE.includes(ar)?(i.consume(Ce),Gt):rt(Ce)}return na(Ce)&&e.length<8?(i.consume(Ce),e+=String.fromCharCode(Ce),yt):rt(Ce)}function lt(Ce){return Ce===93?(i.consume(Ce),ge):rt(Ce)}function ge(Ce){return Ce===62?(i.consume(Ce),Gt):Ce===45&&f===2?(i.consume(Ce),ge):rt(Ce)}function Gt(Ce){return Ce===null||br(Ce)?(i.exit("htmlFlowData"),Ut(Ce)):(i.consume(Ce),Gt)}function Ut(Ce){return i.exit("htmlFlow"),n(Ce)}}function bV(i,n,a){const c=this;return f;function f(e){return br(e)?(i.enter("lineEnding"),i.consume(e),i.exit("lineEnding"),y):a(e)}function y(e){return c.parser.lazy[c.now().line]?a(e):n(e)}}function vV(i,n,a){return c;function c(f){return i.enter("lineEnding"),i.consume(f),i.exit("lineEnding"),i.attempt(rv,n,a)}}var xV={name:"htmlText",tokenize:wV};function wV(i,n,a){const c=this;let f,y,e;return l;function l(ge){return i.enter("htmlText"),i.enter("htmlTextData"),i.consume(ge),_}function _(ge){return ge===33?(i.consume(ge),w):ge===47?(i.consume(ge),Be):ge===63?(i.consume(ge),he):na(ge)?(i.consume(ge),et):a(ge)}function w(ge){return ge===45?(i.consume(ge),R):ge===91?(i.consume(ge),y=0,O):na(ge)?(i.consume(ge),ne):a(ge)}function R(ge){return ge===45?(i.consume(ge),L):a(ge)}function C(ge){return ge===null?a(ge):ge===45?(i.consume(ge),I):br(ge)?(e=C,tt(ge)):(i.consume(ge),C)}function I(ge){return ge===45?(i.consume(ge),L):C(ge)}function L(ge){return ge===62?me(ge):ge===45?I(ge):C(ge)}function O(ge){const Gt="CDATA[";return ge===Gt.charCodeAt(y++)?(i.consume(ge),y===Gt.length?q:O):a(ge)}function q(ge){return ge===null?a(ge):ge===93?(i.consume(ge),G):br(ge)?(e=q,tt(ge)):(i.consume(ge),q)}function G(ge){return ge===93?(i.consume(ge),j):q(ge)}function j(ge){return ge===62?me(ge):ge===93?(i.consume(ge),j):q(ge)}function ne(ge){return ge===null||ge===62?me(ge):br(ge)?(e=ne,tt(ge)):(i.consume(ge),ne)}function he(ge){return ge===null?a(ge):ge===63?(i.consume(ge),Q):br(ge)?(e=he,tt(ge)):(i.consume(ge),he)}function Q(ge){return ge===62?me(ge):he(ge)}function Be(ge){return na(ge)?(i.consume(ge),we):a(ge)}function we(ge){return ge===45||Gs(ge)?(i.consume(ge),we):ze(ge)}function ze(ge){return br(ge)?(e=ze,tt(ge)):oi(ge)?(i.consume(ge),ze):me(ge)}function et(ge){return ge===45||Gs(ge)?(i.consume(ge),et):ge===47||ge===62||As(ge)?gt(ge):a(ge)}function gt(ge){return ge===47?(i.consume(ge),me):ge===58||ge===95||na(ge)?(i.consume(ge),st):br(ge)?(e=gt,tt(ge)):oi(ge)?(i.consume(ge),gt):me(ge)}function st(ge){return ge===45||ge===46||ge===58||ge===95||Gs(ge)?(i.consume(ge),st):nt(ge)}function nt(ge){return ge===61?(i.consume(ge),rt):br(ge)?(e=nt,tt(ge)):oi(ge)?(i.consume(ge),nt):gt(ge)}function rt(ge){return ge===null||ge===60||ge===61||ge===62||ge===96?a(ge):ge===34||ge===39?(i.consume(ge),f=ge,ee):br(ge)?(e=rt,tt(ge)):oi(ge)?(i.consume(ge),rt):(i.consume(ge),Le)}function ee(ge){return ge===f?(i.consume(ge),f=void 0,de):ge===null?a(ge):br(ge)?(e=ee,tt(ge)):(i.consume(ge),ee)}function Le(ge){return ge===null||ge===34||ge===39||ge===60||ge===61||ge===96?a(ge):ge===47||ge===62||As(ge)?gt(ge):(i.consume(ge),Le)}function de(ge){return ge===47||ge===62||As(ge)?gt(ge):a(ge)}function me(ge){return ge===62?(i.consume(ge),i.exit("htmlTextData"),i.exit("htmlText"),n):a(ge)}function tt(ge){return i.exit("htmlTextData"),i.enter("lineEnding"),i.consume(ge),i.exit("lineEnding"),yt}function yt(ge){return oi(ge)?Ei(i,lt,"linePrefix",c.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(ge):lt(ge)}function lt(ge){return i.enter("htmlTextData"),e(ge)}}var Gx={name:"labelEnd",resolveAll:SV,resolveTo:TV,tokenize:CV},EV={tokenize:kV},AV={tokenize:PV},RV={tokenize:LV};function SV(i){let n=-1;const a=[];for(;++n<i.length;){const c=i[n][1];if(a.push(i[n]),c.type==="labelImage"||c.type==="labelLink"||c.type==="labelEnd"){const f=c.type==="labelImage"?4:2;c.type="data",n+=f}}return i.length!==a.length&&la(i,0,i.length,a),i}function TV(i,n){let a=i.length,c=0,f,y,e,l;for(;a--;)if(f=i[a][1],y){if(f.type==="link"||f.type==="labelLink"&&f._inactive)break;i[a][0]==="enter"&&f.type==="labelLink"&&(f._inactive=!0)}else if(e){if(i[a][0]==="enter"&&(f.type==="labelImage"||f.type==="labelLink")&&!f._balanced&&(y=a,f.type!=="labelLink")){c=2;break}}else f.type==="labelEnd"&&(e=a);const _={type:i[y][1].type==="labelLink"?"link":"image",start:{...i[y][1].start},end:{...i[i.length-1][1].end}},w={type:"label",start:{...i[y][1].start},end:{...i[e][1].end}},R={type:"labelText",start:{...i[y+c+2][1].end},end:{...i[e-2][1].start}};return l=[["enter",_,n],["enter",w,n]],l=oo(l,i.slice(y+1,y+c+3)),l=oo(l,[["enter",R,n]]),l=oo(l,Kx(n.parser.constructs.insideSpan.null,i.slice(y+c+4,e-3),n)),l=oo(l,[["exit",R,n],i[e-2],i[e-1],["exit",w,n]]),l=oo(l,i.slice(e+1)),l=oo(l,[["exit",_,n]]),la(i,y,i.length,l),i}function CV(i,n,a){const c=this;let f=c.events.length,y,e;for(;f--;)if((c.events[f][1].type==="labelImage"||c.events[f][1].type==="labelLink")&&!c.events[f][1]._balanced){y=c.events[f][1];break}return l;function l(I){return y?y._inactive?C(I):(e=c.parser.defined.includes(Op(c.sliceSerialize({start:y.end,end:c.now()}))),i.enter("labelEnd"),i.enter("labelMarker"),i.consume(I),i.exit("labelMarker"),i.exit("labelEnd"),_):a(I)}function _(I){return I===40?i.attempt(EV,R,e?R:C)(I):I===91?i.attempt(AV,R,e?w:C)(I):e?R(I):C(I)}function w(I){return i.attempt(RV,R,C)(I)}function R(I){return n(I)}function C(I){return y._balanced=!0,a(I)}}function kV(i,n,a){return c;function c(C){return i.enter("resource"),i.enter("resourceMarker"),i.consume(C),i.exit("resourceMarker"),f}function f(C){return As(C)?Xh(i,y)(C):y(C)}function y(C){return C===41?R(C):vD(i,e,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(C)}function e(C){return As(C)?Xh(i,_)(C):R(C)}function l(C){return a(C)}function _(C){return C===34||C===39||C===40?wD(i,w,a,"resourceTitle","resourceTitleMarker","resourceTitleString")(C):R(C)}function w(C){return As(C)?Xh(i,R)(C):R(C)}function R(C){return C===41?(i.enter("resourceMarker"),i.consume(C),i.exit("resourceMarker"),i.exit("resource"),n):a(C)}}function PV(i,n,a){const c=this;return f;function f(l){return xD.call(c,i,y,e,"reference","referenceMarker","referenceString")(l)}function y(l){return c.parser.defined.includes(Op(c.sliceSerialize(c.events[c.events.length-1][1]).slice(1,-1)))?n(l):a(l)}function e(l){return a(l)}}function LV(i,n,a){return c;function c(y){return i.enter("reference"),i.enter("referenceMarker"),i.consume(y),i.exit("referenceMarker"),f}function f(y){return y===93?(i.enter("referenceMarker"),i.consume(y),i.exit("referenceMarker"),i.exit("reference"),n):a(y)}}var DV={name:"labelStartImage",resolveAll:Gx.resolveAll,tokenize:IV};function IV(i,n,a){const c=this;return f;function f(l){return i.enter("labelImage"),i.enter("labelImageMarker"),i.consume(l),i.exit("labelImageMarker"),y}function y(l){return l===91?(i.enter("labelMarker"),i.consume(l),i.exit("labelMarker"),i.exit("labelImage"),e):a(l)}function e(l){return l===94&&"_hiddenFootnoteSupport"in c.parser.constructs?a(l):n(l)}}var BV={name:"labelStartLink",resolveAll:Gx.resolveAll,tokenize:MV};function MV(i,n,a){const c=this;return f;function f(e){return i.enter("labelLink"),i.enter("labelMarker"),i.consume(e),i.exit("labelMarker"),i.exit("labelLink"),y}function y(e){return e===94&&"_hiddenFootnoteSupport"in c.parser.constructs?a(e):n(e)}}var w0={name:"lineEnding",tokenize:zV};function zV(i,n){return a;function a(c){return i.enter("lineEnding"),i.consume(c),i.exit("lineEnding"),Ei(i,n,"linePrefix")}}var Db={name:"thematicBreak",tokenize:OV};function OV(i,n,a){let c=0,f;return y;function y(w){return i.enter("thematicBreak"),e(w)}function e(w){return f=w,l(w)}function l(w){return w===f?(i.enter("thematicBreakSequence"),_(w)):c>=3&&(w===null||br(w))?(i.exit("thematicBreak"),n(w)):a(w)}function _(w){return w===f?(i.consume(w),c++,_):(i.exit("thematicBreakSequence"),oi(w)?Ei(i,l,"whitespace")(w):l(w))}}var Es={continuation:{tokenize:NV},exit:qV,name:"list",tokenize:jV},VV={partial:!0,tokenize:KV},UV={partial:!0,tokenize:FV};function jV(i,n,a){const c=this,f=c.events[c.events.length-1];let y=f&&f[1].type==="linePrefix"?f[2].sliceSerialize(f[1],!0).length:0,e=0;return l;function l(L){const O=c.containerState.type||(L===42||L===43||L===45?"listUnordered":"listOrdered");if(O==="listUnordered"?!c.containerState.marker||L===c.containerState.marker:hx(L)){if(c.containerState.type||(c.containerState.type=O,i.enter(O,{_container:!0})),O==="listUnordered")return i.enter("listItemPrefix"),L===42||L===45?i.check(Db,a,w)(L):w(L);if(!c.interrupt||L===49)return i.enter("listItemPrefix"),i.enter("listItemValue"),_(L)}return a(L)}function _(L){return hx(L)&&++e<10?(i.consume(L),_):(!c.interrupt||e<2)&&(c.containerState.marker?L===c.containerState.marker:L===41||L===46)?(i.exit("listItemValue"),w(L)):a(L)}function w(L){return i.enter("listItemMarker"),i.consume(L),i.exit("listItemMarker"),c.containerState.marker=c.containerState.marker||L,i.check(rv,c.interrupt?a:R,i.attempt(VV,I,C))}function R(L){return c.containerState.initialBlankLine=!0,y++,I(L)}function C(L){return oi(L)?(i.enter("listItemPrefixWhitespace"),i.consume(L),i.exit("listItemPrefixWhitespace"),I):a(L)}function I(L){return c.containerState.size=y+c.sliceSerialize(i.exit("listItemPrefix"),!0).length,n(L)}}function NV(i,n,a){const c=this;return c.containerState._closeFlow=void 0,i.check(rv,f,y);function f(l){return c.containerState.furtherBlankLines=c.containerState.furtherBlankLines||c.containerState.initialBlankLine,Ei(i,n,"listItemIndent",c.containerState.size+1)(l)}function y(l){return c.containerState.furtherBlankLines||!oi(l)?(c.containerState.furtherBlankLines=void 0,c.containerState.initialBlankLine=void 0,e(l)):(c.containerState.furtherBlankLines=void 0,c.containerState.initialBlankLine=void 0,i.attempt(UV,n,e)(l))}function e(l){return c.containerState._closeFlow=!0,c.interrupt=void 0,Ei(i,i.attempt(Es,n,a),"linePrefix",c.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function FV(i,n,a){const c=this;return Ei(i,f,"listItemIndent",c.containerState.size+1);function f(y){const e=c.events[c.events.length-1];return e&&e[1].type==="listItemIndent"&&e[2].sliceSerialize(e[1],!0).length===c.containerState.size?n(y):a(y)}}function qV(i){i.exit(this.containerState.type)}function KV(i,n,a){const c=this;return Ei(i,f,"listItemPrefixWhitespace",c.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function f(y){const e=c.events[c.events.length-1];return!oi(y)&&e&&e[1].type==="listItemPrefixWhitespace"?n(y):a(y)}}var fE={name:"setextUnderline",resolveTo:GV,tokenize:$V};function GV(i,n){let a=i.length,c,f,y;for(;a--;)if(i[a][0]==="enter"){if(i[a][1].type==="content"){c=a;break}i[a][1].type==="paragraph"&&(f=a)}else i[a][1].type==="content"&&i.splice(a,1),!y&&i[a][1].type==="definition"&&(y=a);const e={type:"setextHeading",start:{...i[c][1].start},end:{...i[i.length-1][1].end}};return i[f][1].type="setextHeadingText",y?(i.splice(f,0,["enter",e,n]),i.splice(y+1,0,["exit",i[c][1],n]),i[c][1].end={...i[y][1].end}):i[c][1]=e,i.push(["exit",e,n]),i}function $V(i,n,a){const c=this;let f;return y;function y(w){let R=c.events.length,C;for(;R--;)if(c.events[R][1].type!=="lineEnding"&&c.events[R][1].type!=="linePrefix"&&c.events[R][1].type!=="content"){C=c.events[R][1].type==="paragraph";break}return!c.parser.lazy[c.now().line]&&(c.interrupt||C)?(i.enter("setextHeadingLine"),f=w,e(w)):a(w)}function e(w){return i.enter("setextHeadingLineSequence"),l(w)}function l(w){return w===f?(i.consume(w),l):(i.exit("setextHeadingLineSequence"),oi(w)?Ei(i,_,"lineSuffix")(w):_(w))}function _(w){return w===null||br(w)?(i.exit("setextHeadingLine"),n(w)):a(w)}}var ZV={tokenize:HV};function HV(i){const n=this,a=i.attempt(rv,c,i.attempt(this.parser.constructs.flowInitial,f,Ei(i,i.attempt(this.parser.constructs.flow,f,i.attempt(QO,f)),"linePrefix")));return a;function c(y){if(y===null){i.consume(y);return}return i.enter("lineEndingBlank"),i.consume(y),i.exit("lineEndingBlank"),n.currentConstruct=void 0,a}function f(y){if(y===null){i.consume(y);return}return i.enter("lineEnding"),i.consume(y),i.exit("lineEnding"),n.currentConstruct=void 0,a}}var XV={resolveAll:AD()},WV=ED("string"),YV=ED("text");function ED(i){return{resolveAll:AD(i==="text"?JV:void 0),tokenize:n};function n(a){const c=this,f=this.parser.constructs[i],y=a.attempt(f,e,l);return e;function e(R){return w(R)?y(R):l(R)}function l(R){if(R===null){a.consume(R);return}return a.enter("data"),a.consume(R),_}function _(R){return w(R)?(a.exit("data"),y(R)):(a.consume(R),_)}function w(R){if(R===null)return!0;const C=f[R];let I=-1;if(C)for(;++I<C.length;){const L=C[I];if(!L.previous||L.previous.call(c,c.previous))return!0}return!1}}}function AD(i){return n;function n(a,c){let f=-1,y;for(;++f<=a.length;)y===void 0?a[f]&&a[f][1].type==="data"&&(y=f,f++):(!a[f]||a[f][1].type!=="data")&&(f!==y+2&&(a[y][1].end=a[f-1][1].end,a.splice(y+2,f-y-2),f=y+2),y=void 0);return i?i(a,c):a}}function JV(i,n){let a=0;for(;++a<=i.length;)if((a===i.length||i[a][1].type==="lineEnding")&&i[a-1][1].type==="data"){const c=i[a-1][1],f=n.sliceStream(c);let y=f.length,e=-1,l=0,_;for(;y--;){const w=f[y];if(typeof w=="string"){for(e=w.length;w.charCodeAt(e-1)===32;)l++,e--;if(e)break;e=-1}else if(w===-2)_=!0,l++;else if(w!==-1){y++;break}}if(n._contentTypeTextTrailing&&a===i.length&&(l=0),l){const w={type:a===i.length||_||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:y?e:c.start._bufferIndex+e,_index:c.start._index+y,line:c.end.line,column:c.end.column-l,offset:c.end.offset-l},end:{...c.end}};c.end={...w.start},c.start.offset===c.end.offset?Object.assign(c,w):(i.splice(a,0,["enter",w,n],["exit",w,n]),a+=2)}a++}return i}var RD={};dO(RD,{attentionMarkers:()=>oU,contentInitial:()=>eU,disable:()=>aU,document:()=>QV,flow:()=>rU,flowInitial:()=>tU,insideSpan:()=>sU,string:()=>iU,text:()=>nU});var QV={42:Es,43:Es,45:Es,48:Es,49:Es,50:Es,51:Es,52:Es,53:Es,54:Es,55:Es,56:Es,57:Es,62:yD},eU={91:nV},tU={[-2]:x0,[-1]:x0,32:x0},rU={35:cV,42:Db,45:[fE,Db],60:hV,61:fE,95:Db,96:dE,126:dE},iU={38:_D,92:gD},nU={[-5]:w0,[-4]:w0,[-3]:w0,33:DV,38:_D,42:mx,60:[BO,xV],91:BV,92:[lV,gD],93:Gx,95:mx,96:ZO},sU={null:[mx,XV]},oU={null:[42,95]},aU={null:[]};function lU(i,n,a){let c={_bufferIndex:-1,_index:0,line:a&&a.line||1,column:a&&a.column||1,offset:a&&a.offset||0};const f={},y=[];let e=[],l=[];const _={attempt:ze(Be),check:ze(we),consume:ne,enter:he,exit:Q,interrupt:ze(we,{interrupt:!0})},w={code:null,containerState:{},defineSkip:q,events:[],now:O,parser:i,previous:null,sliceSerialize:I,sliceStream:L,write:C};let R=n.tokenize.call(w,_);return n.resolveAll&&y.push(n),w;function C(nt){return e=oo(e,nt),G(),e[e.length-1]!==null?[]:(et(n,0),w.events=Kx(y,w.events,w),w.events)}function I(nt,rt){return cU(L(nt),rt)}function L(nt){return uU(e,nt)}function O(){const{_bufferIndex:nt,_index:rt,line:ee,column:Le,offset:de}=c;return{_bufferIndex:nt,_index:rt,line:ee,column:Le,offset:de}}function q(nt){f[nt.line]=nt.column,st()}function G(){let nt;for(;c._index<e.length;){const rt=e[c._index];if(typeof rt=="string")for(nt=c._index,c._bufferIndex<0&&(c._bufferIndex=0);c._index===nt&&c._bufferIndex<rt.length;)j(rt.charCodeAt(c._bufferIndex));else j(rt)}}function j(nt){R=R(nt)}function ne(nt){br(nt)?(c.line++,c.column=1,c.offset+=nt===-3?2:1,st()):nt!==-1&&(c.column++,c.offset++),c._bufferIndex<0?c._index++:(c._bufferIndex++,c._bufferIndex===e[c._index].length&&(c._bufferIndex=-1,c._index++)),w.previous=nt}function he(nt,rt){const ee=rt||{};return ee.type=nt,ee.start=O(),w.events.push(["enter",ee,w]),l.push(ee),ee}function Q(nt){const rt=l.pop();return rt.end=O(),w.events.push(["exit",rt,w]),rt}function Be(nt,rt){et(nt,rt.from)}function we(nt,rt){rt.restore()}function ze(nt,rt){return ee;function ee(Le,de,me){let tt,yt,lt,ge;return Array.isArray(Le)?Ut(Le):"tokenize"in Le?Ut([Le]):Gt(Le);function Gt(er){return Ur;function Ur(or){const Sr=or!==null&&er[or],Ar=or!==null&&er.null,Nr=[...Array.isArray(Sr)?Sr:Sr?[Sr]:[],...Array.isArray(Ar)?Ar:Ar?[Ar]:[]];return Ut(Nr)(or)}}function Ut(er){return tt=er,yt=0,er.length===0?me:Ce(er[yt])}function Ce(er){return Ur;function Ur(or){return ge=gt(),lt=er,er.partial||(w.currentConstruct=er),er.name&&w.parser.constructs.disable.null.includes(er.name)?kt():er.tokenize.call(rt?Object.assign(Object.create(w),rt):w,_,ar,kt)(or)}}function ar(er){return nt(lt,ge),de}function kt(er){return ge.restore(),++yt<tt.length?Ce(tt[yt]):me}}}function et(nt,rt){nt.resolveAll&&!y.includes(nt)&&y.push(nt),nt.resolve&&la(w.events,rt,w.events.length-rt,nt.resolve(w.events.slice(rt),w)),nt.resolveTo&&(w.events=nt.resolveTo(w.events,w))}function gt(){const nt=O(),rt=w.previous,ee=w.currentConstruct,Le=w.events.length,de=Array.from(l);return{from:Le,restore:me};function me(){c=nt,w.previous=rt,w.currentConstruct=ee,w.events.length=Le,l=de,st()}}function st(){c.line in f&&c.column<2&&(c.column=f[c.line],c.offset+=f[c.line]-1)}}function uU(i,n){const a=n.start._index,c=n.start._bufferIndex,f=n.end._index,y=n.end._bufferIndex;let e;if(a===f)e=[i[a].slice(c,y)];else{if(e=i.slice(a,f),c>-1){const l=e[0];typeof l=="string"?e[0]=l.slice(c):e.shift()}y>0&&e.push(i[f].slice(0,y))}return e}function cU(i,n){let a=-1;const c=[];let f;for(;++a<i.length;){const y=i[a];let e;if(typeof y=="string")e=y;else switch(y){case-5:{e="\r";break}case-4:{e=`
`;break}case-3:{e=`\r
`;break}case-2:{e=n?" ":"	";break}case-1:{if(!n&&f)continue;e=" ";break}default:e=String.fromCharCode(y)}f=y===-2,c.push(e)}return c.join("")}function dU(i){const c={constructs:bO([RD,...(i||{}).extensions||[]]),content:f(TO),defined:[],document:f(kO),flow:f(ZV),lazy:{},string:f(WV),text:f(YV)};return c;function f(y){return e;function e(l){return lU(c,y,l)}}}function pU(i){for(;!bD(i););return i}var hE=/[\0\t\n\r]/g;function fU(){let i=1,n="",a=!0,c;return f;function f(y,e,l){const _=[];let w,R,C,I,L;for(y=n+(typeof y=="string"?y.toString():new TextDecoder(e||void 0).decode(y)),C=0,n="",a&&(y.charCodeAt(0)===65279&&C++,a=void 0);C<y.length;){if(hE.lastIndex=C,w=hE.exec(y),I=w&&w.index!==void 0?w.index:y.length,L=y.charCodeAt(I),!w){n=y.slice(C);break}if(L===10&&C===I&&c)_.push(-3),c=void 0;else switch(c&&(_.push(-5),c=void 0),C<I&&(_.push(y.slice(C,I)),i+=I-C),L){case 0:{_.push(65533),i++;break}case 9:{for(R=Math.ceil(i/4)*4,_.push(-2);i++<R;)_.push(-1);break}case 10:{_.push(-4),i=1;break}default:c=!0,i=1}C=I+1}return l&&(c&&_.push(-5),n&&_.push(n),_.push(null)),_}}var hU=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function mU(i){return i.replace(hU,yU)}function yU(i,n,a){if(n)return n;if(a.charCodeAt(0)===35){const f=a.charCodeAt(1),y=f===120||f===88;return mD(a.slice(y?2:1),y?16:10)}return qx(a)||i}function Wh(i){return!i||typeof i!="object"?"":"position"in i||"type"in i?mE(i.position):"start"in i||"end"in i?mE(i):"line"in i||"column"in i?yx(i):""}function yx(i){return yE(i&&i.line)+":"+yE(i&&i.column)}function mE(i){return yx(i&&i.start)+"-"+yx(i&&i.end)}function yE(i){return i&&typeof i=="number"?i:1}var SD={}.hasOwnProperty;function gU(i,n,a){return typeof n!="string"&&(a=n,n=void 0),_U(a)(pU(dU(a).document().write(fU()(i,n,!0))))}function _U(i){const n={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:y(Qt),autolinkProtocol:gt,autolinkEmail:gt,atxHeading:y(qr),blockQuote:y(Ar),characterEscape:gt,characterReference:gt,codeFenced:y(Nr),codeFencedFenceInfo:e,codeFencedFenceMeta:e,codeIndented:y(Nr,e),codeText:y(rr,e),codeTextData:gt,data:gt,codeFlowValue:gt,definition:y(gr),definitionDestinationString:e,definitionLabelString:e,definitionTitleString:e,emphasis:y(ir),hardBreakEscape:y(Vt),hardBreakTrailing:y(Vt),htmlFlow:y(Pr,e),htmlFlowData:gt,htmlText:y(Pr,e),htmlTextData:gt,image:y(St),label:e,link:y(Qt),listItem:y(Tr),listItemValue:I,listOrdered:y(nr,C),listUnordered:y(nr),paragraph:y($r),reference:Ce,referenceString:e,resourceDestinationString:e,resourceTitleString:e,setextHeading:y(qr),strong:y(bt),thematicBreak:y(Ii)},exit:{atxHeading:_(),atxHeadingSequence:Be,autolink:_(),autolinkEmail:Sr,autolinkProtocol:or,blockQuote:_(),characterEscapeValue:st,characterReferenceMarkerHexadecimal:kt,characterReferenceMarkerNumeric:kt,characterReferenceValue:er,characterReference:Ur,codeFenced:_(G),codeFencedFence:q,codeFencedFenceInfo:L,codeFencedFenceMeta:O,codeFlowValue:st,codeIndented:_(j),codeText:_(de),codeTextData:st,data:st,definition:_(),definitionDestinationString:Q,definitionLabelString:ne,definitionTitleString:he,emphasis:_(),hardBreakEscape:_(rt),hardBreakTrailing:_(rt),htmlFlow:_(ee),htmlFlowData:st,htmlText:_(Le),htmlTextData:st,image:_(tt),label:lt,labelText:yt,lineEnding:nt,link:_(me),listItem:_(),listOrdered:_(),listUnordered:_(),paragraph:_(),referenceString:ar,resourceDestinationString:ge,resourceTitleString:Gt,resource:Ut,setextHeading:_(et),setextHeadingLineSequence:ze,setextHeadingText:we,strong:_(),thematicBreak:_()}};TD(n,(i||{}).mdastExtensions||[]);const a={};return c;function c(Oe){let vt={type:"root",children:[]};const Nt={stack:[vt],tokenStack:[],config:n,enter:l,exit:w,buffer:e,resume:R,data:a},ve=[];let W=-1;for(;++W<Oe.length;)if(Oe[W][1].type==="listOrdered"||Oe[W][1].type==="listUnordered")if(Oe[W][0]==="enter")ve.push(W);else{const J=ve.pop();W=f(Oe,J,W)}for(W=-1;++W<Oe.length;){const J=n[Oe[W][0]];SD.call(J,Oe[W][1].type)&&J[Oe[W][1].type].call(Object.assign({sliceSerialize:Oe[W][2].sliceSerialize},Nt),Oe[W][1])}if(Nt.tokenStack.length>0){const J=Nt.tokenStack[Nt.tokenStack.length-1];(J[1]||gE).call(Nt,void 0,J[0])}for(vt.position={start:vl(Oe.length>0?Oe[0][1].start:{line:1,column:1,offset:0}),end:vl(Oe.length>0?Oe[Oe.length-2][1].end:{line:1,column:1,offset:0})},W=-1;++W<n.transforms.length;)vt=n.transforms[W](vt)||vt;return vt}function f(Oe,vt,Nt){let ve=vt-1,W=-1,J=!1,se,_e,Re,je;for(;++ve<=Nt;){const Ge=Oe[ve];switch(Ge[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ge[0]==="enter"?W++:W--,je=void 0;break}case"lineEndingBlank":{Ge[0]==="enter"&&(se&&!je&&!W&&!Re&&(Re=ve),je=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:je=void 0}if(!W&&Ge[0]==="enter"&&Ge[1].type==="listItemPrefix"||W===-1&&Ge[0]==="exit"&&(Ge[1].type==="listUnordered"||Ge[1].type==="listOrdered")){if(se){let Ne=ve;for(_e=void 0;Ne--;){const Ye=Oe[Ne];if(Ye[1].type==="lineEnding"||Ye[1].type==="lineEndingBlank"){if(Ye[0]==="exit")continue;_e&&(Oe[_e][1].type="lineEndingBlank",J=!0),Ye[1].type="lineEnding",_e=Ne}else if(!(Ye[1].type==="linePrefix"||Ye[1].type==="blockQuotePrefix"||Ye[1].type==="blockQuotePrefixWhitespace"||Ye[1].type==="blockQuoteMarker"||Ye[1].type==="listItemIndent"))break}Re&&(!_e||Re<_e)&&(se._spread=!0),se.end=Object.assign({},_e?Oe[_e][1].start:Ge[1].end),Oe.splice(_e||ve,0,["exit",se,Ge[2]]),ve++,Nt++}if(Ge[1].type==="listItemPrefix"){const Ne={type:"listItem",_spread:!1,start:Object.assign({},Ge[1].start),end:void 0};se=Ne,Oe.splice(ve,0,["enter",Ne,Ge[2]]),ve++,Nt++,Re=void 0,je=!0}}}return Oe[vt][1]._spread=J,Nt}function y(Oe,vt){return Nt;function Nt(ve){l.call(this,Oe(ve),ve),vt&&vt.call(this,ve)}}function e(){this.stack.push({type:"fragment",children:[]})}function l(Oe,vt,Nt){this.stack[this.stack.length-1].children.push(Oe),this.stack.push(Oe),this.tokenStack.push([vt,Nt||void 0]),Oe.position={start:vl(vt.start),end:void 0}}function _(Oe){return vt;function vt(Nt){Oe&&Oe.call(this,Nt),w.call(this,Nt)}}function w(Oe,vt){const Nt=this.stack.pop(),ve=this.tokenStack.pop();if(ve)ve[0].type!==Oe.type&&(vt?vt.call(this,Oe,ve[0]):(ve[1]||gE).call(this,Oe,ve[0]));else throw new Error("Cannot close `"+Oe.type+"` ("+Wh({start:Oe.start,end:Oe.end})+"): it’s not open");Nt.position.end=vl(Oe.end)}function R(){return yO(this.stack.pop())}function C(){this.data.expectingFirstListItemValue=!0}function I(Oe){if(this.data.expectingFirstListItemValue){const vt=this.stack[this.stack.length-2];vt.start=Number.parseInt(this.sliceSerialize(Oe),10),this.data.expectingFirstListItemValue=void 0}}function L(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.lang=Oe}function O(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.meta=Oe}function q(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function G(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.value=Oe.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function j(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.value=Oe.replace(/(\r?\n|\r)$/g,"")}function ne(Oe){const vt=this.resume(),Nt=this.stack[this.stack.length-1];Nt.label=vt,Nt.identifier=Op(this.sliceSerialize(Oe)).toLowerCase()}function he(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.title=Oe}function Q(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.url=Oe}function Be(Oe){const vt=this.stack[this.stack.length-1];if(!vt.depth){const Nt=this.sliceSerialize(Oe).length;vt.depth=Nt}}function we(){this.data.setextHeadingSlurpLineEnding=!0}function ze(Oe){const vt=this.stack[this.stack.length-1];vt.depth=this.sliceSerialize(Oe).codePointAt(0)===61?1:2}function et(){this.data.setextHeadingSlurpLineEnding=void 0}function gt(Oe){const Nt=this.stack[this.stack.length-1].children;let ve=Nt[Nt.length-1];(!ve||ve.type!=="text")&&(ve=pi(),ve.position={start:vl(Oe.start),end:void 0},Nt.push(ve)),this.stack.push(ve)}function st(Oe){const vt=this.stack.pop();vt.value+=this.sliceSerialize(Oe),vt.position.end=vl(Oe.end)}function nt(Oe){const vt=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Nt=vt.children[vt.children.length-1];Nt.position.end=vl(Oe.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&n.canContainEols.includes(vt.type)&&(gt.call(this,Oe),st.call(this,Oe))}function rt(){this.data.atHardBreak=!0}function ee(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.value=Oe}function Le(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.value=Oe}function de(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.value=Oe}function me(){const Oe=this.stack[this.stack.length-1];if(this.data.inReference){const vt=this.data.referenceType||"shortcut";Oe.type+="Reference",Oe.referenceType=vt,delete Oe.url,delete Oe.title}else delete Oe.identifier,delete Oe.label;this.data.referenceType=void 0}function tt(){const Oe=this.stack[this.stack.length-1];if(this.data.inReference){const vt=this.data.referenceType||"shortcut";Oe.type+="Reference",Oe.referenceType=vt,delete Oe.url,delete Oe.title}else delete Oe.identifier,delete Oe.label;this.data.referenceType=void 0}function yt(Oe){const vt=this.sliceSerialize(Oe),Nt=this.stack[this.stack.length-2];Nt.label=mU(vt),Nt.identifier=Op(vt).toLowerCase()}function lt(){const Oe=this.stack[this.stack.length-1],vt=this.resume(),Nt=this.stack[this.stack.length-1];if(this.data.inReference=!0,Nt.type==="link"){const ve=Oe.children;Nt.children=ve}else Nt.alt=vt}function ge(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.url=Oe}function Gt(){const Oe=this.resume(),vt=this.stack[this.stack.length-1];vt.title=Oe}function Ut(){this.data.inReference=void 0}function Ce(){this.data.referenceType="collapsed"}function ar(Oe){const vt=this.resume(),Nt=this.stack[this.stack.length-1];Nt.label=vt,Nt.identifier=Op(this.sliceSerialize(Oe)).toLowerCase(),this.data.referenceType="full"}function kt(Oe){this.data.characterReferenceType=Oe.type}function er(Oe){const vt=this.sliceSerialize(Oe),Nt=this.data.characterReferenceType;let ve;Nt?(ve=mD(vt,Nt==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ve=qx(vt);const W=this.stack[this.stack.length-1];W.value+=ve}function Ur(Oe){const vt=this.stack.pop();vt.position.end=vl(Oe.end)}function or(Oe){st.call(this,Oe);const vt=this.stack[this.stack.length-1];vt.url=this.sliceSerialize(Oe)}function Sr(Oe){st.call(this,Oe);const vt=this.stack[this.stack.length-1];vt.url="mailto:"+this.sliceSerialize(Oe)}function Ar(){return{type:"blockquote",children:[]}}function Nr(){return{type:"code",lang:null,meta:null,value:""}}function rr(){return{type:"inlineCode",value:""}}function gr(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function ir(){return{type:"emphasis",children:[]}}function qr(){return{type:"heading",depth:0,children:[]}}function Vt(){return{type:"break"}}function Pr(){return{type:"html",value:""}}function St(){return{type:"image",title:null,url:"",alt:null}}function Qt(){return{type:"link",title:null,url:"",children:[]}}function nr(Oe){return{type:"list",ordered:Oe.type==="listOrdered",start:null,spread:Oe._spread,children:[]}}function Tr(Oe){return{type:"listItem",spread:Oe._spread,checked:null,children:[]}}function $r(){return{type:"paragraph",children:[]}}function bt(){return{type:"strong",children:[]}}function pi(){return{type:"text",value:""}}function Ii(){return{type:"thematicBreak"}}}function vl(i){return{line:i.line,column:i.column,offset:i.offset}}function TD(i,n){let a=-1;for(;++a<n.length;){const c=n[a];Array.isArray(c)?TD(i,c):bU(i,c)}}function bU(i,n){let a;for(a in n)if(SD.call(n,a))switch(a){case"canContainEols":{const c=n[a];c&&i[a].push(...c);break}case"transforms":{const c=n[a];c&&i[a].push(...c);break}case"enter":case"exit":{const c=n[a];c&&Object.assign(i[a],c);break}}}function gE(i,n){throw i?new Error("Cannot close `"+i.type+"` ("+Wh({start:i.start,end:i.end})+"): a different token (`"+n.type+"`, "+Wh({start:n.start,end:n.end})+") is open"):new Error("Cannot close document, a token (`"+n.type+"`, "+Wh({start:n.start,end:n.end})+") is still open")}function vU(i){const n=this;n.parser=a;function a(c){return gU(c,{...n.data("settings"),...i,extensions:n.data("micromarkExtensions")||[],mdastExtensions:n.data("fromMarkdownExtensions")||[]})}}function xU(i,n){const a={type:"element",tagName:"blockquote",properties:{},children:i.wrap(i.all(n),!0)};return i.patch(n,a),i.applyData(n,a)}function wU(i,n){const a={type:"element",tagName:"br",properties:{},children:[]};return i.patch(n,a),[i.applyData(n,a),{type:"text",value:`
`}]}function EU(i,n){const a=n.value?n.value+`
`:"",c={};n.lang&&(c.className=["language-"+n.lang]);let f={type:"element",tagName:"code",properties:c,children:[{type:"text",value:a}]};return n.meta&&(f.data={meta:n.meta}),i.patch(n,f),f=i.applyData(n,f),f={type:"element",tagName:"pre",properties:{},children:[f]},i.patch(n,f),f}function AU(i,n){const a={type:"element",tagName:"del",properties:{},children:i.all(n)};return i.patch(n,a),i.applyData(n,a)}function RU(i,n){const a={type:"element",tagName:"em",properties:{},children:i.all(n)};return i.patch(n,a),i.applyData(n,a)}function SU(i,n){const a=typeof i.options.clobberPrefix=="string"?i.options.clobberPrefix:"user-content-",c=String(n.identifier).toUpperCase(),f=$p(c.toLowerCase()),y=i.footnoteOrder.indexOf(c);let e,l=i.footnoteCounts.get(c);l===void 0?(l=0,i.footnoteOrder.push(c),e=i.footnoteOrder.length):e=y+1,l+=1,i.footnoteCounts.set(c,l);const _={type:"element",tagName:"a",properties:{href:"#"+a+"fn-"+f,id:a+"fnref-"+f+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(e)}]};i.patch(n,_);const w={type:"element",tagName:"sup",properties:{},children:[_]};return i.patch(n,w),i.applyData(n,w)}function TU(i,n){const a={type:"element",tagName:"h"+n.depth,properties:{},children:i.all(n)};return i.patch(n,a),i.applyData(n,a)}function CU(i,n){if(i.options.allowDangerousHtml){const a={type:"raw",value:n.value};return i.patch(n,a),i.applyData(n,a)}}function CD(i,n){const a=n.referenceType;let c="]";if(a==="collapsed"?c+="[]":a==="full"&&(c+="["+(n.label||n.identifier)+"]"),n.type==="imageReference")return[{type:"text",value:"!["+n.alt+c}];const f=i.all(n),y=f[0];y&&y.type==="text"?y.value="["+y.value:f.unshift({type:"text",value:"["});const e=f[f.length-1];return e&&e.type==="text"?e.value+=c:f.push({type:"text",value:c}),f}function kU(i,n){const a=String(n.identifier).toUpperCase(),c=i.definitionById.get(a);if(!c)return CD(i,n);const f={src:$p(c.url||""),alt:n.alt};c.title!==null&&c.title!==void 0&&(f.title=c.title);const y={type:"element",tagName:"img",properties:f,children:[]};return i.patch(n,y),i.applyData(n,y)}function PU(i,n){const a={src:$p(n.url)};n.alt!==null&&n.alt!==void 0&&(a.alt=n.alt),n.title!==null&&n.title!==void 0&&(a.title=n.title);const c={type:"element",tagName:"img",properties:a,children:[]};return i.patch(n,c),i.applyData(n,c)}function LU(i,n){const a={type:"text",value:n.value.replace(/\r?\n|\r/g," ")};i.patch(n,a);const c={type:"element",tagName:"code",properties:{},children:[a]};return i.patch(n,c),i.applyData(n,c)}function DU(i,n){const a=String(n.identifier).toUpperCase(),c=i.definitionById.get(a);if(!c)return CD(i,n);const f={href:$p(c.url||"")};c.title!==null&&c.title!==void 0&&(f.title=c.title);const y={type:"element",tagName:"a",properties:f,children:i.all(n)};return i.patch(n,y),i.applyData(n,y)}function IU(i,n){const a={href:$p(n.url)};n.title!==null&&n.title!==void 0&&(a.title=n.title);const c={type:"element",tagName:"a",properties:a,children:i.all(n)};return i.patch(n,c),i.applyData(n,c)}function BU(i,n,a){const c=i.all(n),f=a?MU(a):kD(n),y={},e=[];if(typeof n.checked=="boolean"){const R=c[0];let C;R&&R.type==="element"&&R.tagName==="p"?C=R:(C={type:"element",tagName:"p",properties:{},children:[]},c.unshift(C)),C.children.length>0&&C.children.unshift({type:"text",value:" "}),C.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:n.checked,disabled:!0},children:[]}),y.className=["task-list-item"]}let l=-1;for(;++l<c.length;){const R=c[l];(f||l!==0||R.type!=="element"||R.tagName!=="p")&&e.push({type:"text",value:`
`}),R.type==="element"&&R.tagName==="p"&&!f?e.push(...R.children):e.push(R)}const _=c[c.length-1];_&&(f||_.type!=="element"||_.tagName!=="p")&&e.push({type:"text",value:`
`});const w={type:"element",tagName:"li",properties:y,children:e};return i.patch(n,w),i.applyData(n,w)}function MU(i){let n=!1;if(i.type==="list"){n=i.spread||!1;const a=i.children;let c=-1;for(;!n&&++c<a.length;)n=kD(a[c])}return n}function kD(i){const n=i.spread;return n??i.children.length>1}function zU(i,n){const a={},c=i.all(n);let f=-1;for(typeof n.start=="number"&&n.start!==1&&(a.start=n.start);++f<c.length;){const e=c[f];if(e.type==="element"&&e.tagName==="li"&&e.properties&&Array.isArray(e.properties.className)&&e.properties.className.includes("task-list-item")){a.className=["contains-task-list"];break}}const y={type:"element",tagName:n.ordered?"ol":"ul",properties:a,children:i.wrap(c,!0)};return i.patch(n,y),i.applyData(n,y)}function OU(i,n){const a={type:"element",tagName:"p",properties:{},children:i.all(n)};return i.patch(n,a),i.applyData(n,a)}function VU(i,n){const a={type:"root",children:i.wrap(i.all(n))};return i.patch(n,a),i.applyData(n,a)}function UU(i,n){const a={type:"element",tagName:"strong",properties:{},children:i.all(n)};return i.patch(n,a),i.applyData(n,a)}var PD=DD("end"),LD=DD("start");function DD(i){return n;function n(a){const c=a&&a.position&&a.position[i]||{};if(typeof c.line=="number"&&c.line>0&&typeof c.column=="number"&&c.column>0)return{line:c.line,column:c.column,offset:typeof c.offset=="number"&&c.offset>-1?c.offset:void 0}}}function jU(i){const n=LD(i),a=PD(i);if(n&&a)return{start:n,end:a}}function NU(i,n){const a=i.all(n),c=a.shift(),f=[];if(c){const e={type:"element",tagName:"thead",properties:{},children:i.wrap([c],!0)};i.patch(n.children[0],e),f.push(e)}if(a.length>0){const e={type:"element",tagName:"tbody",properties:{},children:i.wrap(a,!0)},l=LD(n.children[1]),_=PD(n.children[n.children.length-1]);l&&_&&(e.position={start:l,end:_}),f.push(e)}const y={type:"element",tagName:"table",properties:{},children:i.wrap(f,!0)};return i.patch(n,y),i.applyData(n,y)}function FU(i,n,a){const c=a?a.children:void 0,y=(c?c.indexOf(n):1)===0?"th":"td",e=a&&a.type==="table"?a.align:void 0,l=e?e.length:n.children.length;let _=-1;const w=[];for(;++_<l;){const C=n.children[_],I={},L=e?e[_]:void 0;L&&(I.align=L);let O={type:"element",tagName:y,properties:I,children:[]};C&&(O.children=i.all(C),i.patch(C,O),O=i.applyData(C,O)),w.push(O)}const R={type:"element",tagName:"tr",properties:{},children:i.wrap(w,!0)};return i.patch(n,R),i.applyData(n,R)}function qU(i,n){const a={type:"element",tagName:"td",properties:{},children:i.all(n)};return i.patch(n,a),i.applyData(n,a)}var _E=9,bE=32;function KU(i){const n=String(i),a=/\r?\n|\r/g;let c=a.exec(n),f=0;const y=[];for(;c;)y.push(vE(n.slice(f,c.index),f>0,!0),c[0]),f=c.index+c[0].length,c=a.exec(n);return y.push(vE(n.slice(f),f>0,!1)),y.join("")}function vE(i,n,a){let c=0,f=i.length;if(n){let y=i.codePointAt(c);for(;y===_E||y===bE;)c++,y=i.codePointAt(c)}if(a){let y=i.codePointAt(f-1);for(;y===_E||y===bE;)f--,y=i.codePointAt(f-1)}return f>c?i.slice(c,f):""}function GU(i,n){const a={type:"text",value:KU(String(n.value))};return i.patch(n,a),i.applyData(n,a)}function $U(i,n){const a={type:"element",tagName:"hr",properties:{},children:[]};return i.patch(n,a),i.applyData(n,a)}var ZU={blockquote:xU,break:wU,code:EU,delete:AU,emphasis:RU,footnoteReference:SU,heading:TU,html:CU,imageReference:kU,image:PU,inlineCode:LU,linkReference:DU,link:IU,listItem:BU,list:zU,paragraph:OU,root:VU,strong:UU,table:NU,tableCell:qU,tableRow:FU,text:GU,thematicBreak:$U,toml:Sy,yaml:Sy,definition:Sy,footnoteDefinition:Sy};function Sy(){}var ID=-1,iv=0,Yh=1,jb=2,$x=3,Zx=4,Hx=5,Xx=6,BD=7,MD=8,xE=typeof self=="object"?self:globalThis,HU=(i,n)=>{const a=(f,y)=>(i.set(y,f),f),c=f=>{if(i.has(f))return i.get(f);const[y,e]=n[f];switch(y){case iv:case ID:return a(e,f);case Yh:{const l=a([],f);for(const _ of e)l.push(c(_));return l}case jb:{const l=a({},f);for(const[_,w]of e)l[c(_)]=c(w);return l}case $x:return a(new Date(e),f);case Zx:{const{source:l,flags:_}=e;return a(new RegExp(l,_),f)}case Hx:{const l=a(new Map,f);for(const[_,w]of e)l.set(c(_),c(w));return l}case Xx:{const l=a(new Set,f);for(const _ of e)l.add(c(_));return l}case BD:{const{name:l,message:_}=e;return a(new xE[l](_),f)}case MD:return a(BigInt(e),f);case"BigInt":return a(Object(BigInt(e)),f);case"ArrayBuffer":return a(new Uint8Array(e).buffer,e);case"DataView":{const{buffer:l}=new Uint8Array(e);return a(new DataView(l),e)}}return a(new xE[y](e),f)};return c},wE=i=>HU(new Map,i)(0),Sd="",{toString:XU}={},{keys:WU}=Object,sh=i=>{const n=typeof i;if(n!=="object"||!i)return[iv,n];const a=XU.call(i).slice(8,-1);switch(a){case"Array":return[Yh,Sd];case"Object":return[jb,Sd];case"Date":return[$x,Sd];case"RegExp":return[Zx,Sd];case"Map":return[Hx,Sd];case"Set":return[Xx,Sd];case"DataView":return[Yh,a]}return a.includes("Array")?[Yh,a]:a.includes("Error")?[BD,a]:[jb,a]},Ty=([i,n])=>i===iv&&(n==="function"||n==="symbol"),YU=(i,n,a,c)=>{const f=(e,l)=>{const _=c.push(e)-1;return a.set(l,_),_},y=e=>{if(a.has(e))return a.get(e);let[l,_]=sh(e);switch(l){case iv:{let R=e;switch(_){case"bigint":l=MD,R=e.toString();break;case"function":case"symbol":if(i)throw new TypeError("unable to serialize "+_);R=null;break;case"undefined":return f([ID],e)}return f([l,R],e)}case Yh:{if(_){let I=e;return _==="DataView"?I=new Uint8Array(e.buffer):_==="ArrayBuffer"&&(I=new Uint8Array(e)),f([_,[...I]],e)}const R=[],C=f([l,R],e);for(const I of e)R.push(y(I));return C}case jb:{if(_)switch(_){case"BigInt":return f([_,e.toString()],e);case"Boolean":case"Number":case"String":return f([_,e.valueOf()],e)}if(n&&"toJSON"in e)return y(e.toJSON());const R=[],C=f([l,R],e);for(const I of WU(e))(i||!Ty(sh(e[I])))&&R.push([y(I),y(e[I])]);return C}case $x:return f([l,e.toISOString()],e);case Zx:{const{source:R,flags:C}=e;return f([l,{source:R,flags:C}],e)}case Hx:{const R=[],C=f([l,R],e);for(const[I,L]of e)(i||!(Ty(sh(I))||Ty(sh(L))))&&R.push([y(I),y(L)]);return C}case Xx:{const R=[],C=f([l,R],e);for(const I of e)(i||!Ty(sh(I)))&&R.push(y(I));return C}}const{message:w}=e;return f([l,{name:_,message:w}],e)};return y},EE=(i,{json:n,lossy:a}={})=>{const c=[];return YU(!(n||a),!!n,new Map,c)(i),c},Nb=typeof structuredClone=="function"?((i,n)=>n&&("json"in n||"lossy"in n)?wE(EE(i,n)):structuredClone(i)):(i,n)=>wE(EE(i,n));function JU(i,n){const a=[{type:"text",value:"↩"}];return n>1&&a.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(n)}]}),a}function QU(i,n){return"Back to reference "+(i+1)+(n>1?"-"+n:"")}function ej(i){const n=typeof i.options.clobberPrefix=="string"?i.options.clobberPrefix:"user-content-",a=i.options.footnoteBackContent||JU,c=i.options.footnoteBackLabel||QU,f=i.options.footnoteLabel||"Footnotes",y=i.options.footnoteLabelTagName||"h2",e=i.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let _=-1;for(;++_<i.footnoteOrder.length;){const w=i.footnoteById.get(i.footnoteOrder[_]);if(!w)continue;const R=i.all(w),C=String(w.identifier).toUpperCase(),I=$p(C.toLowerCase());let L=0;const O=[],q=i.footnoteCounts.get(C);for(;q!==void 0&&++L<=q;){O.length>0&&O.push({type:"text",value:" "});let ne=typeof a=="string"?a:a(_,L);typeof ne=="string"&&(ne={type:"text",value:ne}),O.push({type:"element",tagName:"a",properties:{href:"#"+n+"fnref-"+I+(L>1?"-"+L:""),dataFootnoteBackref:"",ariaLabel:typeof c=="string"?c:c(_,L),className:["data-footnote-backref"]},children:Array.isArray(ne)?ne:[ne]})}const G=R[R.length-1];if(G&&G.type==="element"&&G.tagName==="p"){const ne=G.children[G.children.length-1];ne&&ne.type==="text"?ne.value+=" ":G.children.push({type:"text",value:" "}),G.children.push(...O)}else R.push(...O);const j={type:"element",tagName:"li",properties:{id:n+"fn-"+I},children:i.wrap(R,!0)};i.patch(w,j),l.push(j)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:y,properties:{...Nb(e),id:"footnote-label"},children:[{type:"text",value:f}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:i.wrap(l,!0)},{type:"text",value:`
`}]}}var zD=(function(i){if(i==null)return nj;if(typeof i=="function")return nv(i);if(typeof i=="object")return Array.isArray(i)?tj(i):rj(i);if(typeof i=="string")return ij(i);throw new Error("Expected function, string, or object as test")});function tj(i){const n=[];let a=-1;for(;++a<i.length;)n[a]=zD(i[a]);return nv(c);function c(...f){let y=-1;for(;++y<n.length;)if(n[y].apply(this,f))return!0;return!1}}function rj(i){const n=i;return nv(a);function a(c){const f=c;let y;for(y in i)if(f[y]!==n[y])return!1;return!0}}function ij(i){return nv(n);function n(a){return a&&a.type===i}}function nv(i){return n;function n(a,c,f){return!!(sj(a)&&i.call(this,a,typeof c=="number"?c:void 0,f||void 0))}}function nj(){return!0}function sj(i){return i!==null&&typeof i=="object"&&"type"in i}var OD=[],oj=!0,AE=!1,aj="skip";function lj(i,n,a,c){let f;typeof n=="function"&&typeof a!="function"?(c=a,a=n):f=n;const y=zD(f),e=c?-1:1;l(i,void 0,[])();function l(_,w,R){const C=_&&typeof _=="object"?_:{};if(typeof C.type=="string"){const L=typeof C.tagName=="string"?C.tagName:typeof C.name=="string"?C.name:void 0;Object.defineProperty(I,"name",{value:"node ("+(_.type+(L?"<"+L+">":""))+")"})}return I;function I(){let L=OD,O,q,G;if((!n||y(_,w,R[R.length-1]||void 0))&&(L=uj(a(_,R)),L[0]===AE))return L;if("children"in _&&_.children){const j=_;if(j.children&&L[0]!==aj)for(q=(c?j.children.length:-1)+e,G=R.concat(j);q>-1&&q<j.children.length;){const ne=j.children[q];if(O=l(ne,q,G)(),O[0]===AE)return O;q=typeof O[1]=="number"?O[1]:q+e}}return L}}}function uj(i){return Array.isArray(i)?i:typeof i=="number"?[oj,i]:i==null?OD:[i]}function cj(i,n,a,c){let f,y,e;typeof n=="function"&&typeof a!="function"?(y=void 0,e=n,f=a):(y=n,e=a,f=c),lj(i,y,l,f);function l(_,w){const R=w[w.length-1],C=R?R.children.indexOf(_):void 0;return e(_,C,R)}}var gx={}.hasOwnProperty,dj={};function pj(i,n){const a=n||dj,c=new Map,f=new Map,y=new Map,e={...ZU,...a.handlers},l={all:w,applyData:hj,definitionById:c,footnoteById:f,footnoteCounts:y,footnoteOrder:[],handlers:e,one:_,options:a,patch:fj,wrap:yj};return cj(i,function(R){if(R.type==="definition"||R.type==="footnoteDefinition"){const C=R.type==="definition"?c:f,I=String(R.identifier).toUpperCase();C.has(I)||C.set(I,R)}}),l;function _(R,C){const I=R.type,L=l.handlers[I];if(gx.call(l.handlers,I)&&L)return L(l,R,C);if(l.options.passThrough&&l.options.passThrough.includes(I)){if("children"in R){const{children:q,...G}=R,j=Nb(G);return j.children=l.all(R),j}return Nb(R)}return(l.options.unknownHandler||mj)(l,R,C)}function w(R){const C=[];if("children"in R){const I=R.children;let L=-1;for(;++L<I.length;){const O=l.one(I[L],R);if(O){if(L&&I[L-1].type==="break"&&(!Array.isArray(O)&&O.type==="text"&&(O.value=RE(O.value)),!Array.isArray(O)&&O.type==="element")){const q=O.children[0];q&&q.type==="text"&&(q.value=RE(q.value))}Array.isArray(O)?C.push(...O):C.push(O)}}}return C}}function fj(i,n){i.position&&(n.position=jU(i))}function hj(i,n){let a=n;if(i&&i.data){const c=i.data.hName,f=i.data.hChildren,y=i.data.hProperties;if(typeof c=="string")if(a.type==="element")a.tagName=c;else{const e="children"in a?a.children:[a];a={type:"element",tagName:c,properties:{},children:e}}a.type==="element"&&y&&Object.assign(a.properties,Nb(y)),"children"in a&&a.children&&f!==null&&f!==void 0&&(a.children=f)}return a}function mj(i,n){const a=n.data||{},c="value"in n&&!(gx.call(a,"hProperties")||gx.call(a,"hChildren"))?{type:"text",value:n.value}:{type:"element",tagName:"div",properties:{},children:i.all(n)};return i.patch(n,c),i.applyData(n,c)}function yj(i,n){const a=[];let c=-1;for(n&&a.push({type:"text",value:`
`});++c<i.length;)c&&a.push({type:"text",value:`
`}),a.push(i[c]);return n&&i.length>0&&a.push({type:"text",value:`
`}),a}function RE(i){let n=0,a=i.charCodeAt(n);for(;a===9||a===32;)n++,a=i.charCodeAt(n);return i.slice(n)}function SE(i,n){const a=pj(i,n),c=a.one(i,void 0),f=ej(a),y=Array.isArray(c)?{type:"root",children:c}:c||{type:"root",children:[]};return f&&y.children.push({type:"text",value:`
`},f),y}function gj(i,n){return i&&"run"in i?async function(a,c){const f=SE(a,{file:c,...n});await i.run(f,c)}:function(a,c){return SE(a,{file:c,...i||n})}}function TE(i){if(i)throw i}var E0=fO(hO());function _x(i){if(typeof i!="object"||i===null)return!1;const n=Object.getPrototypeOf(i);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)}function _j(){const i=[],n={run:a,use:c};return n;function a(...f){let y=-1;const e=f.pop();if(typeof e!="function")throw new TypeError("Expected function as last argument, not "+e);l(null,...f);function l(_,...w){const R=i[++y];let C=-1;if(_){e(_);return}for(;++C<f.length;)(w[C]===null||w[C]===void 0)&&(w[C]=f[C]);f=w,R?bj(R,l)(...w):e(null,...w)}}function c(f){if(typeof f!="function")throw new TypeError("Expected `middelware` to be a function, not "+f);return i.push(f),n}}function bj(i,n){let a;return c;function c(...e){const l=i.length>e.length;let _;l&&e.push(f);try{_=i.apply(this,e)}catch(w){const R=w;if(l&&a)throw R;return f(R)}l||(_&&_.then&&typeof _.then=="function"?_.then(y,f):_ instanceof Error?f(_):y(_))}function f(e,...l){a||(a=!0,n(e,...l))}function y(e){f(null,e)}}var Rs=class extends Error{constructor(i,n,a){super(),typeof n=="string"&&(a=n,n=void 0);let c="",f={},y=!1;if(n&&("line"in n&&"column"in n?f={place:n}:"start"in n&&"end"in n?f={place:n}:"type"in n?f={ancestors:[n],place:n.position}:f={...n}),typeof i=="string"?c=i:!f.cause&&i&&(y=!0,c=i.message,f.cause=i),!f.ruleId&&!f.source&&typeof a=="string"){const l=a.indexOf(":");l===-1?f.ruleId=a:(f.source=a.slice(0,l),f.ruleId=a.slice(l+1))}if(!f.place&&f.ancestors&&f.ancestors){const l=f.ancestors[f.ancestors.length-1];l&&(f.place=l.position)}const e=f.place&&"start"in f.place?f.place.start:f.place;this.ancestors=f.ancestors||void 0,this.cause=f.cause||void 0,this.column=e?e.column:void 0,this.fatal=void 0,this.file="",this.message=c,this.line=e?e.line:void 0,this.name=Wh(f.place)||"1:1",this.place=f.place||void 0,this.reason=this.message,this.ruleId=f.ruleId||void 0,this.source=f.source||void 0,this.stack=y&&f.cause&&typeof f.cause.stack=="string"?f.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}};Rs.prototype.file="";Rs.prototype.name="";Rs.prototype.reason="";Rs.prototype.message="";Rs.prototype.stack="";Rs.prototype.column=void 0;Rs.prototype.line=void 0;Rs.prototype.ancestors=void 0;Rs.prototype.cause=void 0;Rs.prototype.fatal=void 0;Rs.prototype.place=void 0;Rs.prototype.ruleId=void 0;Rs.prototype.source=void 0;var ra={basename:vj,dirname:xj,extname:wj,join:Ej,sep:"/"};function vj(i,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');cm(i);let a=0,c=-1,f=i.length,y;if(n===void 0||n.length===0||n.length>i.length){for(;f--;)if(i.codePointAt(f)===47){if(y){a=f+1;break}}else c<0&&(y=!0,c=f+1);return c<0?"":i.slice(a,c)}if(n===i)return"";let e=-1,l=n.length-1;for(;f--;)if(i.codePointAt(f)===47){if(y){a=f+1;break}}else e<0&&(y=!0,e=f+1),l>-1&&(i.codePointAt(f)===n.codePointAt(l--)?l<0&&(c=f):(l=-1,c=e));return a===c?c=e:c<0&&(c=i.length),i.slice(a,c)}function xj(i){if(cm(i),i.length===0)return".";let n=-1,a=i.length,c;for(;--a;)if(i.codePointAt(a)===47){if(c){n=a;break}}else c||(c=!0);return n<0?i.codePointAt(0)===47?"/":".":n===1&&i.codePointAt(0)===47?"//":i.slice(0,n)}function wj(i){cm(i);let n=i.length,a=-1,c=0,f=-1,y=0,e;for(;n--;){const l=i.codePointAt(n);if(l===47){if(e){c=n+1;break}continue}a<0&&(e=!0,a=n+1),l===46?f<0?f=n:y!==1&&(y=1):f>-1&&(y=-1)}return f<0||a<0||y===0||y===1&&f===a-1&&f===c+1?"":i.slice(f,a)}function Ej(...i){let n=-1,a;for(;++n<i.length;)cm(i[n]),i[n]&&(a=a===void 0?i[n]:a+"/"+i[n]);return a===void 0?".":Aj(a)}function Aj(i){cm(i);const n=i.codePointAt(0)===47;let a=Rj(i,!n);return a.length===0&&!n&&(a="."),a.length>0&&i.codePointAt(i.length-1)===47&&(a+="/"),n?"/"+a:a}function Rj(i,n){let a="",c=0,f=-1,y=0,e=-1,l,_;for(;++e<=i.length;){if(e<i.length)l=i.codePointAt(e);else{if(l===47)break;l=47}if(l===47){if(!(f===e-1||y===1))if(f!==e-1&&y===2){if(a.length<2||c!==2||a.codePointAt(a.length-1)!==46||a.codePointAt(a.length-2)!==46){if(a.length>2){if(_=a.lastIndexOf("/"),_!==a.length-1){_<0?(a="",c=0):(a=a.slice(0,_),c=a.length-1-a.lastIndexOf("/")),f=e,y=0;continue}}else if(a.length>0){a="",c=0,f=e,y=0;continue}}n&&(a=a.length>0?a+"/..":"..",c=2)}else a.length>0?a+="/"+i.slice(f+1,e):a=i.slice(f+1,e),c=e-f-1;f=e,y=0}else l===46&&y>-1?y++:y=-1}return a}function cm(i){if(typeof i!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(i))}var Sj={cwd:Tj};function Tj(){return"/"}function bx(i){return!!(i!==null&&typeof i=="object"&&"href"in i&&i.href&&"protocol"in i&&i.protocol&&i.auth===void 0)}function Cj(i){if(typeof i=="string")i=new URL(i);else if(!bx(i)){const n=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+i+"`");throw n.code="ERR_INVALID_ARG_TYPE",n}if(i.protocol!=="file:"){const n=new TypeError("The URL must be of scheme file");throw n.code="ERR_INVALID_URL_SCHEME",n}return kj(i)}function kj(i){if(i.hostname!==""){const c=new TypeError('File URL host must be "localhost" or empty on darwin');throw c.code="ERR_INVALID_FILE_URL_HOST",c}const n=i.pathname;let a=-1;for(;++a<n.length;)if(n.codePointAt(a)===37&&n.codePointAt(a+1)===50){const c=n.codePointAt(a+2);if(c===70||c===102){const f=new TypeError("File URL path must not include encoded / characters");throw f.code="ERR_INVALID_FILE_URL_PATH",f}}return decodeURIComponent(n)}var A0=["history","path","basename","stem","extname","dirname"],Pj=class{constructor(i){let n;i?bx(i)?n={path:i}:typeof i=="string"||Lj(i)?n={value:i}:n=i:n={},this.cwd="cwd"in n?"":Sj.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let a=-1;for(;++a<A0.length;){const f=A0[a];f in n&&n[f]!==void 0&&n[f]!==null&&(this[f]=f==="history"?[...n[f]]:n[f])}let c;for(c in n)A0.includes(c)||(this[c]=n[c])}get basename(){return typeof this.path=="string"?ra.basename(this.path):void 0}set basename(i){S0(i,"basename"),R0(i,"basename"),this.path=ra.join(this.dirname||"",i)}get dirname(){return typeof this.path=="string"?ra.dirname(this.path):void 0}set dirname(i){CE(this.basename,"dirname"),this.path=ra.join(i||"",this.basename)}get extname(){return typeof this.path=="string"?ra.extname(this.path):void 0}set extname(i){if(R0(i,"extname"),CE(this.dirname,"extname"),i){if(i.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(i.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=ra.join(this.dirname,this.stem+(i||""))}get path(){return this.history[this.history.length-1]}set path(i){bx(i)&&(i=Cj(i)),S0(i,"path"),this.path!==i&&this.history.push(i)}get stem(){return typeof this.path=="string"?ra.basename(this.path,this.extname):void 0}set stem(i){S0(i,"stem"),R0(i,"stem"),this.path=ra.join(this.dirname||"",i+(this.extname||""))}fail(i,n,a){const c=this.message(i,n,a);throw c.fatal=!0,c}info(i,n,a){const c=this.message(i,n,a);return c.fatal=void 0,c}message(i,n,a){const c=new Rs(i,n,a);return this.path&&(c.name=this.path+":"+c.name,c.file=this.path),c.fatal=!1,this.messages.push(c),c}toString(i){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(i||void 0).decode(this.value)}};function R0(i,n){if(i&&i.includes(ra.sep))throw new Error("`"+n+"` cannot be a path: did not expect `"+ra.sep+"`")}function S0(i,n){if(!i)throw new Error("`"+n+"` cannot be empty")}function CE(i,n){if(!i)throw new Error("Setting `"+n+"` requires `path` to be set too")}function Lj(i){return!!(i&&typeof i=="object"&&"byteLength"in i&&"byteOffset"in i)}var Dj=(function(i){const c=this.constructor.prototype,f=c[i],y=function(){return f.apply(y,arguments)};return Object.setPrototypeOf(y,c),y}),Ij={}.hasOwnProperty,Bj=class VD extends Dj{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=_j()}copy(){const n=new VD;let a=-1;for(;++a<this.attachers.length;){const c=this.attachers[a];n.use(...c)}return n.data((0,E0.default)(!0,{},this.namespace)),n}data(n,a){return typeof n=="string"?arguments.length===2?(k0("data",this.frozen),this.namespace[n]=a,this):Ij.call(this.namespace,n)&&this.namespace[n]||void 0:n?(k0("data",this.frozen),this.namespace=n,this):this.namespace}freeze(){if(this.frozen)return this;const n=this;for(;++this.freezeIndex<this.attachers.length;){const[a,...c]=this.attachers[this.freezeIndex];if(c[0]===!1)continue;c[0]===!0&&(c[0]=void 0);const f=a.call(n,...c);typeof f=="function"&&this.transformers.use(f)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(n){this.freeze();const a=Cy(n),c=this.parser||this.Parser;return T0("parse",c),c(String(a),a)}process(n,a){const c=this;return this.freeze(),T0("process",this.parser||this.Parser),C0("process",this.compiler||this.Compiler),a?f(void 0,a):new Promise(f);function f(y,e){const l=Cy(n),_=c.parse(l);c.run(_,l,function(R,C,I){if(R||!C||!I)return w(R);const L=C,O=c.stringify(L,I);Oj(O)?I.value=O:I.result=O,w(R,I)});function w(R,C){R||!C?e(R):y?y(C):a(void 0,C)}}}processSync(n){let a=!1,c;return this.freeze(),T0("processSync",this.parser||this.Parser),C0("processSync",this.compiler||this.Compiler),this.process(n,f),PE("processSync","process",a),c;function f(y,e){a=!0,TE(y),c=e}}run(n,a,c){kE(n),this.freeze();const f=this.transformers;return!c&&typeof a=="function"&&(c=a,a=void 0),c?y(void 0,c):new Promise(y);function y(e,l){const _=Cy(a);f.run(n,_,w);function w(R,C,I){const L=C||n;R?l(R):e?e(L):c(void 0,L,I)}}}runSync(n,a){let c=!1,f;return this.run(n,a,y),PE("runSync","run",c),f;function y(e,l){TE(e),f=l,c=!0}}stringify(n,a){this.freeze();const c=Cy(a),f=this.compiler||this.Compiler;return C0("stringify",f),kE(n),f(n,c)}use(n,...a){const c=this.attachers,f=this.namespace;if(k0("use",this.frozen),n!=null)if(typeof n=="function")_(n,a);else if(typeof n=="object")Array.isArray(n)?l(n):e(n);else throw new TypeError("Expected usable value, not `"+n+"`");return this;function y(w){if(typeof w=="function")_(w,[]);else if(typeof w=="object")if(Array.isArray(w)){const[R,...C]=w;_(R,C)}else e(w);else throw new TypeError("Expected usable value, not `"+w+"`")}function e(w){if(!("plugins"in w)&&!("settings"in w))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(w.plugins),w.settings&&(f.settings=(0,E0.default)(!0,f.settings,w.settings))}function l(w){let R=-1;if(w!=null)if(Array.isArray(w))for(;++R<w.length;){const C=w[R];y(C)}else throw new TypeError("Expected a list of plugins, not `"+w+"`")}function _(w,R){let C=-1,I=-1;for(;++C<c.length;)if(c[C][0]===w){I=C;break}if(I===-1)c.push([w,...R]);else if(R.length>0){let[L,...O]=R;const q=c[I][1];_x(q)&&_x(L)&&(L=(0,E0.default)(!0,q,L)),c[I]=[w,L,...O]}}}},Mj=new Bj().freeze();function T0(i,n){if(typeof n!="function")throw new TypeError("Cannot `"+i+"` without `parser`")}function C0(i,n){if(typeof n!="function")throw new TypeError("Cannot `"+i+"` without `compiler`")}function k0(i,n){if(n)throw new Error("Cannot call `"+i+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function kE(i){if(!_x(i)||typeof i.type!="string")throw new TypeError("Expected node, got `"+i+"`")}function PE(i,n,a){if(!a)throw new Error("`"+i+"` finished async. Use `"+n+"` instead")}function Cy(i){return zj(i)?i:new Pj(i)}function zj(i){return!!(i&&typeof i=="object"&&"message"in i&&"messages"in i)}function Oj(i){return typeof i=="string"||Vj(i)}function Vj(i){return!!(i&&typeof i=="object"&&"byteLength"in i&&"byteOffset"in i)}var vx=i=>i!=null,Uj=i=>i.replace(/[A-Z]/g,n=>`-${n.toLowerCase()}`),jj=i=>{i.type!=="element"||i.properties===void 0||!Array.isArray(i.properties.className)||(i.properties.class=i.properties.className.join(" "),delete i.properties.className)},Nj=i=>{if(i.type!=="element"||i.properties===void 0)return;const n=Object.keys(i.properties).filter(a=>a.startsWith("aria"));for(const a of n){const c=i.properties[a];delete i.properties[a],i.properties[Uj(a)]=c}},Fj=i=>{jj(i),Nj(i)},UD=(i,n)=>{i(n),n.children?.forEach(a=>UD(i,a))},qj=()=>(i,n,a)=>{try{UD(Fj,i),a()}catch(c){return c instanceof Error?a(c):a(new Error(String(c)))}},Kj=i=>{const n=Mj().use(vU).use(i.map(a=>a.remarkPlugin).filter(vx)).use(gj,{allowDangerousHtml:!0}).use(i.map(a=>a.rehypePlugin).filter(vx)).use(qj);return a=>n.runSync(n.parse(a),a)},jD=(i,n,a=[])=>{if(a.includes(n))throw a.push(n),new Error(`Circular dependency detected: ${a.join(" -> ")}`);const c=i[n];return typeof c=="string"?jD(i,c,[...a,n]):c===null?null:c===void 0?n:c},LE=i=>i.map(n=>n.renderer).filter(vx).reduce((n,a)=>({...n,...a}),{}),xx=Symbol.for("snippetRenderer"),Gj=i=>{const n=i;return n[xx]=!0,n};const oh=(i,n=sm)=>{var a=yi(),c=Hr(a);oc(c,17,n,sc,(f,y)=>{ND(f,{get astNode(){return Ie(y)}})}),wr(i,a)};function ND(i,n){Gn(n,!0);const a=rO(),c=dD(n.astNode);SL(()=>{c.current=n.astNode}),sO(c);const f="svg";n.astNode.type==="element"&&n.astNode.tagName==="svg"&&gc(f,!0);var y=yi(),e=Hr(y);{var l=w=>{oh(w,()=>n.astNode.children)},_=w=>{var R=yi(),C=Hr(R);{var I=O=>{const q=Xr(()=>jD(a.current,n.astNode.tagName));var G=yi(),j=Hr(G);{var ne=Q=>{var Be=yi(),we=Hr(Be);{var ze=gt=>{const st=Xr(()=>Ie(q));var nt=yi(),rt=Hr(nt);{var ee=de=>{var me=yi(),tt=Hr(me);Hh(tt,()=>Ie(st),!0,(yt,lt)=>{Bp(yt,()=>({xmlns:"http://www.w3.org/2000/svg",...n.astNode.properties})),oh(lt,()=>n.astNode.children)}),wr(de,me)},Le=de=>{var me=yi(),tt=Hr(me);Hh(tt,()=>Ie(st),!0,(yt,lt)=>{Bp(yt,()=>({xmlns:"http://www.w3.org/2000/svg",...n.astNode.properties}))}),wr(de,me)};wn(rt,de=>{Array.isArray(n.astNode.children)&&n.astNode.children.length!==0?de(ee):de(Le,!1)})}wr(gt,nt)},et=gt=>{var st=yi(),nt=Hr(st);{var rt=Le=>{var de=yi(),me=Hr(de);Hh(me,()=>Ie(q),!1,(tt,yt)=>{Bp(tt,()=>({...n.astNode.properties})),oh(yt,()=>n.astNode.children)}),wr(Le,de)},ee=Le=>{var de=yi(),me=Hr(de);Hh(me,()=>Ie(q),!1,(tt,yt)=>{Bp(tt,()=>({...n.astNode.properties}))}),wr(Le,de)};wn(nt,Le=>{Array.isArray(n.astNode.children)&&n.astNode.children.length!==0?Le(rt):Le(ee,!1)},!0)}wr(gt,st)};wn(we,gt=>{yc(f)?gt(ze):gt(et,!1)})}wr(Q,Be)},he=Q=>{var Be=yi(),we=Hr(Be);{var ze=et=>{var gt=yi(),st=Hr(gt);{var nt=ee=>{var Le=yi(),de=Hr(Le);{var me=yt=>{var lt=yi();const ge=Ut=>{oh(Ut,()=>n.astNode.children)};var Gt=Hr(lt);{let Ut=Xr(()=>({...n.astNode.properties,children:ge}));rm(Gt,()=>Ie(q),()=>Ie(Ut))}wr(yt,lt)},tt=yt=>{var lt=yi(),ge=Hr(lt);rm(ge,()=>Ie(q),()=>n.astNode.properties),wr(yt,lt)};wn(de,yt=>{Array.isArray(n.astNode.children)&&n.astNode.children.length!==0?yt(me):yt(tt,!1)})}wr(ee,Le)},rt=ee=>{var Le=yi(),de=Hr(Le);{var me=yt=>{var lt=yi(),ge=Hr(lt);Xw(ge,()=>Ie(q),(Gt,Ut)=>{Ut(Gt,dx(()=>n.astNode.properties,{children:(Ce,ar)=>{oh(Ce,()=>n.astNode.children)},$$slots:{default:!0}}))}),wr(yt,lt)},tt=yt=>{var lt=yi(),ge=Hr(lt);Xw(ge,()=>Ie(q),(Gt,Ut)=>{Ut(Gt,dx(()=>n.astNode.properties))}),wr(yt,lt)};wn(de,yt=>{Array.isArray(n.astNode.children)&&n.astNode.children.length!==0?yt(me):yt(tt,!1)},!0)}wr(ee,Le)};wn(st,ee=>{xx in Ie(q)&&Ie(q)[xx]?ee(nt):ee(rt,!1)})}wr(et,gt)};wn(we,et=>{Ie(q)!==null&&et(ze)},!0)}wr(Q,Be)};wn(j,Q=>{typeof Ie(q)=="string"?Q(ne):Q(he,!1)})}wr(O,G)},L=O=>{var q=yi(),G=Hr(q);{var j=ne=>{var he=Dz();ko(()=>lc(he,n.astNode.value)),wr(ne,he)};wn(G,ne=>{(n.astNode.type==="text"||n.astNode.type==="raw")&&ne(j)},!0)}wr(O,q)};wn(C,O=>{n.astNode.type==="element"?O(I):O(L,!1)},!0)}wr(w,R)};wn(e,w=>{n.astNode.type==="root"?w(l):w(_,!1)})}wr(i,y),$n()}function $j(i,n){Gn(n,!0);let a=Ct(n,"plugins",19,()=>[]),c=QL(n,["$$slots","$$events","$$legacy","md","plugins"]),f=Xr(()=>({renderer:Object.fromEntries(Object.entries(c).map(([_,w])=>{if(typeof w=="string")return[_,w];if(typeof w=="function")return[_,Gj(w)]}).filter(_=>_!=null))})),y=Xr(()=>Kj(a()));const e=dD(LE([...a(),Ie(f)]));bi(()=>{e.current=LE([...a(),Ie(f)])}),iO(e);let l=Xr(()=>Ie(y)(n.md));ND(i,{get astNode(){return Ie(l)}}),$n()}var Mu={},zu={},P0={},_o={},Ou={},Pa={},ky={},La={},L0={},DE;function sv(){return DE||(DE=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.getParsedType=i.ZodParsedType=i.objectUtil=i.util=void 0;var n;(function(f){f.assertEqual=_=>{};function y(_){}f.assertIs=y;function e(_){throw new Error}f.assertNever=e,f.arrayToEnum=_=>{const w={};for(const R of _)w[R]=R;return w},f.getValidEnumValues=_=>{const w=f.objectKeys(_).filter(C=>typeof _[_[C]]!="number"),R={};for(const C of w)R[C]=_[C];return f.objectValues(R)},f.objectValues=_=>f.objectKeys(_).map(function(w){return _[w]}),f.objectKeys=typeof Object.keys=="function"?_=>Object.keys(_):_=>{const w=[];for(const R in _)Object.prototype.hasOwnProperty.call(_,R)&&w.push(R);return w},f.find=(_,w)=>{for(const R of _)if(w(R))return R},f.isInteger=typeof Number.isInteger=="function"?_=>Number.isInteger(_):_=>typeof _=="number"&&Number.isFinite(_)&&Math.floor(_)===_;function l(_,w=" | "){return _.map(R=>typeof R=="string"?`'${R}'`:R).join(w)}f.joinValues=l,f.jsonStringifyReplacer=(_,w)=>typeof w=="bigint"?w.toString():w})(n||(i.util=n={}));var a;(function(f){f.mergeShapes=(y,e)=>({...y,...e})})(a||(i.objectUtil=a={})),i.ZodParsedType=n.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]);const c=f=>{switch(typeof f){case"undefined":return i.ZodParsedType.undefined;case"string":return i.ZodParsedType.string;case"number":return Number.isNaN(f)?i.ZodParsedType.nan:i.ZodParsedType.number;case"boolean":return i.ZodParsedType.boolean;case"function":return i.ZodParsedType.function;case"bigint":return i.ZodParsedType.bigint;case"symbol":return i.ZodParsedType.symbol;case"object":return Array.isArray(f)?i.ZodParsedType.array:f===null?i.ZodParsedType.null:f.then&&typeof f.then=="function"&&f.catch&&typeof f.catch=="function"?i.ZodParsedType.promise:typeof Map<"u"&&f instanceof Map?i.ZodParsedType.map:typeof Set<"u"&&f instanceof Set?i.ZodParsedType.set:typeof Date<"u"&&f instanceof Date?i.ZodParsedType.date:i.ZodParsedType.object;default:return i.ZodParsedType.unknown}};i.getParsedType=c})(L0)),L0}var IE;function Wx(){if(IE)return La;IE=1,Object.defineProperty(La,"__esModule",{value:!0}),La.ZodError=La.quotelessJson=La.ZodIssueCode=void 0;const i=sv();La.ZodIssueCode=i.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);const n=c=>JSON.stringify(c,null,2).replace(/"([^"]+)":/g,"$1:");La.quotelessJson=n;let a=class FD extends Error{get errors(){return this.issues}constructor(f){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const y=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,y):this.__proto__=y,this.name="ZodError",this.issues=f}format(f){const y=f||function(_){return _.message},e={_errors:[]},l=_=>{for(const w of _.issues)if(w.code==="invalid_union")w.unionErrors.map(l);else if(w.code==="invalid_return_type")l(w.returnTypeError);else if(w.code==="invalid_arguments")l(w.argumentsError);else if(w.path.length===0)e._errors.push(y(w));else{let R=e,C=0;for(;C<w.path.length;){const I=w.path[C];C===w.path.length-1?(R[I]=R[I]||{_errors:[]},R[I]._errors.push(y(w))):R[I]=R[I]||{_errors:[]},R=R[I],C++}}};return l(this),e}static assert(f){if(!(f instanceof FD))throw new Error(`Not a ZodError: ${f}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,i.util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(f=y=>y.message){const y={},e=[];for(const l of this.issues)if(l.path.length>0){const _=l.path[0];y[_]=y[_]||[],y[_].push(f(l))}else e.push(f(l));return{formErrors:e,fieldErrors:y}}get formErrors(){return this.flatten()}};return La.ZodError=a,a.create=c=>new a(c),La}var BE;function qD(){if(BE)return ky;BE=1,Object.defineProperty(ky,"__esModule",{value:!0});const i=Wx(),n=sv(),a=(c,f)=>{let y;switch(c.code){case i.ZodIssueCode.invalid_type:c.received===n.ZodParsedType.undefined?y="Required":y=`Expected ${c.expected}, received ${c.received}`;break;case i.ZodIssueCode.invalid_literal:y=`Invalid literal value, expected ${JSON.stringify(c.expected,n.util.jsonStringifyReplacer)}`;break;case i.ZodIssueCode.unrecognized_keys:y=`Unrecognized key(s) in object: ${n.util.joinValues(c.keys,", ")}`;break;case i.ZodIssueCode.invalid_union:y="Invalid input";break;case i.ZodIssueCode.invalid_union_discriminator:y=`Invalid discriminator value. Expected ${n.util.joinValues(c.options)}`;break;case i.ZodIssueCode.invalid_enum_value:y=`Invalid enum value. Expected ${n.util.joinValues(c.options)}, received '${c.received}'`;break;case i.ZodIssueCode.invalid_arguments:y="Invalid function arguments";break;case i.ZodIssueCode.invalid_return_type:y="Invalid function return type";break;case i.ZodIssueCode.invalid_date:y="Invalid date";break;case i.ZodIssueCode.invalid_string:typeof c.validation=="object"?"includes"in c.validation?(y=`Invalid input: must include "${c.validation.includes}"`,typeof c.validation.position=="number"&&(y=`${y} at one or more positions greater than or equal to ${c.validation.position}`)):"startsWith"in c.validation?y=`Invalid input: must start with "${c.validation.startsWith}"`:"endsWith"in c.validation?y=`Invalid input: must end with "${c.validation.endsWith}"`:n.util.assertNever(c.validation):c.validation!=="regex"?y=`Invalid ${c.validation}`:y="Invalid";break;case i.ZodIssueCode.too_small:c.type==="array"?y=`Array must contain ${c.exact?"exactly":c.inclusive?"at least":"more than"} ${c.minimum} element(s)`:c.type==="string"?y=`String must contain ${c.exact?"exactly":c.inclusive?"at least":"over"} ${c.minimum} character(s)`:c.type==="number"?y=`Number must be ${c.exact?"exactly equal to ":c.inclusive?"greater than or equal to ":"greater than "}${c.minimum}`:c.type==="bigint"?y=`Number must be ${c.exact?"exactly equal to ":c.inclusive?"greater than or equal to ":"greater than "}${c.minimum}`:c.type==="date"?y=`Date must be ${c.exact?"exactly equal to ":c.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(c.minimum))}`:y="Invalid input";break;case i.ZodIssueCode.too_big:c.type==="array"?y=`Array must contain ${c.exact?"exactly":c.inclusive?"at most":"less than"} ${c.maximum} element(s)`:c.type==="string"?y=`String must contain ${c.exact?"exactly":c.inclusive?"at most":"under"} ${c.maximum} character(s)`:c.type==="number"?y=`Number must be ${c.exact?"exactly":c.inclusive?"less than or equal to":"less than"} ${c.maximum}`:c.type==="bigint"?y=`BigInt must be ${c.exact?"exactly":c.inclusive?"less than or equal to":"less than"} ${c.maximum}`:c.type==="date"?y=`Date must be ${c.exact?"exactly":c.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(c.maximum))}`:y="Invalid input";break;case i.ZodIssueCode.custom:y="Invalid input";break;case i.ZodIssueCode.invalid_intersection_types:y="Intersection results could not be merged";break;case i.ZodIssueCode.not_multiple_of:y=`Number must be a multiple of ${c.multipleOf}`;break;case i.ZodIssueCode.not_finite:y="Number must be finite";break;default:y=f.defaultError,n.util.assertNever(c)}return{message:y}};return ky.default=a,ky}var ME;function Yx(){if(ME)return Pa;ME=1;var i=Pa&&Pa.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(Pa,"__esModule",{value:!0}),Pa.defaultErrorMap=void 0,Pa.setErrorMap=c,Pa.getErrorMap=f;const n=i(qD());Pa.defaultErrorMap=n.default;let a=n.default;function c(y){a=y}function f(){return a}return Pa}var ah={},zE;function KD(){return zE||(zE=1,(function(i){var n=ah&&ah.__importDefault||function(L){return L&&L.__esModule?L:{default:L}};Object.defineProperty(i,"__esModule",{value:!0}),i.isAsync=i.isValid=i.isDirty=i.isAborted=i.OK=i.DIRTY=i.INVALID=i.ParseStatus=i.EMPTY_PATH=i.makeIssue=void 0,i.addIssueToContext=y;const a=Yx(),c=n(qD()),f=L=>{const{data:O,path:q,errorMaps:G,issueData:j}=L,ne=[...q,...j.path||[]],he={...j,path:ne};if(j.message!==void 0)return{...j,path:ne,message:j.message};let Q="";const Be=G.filter(we=>!!we).slice().reverse();for(const we of Be)Q=we(he,{data:O,defaultError:Q}).message;return{...j,path:ne,message:Q}};i.makeIssue=f,i.EMPTY_PATH=[];function y(L,O){const q=(0,a.getErrorMap)(),G=(0,i.makeIssue)({issueData:O,data:L.data,path:L.path,errorMaps:[L.common.contextualErrorMap,L.schemaErrorMap,q,q===c.default?void 0:c.default].filter(j=>!!j)});L.common.issues.push(G)}class e{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(O,q){const G=[];for(const j of q){if(j.status==="aborted")return i.INVALID;j.status==="dirty"&&O.dirty(),G.push(j.value)}return{status:O.value,value:G}}static async mergeObjectAsync(O,q){const G=[];for(const j of q){const ne=await j.key,he=await j.value;G.push({key:ne,value:he})}return e.mergeObjectSync(O,G)}static mergeObjectSync(O,q){const G={};for(const j of q){const{key:ne,value:he}=j;if(ne.status==="aborted"||he.status==="aborted")return i.INVALID;ne.status==="dirty"&&O.dirty(),he.status==="dirty"&&O.dirty(),ne.value!=="__proto__"&&(typeof he.value<"u"||j.alwaysSet)&&(G[ne.value]=he.value)}return{status:O.value,value:G}}}i.ParseStatus=e,i.INVALID=Object.freeze({status:"aborted"});const l=L=>({status:"dirty",value:L});i.DIRTY=l;const _=L=>({status:"valid",value:L});i.OK=_;const w=L=>L.status==="aborted";i.isAborted=w;const R=L=>L.status==="dirty";i.isDirty=R;const C=L=>L.status==="valid";i.isValid=C;const I=L=>typeof Promise<"u"&&L instanceof Promise;i.isAsync=I})(ah)),ah}var D0={},OE;function Zj(){return OE||(OE=1,Object.defineProperty(D0,"__esModule",{value:!0})),D0}var He={},lh={},VE;function Hj(){if(VE)return lh;VE=1,Object.defineProperty(lh,"__esModule",{value:!0}),lh.errorUtil=void 0;var i;return(function(n){n.errToObj=a=>typeof a=="string"?{message:a}:a||{},n.toString=a=>typeof a=="string"?a:a?.message})(i||(lh.errorUtil=i={})),lh}var UE;function Xj(){if(UE)return He;UE=1,Object.defineProperty(He,"__esModule",{value:!0}),He.discriminatedUnion=He.date=He.boolean=He.bigint=He.array=He.any=He.coerce=He.ZodFirstPartyTypeKind=He.late=He.ZodSchema=He.Schema=He.ZodReadonly=He.ZodPipeline=He.ZodBranded=He.BRAND=He.ZodNaN=He.ZodCatch=He.ZodDefault=He.ZodNullable=He.ZodOptional=He.ZodTransformer=He.ZodEffects=He.ZodPromise=He.ZodNativeEnum=He.ZodEnum=He.ZodLiteral=He.ZodLazy=He.ZodFunction=He.ZodSet=He.ZodMap=He.ZodRecord=He.ZodTuple=He.ZodIntersection=He.ZodDiscriminatedUnion=He.ZodUnion=He.ZodObject=He.ZodArray=He.ZodVoid=He.ZodNever=He.ZodUnknown=He.ZodAny=He.ZodNull=He.ZodUndefined=He.ZodSymbol=He.ZodDate=He.ZodBoolean=He.ZodBigInt=He.ZodNumber=He.ZodString=He.ZodType=void 0,He.NEVER=He.void=He.unknown=He.union=He.undefined=He.tuple=He.transformer=He.symbol=He.string=He.strictObject=He.set=He.record=He.promise=He.preprocess=He.pipeline=He.ostring=He.optional=He.onumber=He.oboolean=He.object=He.number=He.nullable=He.null=He.never=He.nativeEnum=He.nan=He.map=He.literal=He.lazy=He.intersection=He.instanceof=He.function=He.enum=He.effect=void 0,He.datetimeRegex=ee,He.custom=ht;const i=Wx(),n=Yx(),a=Hj(),c=KD(),f=sv();class y{constructor(U,te,oe,ke){this._cachedPath=[],this.parent=U,this.data=te,this._path=oe,this._key=ke}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const e=(Te,U)=>{if((0,c.isValid)(U))return{success:!0,data:U.value};if(!Te.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const te=new i.ZodError(Te.common.issues);return this._error=te,this._error}}};function l(Te){if(!Te)return{};const{errorMap:U,invalid_type_error:te,required_error:oe,description:ke}=Te;if(U&&(te||oe))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return U?{errorMap:U,description:ke}:{errorMap:(Et,ft)=>{const{message:$t}=Te;return Et.code==="invalid_enum_value"?{message:$t??ft.defaultError}:typeof ft.data>"u"?{message:$t??oe??ft.defaultError}:Et.code!=="invalid_type"?{message:ft.defaultError}:{message:$t??te??ft.defaultError}},description:ke}}class _{get description(){return this._def.description}_getType(U){return(0,f.getParsedType)(U.data)}_getOrReturnCtx(U,te){return te||{common:U.parent.common,data:U.data,parsedType:(0,f.getParsedType)(U.data),schemaErrorMap:this._def.errorMap,path:U.path,parent:U.parent}}_processInputParams(U){return{status:new c.ParseStatus,ctx:{common:U.parent.common,data:U.data,parsedType:(0,f.getParsedType)(U.data),schemaErrorMap:this._def.errorMap,path:U.path,parent:U.parent}}}_parseSync(U){const te=this._parse(U);if((0,c.isAsync)(te))throw new Error("Synchronous parse encountered promise.");return te}_parseAsync(U){const te=this._parse(U);return Promise.resolve(te)}parse(U,te){const oe=this.safeParse(U,te);if(oe.success)return oe.data;throw oe.error}safeParse(U,te){const oe={common:{issues:[],async:te?.async??!1,contextualErrorMap:te?.errorMap},path:te?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:U,parsedType:(0,f.getParsedType)(U)},ke=this._parseSync({data:U,path:oe.path,parent:oe});return e(oe,ke)}"~validate"(U){const te={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:U,parsedType:(0,f.getParsedType)(U)};if(!this["~standard"].async)try{const oe=this._parseSync({data:U,path:[],parent:te});return(0,c.isValid)(oe)?{value:oe.value}:{issues:te.common.issues}}catch(oe){oe?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),te.common={issues:[],async:!0}}return this._parseAsync({data:U,path:[],parent:te}).then(oe=>(0,c.isValid)(oe)?{value:oe.value}:{issues:te.common.issues})}async parseAsync(U,te){const oe=await this.safeParseAsync(U,te);if(oe.success)return oe.data;throw oe.error}async safeParseAsync(U,te){const oe={common:{issues:[],contextualErrorMap:te?.errorMap,async:!0},path:te?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:U,parsedType:(0,f.getParsedType)(U)},ke=this._parse({data:U,path:oe.path,parent:oe}),De=await((0,c.isAsync)(ke)?ke:Promise.resolve(ke));return e(oe,De)}refine(U,te){const oe=ke=>typeof te=="string"||typeof te>"u"?{message:te}:typeof te=="function"?te(ke):te;return this._refinement((ke,De)=>{const Et=U(ke),ft=()=>De.addIssue({code:i.ZodIssueCode.custom,...oe(ke)});return typeof Promise<"u"&&Et instanceof Promise?Et.then($t=>$t?!0:(ft(),!1)):Et?!0:(ft(),!1)})}refinement(U,te){return this._refinement((oe,ke)=>U(oe)?!0:(ke.addIssue(typeof te=="function"?te(oe,ke):te),!1))}_refinement(U){return new ve({schema:this,typeName:Ze.ZodEffects,effect:{type:"refinement",refinement:U}})}superRefine(U){return this._refinement(U)}constructor(U){this.spa=this.safeParseAsync,this._def=U,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:te=>this["~validate"](te)}}optional(){return W.create(this,this._def)}nullable(){return J.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ar.create(this)}promise(){return Nt.create(this,this._def)}or(U){return gr.create([this,U],this._def)}and(U){return Pr.create(this,U,this._def)}transform(U){return new ve({...l(this._def),schema:this,typeName:Ze.ZodEffects,effect:{type:"transform",transform:U}})}default(U){const te=typeof U=="function"?U:()=>U;return new se({...l(this._def),innerType:this,defaultValue:te,typeName:Ze.ZodDefault})}brand(){return new je({typeName:Ze.ZodBranded,type:this,...l(this._def)})}catch(U){const te=typeof U=="function"?U:()=>U;return new _e({...l(this._def),innerType:this,catchValue:te,typeName:Ze.ZodCatch})}describe(U){const te=this.constructor;return new te({...this._def,description:U})}pipe(U){return Ge.create(this,U)}readonly(){return Ne.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}He.ZodType=_,He.Schema=_,He.ZodSchema=_;const w=/^c[^\s-]{8,}$/i,R=/^[0-9a-z]+$/,C=/^[0-9A-HJKMNP-TV-Z]{26}$/i,I=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,L=/^[a-z0-9_-]{21}$/i,O=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,q=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,G=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,j="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ne;const he=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Q=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Be=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,we=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ze=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,et=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,gt="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",st=new RegExp(`^${gt}$`);function nt(Te){let U="[0-5]\\d";Te.precision?U=`${U}\\.\\d{${Te.precision}}`:Te.precision==null&&(U=`${U}(\\.\\d+)?`);const te=Te.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${U})${te}`}function rt(Te){return new RegExp(`^${nt(Te)}$`)}function ee(Te){let U=`${gt}T${nt(Te)}`;const te=[];return te.push(Te.local?"Z?":"Z"),Te.offset&&te.push("([+-]\\d{2}:?\\d{2})"),U=`${U}(${te.join("|")})`,new RegExp(`^${U}$`)}function Le(Te,U){return!!((U==="v4"||!U)&&he.test(Te)||(U==="v6"||!U)&&Be.test(Te))}function de(Te,U){if(!O.test(Te))return!1;try{const[te]=Te.split(".");if(!te)return!1;const oe=te.replace(/-/g,"+").replace(/_/g,"/").padEnd(te.length+(4-te.length%4)%4,"="),ke=JSON.parse(atob(oe));return!(typeof ke!="object"||ke===null||"typ"in ke&&ke?.typ!=="JWT"||!ke.alg||U&&ke.alg!==U)}catch{return!1}}function me(Te,U){return!!((U==="v4"||!U)&&Q.test(Te)||(U==="v6"||!U)&&we.test(Te))}class tt extends _{_parse(U){if(this._def.coerce&&(U.data=String(U.data)),this._getType(U)!==f.ZodParsedType.string){const De=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(De,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.string,received:De.parsedType}),c.INVALID}const oe=new c.ParseStatus;let ke;for(const De of this._def.checks)if(De.kind==="min")U.data.length<De.value&&(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.too_small,minimum:De.value,type:"string",inclusive:!0,exact:!1,message:De.message}),oe.dirty());else if(De.kind==="max")U.data.length>De.value&&(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.too_big,maximum:De.value,type:"string",inclusive:!0,exact:!1,message:De.message}),oe.dirty());else if(De.kind==="length"){const Et=U.data.length>De.value,ft=U.data.length<De.value;(Et||ft)&&(ke=this._getOrReturnCtx(U,ke),Et?(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.too_big,maximum:De.value,type:"string",inclusive:!0,exact:!0,message:De.message}):ft&&(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.too_small,minimum:De.value,type:"string",inclusive:!0,exact:!0,message:De.message}),oe.dirty())}else if(De.kind==="email")G.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"email",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty());else if(De.kind==="emoji")ne||(ne=new RegExp(j,"u")),ne.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"emoji",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty());else if(De.kind==="uuid")I.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"uuid",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty());else if(De.kind==="nanoid")L.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"nanoid",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty());else if(De.kind==="cuid")w.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"cuid",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty());else if(De.kind==="cuid2")R.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"cuid2",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty());else if(De.kind==="ulid")C.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"ulid",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty());else if(De.kind==="url")try{new URL(U.data)}catch{ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"url",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty()}else De.kind==="regex"?(De.regex.lastIndex=0,De.regex.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"regex",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty())):De.kind==="trim"?U.data=U.data.trim():De.kind==="includes"?U.data.includes(De.value,De.position)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.invalid_string,validation:{includes:De.value,position:De.position},message:De.message}),oe.dirty()):De.kind==="toLowerCase"?U.data=U.data.toLowerCase():De.kind==="toUpperCase"?U.data=U.data.toUpperCase():De.kind==="startsWith"?U.data.startsWith(De.value)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.invalid_string,validation:{startsWith:De.value},message:De.message}),oe.dirty()):De.kind==="endsWith"?U.data.endsWith(De.value)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.invalid_string,validation:{endsWith:De.value},message:De.message}),oe.dirty()):De.kind==="datetime"?ee(De).test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.invalid_string,validation:"datetime",message:De.message}),oe.dirty()):De.kind==="date"?st.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.invalid_string,validation:"date",message:De.message}),oe.dirty()):De.kind==="time"?rt(De).test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.invalid_string,validation:"time",message:De.message}),oe.dirty()):De.kind==="duration"?q.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"duration",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty()):De.kind==="ip"?Le(U.data,De.version)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"ip",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty()):De.kind==="jwt"?de(U.data,De.alg)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"jwt",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty()):De.kind==="cidr"?me(U.data,De.version)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"cidr",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty()):De.kind==="base64"?ze.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"base64",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty()):De.kind==="base64url"?et.test(U.data)||(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{validation:"base64url",code:i.ZodIssueCode.invalid_string,message:De.message}),oe.dirty()):f.util.assertNever(De);return{status:oe.value,value:U.data}}_regex(U,te,oe){return this.refinement(ke=>U.test(ke),{validation:te,code:i.ZodIssueCode.invalid_string,...a.errorUtil.errToObj(oe)})}_addCheck(U){return new tt({...this._def,checks:[...this._def.checks,U]})}email(U){return this._addCheck({kind:"email",...a.errorUtil.errToObj(U)})}url(U){return this._addCheck({kind:"url",...a.errorUtil.errToObj(U)})}emoji(U){return this._addCheck({kind:"emoji",...a.errorUtil.errToObj(U)})}uuid(U){return this._addCheck({kind:"uuid",...a.errorUtil.errToObj(U)})}nanoid(U){return this._addCheck({kind:"nanoid",...a.errorUtil.errToObj(U)})}cuid(U){return this._addCheck({kind:"cuid",...a.errorUtil.errToObj(U)})}cuid2(U){return this._addCheck({kind:"cuid2",...a.errorUtil.errToObj(U)})}ulid(U){return this._addCheck({kind:"ulid",...a.errorUtil.errToObj(U)})}base64(U){return this._addCheck({kind:"base64",...a.errorUtil.errToObj(U)})}base64url(U){return this._addCheck({kind:"base64url",...a.errorUtil.errToObj(U)})}jwt(U){return this._addCheck({kind:"jwt",...a.errorUtil.errToObj(U)})}ip(U){return this._addCheck({kind:"ip",...a.errorUtil.errToObj(U)})}cidr(U){return this._addCheck({kind:"cidr",...a.errorUtil.errToObj(U)})}datetime(U){return typeof U=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:U}):this._addCheck({kind:"datetime",precision:typeof U?.precision>"u"?null:U?.precision,offset:U?.offset??!1,local:U?.local??!1,...a.errorUtil.errToObj(U?.message)})}date(U){return this._addCheck({kind:"date",message:U})}time(U){return typeof U=="string"?this._addCheck({kind:"time",precision:null,message:U}):this._addCheck({kind:"time",precision:typeof U?.precision>"u"?null:U?.precision,...a.errorUtil.errToObj(U?.message)})}duration(U){return this._addCheck({kind:"duration",...a.errorUtil.errToObj(U)})}regex(U,te){return this._addCheck({kind:"regex",regex:U,...a.errorUtil.errToObj(te)})}includes(U,te){return this._addCheck({kind:"includes",value:U,position:te?.position,...a.errorUtil.errToObj(te?.message)})}startsWith(U,te){return this._addCheck({kind:"startsWith",value:U,...a.errorUtil.errToObj(te)})}endsWith(U,te){return this._addCheck({kind:"endsWith",value:U,...a.errorUtil.errToObj(te)})}min(U,te){return this._addCheck({kind:"min",value:U,...a.errorUtil.errToObj(te)})}max(U,te){return this._addCheck({kind:"max",value:U,...a.errorUtil.errToObj(te)})}length(U,te){return this._addCheck({kind:"length",value:U,...a.errorUtil.errToObj(te)})}nonempty(U){return this.min(1,a.errorUtil.errToObj(U))}trim(){return new tt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new tt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new tt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(U=>U.kind==="datetime")}get isDate(){return!!this._def.checks.find(U=>U.kind==="date")}get isTime(){return!!this._def.checks.find(U=>U.kind==="time")}get isDuration(){return!!this._def.checks.find(U=>U.kind==="duration")}get isEmail(){return!!this._def.checks.find(U=>U.kind==="email")}get isURL(){return!!this._def.checks.find(U=>U.kind==="url")}get isEmoji(){return!!this._def.checks.find(U=>U.kind==="emoji")}get isUUID(){return!!this._def.checks.find(U=>U.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(U=>U.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(U=>U.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(U=>U.kind==="cuid2")}get isULID(){return!!this._def.checks.find(U=>U.kind==="ulid")}get isIP(){return!!this._def.checks.find(U=>U.kind==="ip")}get isCIDR(){return!!this._def.checks.find(U=>U.kind==="cidr")}get isBase64(){return!!this._def.checks.find(U=>U.kind==="base64")}get isBase64url(){return!!this._def.checks.find(U=>U.kind==="base64url")}get minLength(){let U=null;for(const te of this._def.checks)te.kind==="min"&&(U===null||te.value>U)&&(U=te.value);return U}get maxLength(){let U=null;for(const te of this._def.checks)te.kind==="max"&&(U===null||te.value<U)&&(U=te.value);return U}}He.ZodString=tt,tt.create=Te=>new tt({checks:[],typeName:Ze.ZodString,coerce:Te?.coerce??!1,...l(Te)});function yt(Te,U){const te=(Te.toString().split(".")[1]||"").length,oe=(U.toString().split(".")[1]||"").length,ke=te>oe?te:oe,De=Number.parseInt(Te.toFixed(ke).replace(".","")),Et=Number.parseInt(U.toFixed(ke).replace(".",""));return De%Et/10**ke}class lt extends _{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(U){if(this._def.coerce&&(U.data=Number(U.data)),this._getType(U)!==f.ZodParsedType.number){const De=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(De,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.number,received:De.parsedType}),c.INVALID}let oe;const ke=new c.ParseStatus;for(const De of this._def.checks)De.kind==="int"?f.util.isInteger(U.data)||(oe=this._getOrReturnCtx(U,oe),(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:De.message}),ke.dirty()):De.kind==="min"?(De.inclusive?U.data<De.value:U.data<=De.value)&&(oe=this._getOrReturnCtx(U,oe),(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.too_small,minimum:De.value,type:"number",inclusive:De.inclusive,exact:!1,message:De.message}),ke.dirty()):De.kind==="max"?(De.inclusive?U.data>De.value:U.data>=De.value)&&(oe=this._getOrReturnCtx(U,oe),(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.too_big,maximum:De.value,type:"number",inclusive:De.inclusive,exact:!1,message:De.message}),ke.dirty()):De.kind==="multipleOf"?yt(U.data,De.value)!==0&&(oe=this._getOrReturnCtx(U,oe),(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.not_multiple_of,multipleOf:De.value,message:De.message}),ke.dirty()):De.kind==="finite"?Number.isFinite(U.data)||(oe=this._getOrReturnCtx(U,oe),(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.not_finite,message:De.message}),ke.dirty()):f.util.assertNever(De);return{status:ke.value,value:U.data}}gte(U,te){return this.setLimit("min",U,!0,a.errorUtil.toString(te))}gt(U,te){return this.setLimit("min",U,!1,a.errorUtil.toString(te))}lte(U,te){return this.setLimit("max",U,!0,a.errorUtil.toString(te))}lt(U,te){return this.setLimit("max",U,!1,a.errorUtil.toString(te))}setLimit(U,te,oe,ke){return new lt({...this._def,checks:[...this._def.checks,{kind:U,value:te,inclusive:oe,message:a.errorUtil.toString(ke)}]})}_addCheck(U){return new lt({...this._def,checks:[...this._def.checks,U]})}int(U){return this._addCheck({kind:"int",message:a.errorUtil.toString(U)})}positive(U){return this._addCheck({kind:"min",value:0,inclusive:!1,message:a.errorUtil.toString(U)})}negative(U){return this._addCheck({kind:"max",value:0,inclusive:!1,message:a.errorUtil.toString(U)})}nonpositive(U){return this._addCheck({kind:"max",value:0,inclusive:!0,message:a.errorUtil.toString(U)})}nonnegative(U){return this._addCheck({kind:"min",value:0,inclusive:!0,message:a.errorUtil.toString(U)})}multipleOf(U,te){return this._addCheck({kind:"multipleOf",value:U,message:a.errorUtil.toString(te)})}finite(U){return this._addCheck({kind:"finite",message:a.errorUtil.toString(U)})}safe(U){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:a.errorUtil.toString(U)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:a.errorUtil.toString(U)})}get minValue(){let U=null;for(const te of this._def.checks)te.kind==="min"&&(U===null||te.value>U)&&(U=te.value);return U}get maxValue(){let U=null;for(const te of this._def.checks)te.kind==="max"&&(U===null||te.value<U)&&(U=te.value);return U}get isInt(){return!!this._def.checks.find(U=>U.kind==="int"||U.kind==="multipleOf"&&f.util.isInteger(U.value))}get isFinite(){let U=null,te=null;for(const oe of this._def.checks){if(oe.kind==="finite"||oe.kind==="int"||oe.kind==="multipleOf")return!0;oe.kind==="min"?(te===null||oe.value>te)&&(te=oe.value):oe.kind==="max"&&(U===null||oe.value<U)&&(U=oe.value)}return Number.isFinite(te)&&Number.isFinite(U)}}He.ZodNumber=lt,lt.create=Te=>new lt({checks:[],typeName:Ze.ZodNumber,coerce:Te?.coerce||!1,...l(Te)});class ge extends _{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(U){if(this._def.coerce)try{U.data=BigInt(U.data)}catch{return this._getInvalidInput(U)}if(this._getType(U)!==f.ZodParsedType.bigint)return this._getInvalidInput(U);let oe;const ke=new c.ParseStatus;for(const De of this._def.checks)De.kind==="min"?(De.inclusive?U.data<De.value:U.data<=De.value)&&(oe=this._getOrReturnCtx(U,oe),(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.too_small,type:"bigint",minimum:De.value,inclusive:De.inclusive,message:De.message}),ke.dirty()):De.kind==="max"?(De.inclusive?U.data>De.value:U.data>=De.value)&&(oe=this._getOrReturnCtx(U,oe),(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.too_big,type:"bigint",maximum:De.value,inclusive:De.inclusive,message:De.message}),ke.dirty()):De.kind==="multipleOf"?U.data%De.value!==BigInt(0)&&(oe=this._getOrReturnCtx(U,oe),(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.not_multiple_of,multipleOf:De.value,message:De.message}),ke.dirty()):f.util.assertNever(De);return{status:ke.value,value:U.data}}_getInvalidInput(U){const te=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(te,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.bigint,received:te.parsedType}),c.INVALID}gte(U,te){return this.setLimit("min",U,!0,a.errorUtil.toString(te))}gt(U,te){return this.setLimit("min",U,!1,a.errorUtil.toString(te))}lte(U,te){return this.setLimit("max",U,!0,a.errorUtil.toString(te))}lt(U,te){return this.setLimit("max",U,!1,a.errorUtil.toString(te))}setLimit(U,te,oe,ke){return new ge({...this._def,checks:[...this._def.checks,{kind:U,value:te,inclusive:oe,message:a.errorUtil.toString(ke)}]})}_addCheck(U){return new ge({...this._def,checks:[...this._def.checks,U]})}positive(U){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:a.errorUtil.toString(U)})}negative(U){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:a.errorUtil.toString(U)})}nonpositive(U){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:a.errorUtil.toString(U)})}nonnegative(U){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:a.errorUtil.toString(U)})}multipleOf(U,te){return this._addCheck({kind:"multipleOf",value:U,message:a.errorUtil.toString(te)})}get minValue(){let U=null;for(const te of this._def.checks)te.kind==="min"&&(U===null||te.value>U)&&(U=te.value);return U}get maxValue(){let U=null;for(const te of this._def.checks)te.kind==="max"&&(U===null||te.value<U)&&(U=te.value);return U}}He.ZodBigInt=ge,ge.create=Te=>new ge({checks:[],typeName:Ze.ZodBigInt,coerce:Te?.coerce??!1,...l(Te)});class Gt extends _{_parse(U){if(this._def.coerce&&(U.data=!!U.data),this._getType(U)!==f.ZodParsedType.boolean){const oe=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.boolean,received:oe.parsedType}),c.INVALID}return(0,c.OK)(U.data)}}He.ZodBoolean=Gt,Gt.create=Te=>new Gt({typeName:Ze.ZodBoolean,coerce:Te?.coerce||!1,...l(Te)});class Ut extends _{_parse(U){if(this._def.coerce&&(U.data=new Date(U.data)),this._getType(U)!==f.ZodParsedType.date){const De=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(De,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.date,received:De.parsedType}),c.INVALID}if(Number.isNaN(U.data.getTime())){const De=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(De,{code:i.ZodIssueCode.invalid_date}),c.INVALID}const oe=new c.ParseStatus;let ke;for(const De of this._def.checks)De.kind==="min"?U.data.getTime()<De.value&&(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.too_small,message:De.message,inclusive:!0,exact:!1,minimum:De.value,type:"date"}),oe.dirty()):De.kind==="max"?U.data.getTime()>De.value&&(ke=this._getOrReturnCtx(U,ke),(0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.too_big,message:De.message,inclusive:!0,exact:!1,maximum:De.value,type:"date"}),oe.dirty()):f.util.assertNever(De);return{status:oe.value,value:new Date(U.data.getTime())}}_addCheck(U){return new Ut({...this._def,checks:[...this._def.checks,U]})}min(U,te){return this._addCheck({kind:"min",value:U.getTime(),message:a.errorUtil.toString(te)})}max(U,te){return this._addCheck({kind:"max",value:U.getTime(),message:a.errorUtil.toString(te)})}get minDate(){let U=null;for(const te of this._def.checks)te.kind==="min"&&(U===null||te.value>U)&&(U=te.value);return U!=null?new Date(U):null}get maxDate(){let U=null;for(const te of this._def.checks)te.kind==="max"&&(U===null||te.value<U)&&(U=te.value);return U!=null?new Date(U):null}}He.ZodDate=Ut,Ut.create=Te=>new Ut({checks:[],coerce:Te?.coerce||!1,typeName:Ze.ZodDate,...l(Te)});class Ce extends _{_parse(U){if(this._getType(U)!==f.ZodParsedType.symbol){const oe=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.symbol,received:oe.parsedType}),c.INVALID}return(0,c.OK)(U.data)}}He.ZodSymbol=Ce,Ce.create=Te=>new Ce({typeName:Ze.ZodSymbol,...l(Te)});class ar extends _{_parse(U){if(this._getType(U)!==f.ZodParsedType.undefined){const oe=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.undefined,received:oe.parsedType}),c.INVALID}return(0,c.OK)(U.data)}}He.ZodUndefined=ar,ar.create=Te=>new ar({typeName:Ze.ZodUndefined,...l(Te)});class kt extends _{_parse(U){if(this._getType(U)!==f.ZodParsedType.null){const oe=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.null,received:oe.parsedType}),c.INVALID}return(0,c.OK)(U.data)}}He.ZodNull=kt,kt.create=Te=>new kt({typeName:Ze.ZodNull,...l(Te)});class er extends _{constructor(){super(...arguments),this._any=!0}_parse(U){return(0,c.OK)(U.data)}}He.ZodAny=er,er.create=Te=>new er({typeName:Ze.ZodAny,...l(Te)});class Ur extends _{constructor(){super(...arguments),this._unknown=!0}_parse(U){return(0,c.OK)(U.data)}}He.ZodUnknown=Ur,Ur.create=Te=>new Ur({typeName:Ze.ZodUnknown,...l(Te)});class or extends _{_parse(U){const te=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(te,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.never,received:te.parsedType}),c.INVALID}}He.ZodNever=or,or.create=Te=>new or({typeName:Ze.ZodNever,...l(Te)});class Sr extends _{_parse(U){if(this._getType(U)!==f.ZodParsedType.undefined){const oe=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.void,received:oe.parsedType}),c.INVALID}return(0,c.OK)(U.data)}}He.ZodVoid=Sr,Sr.create=Te=>new Sr({typeName:Ze.ZodVoid,...l(Te)});class Ar extends _{_parse(U){const{ctx:te,status:oe}=this._processInputParams(U),ke=this._def;if(te.parsedType!==f.ZodParsedType.array)return(0,c.addIssueToContext)(te,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.array,received:te.parsedType}),c.INVALID;if(ke.exactLength!==null){const Et=te.data.length>ke.exactLength.value,ft=te.data.length<ke.exactLength.value;(Et||ft)&&((0,c.addIssueToContext)(te,{code:Et?i.ZodIssueCode.too_big:i.ZodIssueCode.too_small,minimum:ft?ke.exactLength.value:void 0,maximum:Et?ke.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:ke.exactLength.message}),oe.dirty())}if(ke.minLength!==null&&te.data.length<ke.minLength.value&&((0,c.addIssueToContext)(te,{code:i.ZodIssueCode.too_small,minimum:ke.minLength.value,type:"array",inclusive:!0,exact:!1,message:ke.minLength.message}),oe.dirty()),ke.maxLength!==null&&te.data.length>ke.maxLength.value&&((0,c.addIssueToContext)(te,{code:i.ZodIssueCode.too_big,maximum:ke.maxLength.value,type:"array",inclusive:!0,exact:!1,message:ke.maxLength.message}),oe.dirty()),te.common.async)return Promise.all([...te.data].map((Et,ft)=>ke.type._parseAsync(new y(te,Et,te.path,ft)))).then(Et=>c.ParseStatus.mergeArray(oe,Et));const De=[...te.data].map((Et,ft)=>ke.type._parseSync(new y(te,Et,te.path,ft)));return c.ParseStatus.mergeArray(oe,De)}get element(){return this._def.type}min(U,te){return new Ar({...this._def,minLength:{value:U,message:a.errorUtil.toString(te)}})}max(U,te){return new Ar({...this._def,maxLength:{value:U,message:a.errorUtil.toString(te)}})}length(U,te){return new Ar({...this._def,exactLength:{value:U,message:a.errorUtil.toString(te)}})}nonempty(U){return this.min(1,U)}}He.ZodArray=Ar,Ar.create=(Te,U)=>new Ar({type:Te,minLength:null,maxLength:null,exactLength:null,typeName:Ze.ZodArray,...l(U)});function Nr(Te){if(Te instanceof rr){const U={};for(const te in Te.shape){const oe=Te.shape[te];U[te]=W.create(Nr(oe))}return new rr({...Te._def,shape:()=>U})}else return Te instanceof Ar?new Ar({...Te._def,type:Nr(Te.element)}):Te instanceof W?W.create(Nr(Te.unwrap())):Te instanceof J?J.create(Nr(Te.unwrap())):Te instanceof St?St.create(Te.items.map(U=>Nr(U))):Te}class rr extends _{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const U=this._def.shape(),te=f.util.objectKeys(U);return this._cached={shape:U,keys:te},this._cached}_parse(U){if(this._getType(U)!==f.ZodParsedType.object){const Wt=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(Wt,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.object,received:Wt.parsedType}),c.INVALID}const{status:oe,ctx:ke}=this._processInputParams(U),{shape:De,keys:Et}=this._getCached(),ft=[];if(!(this._def.catchall instanceof or&&this._def.unknownKeys==="strip"))for(const Wt in ke.data)Et.includes(Wt)||ft.push(Wt);const $t=[];for(const Wt of Et){const vr=De[Wt],zi=ke.data[Wt];$t.push({key:{status:"valid",value:Wt},value:vr._parse(new y(ke,zi,ke.path,Wt)),alwaysSet:Wt in ke.data})}if(this._def.catchall instanceof or){const Wt=this._def.unknownKeys;if(Wt==="passthrough")for(const vr of ft)$t.push({key:{status:"valid",value:vr},value:{status:"valid",value:ke.data[vr]}});else if(Wt==="strict")ft.length>0&&((0,c.addIssueToContext)(ke,{code:i.ZodIssueCode.unrecognized_keys,keys:ft}),oe.dirty());else if(Wt!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const Wt=this._def.catchall;for(const vr of ft){const zi=ke.data[vr];$t.push({key:{status:"valid",value:vr},value:Wt._parse(new y(ke,zi,ke.path,vr)),alwaysSet:vr in ke.data})}}return ke.common.async?Promise.resolve().then(async()=>{const Wt=[];for(const vr of $t){const zi=await vr.key,Rn=await vr.value;Wt.push({key:zi,value:Rn,alwaysSet:vr.alwaysSet})}return Wt}).then(Wt=>c.ParseStatus.mergeObjectSync(oe,Wt)):c.ParseStatus.mergeObjectSync(oe,$t)}get shape(){return this._def.shape()}strict(U){return a.errorUtil.errToObj,new rr({...this._def,unknownKeys:"strict",...U!==void 0?{errorMap:(te,oe)=>{const ke=this._def.errorMap?.(te,oe).message??oe.defaultError;return te.code==="unrecognized_keys"?{message:a.errorUtil.errToObj(U).message??ke}:{message:ke}}}:{}})}strip(){return new rr({...this._def,unknownKeys:"strip"})}passthrough(){return new rr({...this._def,unknownKeys:"passthrough"})}extend(U){return new rr({...this._def,shape:()=>({...this._def.shape(),...U})})}merge(U){return new rr({unknownKeys:U._def.unknownKeys,catchall:U._def.catchall,shape:()=>({...this._def.shape(),...U._def.shape()}),typeName:Ze.ZodObject})}setKey(U,te){return this.augment({[U]:te})}catchall(U){return new rr({...this._def,catchall:U})}pick(U){const te={};for(const oe of f.util.objectKeys(U))U[oe]&&this.shape[oe]&&(te[oe]=this.shape[oe]);return new rr({...this._def,shape:()=>te})}omit(U){const te={};for(const oe of f.util.objectKeys(this.shape))U[oe]||(te[oe]=this.shape[oe]);return new rr({...this._def,shape:()=>te})}deepPartial(){return Nr(this)}partial(U){const te={};for(const oe of f.util.objectKeys(this.shape)){const ke=this.shape[oe];U&&!U[oe]?te[oe]=ke:te[oe]=ke.optional()}return new rr({...this._def,shape:()=>te})}required(U){const te={};for(const oe of f.util.objectKeys(this.shape))if(U&&!U[oe])te[oe]=this.shape[oe];else{let De=this.shape[oe];for(;De instanceof W;)De=De._def.innerType;te[oe]=De}return new rr({...this._def,shape:()=>te})}keyof(){return Ii(f.util.objectKeys(this.shape))}}He.ZodObject=rr,rr.create=(Te,U)=>new rr({shape:()=>Te,unknownKeys:"strip",catchall:or.create(),typeName:Ze.ZodObject,...l(U)}),rr.strictCreate=(Te,U)=>new rr({shape:()=>Te,unknownKeys:"strict",catchall:or.create(),typeName:Ze.ZodObject,...l(U)}),rr.lazycreate=(Te,U)=>new rr({shape:Te,unknownKeys:"strip",catchall:or.create(),typeName:Ze.ZodObject,...l(U)});class gr extends _{_parse(U){const{ctx:te}=this._processInputParams(U),oe=this._def.options;function ke(De){for(const ft of De)if(ft.result.status==="valid")return ft.result;for(const ft of De)if(ft.result.status==="dirty")return te.common.issues.push(...ft.ctx.common.issues),ft.result;const Et=De.map(ft=>new i.ZodError(ft.ctx.common.issues));return(0,c.addIssueToContext)(te,{code:i.ZodIssueCode.invalid_union,unionErrors:Et}),c.INVALID}if(te.common.async)return Promise.all(oe.map(async De=>{const Et={...te,common:{...te.common,issues:[]},parent:null};return{result:await De._parseAsync({data:te.data,path:te.path,parent:Et}),ctx:Et}})).then(ke);{let De;const Et=[];for(const $t of oe){const Wt={...te,common:{...te.common,issues:[]},parent:null},vr=$t._parseSync({data:te.data,path:te.path,parent:Wt});if(vr.status==="valid")return vr;vr.status==="dirty"&&!De&&(De={result:vr,ctx:Wt}),Wt.common.issues.length&&Et.push(Wt.common.issues)}if(De)return te.common.issues.push(...De.ctx.common.issues),De.result;const ft=Et.map($t=>new i.ZodError($t));return(0,c.addIssueToContext)(te,{code:i.ZodIssueCode.invalid_union,unionErrors:ft}),c.INVALID}}get options(){return this._def.options}}He.ZodUnion=gr,gr.create=(Te,U)=>new gr({options:Te,typeName:Ze.ZodUnion,...l(U)});const ir=Te=>Te instanceof bt?ir(Te.schema):Te instanceof ve?ir(Te.innerType()):Te instanceof pi?[Te.value]:Te instanceof Oe?Te.options:Te instanceof vt?f.util.objectValues(Te.enum):Te instanceof se?ir(Te._def.innerType):Te instanceof ar?[void 0]:Te instanceof kt?[null]:Te instanceof W?[void 0,...ir(Te.unwrap())]:Te instanceof J?[null,...ir(Te.unwrap())]:Te instanceof je||Te instanceof Ne?ir(Te.unwrap()):Te instanceof _e?ir(Te._def.innerType):[];class qr extends _{_parse(U){const{ctx:te}=this._processInputParams(U);if(te.parsedType!==f.ZodParsedType.object)return(0,c.addIssueToContext)(te,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.object,received:te.parsedType}),c.INVALID;const oe=this.discriminator,ke=te.data[oe],De=this.optionsMap.get(ke);return De?te.common.async?De._parseAsync({data:te.data,path:te.path,parent:te}):De._parseSync({data:te.data,path:te.path,parent:te}):((0,c.addIssueToContext)(te,{code:i.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[oe]}),c.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(U,te,oe){const ke=new Map;for(const De of te){const Et=ir(De.shape[U]);if(!Et.length)throw new Error(`A discriminator value for key \`${U}\` could not be extracted from all schema options`);for(const ft of Et){if(ke.has(ft))throw new Error(`Discriminator property ${String(U)} has duplicate value ${String(ft)}`);ke.set(ft,De)}}return new qr({typeName:Ze.ZodDiscriminatedUnion,discriminator:U,options:te,optionsMap:ke,...l(oe)})}}He.ZodDiscriminatedUnion=qr;function Vt(Te,U){const te=(0,f.getParsedType)(Te),oe=(0,f.getParsedType)(U);if(Te===U)return{valid:!0,data:Te};if(te===f.ZodParsedType.object&&oe===f.ZodParsedType.object){const ke=f.util.objectKeys(U),De=f.util.objectKeys(Te).filter(ft=>ke.indexOf(ft)!==-1),Et={...Te,...U};for(const ft of De){const $t=Vt(Te[ft],U[ft]);if(!$t.valid)return{valid:!1};Et[ft]=$t.data}return{valid:!0,data:Et}}else if(te===f.ZodParsedType.array&&oe===f.ZodParsedType.array){if(Te.length!==U.length)return{valid:!1};const ke=[];for(let De=0;De<Te.length;De++){const Et=Te[De],ft=U[De],$t=Vt(Et,ft);if(!$t.valid)return{valid:!1};ke.push($t.data)}return{valid:!0,data:ke}}else return te===f.ZodParsedType.date&&oe===f.ZodParsedType.date&&+Te==+U?{valid:!0,data:Te}:{valid:!1}}class Pr extends _{_parse(U){const{status:te,ctx:oe}=this._processInputParams(U),ke=(De,Et)=>{if((0,c.isAborted)(De)||(0,c.isAborted)(Et))return c.INVALID;const ft=Vt(De.value,Et.value);return ft.valid?(((0,c.isDirty)(De)||(0,c.isDirty)(Et))&&te.dirty(),{status:te.value,value:ft.data}):((0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_intersection_types}),c.INVALID)};return oe.common.async?Promise.all([this._def.left._parseAsync({data:oe.data,path:oe.path,parent:oe}),this._def.right._parseAsync({data:oe.data,path:oe.path,parent:oe})]).then(([De,Et])=>ke(De,Et)):ke(this._def.left._parseSync({data:oe.data,path:oe.path,parent:oe}),this._def.right._parseSync({data:oe.data,path:oe.path,parent:oe}))}}He.ZodIntersection=Pr,Pr.create=(Te,U,te)=>new Pr({left:Te,right:U,typeName:Ze.ZodIntersection,...l(te)});class St extends _{_parse(U){const{status:te,ctx:oe}=this._processInputParams(U);if(oe.parsedType!==f.ZodParsedType.array)return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.array,received:oe.parsedType}),c.INVALID;if(oe.data.length<this._def.items.length)return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),c.INVALID;!this._def.rest&&oe.data.length>this._def.items.length&&((0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),te.dirty());const De=[...oe.data].map((Et,ft)=>{const $t=this._def.items[ft]||this._def.rest;return $t?$t._parse(new y(oe,Et,oe.path,ft)):null}).filter(Et=>!!Et);return oe.common.async?Promise.all(De).then(Et=>c.ParseStatus.mergeArray(te,Et)):c.ParseStatus.mergeArray(te,De)}get items(){return this._def.items}rest(U){return new St({...this._def,rest:U})}}He.ZodTuple=St,St.create=(Te,U)=>{if(!Array.isArray(Te))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new St({items:Te,typeName:Ze.ZodTuple,rest:null,...l(U)})};class Qt extends _{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(U){const{status:te,ctx:oe}=this._processInputParams(U);if(oe.parsedType!==f.ZodParsedType.object)return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.object,received:oe.parsedType}),c.INVALID;const ke=[],De=this._def.keyType,Et=this._def.valueType;for(const ft in oe.data)ke.push({key:De._parse(new y(oe,ft,oe.path,ft)),value:Et._parse(new y(oe,oe.data[ft],oe.path,ft)),alwaysSet:ft in oe.data});return oe.common.async?c.ParseStatus.mergeObjectAsync(te,ke):c.ParseStatus.mergeObjectSync(te,ke)}get element(){return this._def.valueType}static create(U,te,oe){return te instanceof _?new Qt({keyType:U,valueType:te,typeName:Ze.ZodRecord,...l(oe)}):new Qt({keyType:tt.create(),valueType:U,typeName:Ze.ZodRecord,...l(te)})}}He.ZodRecord=Qt;class nr extends _{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(U){const{status:te,ctx:oe}=this._processInputParams(U);if(oe.parsedType!==f.ZodParsedType.map)return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.map,received:oe.parsedType}),c.INVALID;const ke=this._def.keyType,De=this._def.valueType,Et=[...oe.data.entries()].map(([ft,$t],Wt)=>({key:ke._parse(new y(oe,ft,oe.path,[Wt,"key"])),value:De._parse(new y(oe,$t,oe.path,[Wt,"value"]))}));if(oe.common.async){const ft=new Map;return Promise.resolve().then(async()=>{for(const $t of Et){const Wt=await $t.key,vr=await $t.value;if(Wt.status==="aborted"||vr.status==="aborted")return c.INVALID;(Wt.status==="dirty"||vr.status==="dirty")&&te.dirty(),ft.set(Wt.value,vr.value)}return{status:te.value,value:ft}})}else{const ft=new Map;for(const $t of Et){const Wt=$t.key,vr=$t.value;if(Wt.status==="aborted"||vr.status==="aborted")return c.INVALID;(Wt.status==="dirty"||vr.status==="dirty")&&te.dirty(),ft.set(Wt.value,vr.value)}return{status:te.value,value:ft}}}}He.ZodMap=nr,nr.create=(Te,U,te)=>new nr({valueType:U,keyType:Te,typeName:Ze.ZodMap,...l(te)});class Tr extends _{_parse(U){const{status:te,ctx:oe}=this._processInputParams(U);if(oe.parsedType!==f.ZodParsedType.set)return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.set,received:oe.parsedType}),c.INVALID;const ke=this._def;ke.minSize!==null&&oe.data.size<ke.minSize.value&&((0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.too_small,minimum:ke.minSize.value,type:"set",inclusive:!0,exact:!1,message:ke.minSize.message}),te.dirty()),ke.maxSize!==null&&oe.data.size>ke.maxSize.value&&((0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.too_big,maximum:ke.maxSize.value,type:"set",inclusive:!0,exact:!1,message:ke.maxSize.message}),te.dirty());const De=this._def.valueType;function Et($t){const Wt=new Set;for(const vr of $t){if(vr.status==="aborted")return c.INVALID;vr.status==="dirty"&&te.dirty(),Wt.add(vr.value)}return{status:te.value,value:Wt}}const ft=[...oe.data.values()].map(($t,Wt)=>De._parse(new y(oe,$t,oe.path,Wt)));return oe.common.async?Promise.all(ft).then($t=>Et($t)):Et(ft)}min(U,te){return new Tr({...this._def,minSize:{value:U,message:a.errorUtil.toString(te)}})}max(U,te){return new Tr({...this._def,maxSize:{value:U,message:a.errorUtil.toString(te)}})}size(U,te){return this.min(U,te).max(U,te)}nonempty(U){return this.min(1,U)}}He.ZodSet=Tr,Tr.create=(Te,U)=>new Tr({valueType:Te,minSize:null,maxSize:null,typeName:Ze.ZodSet,...l(U)});class $r extends _{constructor(){super(...arguments),this.validate=this.implement}_parse(U){const{ctx:te}=this._processInputParams(U);if(te.parsedType!==f.ZodParsedType.function)return(0,c.addIssueToContext)(te,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.function,received:te.parsedType}),c.INVALID;function oe(ft,$t){return(0,c.makeIssue)({data:ft,path:te.path,errorMaps:[te.common.contextualErrorMap,te.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter(Wt=>!!Wt),issueData:{code:i.ZodIssueCode.invalid_arguments,argumentsError:$t}})}function ke(ft,$t){return(0,c.makeIssue)({data:ft,path:te.path,errorMaps:[te.common.contextualErrorMap,te.schemaErrorMap,(0,n.getErrorMap)(),n.defaultErrorMap].filter(Wt=>!!Wt),issueData:{code:i.ZodIssueCode.invalid_return_type,returnTypeError:$t}})}const De={errorMap:te.common.contextualErrorMap},Et=te.data;if(this._def.returns instanceof Nt){const ft=this;return(0,c.OK)(async function(...$t){const Wt=new i.ZodError([]),vr=await ft._def.args.parseAsync($t,De).catch(Bt=>{throw Wt.addIssue(oe($t,Bt)),Wt}),zi=await Reflect.apply(Et,this,vr);return await ft._def.returns._def.type.parseAsync(zi,De).catch(Bt=>{throw Wt.addIssue(ke(zi,Bt)),Wt})})}else{const ft=this;return(0,c.OK)(function(...$t){const Wt=ft._def.args.safeParse($t,De);if(!Wt.success)throw new i.ZodError([oe($t,Wt.error)]);const vr=Reflect.apply(Et,this,Wt.data),zi=ft._def.returns.safeParse(vr,De);if(!zi.success)throw new i.ZodError([ke(vr,zi.error)]);return zi.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...U){return new $r({...this._def,args:St.create(U).rest(Ur.create())})}returns(U){return new $r({...this._def,returns:U})}implement(U){return this.parse(U)}strictImplement(U){return this.parse(U)}static create(U,te,oe){return new $r({args:U||St.create([]).rest(Ur.create()),returns:te||Ur.create(),typeName:Ze.ZodFunction,...l(oe)})}}He.ZodFunction=$r;class bt extends _{get schema(){return this._def.getter()}_parse(U){const{ctx:te}=this._processInputParams(U);return this._def.getter()._parse({data:te.data,path:te.path,parent:te})}}He.ZodLazy=bt,bt.create=(Te,U)=>new bt({getter:Te,typeName:Ze.ZodLazy,...l(U)});class pi extends _{_parse(U){if(U.data!==this._def.value){const te=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(te,{received:te.data,code:i.ZodIssueCode.invalid_literal,expected:this._def.value}),c.INVALID}return{status:"valid",value:U.data}}get value(){return this._def.value}}He.ZodLiteral=pi,pi.create=(Te,U)=>new pi({value:Te,typeName:Ze.ZodLiteral,...l(U)});function Ii(Te,U){return new Oe({values:Te,typeName:Ze.ZodEnum,...l(U)})}class Oe extends _{_parse(U){if(typeof U.data!="string"){const te=this._getOrReturnCtx(U),oe=this._def.values;return(0,c.addIssueToContext)(te,{expected:f.util.joinValues(oe),received:te.parsedType,code:i.ZodIssueCode.invalid_type}),c.INVALID}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(U.data)){const te=this._getOrReturnCtx(U),oe=this._def.values;return(0,c.addIssueToContext)(te,{received:te.data,code:i.ZodIssueCode.invalid_enum_value,options:oe}),c.INVALID}return(0,c.OK)(U.data)}get options(){return this._def.values}get enum(){const U={};for(const te of this._def.values)U[te]=te;return U}get Values(){const U={};for(const te of this._def.values)U[te]=te;return U}get Enum(){const U={};for(const te of this._def.values)U[te]=te;return U}extract(U,te=this._def){return Oe.create(U,{...this._def,...te})}exclude(U,te=this._def){return Oe.create(this.options.filter(oe=>!U.includes(oe)),{...this._def,...te})}}He.ZodEnum=Oe,Oe.create=Ii;class vt extends _{_parse(U){const te=f.util.getValidEnumValues(this._def.values),oe=this._getOrReturnCtx(U);if(oe.parsedType!==f.ZodParsedType.string&&oe.parsedType!==f.ZodParsedType.number){const ke=f.util.objectValues(te);return(0,c.addIssueToContext)(oe,{expected:f.util.joinValues(ke),received:oe.parsedType,code:i.ZodIssueCode.invalid_type}),c.INVALID}if(this._cache||(this._cache=new Set(f.util.getValidEnumValues(this._def.values))),!this._cache.has(U.data)){const ke=f.util.objectValues(te);return(0,c.addIssueToContext)(oe,{received:oe.data,code:i.ZodIssueCode.invalid_enum_value,options:ke}),c.INVALID}return(0,c.OK)(U.data)}get enum(){return this._def.values}}He.ZodNativeEnum=vt,vt.create=(Te,U)=>new vt({values:Te,typeName:Ze.ZodNativeEnum,...l(U)});class Nt extends _{unwrap(){return this._def.type}_parse(U){const{ctx:te}=this._processInputParams(U);if(te.parsedType!==f.ZodParsedType.promise&&te.common.async===!1)return(0,c.addIssueToContext)(te,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.promise,received:te.parsedType}),c.INVALID;const oe=te.parsedType===f.ZodParsedType.promise?te.data:Promise.resolve(te.data);return(0,c.OK)(oe.then(ke=>this._def.type.parseAsync(ke,{path:te.path,errorMap:te.common.contextualErrorMap})))}}He.ZodPromise=Nt,Nt.create=(Te,U)=>new Nt({type:Te,typeName:Ze.ZodPromise,...l(U)});class ve extends _{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ze.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(U){const{status:te,ctx:oe}=this._processInputParams(U),ke=this._def.effect||null,De={addIssue:Et=>{(0,c.addIssueToContext)(oe,Et),Et.fatal?te.abort():te.dirty()},get path(){return oe.path}};if(De.addIssue=De.addIssue.bind(De),ke.type==="preprocess"){const Et=ke.transform(oe.data,De);if(oe.common.async)return Promise.resolve(Et).then(async ft=>{if(te.value==="aborted")return c.INVALID;const $t=await this._def.schema._parseAsync({data:ft,path:oe.path,parent:oe});return $t.status==="aborted"?c.INVALID:$t.status==="dirty"||te.value==="dirty"?(0,c.DIRTY)($t.value):$t});{if(te.value==="aborted")return c.INVALID;const ft=this._def.schema._parseSync({data:Et,path:oe.path,parent:oe});return ft.status==="aborted"?c.INVALID:ft.status==="dirty"||te.value==="dirty"?(0,c.DIRTY)(ft.value):ft}}if(ke.type==="refinement"){const Et=ft=>{const $t=ke.refinement(ft,De);if(oe.common.async)return Promise.resolve($t);if($t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return ft};if(oe.common.async===!1){const ft=this._def.schema._parseSync({data:oe.data,path:oe.path,parent:oe});return ft.status==="aborted"?c.INVALID:(ft.status==="dirty"&&te.dirty(),Et(ft.value),{status:te.value,value:ft.value})}else return this._def.schema._parseAsync({data:oe.data,path:oe.path,parent:oe}).then(ft=>ft.status==="aborted"?c.INVALID:(ft.status==="dirty"&&te.dirty(),Et(ft.value).then(()=>({status:te.value,value:ft.value}))))}if(ke.type==="transform")if(oe.common.async===!1){const Et=this._def.schema._parseSync({data:oe.data,path:oe.path,parent:oe});if(!(0,c.isValid)(Et))return c.INVALID;const ft=ke.transform(Et.value,De);if(ft instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:te.value,value:ft}}else return this._def.schema._parseAsync({data:oe.data,path:oe.path,parent:oe}).then(Et=>(0,c.isValid)(Et)?Promise.resolve(ke.transform(Et.value,De)).then(ft=>({status:te.value,value:ft})):c.INVALID);f.util.assertNever(ke)}}He.ZodEffects=ve,He.ZodTransformer=ve,ve.create=(Te,U,te)=>new ve({schema:Te,typeName:Ze.ZodEffects,effect:U,...l(te)}),ve.createWithPreprocess=(Te,U,te)=>new ve({schema:U,effect:{type:"preprocess",transform:Te},typeName:Ze.ZodEffects,...l(te)});class W extends _{_parse(U){return this._getType(U)===f.ZodParsedType.undefined?(0,c.OK)(void 0):this._def.innerType._parse(U)}unwrap(){return this._def.innerType}}He.ZodOptional=W,W.create=(Te,U)=>new W({innerType:Te,typeName:Ze.ZodOptional,...l(U)});class J extends _{_parse(U){return this._getType(U)===f.ZodParsedType.null?(0,c.OK)(null):this._def.innerType._parse(U)}unwrap(){return this._def.innerType}}He.ZodNullable=J,J.create=(Te,U)=>new J({innerType:Te,typeName:Ze.ZodNullable,...l(U)});class se extends _{_parse(U){const{ctx:te}=this._processInputParams(U);let oe=te.data;return te.parsedType===f.ZodParsedType.undefined&&(oe=this._def.defaultValue()),this._def.innerType._parse({data:oe,path:te.path,parent:te})}removeDefault(){return this._def.innerType}}He.ZodDefault=se,se.create=(Te,U)=>new se({innerType:Te,typeName:Ze.ZodDefault,defaultValue:typeof U.default=="function"?U.default:()=>U.default,...l(U)});class _e extends _{_parse(U){const{ctx:te}=this._processInputParams(U),oe={...te,common:{...te.common,issues:[]}},ke=this._def.innerType._parse({data:oe.data,path:oe.path,parent:{...oe}});return(0,c.isAsync)(ke)?ke.then(De=>({status:"valid",value:De.status==="valid"?De.value:this._def.catchValue({get error(){return new i.ZodError(oe.common.issues)},input:oe.data})})):{status:"valid",value:ke.status==="valid"?ke.value:this._def.catchValue({get error(){return new i.ZodError(oe.common.issues)},input:oe.data})}}removeCatch(){return this._def.innerType}}He.ZodCatch=_e,_e.create=(Te,U)=>new _e({innerType:Te,typeName:Ze.ZodCatch,catchValue:typeof U.catch=="function"?U.catch:()=>U.catch,...l(U)});class Re extends _{_parse(U){if(this._getType(U)!==f.ZodParsedType.nan){const oe=this._getOrReturnCtx(U);return(0,c.addIssueToContext)(oe,{code:i.ZodIssueCode.invalid_type,expected:f.ZodParsedType.nan,received:oe.parsedType}),c.INVALID}return{status:"valid",value:U.data}}}He.ZodNaN=Re,Re.create=Te=>new Re({typeName:Ze.ZodNaN,...l(Te)}),He.BRAND=Symbol("zod_brand");class je extends _{_parse(U){const{ctx:te}=this._processInputParams(U),oe=te.data;return this._def.type._parse({data:oe,path:te.path,parent:te})}unwrap(){return this._def.type}}He.ZodBranded=je;class Ge extends _{_parse(U){const{status:te,ctx:oe}=this._processInputParams(U);if(oe.common.async)return(async()=>{const De=await this._def.in._parseAsync({data:oe.data,path:oe.path,parent:oe});return De.status==="aborted"?c.INVALID:De.status==="dirty"?(te.dirty(),(0,c.DIRTY)(De.value)):this._def.out._parseAsync({data:De.value,path:oe.path,parent:oe})})();{const ke=this._def.in._parseSync({data:oe.data,path:oe.path,parent:oe});return ke.status==="aborted"?c.INVALID:ke.status==="dirty"?(te.dirty(),{status:"dirty",value:ke.value}):this._def.out._parseSync({data:ke.value,path:oe.path,parent:oe})}}static create(U,te){return new Ge({in:U,out:te,typeName:Ze.ZodPipeline})}}He.ZodPipeline=Ge;class Ne extends _{_parse(U){const te=this._def.innerType._parse(U),oe=ke=>((0,c.isValid)(ke)&&(ke.value=Object.freeze(ke.value)),ke);return(0,c.isAsync)(te)?te.then(ke=>oe(ke)):oe(te)}unwrap(){return this._def.innerType}}He.ZodReadonly=Ne,Ne.create=(Te,U)=>new Ne({innerType:Te,typeName:Ze.ZodReadonly,...l(U)});function Ye(Te,U){const te=typeof Te=="function"?Te(U):typeof Te=="string"?{message:Te}:Te;return typeof te=="string"?{message:te}:te}function ht(Te,U={},te){return Te?er.create().superRefine((oe,ke)=>{const De=Te(oe);if(De instanceof Promise)return De.then(Et=>{if(!Et){const ft=Ye(U,oe),$t=ft.fatal??te??!0;ke.addIssue({code:"custom",...ft,fatal:$t})}});if(!De){const Et=Ye(U,oe),ft=Et.fatal??te??!0;ke.addIssue({code:"custom",...Et,fatal:ft})}}):er.create()}He.late={object:rr.lazycreate};var Ze;(function(Te){Te.ZodString="ZodString",Te.ZodNumber="ZodNumber",Te.ZodNaN="ZodNaN",Te.ZodBigInt="ZodBigInt",Te.ZodBoolean="ZodBoolean",Te.ZodDate="ZodDate",Te.ZodSymbol="ZodSymbol",Te.ZodUndefined="ZodUndefined",Te.ZodNull="ZodNull",Te.ZodAny="ZodAny",Te.ZodUnknown="ZodUnknown",Te.ZodNever="ZodNever",Te.ZodVoid="ZodVoid",Te.ZodArray="ZodArray",Te.ZodObject="ZodObject",Te.ZodUnion="ZodUnion",Te.ZodDiscriminatedUnion="ZodDiscriminatedUnion",Te.ZodIntersection="ZodIntersection",Te.ZodTuple="ZodTuple",Te.ZodRecord="ZodRecord",Te.ZodMap="ZodMap",Te.ZodSet="ZodSet",Te.ZodFunction="ZodFunction",Te.ZodLazy="ZodLazy",Te.ZodLiteral="ZodLiteral",Te.ZodEnum="ZodEnum",Te.ZodEffects="ZodEffects",Te.ZodNativeEnum="ZodNativeEnum",Te.ZodOptional="ZodOptional",Te.ZodNullable="ZodNullable",Te.ZodDefault="ZodDefault",Te.ZodCatch="ZodCatch",Te.ZodPromise="ZodPromise",Te.ZodBranded="ZodBranded",Te.ZodPipeline="ZodPipeline",Te.ZodReadonly="ZodReadonly"})(Ze||(He.ZodFirstPartyTypeKind=Ze={}));const Mt=(Te,U={message:`Input not instance of ${Te.name}`})=>ht(te=>te instanceof Te,U);He.instanceof=Mt;const Ft=tt.create;He.string=Ft;const Ke=lt.create;He.number=Ke;const hr=Re.create;He.nan=hr;const Cr=ge.create;He.bigint=Cr;const Ot=Gt.create;He.boolean=Ot;const mr=Ut.create;He.date=mr;const ai=Ce.create;He.symbol=ai;const li=ar.create;He.undefined=li;const Wr=kt.create;He.null=Wr;const fi=er.create;He.any=fi;const jr=Ur.create;He.unknown=jr;const ei=or.create;He.never=ei;const Lr=Sr.create;He.void=Lr;const dt=Ar.create;He.array=dt;const Bi=rr.create;He.object=Bi;const Ci=rr.strictCreate;He.strictObject=Ci;const ki=gr.create;He.union=ki;const at=qr.create;He.discriminatedUnion=at;const At=Pr.create;He.intersection=At;const yr=St.create;He.tuple=yr;const lr=Qt.create;He.record=lr;const Ni=nr.create;He.map=Ni;const an=Tr.create;He.set=an;const Hi=$r.create;He.function=Hi;const ur=bt.create;He.lazy=ur;const Zn=pi.create;He.literal=Zn;const Hn=Oe.create;He.enum=Hn;const Bn=vt.create;He.nativeEnum=Bn;const ds=Nt.create;He.promise=ds;const Xi=ve.create;He.effect=Xi,He.transformer=Xi;const Mn=W.create;He.optional=Mn;const ui=J.create;He.nullable=ui;const Mi=ve.createWithPreprocess;He.preprocess=Mi;const Zr=Ge.create;He.pipeline=Zr;const ps=()=>Ft().optional();He.ostring=ps;const zn=()=>Ke().optional();He.onumber=zn;const Zs=()=>Ot().optional();return He.oboolean=Zs,He.coerce={string:(Te=>tt.create({...Te,coerce:!0})),number:(Te=>lt.create({...Te,coerce:!0})),boolean:(Te=>Gt.create({...Te,coerce:!0})),bigint:(Te=>ge.create({...Te,coerce:!0})),date:(Te=>Ut.create({...Te,coerce:!0}))},He.NEVER=c.INVALID,He}var jE;function NE(){return jE||(jE=1,(function(i){var n=Ou&&Ou.__createBinding||(Object.create?(function(c,f,y,e){e===void 0&&(e=y);var l=Object.getOwnPropertyDescriptor(f,y);(!l||("get"in l?!f.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return f[y]}}),Object.defineProperty(c,e,l)}):(function(c,f,y,e){e===void 0&&(e=y),c[e]=f[y]})),a=Ou&&Ou.__exportStar||function(c,f){for(var y in c)y!=="default"&&!Object.prototype.hasOwnProperty.call(f,y)&&n(f,c,y)};Object.defineProperty(i,"__esModule",{value:!0}),a(Yx(),i),a(KD(),i),a(Zj(),i),a(sv(),i),a(Xj(),i),a(Wx(),i)})(Ou)),Ou}var FE;function bc(){return FE||(FE=1,(function(i){var n=_o&&_o.__createBinding||(Object.create?(function(e,l,_,w){w===void 0&&(w=_);var R=Object.getOwnPropertyDescriptor(l,_);(!R||("get"in R?!l.__esModule:R.writable||R.configurable))&&(R={enumerable:!0,get:function(){return l[_]}}),Object.defineProperty(e,w,R)}):(function(e,l,_,w){w===void 0&&(w=_),e[w]=l[_]})),a=_o&&_o.__setModuleDefault||(Object.create?(function(e,l){Object.defineProperty(e,"default",{enumerable:!0,value:l})}):function(e,l){e.default=l}),c=_o&&_o.__importStar||function(e){if(e&&e.__esModule)return e;var l={};if(e!=null)for(var _ in e)_!=="default"&&Object.prototype.hasOwnProperty.call(e,_)&&n(l,e,_);return a(l,e),l},f=_o&&_o.__exportStar||function(e,l){for(var _ in e)_!=="default"&&!Object.prototype.hasOwnProperty.call(l,_)&&n(l,e,_)};Object.defineProperty(i,"__esModule",{value:!0}),i.z=void 0;const y=c(NE());i.z=y,f(NE(),i),i.default=y})(_o)),_o}var bo={},vo={},qE;function Wj(){if(qE)return vo;qE=1,Object.defineProperty(vo,"__esModule",{value:!0}),vo.isObject=vo.assure=vo.create=vo.is=void 0;const i=(f,y)=>y.safeParse(f).success;vo.is=i;const n=f=>y=>f.safeParse(y).success;vo.create=n;const a=(f,y)=>f.parse(y);vo.assure=a;const c=f=>typeof f=="object"&&f!==null;return vo.isObject=c,vo}var I0={},KE;function im(){return KE||(KE=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.parseIntWithFallback=i.dedupeStrs=i.range=i.chunkArray=i.errHasMsg=i.isErrnoException=i.asyncFilter=i.s32decode=i.s32encode=i.streamToBuffer=i.flattenUint8Arrays=i.bailableWait=i.wait=i.jitter=i.noUndefinedVals=void 0,i.aggregateErrors=a,i.omit=f;const n=Q=>(Object.keys(Q).forEach(Be=>{Q[Be]===void 0&&delete Q[Be]}),Q);i.noUndefinedVals=n;function a(Q,Be){return Q.length===1?Q[0]instanceof Error?Q[0]:new Error(Be??c(Q[0]),{cause:Q[0]}):new AggregateError(Q,Be??`Multiple errors: ${Q.map(c).join(`
`)}`)}function c(Q){return Q instanceof Error?Q.message:String(Q)}function f(Q,Be){if(!Q)return Q;const we={},ze=Object.keys(Q);for(let et=0;et<ze.length;et++){const gt=ze[et];Be.includes(gt)||(we[gt]=Q[gt])}return we}const y=Q=>Math.round((Math.random()-.5)*Q*2);i.jitter=y;const e=Q=>new Promise(Be=>setTimeout(Be,Q));i.wait=e;const l=Q=>{let Be;const we=new Promise(ze=>{const et=setTimeout(ze,Q);Be=()=>{clearTimeout(et),ze()}});return{bail:Be,wait:()=>we}};i.bailableWait=l;const _=Q=>{const Be=Q.reduce((et,gt)=>et+gt.length,0),we=new Uint8Array(Be);let ze=0;return Q.forEach(et=>{we.set(et,ze),ze+=et.length}),we};i.flattenUint8Arrays=_;const w=async Q=>{const Be=[];for await(const we of Q)Be.push(we);return(0,i.flattenUint8Arrays)(Be)};i.streamToBuffer=w;const R="234567abcdefghijklmnopqrstuvwxyz",C=Q=>{let Be="";for(;Q;){const we=Q%32;Q=Math.floor(Q/32),Be=R.charAt(we)+Be}return Be};i.s32encode=C;const I=Q=>{let Be=0;for(const we of Q)Be=Be*32+R.indexOf(we);return Be};i.s32decode=I;const L=async(Q,Be)=>{const we=await Promise.all(Q.map(ze=>Be(ze)));return Q.filter((ze,et)=>we[et])};i.asyncFilter=L;const O=Q=>!!Q&&Q.code;i.isErrnoException=O;const q=(Q,Be)=>!!Q&&typeof Q=="object"&&Q.message===Be;i.errHasMsg=q;const G=(Q,Be)=>Q.reduce((we,ze,et)=>{const gt=Math.floor(et/Be);return we[gt]||(we[gt]=[]),we[gt].push(ze),we},[]);i.chunkArray=G;const j=Q=>{const Be=[];for(let we=0;we<Q;we++)Be.push(we);return Be};i.range=j;const ne=Q=>[...new Set(Q)];i.dedupeStrs=ne;const he=(Q,Be)=>{const we=parseInt(Q||"",10);return isNaN(we)?Be:we};i.parseIntWithFallback=he})(I0)),I0}var Td={},GE;function Yj(){if(GE)return Td;GE=1,Object.defineProperty(Td,"__esModule",{value:!0}),Td.mapDefined=void 0,Td.keyBy=i;function i(a,c){return a.reduce((f,y)=>(f.set(y[c],y),f),new Map)}const n=(a,c)=>{const f=[];for(const y of a){const e=c(y);e!==void 0&&f.push(e)}return f};return Td.mapDefined=n,Td}var B0={},$E;function Jj(){return $E||($E=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.AsyncBufferFullError=i.AsyncBuffer=i.allComplete=i.createDeferrables=i.createDeferrable=i.readFromGenerator=void 0,i.allFulfilled=_,i.handleAllSettledErrors=w,i.isRejectedResult=R,i.isFulfilledResult=I;const n=im(),a=async(O,q,G=Promise.resolve(),j=Number.MAX_SAFE_INTEGER)=>{const ne=[];let he,Q=!1;const Be=async()=>{if(await q(ne.at(-1)))return!0;const ze=(0,n.bailableWait)(20);return await ze.wait(),he=ze.bail,Q?!1:await Be()},we=new Promise(ze=>{G.then(()=>{Be().then(()=>ze())})});try{for(;ne.length<j;){const ze=await Promise.race([O.next(),we]);if(!ze)break;const et=ze;if(et.done)break;ne.push(et.value)}}finally{Q=!0,he&&he()}return ne};i.readFromGenerator=a;const c=()=>{let O;const q=new Promise(G=>{O=()=>G()});return{resolve:O,complete:q}};i.createDeferrable=c;const f=O=>{const q=[];for(let G=0;G<O;G++)q.push((0,i.createDeferrable)());return q};i.createDeferrables=f;const y=async O=>{await Promise.all(O.map(q=>q.complete))};i.allComplete=y;class e{constructor(q){Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:q}),Object.defineProperty(this,"buffer",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"promise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resolve",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"toThrow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.promise=Promise.resolve(),this.resolve=()=>null,this.resetPromise()}get curr(){return this.buffer}get size(){return this.buffer.length}get isClosed(){return this.closed}resetPromise(){this.promise=new Promise(q=>this.resolve=q)}push(q){this.buffer.push(q),this.resolve()}pushMany(q){q.forEach(G=>this.buffer.push(G)),this.resolve()}async*events(){for(;;){if(this.closed&&this.buffer.length===0){if(this.toThrow)throw this.toThrow;return}if(await this.promise,this.toThrow)throw this.toThrow;if(this.maxSize&&this.size>this.maxSize)throw new l(this.maxSize);const[q,...G]=this.buffer;q?(this.buffer=G,yield q):this.resetPromise()}}throw(q){this.toThrow=q,this.closed=!0,this.resolve()}close(){this.closed=!0,this.resolve()}}i.AsyncBuffer=e;class l extends Error{constructor(q){super(`ReachedMaxBufferSize: ${q}`)}}i.AsyncBufferFullError=l;function _(O){return Promise.allSettled(O).then(w)}function w(O){if(O.every(I))return O.map(L);const q=O.filter(R).map(C);throw(0,n.aggregateErrors)(q)}function R(O){return O.status==="rejected"}function C(O){return O.reason}function I(O){return O.status==="fulfilled"}function L(O){return O.value}})(B0)),B0}var uh={},ZE;function Qj(){if(ZE)return uh;ZE=1,Object.defineProperty(uh,"__esModule",{value:!0}),uh.TID=void 0;const i=im(),n=13;let a=0,c=0,f=null;function y(l){return l.replaceAll("-","")}class e{constructor(_){Object.defineProperty(this,"str",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const w=y(_);if(w.length!==n)throw new Error(`Poorly formatted TID: ${w.length} length`);this.str=w}static next(_){const w=Math.max(Date.now(),a);w===a&&c++,a=w;const R=w*1e3+c;f===null&&(f=Math.floor(Math.random()*32));const C=e.fromTime(R,f);return!_||C.newerThan(_)?C:e.fromTime(_.timestamp()+1,f)}static nextStr(_){return e.next(_?new e(_):void 0).toString()}static fromTime(_,w){const R=`${(0,i.s32encode)(_)}${(0,i.s32encode)(w).padStart(2,"2")}`;return new e(R)}static fromStr(_){return new e(_)}static oldestFirst(_,w){return _.compareTo(w)}static newestFirst(_,w){return w.compareTo(_)}static is(_){return y(_).length===n}timestamp(){return(0,i.s32decode)(this.str.slice(0,11))}clockid(){return(0,i.s32decode)(this.str.slice(11,13))}formatted(){const _=this.toString();return`${_.slice(0,4)}-${_.slice(4,7)}-${_.slice(7,11)}-${_.slice(11,13)}`}toString(){return this.str}compareTo(_){return this.str>_.str?1:this.str<_.str?-1:0}equals(_){return this.str===_.str}newerThan(_){return this.compareTo(_)>0}olderThan(_){return this.compareTo(_)<0}}return uh.TID=e,uh}var Da={},eN=GD,HE=128,tN=-128,rN=Math.pow(2,31);function GD(i,n,a){n=n||[],a=a||0;for(var c=a;i>=rN;)n[a++]=i&255|HE,i/=128;for(;i&tN;)n[a++]=i&255|HE,i>>>=7;return n[a]=i|0,GD.bytes=a-c+1,n}var iN=wx,nN=128,XE=127;function wx(i,c){var a=0,c=c||0,f=0,y=c,e,l=i.length;do{if(y>=l)throw wx.bytes=0,new RangeError("Could not decode varint");e=i[y++],a+=f<28?(e&XE)<<f:(e&XE)*Math.pow(2,f),f+=7}while(e>=nN);return wx.bytes=y-c,a}var sN=Math.pow(2,7),oN=Math.pow(2,14),aN=Math.pow(2,21),lN=Math.pow(2,28),uN=Math.pow(2,35),cN=Math.pow(2,42),dN=Math.pow(2,49),pN=Math.pow(2,56),fN=Math.pow(2,63),hN=function(i){return i<sN?1:i<oN?2:i<aN?3:i<lN?4:i<uN?5:i<cN?6:i<dN?7:i<pN?8:i<fN?9:10},mN={encode:eN,decode:iN,encodingLength:hN},Fb=mN;const Ex=(i,n=0)=>[Fb.decode(i,n),Fb.decode.bytes],qb=(i,n,a=0)=>(Fb.encode(i,n,a),n),Kb=i=>Fb.encodingLength(i),yN=(i,n)=>{if(i===n)return!0;if(i.byteLength!==n.byteLength)return!1;for(let a=0;a<i.byteLength;a++)if(i[a]!==n[a])return!1;return!0},Jx=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},gN=i=>new TextEncoder().encode(i),_N=i=>new TextDecoder().decode(i),bN=(i,n)=>{const a=n.byteLength,c=Kb(i),f=c+Kb(a),y=new Uint8Array(f+a);return qb(i,y,0),qb(a,y,c),y.set(n,f),new Qx(i,a,n,y)},vN=i=>{const n=Jx(i),[a,c]=Ex(n),[f,y]=Ex(n.subarray(c)),e=n.subarray(c+y);if(e.byteLength!==f)throw new Error("Incorrect length");return new Qx(a,f,e,n)},xN=(i,n)=>i===n?!0:i.code===n.code&&i.size===n.size&&yN(i.bytes,n.bytes);class Qx{constructor(n,a,c,f){this.code=n,this.size=a,this.digest=c,this.bytes=f}}function wN(i,n){if(i.length>=255)throw new TypeError("Alphabet too long");for(var a=new Uint8Array(256),c=0;c<a.length;c++)a[c]=255;for(var f=0;f<i.length;f++){var y=i.charAt(f),e=y.charCodeAt(0);if(a[e]!==255)throw new TypeError(y+" is ambiguous");a[e]=f}var l=i.length,_=i.charAt(0),w=Math.log(l)/Math.log(256),R=Math.log(256)/Math.log(l);function C(O){if(O instanceof Uint8Array||(ArrayBuffer.isView(O)?O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength):Array.isArray(O)&&(O=Uint8Array.from(O))),!(O instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(O.length===0)return"";for(var q=0,G=0,j=0,ne=O.length;j!==ne&&O[j]===0;)j++,q++;for(var he=(ne-j)*R+1>>>0,Q=new Uint8Array(he);j!==ne;){for(var Be=O[j],we=0,ze=he-1;(Be!==0||we<G)&&ze!==-1;ze--,we++)Be+=256*Q[ze]>>>0,Q[ze]=Be%l>>>0,Be=Be/l>>>0;if(Be!==0)throw new Error("Non-zero carry");G=we,j++}for(var et=he-G;et!==he&&Q[et]===0;)et++;for(var gt=_.repeat(q);et<he;++et)gt+=i.charAt(Q[et]);return gt}function I(O){if(typeof O!="string")throw new TypeError("Expected String");if(O.length===0)return new Uint8Array;var q=0;if(O[q]!==" "){for(var G=0,j=0;O[q]===_;)G++,q++;for(var ne=(O.length-q)*w+1>>>0,he=new Uint8Array(ne);O[q];){var Q=a[O.charCodeAt(q)];if(Q===255)return;for(var Be=0,we=ne-1;(Q!==0||Be<j)&&we!==-1;we--,Be++)Q+=l*he[we]>>>0,he[we]=Q%256>>>0,Q=Q/256>>>0;if(Q!==0)throw new Error("Non-zero carry");j=Be,q++}if(O[q]!==" "){for(var ze=ne-j;ze!==ne&&he[ze]===0;)ze++;for(var et=new Uint8Array(G+(ne-ze)),gt=G;ze!==ne;)et[gt++]=he[ze++];return et}}}function L(O){var q=I(O);if(q)return q;throw new Error(`Non-${n} character`)}return{encode:C,decodeUnsafe:I,decode:L}}var EN=wN,AN=EN;class RN{constructor(n,a,c){this.name=n,this.prefix=a,this.baseEncode=c}encode(n){if(n instanceof Uint8Array)return`${this.prefix}${this.baseEncode(n)}`;throw Error("Unknown type, must be binary type")}}class SN{constructor(n,a,c){if(this.name=n,this.prefix=a,a.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=a.codePointAt(0),this.baseDecode=c}decode(n){if(typeof n=="string"){if(n.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(n)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(n.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(n){return $D(this,n)}}class TN{constructor(n){this.decoders=n}or(n){return $D(this,n)}decode(n){const a=n[0],c=this.decoders[a];if(c)return c.decode(n);throw RangeError(`Unable to decode multibase string ${JSON.stringify(n)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const $D=(i,n)=>new TN({...i.decoders||{[i.prefix]:i},...n.decoders||{[n.prefix]:n}});class CN{constructor(n,a,c,f){this.name=n,this.prefix=a,this.baseEncode=c,this.baseDecode=f,this.encoder=new RN(n,a,c),this.decoder=new SN(n,a,f)}encode(n){return this.encoder.encode(n)}decode(n){return this.decoder.decode(n)}}const ov=({name:i,prefix:n,encode:a,decode:c})=>new CN(i,n,a,c),dm=({prefix:i,name:n,alphabet:a})=>{const{encode:c,decode:f}=AN(a,n);return ov({prefix:i,name:n,encode:c,decode:y=>Jx(f(y))})},kN=(i,n,a,c)=>{const f={};for(let R=0;R<n.length;++R)f[n[R]]=R;let y=i.length;for(;i[y-1]==="=";)--y;const e=new Uint8Array(y*a/8|0);let l=0,_=0,w=0;for(let R=0;R<y;++R){const C=f[i[R]];if(C===void 0)throw new SyntaxError(`Non-${c} character`);_=_<<a|C,l+=a,l>=8&&(l-=8,e[w++]=255&_>>l)}if(l>=a||255&_<<8-l)throw new SyntaxError("Unexpected end of data");return e},PN=(i,n,a)=>{const c=n[n.length-1]==="=",f=(1<<a)-1;let y="",e=0,l=0;for(let _=0;_<i.length;++_)for(l=l<<8|i[_],e+=8;e>a;)e-=a,y+=n[f&l>>e];if(e&&(y+=n[f&l<<a-e]),c)for(;y.length*a&7;)y+="=";return y},In=({name:i,prefix:n,bitsPerChar:a,alphabet:c})=>ov({prefix:n,name:i,encode(f){return PN(f,c,a)},decode(f){return kN(f,c,a,i)}}),za=dm({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),LN=dm({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),DN=Object.freeze(Object.defineProperty({__proto__:null,base58btc:za,base58flickr:LN},Symbol.toStringTag,{value:"Module"})),Jh=In({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),IN=In({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),BN=In({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),MN=In({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zN=In({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ON=In({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),VN=In({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),UN=In({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),jN=In({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),NN=Object.freeze(Object.defineProperty({__proto__:null,base32:Jh,base32hex:zN,base32hexpad:VN,base32hexpadupper:UN,base32hexupper:ON,base32pad:BN,base32padupper:MN,base32upper:IN,base32z:jN},Symbol.toStringTag,{value:"Module"}));class Fn{constructor(n,a,c,f){this.code=a,this.version=n,this.multihash=c,this.bytes=f,this.byteOffset=f.byteOffset,this.byteLength=f.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Ly,byteLength:Ly,code:Py,version:Py,multihash:Py,bytes:Py,_baseCache:Ly,asCID:Ly})}toV0(){switch(this.version){case 0:return this;default:{const{code:n,multihash:a}=this;if(n!==ch)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(a.code!==GN)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Fn.createV0(a)}}}toV1(){switch(this.version){case 0:{const{code:n,digest:a}=this.multihash,c=bN(n,a);return Fn.createV1(this.code,c)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(n){return n&&this.code===n.code&&this.version===n.version&&xN(this.multihash,n.multihash)}toString(n){const{bytes:a,version:c,_baseCache:f}=this;switch(c){case 0:return qN(a,f,n||za.encoder);default:return KN(a,f,n||Jh.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(n){return ZN(/^0\.0/,HN),!!(n&&(n[YE]||n.asCID===n))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(n){if(n instanceof Fn)return n;if(n!=null&&n.asCID===n){const{version:a,code:c,multihash:f,bytes:y}=n;return new Fn(a,c,f,y||WE(a,c,f.bytes))}else if(n!=null&&n[YE]===!0){const{version:a,multihash:c,code:f}=n,y=vN(c);return Fn.create(a,f,y)}else return null}static create(n,a,c){if(typeof a!="number")throw new Error("String codecs are no longer supported");switch(n){case 0:{if(a!==ch)throw new Error(`Version 0 CID must use dag-pb (code: ${ch}) block encoding`);return new Fn(n,a,c,c.bytes)}case 1:{const f=WE(n,a,c.bytes);return new Fn(n,a,c,f)}default:throw new Error("Invalid version")}}static createV0(n){return Fn.create(0,ch,n)}static createV1(n,a){return Fn.create(1,n,a)}static decode(n){const[a,c]=Fn.decodeFirst(n);if(c.length)throw new Error("Incorrect length");return a}static decodeFirst(n){const a=Fn.inspectBytes(n),c=a.size-a.multihashSize,f=Jx(n.subarray(c,c+a.multihashSize));if(f.byteLength!==a.multihashSize)throw new Error("Incorrect length");const y=f.subarray(a.multihashSize-a.digestSize),e=new Qx(a.multihashCode,a.digestSize,y,f);return[a.version===0?Fn.createV0(e):Fn.createV1(a.codec,e),n.subarray(a.size)]}static inspectBytes(n){let a=0;const c=()=>{const[C,I]=Ex(n.subarray(a));return a+=I,C};let f=c(),y=ch;if(f===18?(f=0,a=0):f===1&&(y=c()),f!==0&&f!==1)throw new RangeError(`Invalid CID version ${f}`);const e=a,l=c(),_=c(),w=a+_,R=w-e;return{version:f,codec:y,multihashCode:l,digestSize:_,multihashSize:R,size:w}}static parse(n,a){const[c,f]=FN(n,a),y=Fn.decode(f);return y._baseCache.set(c,n),y}}const FN=(i,n)=>{switch(i[0]){case"Q":{const a=n||za;return[za.prefix,a.decode(`${za.prefix}${i}`)]}case za.prefix:{const a=n||za;return[za.prefix,a.decode(i)]}case Jh.prefix:{const a=n||Jh;return[Jh.prefix,a.decode(i)]}default:{if(n==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[i[0],n.decode(i)]}}},qN=(i,n,a)=>{const{prefix:c}=a;if(c!==za.prefix)throw Error(`Cannot string encode V0 in ${a.name} encoding`);const f=n.get(c);if(f==null){const y=a.encode(i).slice(1);return n.set(c,y),y}else return f},KN=(i,n,a)=>{const{prefix:c}=a,f=n.get(c);if(f==null){const y=a.encode(i);return n.set(c,y),y}else return f},ch=112,GN=18,WE=(i,n,a)=>{const c=Kb(i),f=c+Kb(n),y=new Uint8Array(f+a.byteLength);return qb(i,y,0),qb(n,y,c),y.set(a,f),y},YE=Symbol.for("@ipld/js-cid/CID"),Py={writable:!1,configurable:!1,enumerable:!0},Ly={writable:!1,enumerable:!1,configurable:!1},$N="0.0.0-dev",ZN=(i,n)=>{if(i.test($N))console.warn(n);else throw new Error(n)},HN=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`,XN=Object.freeze(Object.defineProperty({__proto__:null,CID:Fn},Symbol.toStringTag,{value:"Module"})),Zp=oD(XN);function WN(i,n){for(let a=0;a<i.byteLength;a++){if(i[a]<n[a])return-1;if(i[a]>n[a])return 1}return i.byteLength>n.byteLength?1:i.byteLength<n.byteLength?-1:0}function YN(i,n){n||(n=i.reduce((f,y)=>f+y.length,0));const a=new Uint8Array(n);let c=0;for(const f of i)a.set(f,c),c+=f.length;return a}function JN(i,n){if(i===n)return!0;if(i.byteLength!==n.byteLength)return!1;for(let a=0;a<i.byteLength;a++)if(i[a]!==n[a])return!1;return!0}const QN=ov({prefix:"\0",name:"identity",encode:i=>_N(i),decode:i=>gN(i)}),e5=Object.freeze(Object.defineProperty({__proto__:null,identity:QN},Symbol.toStringTag,{value:"Module"})),t5=In({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),r5=Object.freeze(Object.defineProperty({__proto__:null,base2:t5},Symbol.toStringTag,{value:"Module"})),i5=In({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),n5=Object.freeze(Object.defineProperty({__proto__:null,base8:i5},Symbol.toStringTag,{value:"Module"})),s5=dm({prefix:"9",name:"base10",alphabet:"0123456789"}),o5=Object.freeze(Object.defineProperty({__proto__:null,base10:s5},Symbol.toStringTag,{value:"Module"})),a5=In({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),l5=In({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),u5=Object.freeze(Object.defineProperty({__proto__:null,base16:a5,base16upper:l5},Symbol.toStringTag,{value:"Module"})),c5=dm({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),d5=dm({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),p5=Object.freeze(Object.defineProperty({__proto__:null,base36:c5,base36upper:d5},Symbol.toStringTag,{value:"Module"})),f5=In({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),h5=In({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),m5=In({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),y5=In({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),g5=Object.freeze(Object.defineProperty({__proto__:null,base64:f5,base64pad:h5,base64url:m5,base64urlpad:y5},Symbol.toStringTag,{value:"Module"})),ZD=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),_5=ZD.reduce((i,n,a)=>(i[a]=n,i),[]),b5=ZD.reduce((i,n,a)=>(i[n.codePointAt(0)]=a,i),[]);function v5(i){return i.reduce((n,a)=>(n+=_5[a],n),"")}function x5(i){const n=[];for(const a of i){const c=b5[a.codePointAt(0)];if(c===void 0)throw new Error(`Non-base256emoji character: ${a}`);n.push(c)}return new Uint8Array(n)}const w5=ov({prefix:"🚀",name:"base256emoji",encode:v5,decode:x5}),E5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:w5},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const JE={...e5,...r5,...n5,...o5,...u5,...NN,...p5,...DN,...g5,...E5};function HD(i,n,a,c){return{name:i,prefix:n,encoder:{name:i,prefix:n,encode:a},decoder:{decode:c}}}const QE=HD("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),M0=HD("ascii","a",i=>{let n="a";for(let a=0;a<i.length;a++)n+=String.fromCharCode(i[a]);return n},i=>{i=i.substring(1);const n=new Uint8Array(i.length);for(let a=0;a<i.length;a++)n[a]=i.charCodeAt(a);return n}),XD={utf8:QE,"utf-8":QE,hex:JE.base16,latin1:M0,ascii:M0,binary:M0,...JE};function A5(i,n="utf8"){const a=XD[n];if(!a)throw new Error(`Unsupported encoding "${n}"`);return a.decoder.decode(`${a.prefix}${i}`)}function R5(i,n="utf8"){const a=XD[n];if(!a)throw new Error(`Unsupported encoding "${n}"`);return a.encoder.encode(i).substring(1)}function S5(i,n){if(i.length!==n.length)throw new Error("Inputs should have the same length");const a=new Uint8Array(i.length);for(let c=0;c<i.length;c++)a[c]=i[c]^n[c];return a}const T5=Object.freeze(Object.defineProperty({__proto__:null,compare:WN,concat:YN,equals:JN,fromString:A5,toString:R5,xor:S5},Symbol.toStringTag,{value:"Module"})),WD=oD(T5);var eA;function C5(){return eA||(eA=1,(function(i){var n=Da&&Da.__createBinding||(Object.create?(function(w,R,C,I){I===void 0&&(I=C);var L=Object.getOwnPropertyDescriptor(R,C);(!L||("get"in L?!R.__esModule:L.writable||L.configurable))&&(L={enumerable:!0,get:function(){return R[C]}}),Object.defineProperty(w,I,L)}):(function(w,R,C,I){I===void 0&&(I=C),w[I]=R[C]})),a=Da&&Da.__setModuleDefault||(Object.create?(function(w,R){Object.defineProperty(w,"default",{enumerable:!0,value:R})}):function(w,R){w.default=R}),c=Da&&Da.__importStar||(function(){var w=function(R){return w=Object.getOwnPropertyNames||function(C){var I=[];for(var L in C)Object.prototype.hasOwnProperty.call(C,L)&&(I[I.length]=L);return I},w(R)};return function(R){if(R&&R.__esModule)return R;var C={};if(R!=null)for(var I=w(R),L=0;L<I.length;L++)I[L]!=="default"&&n(C,R,I[L]);return a(C,R),C}})();Object.defineProperty(i,"__esModule",{value:!0}),i.ipldEquals=i.ipldToJson=i.jsonToIpld=void 0;const f=Zp,y=c(WD),e=w=>{if(Array.isArray(w))return w.map(R=>(0,i.jsonToIpld)(R));if(w&&typeof w=="object"){if(typeof w.$link=="string"&&Object.keys(w).length===1)return f.CID.parse(w.$link);if(typeof w.$bytes=="string"&&Object.keys(w).length===1)return y.fromString(w.$bytes,"base64");const R={};for(const C of Object.keys(w))R[C]=(0,i.jsonToIpld)(w[C]);return R}return w};i.jsonToIpld=e;const l=w=>{if(Array.isArray(w))return w.map(R=>(0,i.ipldToJson)(R));if(w&&typeof w=="object"){if(w instanceof Uint8Array)return{$bytes:y.toString(w,"base64")};if(f.CID.asCID(w))return{$link:w.toString()};const R={};for(const C of Object.keys(w))R[C]=(0,i.ipldToJson)(w[C]);return R}return w};i.ipldToJson=l;const _=(w,R)=>{if(Array.isArray(w)&&Array.isArray(R)){if(w.length!==R.length)return!1;for(let C=0;C<w.length;C++)if(!(0,i.ipldEquals)(w[C],R[C]))return!1;return!0}if(w&&R&&typeof w=="object"&&typeof R=="object"){if(w instanceof Uint8Array&&R instanceof Uint8Array)return y.equals(w,R);if(f.CID.asCID(w)&&f.CID.asCID(R))return f.CID.asCID(w)?.equals(f.CID.asCID(R));if(Object.keys(w).length!==Object.keys(R).length)return!1;for(const C of Object.keys(w))if(!(0,i.ipldEquals)(w[C],R[C]))return!1;return!0}return w===R};i.ipldEquals=_})(Da)),Da}var Cd={},tA;function k5(){if(tA)return Cd;tA=1,Object.defineProperty(Cd,"__esModule",{value:!0}),Cd.retry=n,Cd.createRetryable=a,Cd.backoffMs=c;const i=im();async function n(e,l={}){const{maxRetries:_=3,retryable:w=()=>!0,getWaitMs:R=c}=l;let C=0,I;for(;!I;)try{return await e()}catch(L){const O=R(C);C<_&&O!==null&&w(L)?(C+=1,O!==0&&await(0,i.wait)(O)):I=L}throw I}function a(e){return async(l,_)=>n(l,{..._,retryable:e})}function c(e,l=100,_=1e3){const w=Math.pow(2,e)*l,R=Math.min(w,_);return f(R)}function f(e){const l=e*.15;return e+y(-l,l)}function y(e,l){return Math.random()*(l-e)+e}return Cd}var z0={},rA;function P5(){return rA||(rA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.def=i.schema=void 0;const n=Zp,a=bc(),c=a.z.unknown().transform((y,e)=>{const l=n.CID.asCID(y);return l??(e.addIssue({code:a.z.ZodIssueCode.custom,message:"Not a valid CID"}),a.z.NEVER)}),f=a.z.object({version:a.z.literal(1),roots:a.z.array(c)});i.schema={cid:c,carHeader:f,bytes:a.z.instanceof(Uint8Array),string:a.z.string(),array:a.z.array(a.z.unknown()),map:a.z.record(a.z.string(),a.z.unknown()),unknown:a.z.unknown()},i.def={cid:{name:"cid",schema:i.schema.cid},carHeader:{name:"CAR header",schema:i.schema.carHeader},bytes:{name:"bytes",schema:i.schema.bytes},string:{name:"string",schema:i.schema.string},map:{name:"map",schema:i.schema.map},unknown:{name:"unknown",schema:i.schema.unknown}}})(z0)),z0}var O0={},iA;function L5(){return iA||(iA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.addHoursToDate=i.lessThanAgoMs=i.DAY=i.HOUR=i.MINUTE=i.SECOND=void 0,i.SECOND=1e3,i.MINUTE=i.SECOND*60,i.HOUR=i.MINUTE*60,i.DAY=i.HOUR*24;const n=(c,f)=>Date.now()<c.getTime()+f;i.lessThanAgoMs=n;const a=(c,f)=>{const y=f?new Date(f):new Date;return y.setHours(y.getHours()+c),y};i.addHoursToDate=a})(O0)),O0}var ji={},kd={},Pd={},V0={},nA;function YD(){return nA||(nA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.EXTENDED_PICTOGRAPHIC=i.CLUSTER_BREAK=void 0,(function(n){n[n.CR=0]="CR",n[n.LF=1]="LF",n[n.CONTROL=2]="CONTROL",n[n.EXTEND=3]="EXTEND",n[n.REGIONAL_INDICATOR=4]="REGIONAL_INDICATOR",n[n.SPACINGMARK=5]="SPACINGMARK",n[n.L=6]="L",n[n.V=7]="V",n[n.T=8]="T",n[n.LV=9]="LV",n[n.LVT=10]="LVT",n[n.OTHER=11]="OTHER",n[n.PREPEND=12]="PREPEND",n[n.E_BASE=13]="E_BASE",n[n.E_MODIFIER=14]="E_MODIFIER",n[n.ZWJ=15]="ZWJ",n[n.GLUE_AFTER_ZWJ=16]="GLUE_AFTER_ZWJ",n[n.E_BASE_GAZ=17]="E_BASE_GAZ"})(i.CLUSTER_BREAK||(i.CLUSTER_BREAK={})),i.EXTENDED_PICTOGRAPHIC=101})(V0)),V0}var Dy={},sA;function D5(){if(sA)return Dy;sA=1,Object.defineProperty(Dy,"__esModule",{value:!0});const i=YD(),n=0,a=1,c=2,f=3,y=4;let e=class{static isSurrogate(_,w){return 55296<=_.charCodeAt(w)&&_.charCodeAt(w)<=56319&&56320<=_.charCodeAt(w+1)&&_.charCodeAt(w+1)<=57343}static codePointAt(_,w){w===void 0&&(w=0);const R=_.charCodeAt(w);if(55296<=R&&R<=56319&&w<_.length-1){const C=R,I=_.charCodeAt(w+1);return 56320<=I&&I<=57343?(C-55296)*1024+(I-56320)+65536:C}if(56320<=R&&R<=57343&&w>=1){const C=_.charCodeAt(w-1),I=R;return 55296<=C&&C<=56319?(C-55296)*1024+(I-56320)+65536:I}return R}static shouldBreak(_,w,R,C,I,L){const O=[_].concat(w).concat([R]),q=[C].concat(I).concat([L]),G=O[O.length-2],j=R,ne=L,he=O.lastIndexOf(i.CLUSTER_BREAK.REGIONAL_INDICATOR);if(he>0&&O.slice(1,he).every(function(Be){return Be===i.CLUSTER_BREAK.REGIONAL_INDICATOR})&&[i.CLUSTER_BREAK.PREPEND,i.CLUSTER_BREAK.REGIONAL_INDICATOR].indexOf(G)===-1)return O.filter(function(Be){return Be===i.CLUSTER_BREAK.REGIONAL_INDICATOR}).length%2===1?f:y;if(G===i.CLUSTER_BREAK.CR&&j===i.CLUSTER_BREAK.LF)return n;if(G===i.CLUSTER_BREAK.CONTROL||G===i.CLUSTER_BREAK.CR||G===i.CLUSTER_BREAK.LF)return a;if(j===i.CLUSTER_BREAK.CONTROL||j===i.CLUSTER_BREAK.CR||j===i.CLUSTER_BREAK.LF)return a;if(G===i.CLUSTER_BREAK.L&&(j===i.CLUSTER_BREAK.L||j===i.CLUSTER_BREAK.V||j===i.CLUSTER_BREAK.LV||j===i.CLUSTER_BREAK.LVT))return n;if((G===i.CLUSTER_BREAK.LV||G===i.CLUSTER_BREAK.V)&&(j===i.CLUSTER_BREAK.V||j===i.CLUSTER_BREAK.T))return n;if((G===i.CLUSTER_BREAK.LVT||G===i.CLUSTER_BREAK.T)&&j===i.CLUSTER_BREAK.T)return n;if(j===i.CLUSTER_BREAK.EXTEND||j===i.CLUSTER_BREAK.ZWJ)return n;if(j===i.CLUSTER_BREAK.SPACINGMARK)return n;if(G===i.CLUSTER_BREAK.PREPEND)return n;const Q=q.slice(0,-1).lastIndexOf(i.EXTENDED_PICTOGRAPHIC);return Q!==-1&&q[Q]===i.EXTENDED_PICTOGRAPHIC&&O.slice(Q+1,-2).every(function(Be){return Be===i.CLUSTER_BREAK.EXTEND})&&G===i.CLUSTER_BREAK.ZWJ&&ne===i.EXTENDED_PICTOGRAPHIC?n:w.indexOf(i.CLUSTER_BREAK.REGIONAL_INDICATOR)!==-1?c:G===i.CLUSTER_BREAK.REGIONAL_INDICATOR&&j===i.CLUSTER_BREAK.REGIONAL_INDICATOR?n:a}};return Dy.default=e,Dy}var Iy={},oA;function I5(){if(oA)return Iy;oA=1,Object.defineProperty(Iy,"__esModule",{value:!0});let i=class{constructor(a,c){this._index=0,this._str=a,this._nextBreak=c}[Symbol.iterator](){return this}next(){let a;if((a=this._nextBreak(this._str,this._index))<this._str.length){const c=this._str.slice(this._index,a);return this._index=a,{value:c,done:!1}}if(this._index<this._str.length){const c=this._str.slice(this._index);return this._index=this._str.length,{value:c,done:!1}}return{value:void 0,done:!0}}};return Iy.default=i,Iy}var aA;function B5(){if(aA)return Pd;aA=1;var i=Pd&&Pd.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(Pd,"__esModule",{value:!0});const n=YD(),a=i(D5()),c=i(I5());let f=class jl{static nextBreak(e,l){if(l===void 0&&(l=0),l<0)return 0;if(l>=e.length-1)return e.length;const _=a.default.codePointAt(e,l),w=jl.getGraphemeBreakProperty(_),R=jl.getEmojiProperty(_),C=[],I=[];for(let L=l+1;L<e.length;L++){if(a.default.isSurrogate(e,L-1))continue;const O=a.default.codePointAt(e,L),q=jl.getGraphemeBreakProperty(O),G=jl.getEmojiProperty(O);if(a.default.shouldBreak(w,C,q,R,I,G))return L;C.push(q),I.push(G)}return e.length}splitGraphemes(e){const l=[];let _=0,w;for(;(w=jl.nextBreak(e,_))<e.length;)l.push(e.slice(_,w)),_=w;return _<e.length&&l.push(e.slice(_)),l}iterateGraphemes(e){return new c.default(e,jl.nextBreak)}countGraphemes(e){let l=0,_=0,w;for(;(w=jl.nextBreak(e,_))<e.length;)_=w,l++;return _<e.length&&l++,l}static getGraphemeBreakProperty(e){if(e<48905){if(e<44116){if(e<4141){if(e<2818){if(e<2363)if(e<1759){if(e<1471){if(e<127){if(e<11){if(e<10){if(0<=e&&e<=9)return n.CLUSTER_BREAK.CONTROL}else if(e===10)return n.CLUSTER_BREAK.LF}else if(e<13){if(11<=e&&e<=12)return n.CLUSTER_BREAK.CONTROL}else if(e<14){if(e===13)return n.CLUSTER_BREAK.CR}else if(14<=e&&e<=31)return n.CLUSTER_BREAK.CONTROL}else if(e<768){if(e<173){if(127<=e&&e<=159)return n.CLUSTER_BREAK.CONTROL}else if(e===173)return n.CLUSTER_BREAK.CONTROL}else if(e<1155){if(768<=e&&e<=879)return n.CLUSTER_BREAK.EXTEND}else if(e<1425){if(1155<=e&&e<=1161)return n.CLUSTER_BREAK.EXTEND}else if(1425<=e&&e<=1469)return n.CLUSTER_BREAK.EXTEND}else if(e<1552){if(e<1476){if(e<1473){if(e===1471)return n.CLUSTER_BREAK.EXTEND}else if(1473<=e&&e<=1474)return n.CLUSTER_BREAK.EXTEND}else if(e<1479){if(1476<=e&&e<=1477)return n.CLUSTER_BREAK.EXTEND}else if(e<1536){if(e===1479)return n.CLUSTER_BREAK.EXTEND}else if(1536<=e&&e<=1541)return n.CLUSTER_BREAK.PREPEND}else if(e<1648){if(e<1564){if(1552<=e&&e<=1562)return n.CLUSTER_BREAK.EXTEND}else if(e<1611){if(e===1564)return n.CLUSTER_BREAK.CONTROL}else if(1611<=e&&e<=1631)return n.CLUSTER_BREAK.EXTEND}else if(e<1750){if(e===1648)return n.CLUSTER_BREAK.EXTEND}else if(e<1757){if(1750<=e&&e<=1756)return n.CLUSTER_BREAK.EXTEND}else if(e===1757)return n.CLUSTER_BREAK.PREPEND}else if(e<2075){if(e<1840)if(e<1770){if(e<1767){if(1759<=e&&e<=1764)return n.CLUSTER_BREAK.EXTEND}else if(1767<=e&&e<=1768)return n.CLUSTER_BREAK.EXTEND}else if(e<1807){if(1770<=e&&e<=1773)return n.CLUSTER_BREAK.EXTEND}else{if(e===1807)return n.CLUSTER_BREAK.PREPEND;if(e===1809)return n.CLUSTER_BREAK.EXTEND}else if(e<2027){if(e<1958){if(1840<=e&&e<=1866)return n.CLUSTER_BREAK.EXTEND}else if(1958<=e&&e<=1968)return n.CLUSTER_BREAK.EXTEND}else if(e<2045){if(2027<=e&&e<=2035)return n.CLUSTER_BREAK.EXTEND}else if(e<2070){if(e===2045)return n.CLUSTER_BREAK.EXTEND}else if(2070<=e&&e<=2073)return n.CLUSTER_BREAK.EXTEND}else if(e<2200){if(e<2089){if(e<2085){if(2075<=e&&e<=2083)return n.CLUSTER_BREAK.EXTEND}else if(2085<=e&&e<=2087)return n.CLUSTER_BREAK.EXTEND}else if(e<2137){if(2089<=e&&e<=2093)return n.CLUSTER_BREAK.EXTEND}else if(e<2192){if(2137<=e&&e<=2139)return n.CLUSTER_BREAK.EXTEND}else if(2192<=e&&e<=2193)return n.CLUSTER_BREAK.PREPEND}else if(e<2275){if(e<2250){if(2200<=e&&e<=2207)return n.CLUSTER_BREAK.EXTEND}else if(e<2274){if(2250<=e&&e<=2273)return n.CLUSTER_BREAK.EXTEND}else if(e===2274)return n.CLUSTER_BREAK.PREPEND}else if(e<2307){if(2275<=e&&e<=2306)return n.CLUSTER_BREAK.EXTEND}else{if(e===2307)return n.CLUSTER_BREAK.SPACINGMARK;if(e===2362)return n.CLUSTER_BREAK.EXTEND}else if(e<2561){if(e<2434){if(e<2381){if(e<2366){if(e===2363)return n.CLUSTER_BREAK.SPACINGMARK;if(e===2364)return n.CLUSTER_BREAK.EXTEND}else if(e<2369){if(2366<=e&&e<=2368)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<2377){if(2369<=e&&e<=2376)return n.CLUSTER_BREAK.EXTEND}else if(2377<=e&&e<=2380)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<2385){if(e<2382){if(e===2381)return n.CLUSTER_BREAK.EXTEND}else if(2382<=e&&e<=2383)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<2402){if(2385<=e&&e<=2391)return n.CLUSTER_BREAK.EXTEND}else if(e<2433){if(2402<=e&&e<=2403)return n.CLUSTER_BREAK.EXTEND}else if(e===2433)return n.CLUSTER_BREAK.EXTEND}else if(e<2503){if(e<2494){if(e<2492){if(2434<=e&&e<=2435)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===2492)return n.CLUSTER_BREAK.EXTEND}else if(e<2495){if(e===2494)return n.CLUSTER_BREAK.EXTEND}else if(e<2497){if(2495<=e&&e<=2496)return n.CLUSTER_BREAK.SPACINGMARK}else if(2497<=e&&e<=2500)return n.CLUSTER_BREAK.EXTEND}else if(e<2519){if(e<2507){if(2503<=e&&e<=2504)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<2509){if(2507<=e&&e<=2508)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===2509)return n.CLUSTER_BREAK.EXTEND}else if(e<2530){if(e===2519)return n.CLUSTER_BREAK.EXTEND}else if(e<2558){if(2530<=e&&e<=2531)return n.CLUSTER_BREAK.EXTEND}else if(e===2558)return n.CLUSTER_BREAK.EXTEND}else if(e<2691){if(e<2631){if(e<2620){if(e<2563){if(2561<=e&&e<=2562)return n.CLUSTER_BREAK.EXTEND}else if(e===2563)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<2622){if(e===2620)return n.CLUSTER_BREAK.EXTEND}else if(e<2625){if(2622<=e&&e<=2624)return n.CLUSTER_BREAK.SPACINGMARK}else if(2625<=e&&e<=2626)return n.CLUSTER_BREAK.EXTEND}else if(e<2672){if(e<2635){if(2631<=e&&e<=2632)return n.CLUSTER_BREAK.EXTEND}else if(e<2641){if(2635<=e&&e<=2637)return n.CLUSTER_BREAK.EXTEND}else if(e===2641)return n.CLUSTER_BREAK.EXTEND}else if(e<2677){if(2672<=e&&e<=2673)return n.CLUSTER_BREAK.EXTEND}else if(e<2689){if(e===2677)return n.CLUSTER_BREAK.EXTEND}else if(2689<=e&&e<=2690)return n.CLUSTER_BREAK.EXTEND}else if(e<2761){if(e<2750){if(e===2691)return n.CLUSTER_BREAK.SPACINGMARK;if(e===2748)return n.CLUSTER_BREAK.EXTEND}else if(e<2753){if(2750<=e&&e<=2752)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<2759){if(2753<=e&&e<=2757)return n.CLUSTER_BREAK.EXTEND}else if(2759<=e&&e<=2760)return n.CLUSTER_BREAK.EXTEND}else if(e<2786){if(e<2763){if(e===2761)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<2765){if(2763<=e&&e<=2764)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===2765)return n.CLUSTER_BREAK.EXTEND}else if(e<2810){if(2786<=e&&e<=2787)return n.CLUSTER_BREAK.EXTEND}else if(e<2817){if(2810<=e&&e<=2815)return n.CLUSTER_BREAK.EXTEND}else if(e===2817)return n.CLUSTER_BREAK.EXTEND}else if(e<3315){if(e<3076){if(e<2946){if(e<2887){if(e<2878){if(e<2876){if(2818<=e&&e<=2819)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===2876)return n.CLUSTER_BREAK.EXTEND}else if(e<2880){if(2878<=e&&e<=2879)return n.CLUSTER_BREAK.EXTEND}else if(e<2881){if(e===2880)return n.CLUSTER_BREAK.SPACINGMARK}else if(2881<=e&&e<=2884)return n.CLUSTER_BREAK.EXTEND}else if(e<2893){if(e<2891){if(2887<=e&&e<=2888)return n.CLUSTER_BREAK.SPACINGMARK}else if(2891<=e&&e<=2892)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<2901){if(e===2893)return n.CLUSTER_BREAK.EXTEND}else if(e<2914){if(2901<=e&&e<=2903)return n.CLUSTER_BREAK.EXTEND}else if(2914<=e&&e<=2915)return n.CLUSTER_BREAK.EXTEND}else if(e<3014){if(e<3007){if(e===2946||e===3006)return n.CLUSTER_BREAK.EXTEND}else if(e<3008){if(e===3007)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3009){if(e===3008)return n.CLUSTER_BREAK.EXTEND}else if(3009<=e&&e<=3010)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3031){if(e<3018){if(3014<=e&&e<=3016)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3021){if(3018<=e&&e<=3020)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===3021)return n.CLUSTER_BREAK.EXTEND}else if(e<3072){if(e===3031)return n.CLUSTER_BREAK.EXTEND}else if(e<3073){if(e===3072)return n.CLUSTER_BREAK.EXTEND}else if(3073<=e&&e<=3075)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3262){if(e<3146){if(e<3134){if(e===3076||e===3132)return n.CLUSTER_BREAK.EXTEND}else if(e<3137){if(3134<=e&&e<=3136)return n.CLUSTER_BREAK.EXTEND}else if(e<3142){if(3137<=e&&e<=3140)return n.CLUSTER_BREAK.SPACINGMARK}else if(3142<=e&&e<=3144)return n.CLUSTER_BREAK.EXTEND}else if(e<3201){if(e<3157){if(3146<=e&&e<=3149)return n.CLUSTER_BREAK.EXTEND}else if(e<3170){if(3157<=e&&e<=3158)return n.CLUSTER_BREAK.EXTEND}else if(3170<=e&&e<=3171)return n.CLUSTER_BREAK.EXTEND}else if(e<3202){if(e===3201)return n.CLUSTER_BREAK.EXTEND}else if(e<3260){if(3202<=e&&e<=3203)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===3260)return n.CLUSTER_BREAK.EXTEND}else if(e<3270){if(e<3264){if(e===3262)return n.CLUSTER_BREAK.SPACINGMARK;if(e===3263)return n.CLUSTER_BREAK.EXTEND}else if(e<3266){if(3264<=e&&e<=3265)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3267){if(e===3266)return n.CLUSTER_BREAK.EXTEND}else if(3267<=e&&e<=3268)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3276){if(e<3271){if(e===3270)return n.CLUSTER_BREAK.EXTEND}else if(e<3274){if(3271<=e&&e<=3272)return n.CLUSTER_BREAK.SPACINGMARK}else if(3274<=e&&e<=3275)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3285){if(3276<=e&&e<=3277)return n.CLUSTER_BREAK.EXTEND}else if(e<3298){if(3285<=e&&e<=3286)return n.CLUSTER_BREAK.EXTEND}else if(3298<=e&&e<=3299)return n.CLUSTER_BREAK.EXTEND}else if(e<3551){if(e<3406){if(e<3391){if(e<3330){if(e<3328){if(e===3315)return n.CLUSTER_BREAK.SPACINGMARK}else if(3328<=e&&e<=3329)return n.CLUSTER_BREAK.EXTEND}else if(e<3387){if(3330<=e&&e<=3331)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3390){if(3387<=e&&e<=3388)return n.CLUSTER_BREAK.EXTEND}else if(e===3390)return n.CLUSTER_BREAK.EXTEND}else if(e<3398){if(e<3393){if(3391<=e&&e<=3392)return n.CLUSTER_BREAK.SPACINGMARK}else if(3393<=e&&e<=3396)return n.CLUSTER_BREAK.EXTEND}else if(e<3402){if(3398<=e&&e<=3400)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3405){if(3402<=e&&e<=3404)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===3405)return n.CLUSTER_BREAK.EXTEND}else if(e<3530){if(e<3426){if(e===3406)return n.CLUSTER_BREAK.PREPEND;if(e===3415)return n.CLUSTER_BREAK.EXTEND}else if(e<3457){if(3426<=e&&e<=3427)return n.CLUSTER_BREAK.EXTEND}else if(e<3458){if(e===3457)return n.CLUSTER_BREAK.EXTEND}else if(3458<=e&&e<=3459)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3538){if(e<3535){if(e===3530)return n.CLUSTER_BREAK.EXTEND}else if(e<3536){if(e===3535)return n.CLUSTER_BREAK.EXTEND}else if(3536<=e&&e<=3537)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3542){if(3538<=e&&e<=3540)return n.CLUSTER_BREAK.EXTEND}else if(e<3544){if(e===3542)return n.CLUSTER_BREAK.EXTEND}else if(3544<=e&&e<=3550)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3893){if(e<3655){if(e<3633){if(e<3570){if(e===3551)return n.CLUSTER_BREAK.EXTEND}else if(3570<=e&&e<=3571)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3635){if(e===3633)return n.CLUSTER_BREAK.EXTEND}else if(e<3636){if(e===3635)return n.CLUSTER_BREAK.SPACINGMARK}else if(3636<=e&&e<=3642)return n.CLUSTER_BREAK.EXTEND}else if(e<3764)if(e<3761){if(3655<=e&&e<=3662)return n.CLUSTER_BREAK.EXTEND}else{if(e===3761)return n.CLUSTER_BREAK.EXTEND;if(e===3763)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3784){if(3764<=e&&e<=3772)return n.CLUSTER_BREAK.EXTEND}else if(e<3864){if(3784<=e&&e<=3790)return n.CLUSTER_BREAK.EXTEND}else if(3864<=e&&e<=3865)return n.CLUSTER_BREAK.EXTEND}else if(e<3967){if(e<3897){if(e===3893||e===3895)return n.CLUSTER_BREAK.EXTEND}else if(e<3902){if(e===3897)return n.CLUSTER_BREAK.EXTEND}else if(e<3953){if(3902<=e&&e<=3903)return n.CLUSTER_BREAK.SPACINGMARK}else if(3953<=e&&e<=3966)return n.CLUSTER_BREAK.EXTEND}else if(e<3981){if(e<3968){if(e===3967)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<3974){if(3968<=e&&e<=3972)return n.CLUSTER_BREAK.EXTEND}else if(3974<=e&&e<=3975)return n.CLUSTER_BREAK.EXTEND}else if(e<3993){if(3981<=e&&e<=3991)return n.CLUSTER_BREAK.EXTEND}else if(e<4038){if(3993<=e&&e<=4028)return n.CLUSTER_BREAK.EXTEND}else if(e===4038)return n.CLUSTER_BREAK.EXTEND}else if(e<7204){if(e<6448){if(e<5938){if(e<4226){if(e<4157){if(e<4146){if(e<4145){if(4141<=e&&e<=4144)return n.CLUSTER_BREAK.EXTEND}else if(e===4145)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<4153){if(4146<=e&&e<=4151)return n.CLUSTER_BREAK.EXTEND}else if(e<4155){if(4153<=e&&e<=4154)return n.CLUSTER_BREAK.EXTEND}else if(4155<=e&&e<=4156)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<4184){if(e<4182){if(4157<=e&&e<=4158)return n.CLUSTER_BREAK.EXTEND}else if(4182<=e&&e<=4183)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<4190){if(4184<=e&&e<=4185)return n.CLUSTER_BREAK.EXTEND}else if(e<4209){if(4190<=e&&e<=4192)return n.CLUSTER_BREAK.EXTEND}else if(4209<=e&&e<=4212)return n.CLUSTER_BREAK.EXTEND}else if(e<4352){if(e<4229){if(e===4226)return n.CLUSTER_BREAK.EXTEND;if(e===4228)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<4237){if(4229<=e&&e<=4230)return n.CLUSTER_BREAK.EXTEND}else if(e===4237||e===4253)return n.CLUSTER_BREAK.EXTEND}else if(e<4957){if(e<4448){if(4352<=e&&e<=4447)return n.CLUSTER_BREAK.L}else if(e<4520){if(4448<=e&&e<=4519)return n.CLUSTER_BREAK.V}else if(4520<=e&&e<=4607)return n.CLUSTER_BREAK.T}else if(e<5906){if(4957<=e&&e<=4959)return n.CLUSTER_BREAK.EXTEND}else if(e<5909){if(5906<=e&&e<=5908)return n.CLUSTER_BREAK.EXTEND}else if(e===5909)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<6089){if(e<6070){if(e<5970){if(e<5940){if(5938<=e&&e<=5939)return n.CLUSTER_BREAK.EXTEND}else if(e===5940)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<6002){if(5970<=e&&e<=5971)return n.CLUSTER_BREAK.EXTEND}else if(e<6068){if(6002<=e&&e<=6003)return n.CLUSTER_BREAK.EXTEND}else if(6068<=e&&e<=6069)return n.CLUSTER_BREAK.EXTEND}else if(e<6078){if(e<6071){if(e===6070)return n.CLUSTER_BREAK.SPACINGMARK}else if(6071<=e&&e<=6077)return n.CLUSTER_BREAK.EXTEND}else if(e<6086){if(6078<=e&&e<=6085)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<6087){if(e===6086)return n.CLUSTER_BREAK.EXTEND}else if(6087<=e&&e<=6088)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<6277)if(e<6155){if(e<6109){if(6089<=e&&e<=6099)return n.CLUSTER_BREAK.EXTEND}else if(e===6109)return n.CLUSTER_BREAK.EXTEND}else if(e<6158){if(6155<=e&&e<=6157)return n.CLUSTER_BREAK.EXTEND}else{if(e===6158)return n.CLUSTER_BREAK.CONTROL;if(e===6159)return n.CLUSTER_BREAK.EXTEND}else if(e<6435){if(e<6313){if(6277<=e&&e<=6278)return n.CLUSTER_BREAK.EXTEND}else if(e<6432){if(e===6313)return n.CLUSTER_BREAK.EXTEND}else if(6432<=e&&e<=6434)return n.CLUSTER_BREAK.EXTEND}else if(e<6439){if(6435<=e&&e<=6438)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<6441){if(6439<=e&&e<=6440)return n.CLUSTER_BREAK.EXTEND}else if(6441<=e&&e<=6443)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<6971){if(e<6744)if(e<6681){if(e<6451){if(e<6450){if(6448<=e&&e<=6449)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===6450)return n.CLUSTER_BREAK.EXTEND}else if(e<6457){if(6451<=e&&e<=6456)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<6679){if(6457<=e&&e<=6459)return n.CLUSTER_BREAK.EXTEND}else if(6679<=e&&e<=6680)return n.CLUSTER_BREAK.EXTEND}else if(e<6741){if(e<6683){if(6681<=e&&e<=6682)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===6683)return n.CLUSTER_BREAK.EXTEND}else if(e<6742){if(e===6741)return n.CLUSTER_BREAK.SPACINGMARK}else{if(e===6742)return n.CLUSTER_BREAK.EXTEND;if(e===6743)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<6771){if(e<6754){if(e<6752){if(6744<=e&&e<=6750)return n.CLUSTER_BREAK.EXTEND}else if(e===6752)return n.CLUSTER_BREAK.EXTEND}else if(e<6757){if(e===6754)return n.CLUSTER_BREAK.EXTEND}else if(e<6765){if(6757<=e&&e<=6764)return n.CLUSTER_BREAK.EXTEND}else if(6765<=e&&e<=6770)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<6912){if(e<6783){if(6771<=e&&e<=6780)return n.CLUSTER_BREAK.EXTEND}else if(e<6832){if(e===6783)return n.CLUSTER_BREAK.EXTEND}else if(6832<=e&&e<=6862)return n.CLUSTER_BREAK.EXTEND}else if(e<6916){if(6912<=e&&e<=6915)return n.CLUSTER_BREAK.EXTEND}else if(e<6964){if(e===6916)return n.CLUSTER_BREAK.SPACINGMARK}else if(6964<=e&&e<=6970)return n.CLUSTER_BREAK.EXTEND}else if(e<7080){if(e<7019){if(e<6973){if(e===6971)return n.CLUSTER_BREAK.SPACINGMARK;if(e===6972)return n.CLUSTER_BREAK.EXTEND}else if(e<6978){if(6973<=e&&e<=6977)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<6979){if(e===6978)return n.CLUSTER_BREAK.EXTEND}else if(6979<=e&&e<=6980)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<7073){if(e<7040){if(7019<=e&&e<=7027)return n.CLUSTER_BREAK.EXTEND}else if(e<7042){if(7040<=e&&e<=7041)return n.CLUSTER_BREAK.EXTEND}else if(e===7042)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<7074){if(e===7073)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<7078){if(7074<=e&&e<=7077)return n.CLUSTER_BREAK.EXTEND}else if(7078<=e&&e<=7079)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<7144)if(e<7083){if(e<7082){if(7080<=e&&e<=7081)return n.CLUSTER_BREAK.EXTEND}else if(e===7082)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<7142){if(7083<=e&&e<=7085)return n.CLUSTER_BREAK.EXTEND}else{if(e===7142)return n.CLUSTER_BREAK.EXTEND;if(e===7143)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<7150){if(e<7146){if(7144<=e&&e<=7145)return n.CLUSTER_BREAK.EXTEND}else if(e<7149){if(7146<=e&&e<=7148)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===7149)return n.CLUSTER_BREAK.EXTEND}else if(e<7151){if(e===7150)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<7154){if(7151<=e&&e<=7153)return n.CLUSTER_BREAK.EXTEND}else if(7154<=e&&e<=7155)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<43346){if(e<11647){if(e<7415){if(e<7380){if(e<7220){if(e<7212){if(7204<=e&&e<=7211)return n.CLUSTER_BREAK.SPACINGMARK}else if(7212<=e&&e<=7219)return n.CLUSTER_BREAK.EXTEND}else if(e<7222){if(7220<=e&&e<=7221)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<7376){if(7222<=e&&e<=7223)return n.CLUSTER_BREAK.EXTEND}else if(7376<=e&&e<=7378)return n.CLUSTER_BREAK.EXTEND}else if(e<7394){if(e<7393){if(7380<=e&&e<=7392)return n.CLUSTER_BREAK.EXTEND}else if(e===7393)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<7405){if(7394<=e&&e<=7400)return n.CLUSTER_BREAK.EXTEND}else if(e===7405||e===7412)return n.CLUSTER_BREAK.EXTEND}else if(e<8205)if(e<7616){if(e<7416){if(e===7415)return n.CLUSTER_BREAK.SPACINGMARK}else if(7416<=e&&e<=7417)return n.CLUSTER_BREAK.EXTEND}else if(e<8203){if(7616<=e&&e<=7679)return n.CLUSTER_BREAK.EXTEND}else{if(e===8203)return n.CLUSTER_BREAK.CONTROL;if(e===8204)return n.CLUSTER_BREAK.EXTEND}else if(e<8288){if(e<8206){if(e===8205)return n.CLUSTER_BREAK.ZWJ}else if(e<8232){if(8206<=e&&e<=8207)return n.CLUSTER_BREAK.CONTROL}else if(8232<=e&&e<=8238)return n.CLUSTER_BREAK.CONTROL}else if(e<8400){if(8288<=e&&e<=8303)return n.CLUSTER_BREAK.CONTROL}else if(e<11503){if(8400<=e&&e<=8432)return n.CLUSTER_BREAK.EXTEND}else if(11503<=e&&e<=11505)return n.CLUSTER_BREAK.EXTEND}else if(e<43043){if(e<42612){if(e<12330){if(e<11744){if(e===11647)return n.CLUSTER_BREAK.EXTEND}else if(11744<=e&&e<=11775)return n.CLUSTER_BREAK.EXTEND}else if(e<12441){if(12330<=e&&e<=12335)return n.CLUSTER_BREAK.EXTEND}else if(e<42607){if(12441<=e&&e<=12442)return n.CLUSTER_BREAK.EXTEND}else if(42607<=e&&e<=42610)return n.CLUSTER_BREAK.EXTEND}else if(e<43010){if(e<42654){if(42612<=e&&e<=42621)return n.CLUSTER_BREAK.EXTEND}else if(e<42736){if(42654<=e&&e<=42655)return n.CLUSTER_BREAK.EXTEND}else if(42736<=e&&e<=42737)return n.CLUSTER_BREAK.EXTEND}else if(e<43014){if(e===43010)return n.CLUSTER_BREAK.EXTEND}else if(e===43014||e===43019)return n.CLUSTER_BREAK.EXTEND}else if(e<43188){if(e<43047){if(e<43045){if(43043<=e&&e<=43044)return n.CLUSTER_BREAK.SPACINGMARK}else if(43045<=e&&e<=43046)return n.CLUSTER_BREAK.EXTEND}else if(e<43052){if(e===43047)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<43136){if(e===43052)return n.CLUSTER_BREAK.EXTEND}else if(43136<=e&&e<=43137)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<43263){if(e<43204){if(43188<=e&&e<=43203)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<43232){if(43204<=e&&e<=43205)return n.CLUSTER_BREAK.EXTEND}else if(43232<=e&&e<=43249)return n.CLUSTER_BREAK.EXTEND}else if(e<43302){if(e===43263)return n.CLUSTER_BREAK.EXTEND}else if(e<43335){if(43302<=e&&e<=43309)return n.CLUSTER_BREAK.EXTEND}else if(43335<=e&&e<=43345)return n.CLUSTER_BREAK.EXTEND}else if(e<43698){if(e<43493){if(e<43444)if(e<43392){if(e<43360){if(43346<=e&&e<=43347)return n.CLUSTER_BREAK.SPACINGMARK}else if(43360<=e&&e<=43388)return n.CLUSTER_BREAK.L}else if(e<43395){if(43392<=e&&e<=43394)return n.CLUSTER_BREAK.EXTEND}else{if(e===43395)return n.CLUSTER_BREAK.SPACINGMARK;if(e===43443)return n.CLUSTER_BREAK.EXTEND}else if(e<43450){if(e<43446){if(43444<=e&&e<=43445)return n.CLUSTER_BREAK.SPACINGMARK}else if(43446<=e&&e<=43449)return n.CLUSTER_BREAK.EXTEND}else if(e<43452){if(43450<=e&&e<=43451)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<43454){if(43452<=e&&e<=43453)return n.CLUSTER_BREAK.EXTEND}else if(43454<=e&&e<=43456)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<43573){if(e<43567){if(e<43561){if(e===43493)return n.CLUSTER_BREAK.EXTEND}else if(43561<=e&&e<=43566)return n.CLUSTER_BREAK.EXTEND}else if(e<43569){if(43567<=e&&e<=43568)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<43571){if(43569<=e&&e<=43570)return n.CLUSTER_BREAK.EXTEND}else if(43571<=e&&e<=43572)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<43597){if(e<43587){if(43573<=e&&e<=43574)return n.CLUSTER_BREAK.EXTEND}else if(e===43587||e===43596)return n.CLUSTER_BREAK.EXTEND}else if(e<43644){if(e===43597)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===43644||e===43696)return n.CLUSTER_BREAK.EXTEND}else if(e<44006){if(e<43756)if(e<43710){if(e<43703){if(43698<=e&&e<=43700)return n.CLUSTER_BREAK.EXTEND}else if(43703<=e&&e<=43704)return n.CLUSTER_BREAK.EXTEND}else if(e<43713){if(43710<=e&&e<=43711)return n.CLUSTER_BREAK.EXTEND}else{if(e===43713)return n.CLUSTER_BREAK.EXTEND;if(e===43755)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<43766){if(e<43758){if(43756<=e&&e<=43757)return n.CLUSTER_BREAK.EXTEND}else if(e<43765){if(43758<=e&&e<=43759)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===43765)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<44003){if(e===43766)return n.CLUSTER_BREAK.EXTEND}else if(e<44005){if(44003<=e&&e<=44004)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===44005)return n.CLUSTER_BREAK.EXTEND}else if(e<44032)if(e<44009){if(e<44008){if(44006<=e&&e<=44007)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===44008)return n.CLUSTER_BREAK.EXTEND}else if(e<44012){if(44009<=e&&e<=44010)return n.CLUSTER_BREAK.SPACINGMARK}else{if(e===44012)return n.CLUSTER_BREAK.SPACINGMARK;if(e===44013)return n.CLUSTER_BREAK.EXTEND}else if(e<44061){if(e<44033){if(e===44032)return n.CLUSTER_BREAK.LV}else if(e<44060){if(44033<=e&&e<=44059)return n.CLUSTER_BREAK.LVT}else if(e===44060)return n.CLUSTER_BREAK.LV}else if(e<44088){if(44061<=e&&e<=44087)return n.CLUSTER_BREAK.LVT}else if(e<44089){if(e===44088)return n.CLUSTER_BREAK.LV}else if(44089<=e&&e<=44115)return n.CLUSTER_BREAK.LVT}else if(e<46497){if(e<45293){if(e<44704){if(e<44397){if(e<44256){if(e<44173){if(e<44144){if(e<44117){if(e===44116)return n.CLUSTER_BREAK.LV}else if(44117<=e&&e<=44143)return n.CLUSTER_BREAK.LVT}else if(e<44145){if(e===44144)return n.CLUSTER_BREAK.LV}else if(e<44172){if(44145<=e&&e<=44171)return n.CLUSTER_BREAK.LVT}else if(e===44172)return n.CLUSTER_BREAK.LV}else if(e<44201){if(e<44200){if(44173<=e&&e<=44199)return n.CLUSTER_BREAK.LVT}else if(e===44200)return n.CLUSTER_BREAK.LV}else if(e<44228){if(44201<=e&&e<=44227)return n.CLUSTER_BREAK.LVT}else if(e<44229){if(e===44228)return n.CLUSTER_BREAK.LV}else if(44229<=e&&e<=44255)return n.CLUSTER_BREAK.LVT}else if(e<44313){if(e<44284){if(e<44257){if(e===44256)return n.CLUSTER_BREAK.LV}else if(44257<=e&&e<=44283)return n.CLUSTER_BREAK.LVT}else if(e<44285){if(e===44284)return n.CLUSTER_BREAK.LV}else if(e<44312){if(44285<=e&&e<=44311)return n.CLUSTER_BREAK.LVT}else if(e===44312)return n.CLUSTER_BREAK.LV}else if(e<44368){if(e<44340){if(44313<=e&&e<=44339)return n.CLUSTER_BREAK.LVT}else if(e<44341){if(e===44340)return n.CLUSTER_BREAK.LV}else if(44341<=e&&e<=44367)return n.CLUSTER_BREAK.LVT}else if(e<44369){if(e===44368)return n.CLUSTER_BREAK.LV}else if(e<44396){if(44369<=e&&e<=44395)return n.CLUSTER_BREAK.LVT}else if(e===44396)return n.CLUSTER_BREAK.LV}else if(e<44537){if(e<44480){if(e<44425){if(e<44424){if(44397<=e&&e<=44423)return n.CLUSTER_BREAK.LVT}else if(e===44424)return n.CLUSTER_BREAK.LV}else if(e<44452){if(44425<=e&&e<=44451)return n.CLUSTER_BREAK.LVT}else if(e<44453){if(e===44452)return n.CLUSTER_BREAK.LV}else if(44453<=e&&e<=44479)return n.CLUSTER_BREAK.LVT}else if(e<44508){if(e<44481){if(e===44480)return n.CLUSTER_BREAK.LV}else if(44481<=e&&e<=44507)return n.CLUSTER_BREAK.LVT}else if(e<44509){if(e===44508)return n.CLUSTER_BREAK.LV}else if(e<44536){if(44509<=e&&e<=44535)return n.CLUSTER_BREAK.LVT}else if(e===44536)return n.CLUSTER_BREAK.LV}else if(e<44620){if(e<44565){if(e<44564){if(44537<=e&&e<=44563)return n.CLUSTER_BREAK.LVT}else if(e===44564)return n.CLUSTER_BREAK.LV}else if(e<44592){if(44565<=e&&e<=44591)return n.CLUSTER_BREAK.LVT}else if(e<44593){if(e===44592)return n.CLUSTER_BREAK.LV}else if(44593<=e&&e<=44619)return n.CLUSTER_BREAK.LVT}else if(e<44649){if(e<44621){if(e===44620)return n.CLUSTER_BREAK.LV}else if(e<44648){if(44621<=e&&e<=44647)return n.CLUSTER_BREAK.LVT}else if(e===44648)return n.CLUSTER_BREAK.LV}else if(e<44676){if(44649<=e&&e<=44675)return n.CLUSTER_BREAK.LVT}else if(e<44677){if(e===44676)return n.CLUSTER_BREAK.LV}else if(44677<=e&&e<=44703)return n.CLUSTER_BREAK.LVT}else if(e<44985){if(e<44844){if(e<44761){if(e<44732){if(e<44705){if(e===44704)return n.CLUSTER_BREAK.LV}else if(44705<=e&&e<=44731)return n.CLUSTER_BREAK.LVT}else if(e<44733){if(e===44732)return n.CLUSTER_BREAK.LV}else if(e<44760){if(44733<=e&&e<=44759)return n.CLUSTER_BREAK.LVT}else if(e===44760)return n.CLUSTER_BREAK.LV}else if(e<44789){if(e<44788){if(44761<=e&&e<=44787)return n.CLUSTER_BREAK.LVT}else if(e===44788)return n.CLUSTER_BREAK.LV}else if(e<44816){if(44789<=e&&e<=44815)return n.CLUSTER_BREAK.LVT}else if(e<44817){if(e===44816)return n.CLUSTER_BREAK.LV}else if(44817<=e&&e<=44843)return n.CLUSTER_BREAK.LVT}else if(e<44901){if(e<44872){if(e<44845){if(e===44844)return n.CLUSTER_BREAK.LV}else if(44845<=e&&e<=44871)return n.CLUSTER_BREAK.LVT}else if(e<44873){if(e===44872)return n.CLUSTER_BREAK.LV}else if(e<44900){if(44873<=e&&e<=44899)return n.CLUSTER_BREAK.LVT}else if(e===44900)return n.CLUSTER_BREAK.LV}else if(e<44956){if(e<44928){if(44901<=e&&e<=44927)return n.CLUSTER_BREAK.LVT}else if(e<44929){if(e===44928)return n.CLUSTER_BREAK.LV}else if(44929<=e&&e<=44955)return n.CLUSTER_BREAK.LVT}else if(e<44957){if(e===44956)return n.CLUSTER_BREAK.LV}else if(e<44984){if(44957<=e&&e<=44983)return n.CLUSTER_BREAK.LVT}else if(e===44984)return n.CLUSTER_BREAK.LV}else if(e<45152){if(e<45068){if(e<45013){if(e<45012){if(44985<=e&&e<=45011)return n.CLUSTER_BREAK.LVT}else if(e===45012)return n.CLUSTER_BREAK.LV}else if(e<45040){if(45013<=e&&e<=45039)return n.CLUSTER_BREAK.LVT}else if(e<45041){if(e===45040)return n.CLUSTER_BREAK.LV}else if(45041<=e&&e<=45067)return n.CLUSTER_BREAK.LVT}else if(e<45097){if(e<45069){if(e===45068)return n.CLUSTER_BREAK.LV}else if(e<45096){if(45069<=e&&e<=45095)return n.CLUSTER_BREAK.LVT}else if(e===45096)return n.CLUSTER_BREAK.LV}else if(e<45124){if(45097<=e&&e<=45123)return n.CLUSTER_BREAK.LVT}else if(e<45125){if(e===45124)return n.CLUSTER_BREAK.LV}else if(45125<=e&&e<=45151)return n.CLUSTER_BREAK.LVT}else if(e<45209){if(e<45180){if(e<45153){if(e===45152)return n.CLUSTER_BREAK.LV}else if(45153<=e&&e<=45179)return n.CLUSTER_BREAK.LVT}else if(e<45181){if(e===45180)return n.CLUSTER_BREAK.LV}else if(e<45208){if(45181<=e&&e<=45207)return n.CLUSTER_BREAK.LVT}else if(e===45208)return n.CLUSTER_BREAK.LV}else if(e<45264){if(e<45236){if(45209<=e&&e<=45235)return n.CLUSTER_BREAK.LVT}else if(e<45237){if(e===45236)return n.CLUSTER_BREAK.LV}else if(45237<=e&&e<=45263)return n.CLUSTER_BREAK.LVT}else if(e<45265){if(e===45264)return n.CLUSTER_BREAK.LV}else if(e<45292){if(45265<=e&&e<=45291)return n.CLUSTER_BREAK.LVT}else if(e===45292)return n.CLUSTER_BREAK.LV}else if(e<45908){if(e<45600){if(e<45433){if(e<45376){if(e<45321){if(e<45320){if(45293<=e&&e<=45319)return n.CLUSTER_BREAK.LVT}else if(e===45320)return n.CLUSTER_BREAK.LV}else if(e<45348){if(45321<=e&&e<=45347)return n.CLUSTER_BREAK.LVT}else if(e<45349){if(e===45348)return n.CLUSTER_BREAK.LV}else if(45349<=e&&e<=45375)return n.CLUSTER_BREAK.LVT}else if(e<45404){if(e<45377){if(e===45376)return n.CLUSTER_BREAK.LV}else if(45377<=e&&e<=45403)return n.CLUSTER_BREAK.LVT}else if(e<45405){if(e===45404)return n.CLUSTER_BREAK.LV}else if(e<45432){if(45405<=e&&e<=45431)return n.CLUSTER_BREAK.LVT}else if(e===45432)return n.CLUSTER_BREAK.LV}else if(e<45516){if(e<45461){if(e<45460){if(45433<=e&&e<=45459)return n.CLUSTER_BREAK.LVT}else if(e===45460)return n.CLUSTER_BREAK.LV}else if(e<45488){if(45461<=e&&e<=45487)return n.CLUSTER_BREAK.LVT}else if(e<45489){if(e===45488)return n.CLUSTER_BREAK.LV}else if(45489<=e&&e<=45515)return n.CLUSTER_BREAK.LVT}else if(e<45545){if(e<45517){if(e===45516)return n.CLUSTER_BREAK.LV}else if(e<45544){if(45517<=e&&e<=45543)return n.CLUSTER_BREAK.LVT}else if(e===45544)return n.CLUSTER_BREAK.LV}else if(e<45572){if(45545<=e&&e<=45571)return n.CLUSTER_BREAK.LVT}else if(e<45573){if(e===45572)return n.CLUSTER_BREAK.LV}else if(45573<=e&&e<=45599)return n.CLUSTER_BREAK.LVT}else if(e<45741){if(e<45657){if(e<45628){if(e<45601){if(e===45600)return n.CLUSTER_BREAK.LV}else if(45601<=e&&e<=45627)return n.CLUSTER_BREAK.LVT}else if(e<45629){if(e===45628)return n.CLUSTER_BREAK.LV}else if(e<45656){if(45629<=e&&e<=45655)return n.CLUSTER_BREAK.LVT}else if(e===45656)return n.CLUSTER_BREAK.LV}else if(e<45712){if(e<45684){if(45657<=e&&e<=45683)return n.CLUSTER_BREAK.LVT}else if(e<45685){if(e===45684)return n.CLUSTER_BREAK.LV}else if(45685<=e&&e<=45711)return n.CLUSTER_BREAK.LVT}else if(e<45713){if(e===45712)return n.CLUSTER_BREAK.LV}else if(e<45740){if(45713<=e&&e<=45739)return n.CLUSTER_BREAK.LVT}else if(e===45740)return n.CLUSTER_BREAK.LV}else if(e<45824){if(e<45769){if(e<45768){if(45741<=e&&e<=45767)return n.CLUSTER_BREAK.LVT}else if(e===45768)return n.CLUSTER_BREAK.LV}else if(e<45796){if(45769<=e&&e<=45795)return n.CLUSTER_BREAK.LVT}else if(e<45797){if(e===45796)return n.CLUSTER_BREAK.LV}else if(45797<=e&&e<=45823)return n.CLUSTER_BREAK.LVT}else if(e<45853){if(e<45825){if(e===45824)return n.CLUSTER_BREAK.LV}else if(e<45852){if(45825<=e&&e<=45851)return n.CLUSTER_BREAK.LVT}else if(e===45852)return n.CLUSTER_BREAK.LV}else if(e<45880){if(45853<=e&&e<=45879)return n.CLUSTER_BREAK.LVT}else if(e<45881){if(e===45880)return n.CLUSTER_BREAK.LV}else if(45881<=e&&e<=45907)return n.CLUSTER_BREAK.LVT}else if(e<46189){if(e<46048){if(e<45965){if(e<45936){if(e<45909){if(e===45908)return n.CLUSTER_BREAK.LV}else if(45909<=e&&e<=45935)return n.CLUSTER_BREAK.LVT}else if(e<45937){if(e===45936)return n.CLUSTER_BREAK.LV}else if(e<45964){if(45937<=e&&e<=45963)return n.CLUSTER_BREAK.LVT}else if(e===45964)return n.CLUSTER_BREAK.LV}else if(e<45993){if(e<45992){if(45965<=e&&e<=45991)return n.CLUSTER_BREAK.LVT}else if(e===45992)return n.CLUSTER_BREAK.LV}else if(e<46020){if(45993<=e&&e<=46019)return n.CLUSTER_BREAK.LVT}else if(e<46021){if(e===46020)return n.CLUSTER_BREAK.LV}else if(46021<=e&&e<=46047)return n.CLUSTER_BREAK.LVT}else if(e<46105){if(e<46076){if(e<46049){if(e===46048)return n.CLUSTER_BREAK.LV}else if(46049<=e&&e<=46075)return n.CLUSTER_BREAK.LVT}else if(e<46077){if(e===46076)return n.CLUSTER_BREAK.LV}else if(e<46104){if(46077<=e&&e<=46103)return n.CLUSTER_BREAK.LVT}else if(e===46104)return n.CLUSTER_BREAK.LV}else if(e<46160){if(e<46132){if(46105<=e&&e<=46131)return n.CLUSTER_BREAK.LVT}else if(e<46133){if(e===46132)return n.CLUSTER_BREAK.LV}else if(46133<=e&&e<=46159)return n.CLUSTER_BREAK.LVT}else if(e<46161){if(e===46160)return n.CLUSTER_BREAK.LV}else if(e<46188){if(46161<=e&&e<=46187)return n.CLUSTER_BREAK.LVT}else if(e===46188)return n.CLUSTER_BREAK.LV}else if(e<46356){if(e<46272){if(e<46217){if(e<46216){if(46189<=e&&e<=46215)return n.CLUSTER_BREAK.LVT}else if(e===46216)return n.CLUSTER_BREAK.LV}else if(e<46244){if(46217<=e&&e<=46243)return n.CLUSTER_BREAK.LVT}else if(e<46245){if(e===46244)return n.CLUSTER_BREAK.LV}else if(46245<=e&&e<=46271)return n.CLUSTER_BREAK.LVT}else if(e<46301){if(e<46273){if(e===46272)return n.CLUSTER_BREAK.LV}else if(e<46300){if(46273<=e&&e<=46299)return n.CLUSTER_BREAK.LVT}else if(e===46300)return n.CLUSTER_BREAK.LV}else if(e<46328){if(46301<=e&&e<=46327)return n.CLUSTER_BREAK.LVT}else if(e<46329){if(e===46328)return n.CLUSTER_BREAK.LV}else if(46329<=e&&e<=46355)return n.CLUSTER_BREAK.LVT}else if(e<46413){if(e<46384){if(e<46357){if(e===46356)return n.CLUSTER_BREAK.LV}else if(46357<=e&&e<=46383)return n.CLUSTER_BREAK.LVT}else if(e<46385){if(e===46384)return n.CLUSTER_BREAK.LV}else if(e<46412){if(46385<=e&&e<=46411)return n.CLUSTER_BREAK.LVT}else if(e===46412)return n.CLUSTER_BREAK.LV}else if(e<46468){if(e<46440){if(46413<=e&&e<=46439)return n.CLUSTER_BREAK.LVT}else if(e<46441){if(e===46440)return n.CLUSTER_BREAK.LV}else if(46441<=e&&e<=46467)return n.CLUSTER_BREAK.LVT}else if(e<46469){if(e===46468)return n.CLUSTER_BREAK.LV}else if(e<46496){if(46469<=e&&e<=46495)return n.CLUSTER_BREAK.LVT}else if(e===46496)return n.CLUSTER_BREAK.LV}else if(e<47701){if(e<47112){if(e<46804){if(e<46637){if(e<46580){if(e<46525){if(e<46524){if(46497<=e&&e<=46523)return n.CLUSTER_BREAK.LVT}else if(e===46524)return n.CLUSTER_BREAK.LV}else if(e<46552){if(46525<=e&&e<=46551)return n.CLUSTER_BREAK.LVT}else if(e<46553){if(e===46552)return n.CLUSTER_BREAK.LV}else if(46553<=e&&e<=46579)return n.CLUSTER_BREAK.LVT}else if(e<46608){if(e<46581){if(e===46580)return n.CLUSTER_BREAK.LV}else if(46581<=e&&e<=46607)return n.CLUSTER_BREAK.LVT}else if(e<46609){if(e===46608)return n.CLUSTER_BREAK.LV}else if(e<46636){if(46609<=e&&e<=46635)return n.CLUSTER_BREAK.LVT}else if(e===46636)return n.CLUSTER_BREAK.LV}else if(e<46720){if(e<46665){if(e<46664){if(46637<=e&&e<=46663)return n.CLUSTER_BREAK.LVT}else if(e===46664)return n.CLUSTER_BREAK.LV}else if(e<46692){if(46665<=e&&e<=46691)return n.CLUSTER_BREAK.LVT}else if(e<46693){if(e===46692)return n.CLUSTER_BREAK.LV}else if(46693<=e&&e<=46719)return n.CLUSTER_BREAK.LVT}else if(e<46749){if(e<46721){if(e===46720)return n.CLUSTER_BREAK.LV}else if(e<46748){if(46721<=e&&e<=46747)return n.CLUSTER_BREAK.LVT}else if(e===46748)return n.CLUSTER_BREAK.LV}else if(e<46776){if(46749<=e&&e<=46775)return n.CLUSTER_BREAK.LVT}else if(e<46777){if(e===46776)return n.CLUSTER_BREAK.LV}else if(46777<=e&&e<=46803)return n.CLUSTER_BREAK.LVT}else if(e<46945){if(e<46861){if(e<46832){if(e<46805){if(e===46804)return n.CLUSTER_BREAK.LV}else if(46805<=e&&e<=46831)return n.CLUSTER_BREAK.LVT}else if(e<46833){if(e===46832)return n.CLUSTER_BREAK.LV}else if(e<46860){if(46833<=e&&e<=46859)return n.CLUSTER_BREAK.LVT}else if(e===46860)return n.CLUSTER_BREAK.LV}else if(e<46916){if(e<46888){if(46861<=e&&e<=46887)return n.CLUSTER_BREAK.LVT}else if(e<46889){if(e===46888)return n.CLUSTER_BREAK.LV}else if(46889<=e&&e<=46915)return n.CLUSTER_BREAK.LVT}else if(e<46917){if(e===46916)return n.CLUSTER_BREAK.LV}else if(e<46944){if(46917<=e&&e<=46943)return n.CLUSTER_BREAK.LVT}else if(e===46944)return n.CLUSTER_BREAK.LV}else if(e<47028){if(e<46973){if(e<46972){if(46945<=e&&e<=46971)return n.CLUSTER_BREAK.LVT}else if(e===46972)return n.CLUSTER_BREAK.LV}else if(e<47e3){if(46973<=e&&e<=46999)return n.CLUSTER_BREAK.LVT}else if(e<47001){if(e===47e3)return n.CLUSTER_BREAK.LV}else if(47001<=e&&e<=47027)return n.CLUSTER_BREAK.LVT}else if(e<47057){if(e<47029){if(e===47028)return n.CLUSTER_BREAK.LV}else if(e<47056){if(47029<=e&&e<=47055)return n.CLUSTER_BREAK.LVT}else if(e===47056)return n.CLUSTER_BREAK.LV}else if(e<47084){if(47057<=e&&e<=47083)return n.CLUSTER_BREAK.LVT}else if(e<47085){if(e===47084)return n.CLUSTER_BREAK.LV}else if(47085<=e&&e<=47111)return n.CLUSTER_BREAK.LVT}else if(e<47393){if(e<47252){if(e<47169){if(e<47140){if(e<47113){if(e===47112)return n.CLUSTER_BREAK.LV}else if(47113<=e&&e<=47139)return n.CLUSTER_BREAK.LVT}else if(e<47141){if(e===47140)return n.CLUSTER_BREAK.LV}else if(e<47168){if(47141<=e&&e<=47167)return n.CLUSTER_BREAK.LVT}else if(e===47168)return n.CLUSTER_BREAK.LV}else if(e<47197){if(e<47196){if(47169<=e&&e<=47195)return n.CLUSTER_BREAK.LVT}else if(e===47196)return n.CLUSTER_BREAK.LV}else if(e<47224){if(47197<=e&&e<=47223)return n.CLUSTER_BREAK.LVT}else if(e<47225){if(e===47224)return n.CLUSTER_BREAK.LV}else if(47225<=e&&e<=47251)return n.CLUSTER_BREAK.LVT}else if(e<47309){if(e<47280){if(e<47253){if(e===47252)return n.CLUSTER_BREAK.LV}else if(47253<=e&&e<=47279)return n.CLUSTER_BREAK.LVT}else if(e<47281){if(e===47280)return n.CLUSTER_BREAK.LV}else if(e<47308){if(47281<=e&&e<=47307)return n.CLUSTER_BREAK.LVT}else if(e===47308)return n.CLUSTER_BREAK.LV}else if(e<47364){if(e<47336){if(47309<=e&&e<=47335)return n.CLUSTER_BREAK.LVT}else if(e<47337){if(e===47336)return n.CLUSTER_BREAK.LV}else if(47337<=e&&e<=47363)return n.CLUSTER_BREAK.LVT}else if(e<47365){if(e===47364)return n.CLUSTER_BREAK.LV}else if(e<47392){if(47365<=e&&e<=47391)return n.CLUSTER_BREAK.LVT}else if(e===47392)return n.CLUSTER_BREAK.LV}else if(e<47560){if(e<47476){if(e<47421){if(e<47420){if(47393<=e&&e<=47419)return n.CLUSTER_BREAK.LVT}else if(e===47420)return n.CLUSTER_BREAK.LV}else if(e<47448){if(47421<=e&&e<=47447)return n.CLUSTER_BREAK.LVT}else if(e<47449){if(e===47448)return n.CLUSTER_BREAK.LV}else if(47449<=e&&e<=47475)return n.CLUSTER_BREAK.LVT}else if(e<47505){if(e<47477){if(e===47476)return n.CLUSTER_BREAK.LV}else if(e<47504){if(47477<=e&&e<=47503)return n.CLUSTER_BREAK.LVT}else if(e===47504)return n.CLUSTER_BREAK.LV}else if(e<47532){if(47505<=e&&e<=47531)return n.CLUSTER_BREAK.LVT}else if(e<47533){if(e===47532)return n.CLUSTER_BREAK.LV}else if(47533<=e&&e<=47559)return n.CLUSTER_BREAK.LVT}else if(e<47617){if(e<47588){if(e<47561){if(e===47560)return n.CLUSTER_BREAK.LV}else if(47561<=e&&e<=47587)return n.CLUSTER_BREAK.LVT}else if(e<47589){if(e===47588)return n.CLUSTER_BREAK.LV}else if(e<47616){if(47589<=e&&e<=47615)return n.CLUSTER_BREAK.LVT}else if(e===47616)return n.CLUSTER_BREAK.LV}else if(e<47672){if(e<47644){if(47617<=e&&e<=47643)return n.CLUSTER_BREAK.LVT}else if(e<47645){if(e===47644)return n.CLUSTER_BREAK.LV}else if(47645<=e&&e<=47671)return n.CLUSTER_BREAK.LVT}else if(e<47673){if(e===47672)return n.CLUSTER_BREAK.LV}else if(e<47700){if(47673<=e&&e<=47699)return n.CLUSTER_BREAK.LVT}else if(e===47700)return n.CLUSTER_BREAK.LV}else if(e<48316){if(e<48008){if(e<47841){if(e<47784){if(e<47729){if(e<47728){if(47701<=e&&e<=47727)return n.CLUSTER_BREAK.LVT}else if(e===47728)return n.CLUSTER_BREAK.LV}else if(e<47756){if(47729<=e&&e<=47755)return n.CLUSTER_BREAK.LVT}else if(e<47757){if(e===47756)return n.CLUSTER_BREAK.LV}else if(47757<=e&&e<=47783)return n.CLUSTER_BREAK.LVT}else if(e<47812){if(e<47785){if(e===47784)return n.CLUSTER_BREAK.LV}else if(47785<=e&&e<=47811)return n.CLUSTER_BREAK.LVT}else if(e<47813){if(e===47812)return n.CLUSTER_BREAK.LV}else if(e<47840){if(47813<=e&&e<=47839)return n.CLUSTER_BREAK.LVT}else if(e===47840)return n.CLUSTER_BREAK.LV}else if(e<47924){if(e<47869){if(e<47868){if(47841<=e&&e<=47867)return n.CLUSTER_BREAK.LVT}else if(e===47868)return n.CLUSTER_BREAK.LV}else if(e<47896){if(47869<=e&&e<=47895)return n.CLUSTER_BREAK.LVT}else if(e<47897){if(e===47896)return n.CLUSTER_BREAK.LV}else if(47897<=e&&e<=47923)return n.CLUSTER_BREAK.LVT}else if(e<47953){if(e<47925){if(e===47924)return n.CLUSTER_BREAK.LV}else if(e<47952){if(47925<=e&&e<=47951)return n.CLUSTER_BREAK.LVT}else if(e===47952)return n.CLUSTER_BREAK.LV}else if(e<47980){if(47953<=e&&e<=47979)return n.CLUSTER_BREAK.LVT}else if(e<47981){if(e===47980)return n.CLUSTER_BREAK.LV}else if(47981<=e&&e<=48007)return n.CLUSTER_BREAK.LVT}else if(e<48149){if(e<48065){if(e<48036){if(e<48009){if(e===48008)return n.CLUSTER_BREAK.LV}else if(48009<=e&&e<=48035)return n.CLUSTER_BREAK.LVT}else if(e<48037){if(e===48036)return n.CLUSTER_BREAK.LV}else if(e<48064){if(48037<=e&&e<=48063)return n.CLUSTER_BREAK.LVT}else if(e===48064)return n.CLUSTER_BREAK.LV}else if(e<48120){if(e<48092){if(48065<=e&&e<=48091)return n.CLUSTER_BREAK.LVT}else if(e<48093){if(e===48092)return n.CLUSTER_BREAK.LV}else if(48093<=e&&e<=48119)return n.CLUSTER_BREAK.LVT}else if(e<48121){if(e===48120)return n.CLUSTER_BREAK.LV}else if(e<48148){if(48121<=e&&e<=48147)return n.CLUSTER_BREAK.LVT}else if(e===48148)return n.CLUSTER_BREAK.LV}else if(e<48232){if(e<48177){if(e<48176){if(48149<=e&&e<=48175)return n.CLUSTER_BREAK.LVT}else if(e===48176)return n.CLUSTER_BREAK.LV}else if(e<48204){if(48177<=e&&e<=48203)return n.CLUSTER_BREAK.LVT}else if(e<48205){if(e===48204)return n.CLUSTER_BREAK.LV}else if(48205<=e&&e<=48231)return n.CLUSTER_BREAK.LVT}else if(e<48261){if(e<48233){if(e===48232)return n.CLUSTER_BREAK.LV}else if(e<48260){if(48233<=e&&e<=48259)return n.CLUSTER_BREAK.LVT}else if(e===48260)return n.CLUSTER_BREAK.LV}else if(e<48288){if(48261<=e&&e<=48287)return n.CLUSTER_BREAK.LVT}else if(e<48289){if(e===48288)return n.CLUSTER_BREAK.LV}else if(48289<=e&&e<=48315)return n.CLUSTER_BREAK.LVT}else if(e<48597){if(e<48456){if(e<48373){if(e<48344){if(e<48317){if(e===48316)return n.CLUSTER_BREAK.LV}else if(48317<=e&&e<=48343)return n.CLUSTER_BREAK.LVT}else if(e<48345){if(e===48344)return n.CLUSTER_BREAK.LV}else if(e<48372){if(48345<=e&&e<=48371)return n.CLUSTER_BREAK.LVT}else if(e===48372)return n.CLUSTER_BREAK.LV}else if(e<48401){if(e<48400){if(48373<=e&&e<=48399)return n.CLUSTER_BREAK.LVT}else if(e===48400)return n.CLUSTER_BREAK.LV}else if(e<48428){if(48401<=e&&e<=48427)return n.CLUSTER_BREAK.LVT}else if(e<48429){if(e===48428)return n.CLUSTER_BREAK.LV}else if(48429<=e&&e<=48455)return n.CLUSTER_BREAK.LVT}else if(e<48513){if(e<48484){if(e<48457){if(e===48456)return n.CLUSTER_BREAK.LV}else if(48457<=e&&e<=48483)return n.CLUSTER_BREAK.LVT}else if(e<48485){if(e===48484)return n.CLUSTER_BREAK.LV}else if(e<48512){if(48485<=e&&e<=48511)return n.CLUSTER_BREAK.LVT}else if(e===48512)return n.CLUSTER_BREAK.LV}else if(e<48568){if(e<48540){if(48513<=e&&e<=48539)return n.CLUSTER_BREAK.LVT}else if(e<48541){if(e===48540)return n.CLUSTER_BREAK.LV}else if(48541<=e&&e<=48567)return n.CLUSTER_BREAK.LVT}else if(e<48569){if(e===48568)return n.CLUSTER_BREAK.LV}else if(e<48596){if(48569<=e&&e<=48595)return n.CLUSTER_BREAK.LVT}else if(e===48596)return n.CLUSTER_BREAK.LV}else if(e<48764){if(e<48680){if(e<48625){if(e<48624){if(48597<=e&&e<=48623)return n.CLUSTER_BREAK.LVT}else if(e===48624)return n.CLUSTER_BREAK.LV}else if(e<48652){if(48625<=e&&e<=48651)return n.CLUSTER_BREAK.LVT}else if(e<48653){if(e===48652)return n.CLUSTER_BREAK.LV}else if(48653<=e&&e<=48679)return n.CLUSTER_BREAK.LVT}else if(e<48709){if(e<48681){if(e===48680)return n.CLUSTER_BREAK.LV}else if(e<48708){if(48681<=e&&e<=48707)return n.CLUSTER_BREAK.LVT}else if(e===48708)return n.CLUSTER_BREAK.LV}else if(e<48736){if(48709<=e&&e<=48735)return n.CLUSTER_BREAK.LVT}else if(e<48737){if(e===48736)return n.CLUSTER_BREAK.LV}else if(48737<=e&&e<=48763)return n.CLUSTER_BREAK.LVT}else if(e<48821){if(e<48792){if(e<48765){if(e===48764)return n.CLUSTER_BREAK.LV}else if(48765<=e&&e<=48791)return n.CLUSTER_BREAK.LVT}else if(e<48793){if(e===48792)return n.CLUSTER_BREAK.LV}else if(e<48820){if(48793<=e&&e<=48819)return n.CLUSTER_BREAK.LVT}else if(e===48820)return n.CLUSTER_BREAK.LV}else if(e<48876){if(e<48848){if(48821<=e&&e<=48847)return n.CLUSTER_BREAK.LVT}else if(e<48849){if(e===48848)return n.CLUSTER_BREAK.LV}else if(48849<=e&&e<=48875)return n.CLUSTER_BREAK.LVT}else if(e<48877){if(e===48876)return n.CLUSTER_BREAK.LV}else if(e<48904){if(48877<=e&&e<=48903)return n.CLUSTER_BREAK.LVT}else if(e===48904)return n.CLUSTER_BREAK.LV}else if(e<53720){if(e<51312){if(e<50108){if(e<49493){if(e<49212){if(e<49045){if(e<48988){if(e<48933){if(e<48932){if(48905<=e&&e<=48931)return n.CLUSTER_BREAK.LVT}else if(e===48932)return n.CLUSTER_BREAK.LV}else if(e<48960){if(48933<=e&&e<=48959)return n.CLUSTER_BREAK.LVT}else if(e<48961){if(e===48960)return n.CLUSTER_BREAK.LV}else if(48961<=e&&e<=48987)return n.CLUSTER_BREAK.LVT}else if(e<49016){if(e<48989){if(e===48988)return n.CLUSTER_BREAK.LV}else if(48989<=e&&e<=49015)return n.CLUSTER_BREAK.LVT}else if(e<49017){if(e===49016)return n.CLUSTER_BREAK.LV}else if(e<49044){if(49017<=e&&e<=49043)return n.CLUSTER_BREAK.LVT}else if(e===49044)return n.CLUSTER_BREAK.LV}else if(e<49128){if(e<49073){if(e<49072){if(49045<=e&&e<=49071)return n.CLUSTER_BREAK.LVT}else if(e===49072)return n.CLUSTER_BREAK.LV}else if(e<49100){if(49073<=e&&e<=49099)return n.CLUSTER_BREAK.LVT}else if(e<49101){if(e===49100)return n.CLUSTER_BREAK.LV}else if(49101<=e&&e<=49127)return n.CLUSTER_BREAK.LVT}else if(e<49157){if(e<49129){if(e===49128)return n.CLUSTER_BREAK.LV}else if(e<49156){if(49129<=e&&e<=49155)return n.CLUSTER_BREAK.LVT}else if(e===49156)return n.CLUSTER_BREAK.LV}else if(e<49184){if(49157<=e&&e<=49183)return n.CLUSTER_BREAK.LVT}else if(e<49185){if(e===49184)return n.CLUSTER_BREAK.LV}else if(49185<=e&&e<=49211)return n.CLUSTER_BREAK.LVT}else if(e<49352){if(e<49269){if(e<49240){if(e<49213){if(e===49212)return n.CLUSTER_BREAK.LV}else if(49213<=e&&e<=49239)return n.CLUSTER_BREAK.LVT}else if(e<49241){if(e===49240)return n.CLUSTER_BREAK.LV}else if(e<49268){if(49241<=e&&e<=49267)return n.CLUSTER_BREAK.LVT}else if(e===49268)return n.CLUSTER_BREAK.LV}else if(e<49297){if(e<49296){if(49269<=e&&e<=49295)return n.CLUSTER_BREAK.LVT}else if(e===49296)return n.CLUSTER_BREAK.LV}else if(e<49324){if(49297<=e&&e<=49323)return n.CLUSTER_BREAK.LVT}else if(e<49325){if(e===49324)return n.CLUSTER_BREAK.LV}else if(49325<=e&&e<=49351)return n.CLUSTER_BREAK.LVT}else if(e<49409){if(e<49380){if(e<49353){if(e===49352)return n.CLUSTER_BREAK.LV}else if(49353<=e&&e<=49379)return n.CLUSTER_BREAK.LVT}else if(e<49381){if(e===49380)return n.CLUSTER_BREAK.LV}else if(e<49408){if(49381<=e&&e<=49407)return n.CLUSTER_BREAK.LVT}else if(e===49408)return n.CLUSTER_BREAK.LV}else if(e<49464){if(e<49436){if(49409<=e&&e<=49435)return n.CLUSTER_BREAK.LVT}else if(e<49437){if(e===49436)return n.CLUSTER_BREAK.LV}else if(49437<=e&&e<=49463)return n.CLUSTER_BREAK.LVT}else if(e<49465){if(e===49464)return n.CLUSTER_BREAK.LV}else if(e<49492){if(49465<=e&&e<=49491)return n.CLUSTER_BREAK.LVT}else if(e===49492)return n.CLUSTER_BREAK.LV}else if(e<49800){if(e<49633){if(e<49576){if(e<49521){if(e<49520){if(49493<=e&&e<=49519)return n.CLUSTER_BREAK.LVT}else if(e===49520)return n.CLUSTER_BREAK.LV}else if(e<49548){if(49521<=e&&e<=49547)return n.CLUSTER_BREAK.LVT}else if(e<49549){if(e===49548)return n.CLUSTER_BREAK.LV}else if(49549<=e&&e<=49575)return n.CLUSTER_BREAK.LVT}else if(e<49604){if(e<49577){if(e===49576)return n.CLUSTER_BREAK.LV}else if(49577<=e&&e<=49603)return n.CLUSTER_BREAK.LVT}else if(e<49605){if(e===49604)return n.CLUSTER_BREAK.LV}else if(e<49632){if(49605<=e&&e<=49631)return n.CLUSTER_BREAK.LVT}else if(e===49632)return n.CLUSTER_BREAK.LV}else if(e<49716){if(e<49661){if(e<49660){if(49633<=e&&e<=49659)return n.CLUSTER_BREAK.LVT}else if(e===49660)return n.CLUSTER_BREAK.LV}else if(e<49688){if(49661<=e&&e<=49687)return n.CLUSTER_BREAK.LVT}else if(e<49689){if(e===49688)return n.CLUSTER_BREAK.LV}else if(49689<=e&&e<=49715)return n.CLUSTER_BREAK.LVT}else if(e<49745){if(e<49717){if(e===49716)return n.CLUSTER_BREAK.LV}else if(e<49744){if(49717<=e&&e<=49743)return n.CLUSTER_BREAK.LVT}else if(e===49744)return n.CLUSTER_BREAK.LV}else if(e<49772){if(49745<=e&&e<=49771)return n.CLUSTER_BREAK.LVT}else if(e<49773){if(e===49772)return n.CLUSTER_BREAK.LV}else if(49773<=e&&e<=49799)return n.CLUSTER_BREAK.LVT}else if(e<49941){if(e<49857){if(e<49828){if(e<49801){if(e===49800)return n.CLUSTER_BREAK.LV}else if(49801<=e&&e<=49827)return n.CLUSTER_BREAK.LVT}else if(e<49829){if(e===49828)return n.CLUSTER_BREAK.LV}else if(e<49856){if(49829<=e&&e<=49855)return n.CLUSTER_BREAK.LVT}else if(e===49856)return n.CLUSTER_BREAK.LV}else if(e<49912){if(e<49884){if(49857<=e&&e<=49883)return n.CLUSTER_BREAK.LVT}else if(e<49885){if(e===49884)return n.CLUSTER_BREAK.LV}else if(49885<=e&&e<=49911)return n.CLUSTER_BREAK.LVT}else if(e<49913){if(e===49912)return n.CLUSTER_BREAK.LV}else if(e<49940){if(49913<=e&&e<=49939)return n.CLUSTER_BREAK.LVT}else if(e===49940)return n.CLUSTER_BREAK.LV}else if(e<50024){if(e<49969){if(e<49968){if(49941<=e&&e<=49967)return n.CLUSTER_BREAK.LVT}else if(e===49968)return n.CLUSTER_BREAK.LV}else if(e<49996){if(49969<=e&&e<=49995)return n.CLUSTER_BREAK.LVT}else if(e<49997){if(e===49996)return n.CLUSTER_BREAK.LV}else if(49997<=e&&e<=50023)return n.CLUSTER_BREAK.LVT}else if(e<50053){if(e<50025){if(e===50024)return n.CLUSTER_BREAK.LV}else if(e<50052){if(50025<=e&&e<=50051)return n.CLUSTER_BREAK.LVT}else if(e===50052)return n.CLUSTER_BREAK.LV}else if(e<50080){if(50053<=e&&e<=50079)return n.CLUSTER_BREAK.LVT}else if(e<50081){if(e===50080)return n.CLUSTER_BREAK.LV}else if(50081<=e&&e<=50107)return n.CLUSTER_BREAK.LVT}else if(e<50697){if(e<50389){if(e<50248){if(e<50165){if(e<50136){if(e<50109){if(e===50108)return n.CLUSTER_BREAK.LV}else if(50109<=e&&e<=50135)return n.CLUSTER_BREAK.LVT}else if(e<50137){if(e===50136)return n.CLUSTER_BREAK.LV}else if(e<50164){if(50137<=e&&e<=50163)return n.CLUSTER_BREAK.LVT}else if(e===50164)return n.CLUSTER_BREAK.LV}else if(e<50193){if(e<50192){if(50165<=e&&e<=50191)return n.CLUSTER_BREAK.LVT}else if(e===50192)return n.CLUSTER_BREAK.LV}else if(e<50220){if(50193<=e&&e<=50219)return n.CLUSTER_BREAK.LVT}else if(e<50221){if(e===50220)return n.CLUSTER_BREAK.LV}else if(50221<=e&&e<=50247)return n.CLUSTER_BREAK.LVT}else if(e<50305){if(e<50276){if(e<50249){if(e===50248)return n.CLUSTER_BREAK.LV}else if(50249<=e&&e<=50275)return n.CLUSTER_BREAK.LVT}else if(e<50277){if(e===50276)return n.CLUSTER_BREAK.LV}else if(e<50304){if(50277<=e&&e<=50303)return n.CLUSTER_BREAK.LVT}else if(e===50304)return n.CLUSTER_BREAK.LV}else if(e<50360){if(e<50332){if(50305<=e&&e<=50331)return n.CLUSTER_BREAK.LVT}else if(e<50333){if(e===50332)return n.CLUSTER_BREAK.LV}else if(50333<=e&&e<=50359)return n.CLUSTER_BREAK.LVT}else if(e<50361){if(e===50360)return n.CLUSTER_BREAK.LV}else if(e<50388){if(50361<=e&&e<=50387)return n.CLUSTER_BREAK.LVT}else if(e===50388)return n.CLUSTER_BREAK.LV}else if(e<50556){if(e<50472){if(e<50417){if(e<50416){if(50389<=e&&e<=50415)return n.CLUSTER_BREAK.LVT}else if(e===50416)return n.CLUSTER_BREAK.LV}else if(e<50444){if(50417<=e&&e<=50443)return n.CLUSTER_BREAK.LVT}else if(e<50445){if(e===50444)return n.CLUSTER_BREAK.LV}else if(50445<=e&&e<=50471)return n.CLUSTER_BREAK.LVT}else if(e<50501){if(e<50473){if(e===50472)return n.CLUSTER_BREAK.LV}else if(e<50500){if(50473<=e&&e<=50499)return n.CLUSTER_BREAK.LVT}else if(e===50500)return n.CLUSTER_BREAK.LV}else if(e<50528){if(50501<=e&&e<=50527)return n.CLUSTER_BREAK.LVT}else if(e<50529){if(e===50528)return n.CLUSTER_BREAK.LV}else if(50529<=e&&e<=50555)return n.CLUSTER_BREAK.LVT}else if(e<50613){if(e<50584){if(e<50557){if(e===50556)return n.CLUSTER_BREAK.LV}else if(50557<=e&&e<=50583)return n.CLUSTER_BREAK.LVT}else if(e<50585){if(e===50584)return n.CLUSTER_BREAK.LV}else if(e<50612){if(50585<=e&&e<=50611)return n.CLUSTER_BREAK.LVT}else if(e===50612)return n.CLUSTER_BREAK.LV}else if(e<50668){if(e<50640){if(50613<=e&&e<=50639)return n.CLUSTER_BREAK.LVT}else if(e<50641){if(e===50640)return n.CLUSTER_BREAK.LV}else if(50641<=e&&e<=50667)return n.CLUSTER_BREAK.LVT}else if(e<50669){if(e===50668)return n.CLUSTER_BREAK.LV}else if(e<50696){if(50669<=e&&e<=50695)return n.CLUSTER_BREAK.LVT}else if(e===50696)return n.CLUSTER_BREAK.LV}else if(e<51004){if(e<50837){if(e<50780){if(e<50725){if(e<50724){if(50697<=e&&e<=50723)return n.CLUSTER_BREAK.LVT}else if(e===50724)return n.CLUSTER_BREAK.LV}else if(e<50752){if(50725<=e&&e<=50751)return n.CLUSTER_BREAK.LVT}else if(e<50753){if(e===50752)return n.CLUSTER_BREAK.LV}else if(50753<=e&&e<=50779)return n.CLUSTER_BREAK.LVT}else if(e<50808){if(e<50781){if(e===50780)return n.CLUSTER_BREAK.LV}else if(50781<=e&&e<=50807)return n.CLUSTER_BREAK.LVT}else if(e<50809){if(e===50808)return n.CLUSTER_BREAK.LV}else if(e<50836){if(50809<=e&&e<=50835)return n.CLUSTER_BREAK.LVT}else if(e===50836)return n.CLUSTER_BREAK.LV}else if(e<50920){if(e<50865){if(e<50864){if(50837<=e&&e<=50863)return n.CLUSTER_BREAK.LVT}else if(e===50864)return n.CLUSTER_BREAK.LV}else if(e<50892){if(50865<=e&&e<=50891)return n.CLUSTER_BREAK.LVT}else if(e<50893){if(e===50892)return n.CLUSTER_BREAK.LV}else if(50893<=e&&e<=50919)return n.CLUSTER_BREAK.LVT}else if(e<50949){if(e<50921){if(e===50920)return n.CLUSTER_BREAK.LV}else if(e<50948){if(50921<=e&&e<=50947)return n.CLUSTER_BREAK.LVT}else if(e===50948)return n.CLUSTER_BREAK.LV}else if(e<50976){if(50949<=e&&e<=50975)return n.CLUSTER_BREAK.LVT}else if(e<50977){if(e===50976)return n.CLUSTER_BREAK.LV}else if(50977<=e&&e<=51003)return n.CLUSTER_BREAK.LVT}else if(e<51145){if(e<51061){if(e<51032){if(e<51005){if(e===51004)return n.CLUSTER_BREAK.LV}else if(51005<=e&&e<=51031)return n.CLUSTER_BREAK.LVT}else if(e<51033){if(e===51032)return n.CLUSTER_BREAK.LV}else if(e<51060){if(51033<=e&&e<=51059)return n.CLUSTER_BREAK.LVT}else if(e===51060)return n.CLUSTER_BREAK.LV}else if(e<51116){if(e<51088){if(51061<=e&&e<=51087)return n.CLUSTER_BREAK.LVT}else if(e<51089){if(e===51088)return n.CLUSTER_BREAK.LV}else if(51089<=e&&e<=51115)return n.CLUSTER_BREAK.LVT}else if(e<51117){if(e===51116)return n.CLUSTER_BREAK.LV}else if(e<51144){if(51117<=e&&e<=51143)return n.CLUSTER_BREAK.LVT}else if(e===51144)return n.CLUSTER_BREAK.LV}else if(e<51228){if(e<51173){if(e<51172){if(51145<=e&&e<=51171)return n.CLUSTER_BREAK.LVT}else if(e===51172)return n.CLUSTER_BREAK.LV}else if(e<51200){if(51173<=e&&e<=51199)return n.CLUSTER_BREAK.LVT}else if(e<51201){if(e===51200)return n.CLUSTER_BREAK.LV}else if(51201<=e&&e<=51227)return n.CLUSTER_BREAK.LVT}else if(e<51257){if(e<51229){if(e===51228)return n.CLUSTER_BREAK.LV}else if(e<51256){if(51229<=e&&e<=51255)return n.CLUSTER_BREAK.LVT}else if(e===51256)return n.CLUSTER_BREAK.LV}else if(e<51284){if(51257<=e&&e<=51283)return n.CLUSTER_BREAK.LVT}else if(e<51285){if(e===51284)return n.CLUSTER_BREAK.LV}else if(51285<=e&&e<=51311)return n.CLUSTER_BREAK.LVT}else if(e<52516){if(e<51901){if(e<51593){if(e<51452){if(e<51369){if(e<51340){if(e<51313){if(e===51312)return n.CLUSTER_BREAK.LV}else if(51313<=e&&e<=51339)return n.CLUSTER_BREAK.LVT}else if(e<51341){if(e===51340)return n.CLUSTER_BREAK.LV}else if(e<51368){if(51341<=e&&e<=51367)return n.CLUSTER_BREAK.LVT}else if(e===51368)return n.CLUSTER_BREAK.LV}else if(e<51397){if(e<51396){if(51369<=e&&e<=51395)return n.CLUSTER_BREAK.LVT}else if(e===51396)return n.CLUSTER_BREAK.LV}else if(e<51424){if(51397<=e&&e<=51423)return n.CLUSTER_BREAK.LVT}else if(e<51425){if(e===51424)return n.CLUSTER_BREAK.LV}else if(51425<=e&&e<=51451)return n.CLUSTER_BREAK.LVT}else if(e<51509){if(e<51480){if(e<51453){if(e===51452)return n.CLUSTER_BREAK.LV}else if(51453<=e&&e<=51479)return n.CLUSTER_BREAK.LVT}else if(e<51481){if(e===51480)return n.CLUSTER_BREAK.LV}else if(e<51508){if(51481<=e&&e<=51507)return n.CLUSTER_BREAK.LVT}else if(e===51508)return n.CLUSTER_BREAK.LV}else if(e<51564){if(e<51536){if(51509<=e&&e<=51535)return n.CLUSTER_BREAK.LVT}else if(e<51537){if(e===51536)return n.CLUSTER_BREAK.LV}else if(51537<=e&&e<=51563)return n.CLUSTER_BREAK.LVT}else if(e<51565){if(e===51564)return n.CLUSTER_BREAK.LV}else if(e<51592){if(51565<=e&&e<=51591)return n.CLUSTER_BREAK.LVT}else if(e===51592)return n.CLUSTER_BREAK.LV}else if(e<51760){if(e<51676){if(e<51621){if(e<51620){if(51593<=e&&e<=51619)return n.CLUSTER_BREAK.LVT}else if(e===51620)return n.CLUSTER_BREAK.LV}else if(e<51648){if(51621<=e&&e<=51647)return n.CLUSTER_BREAK.LVT}else if(e<51649){if(e===51648)return n.CLUSTER_BREAK.LV}else if(51649<=e&&e<=51675)return n.CLUSTER_BREAK.LVT}else if(e<51705){if(e<51677){if(e===51676)return n.CLUSTER_BREAK.LV}else if(e<51704){if(51677<=e&&e<=51703)return n.CLUSTER_BREAK.LVT}else if(e===51704)return n.CLUSTER_BREAK.LV}else if(e<51732){if(51705<=e&&e<=51731)return n.CLUSTER_BREAK.LVT}else if(e<51733){if(e===51732)return n.CLUSTER_BREAK.LV}else if(51733<=e&&e<=51759)return n.CLUSTER_BREAK.LVT}else if(e<51817){if(e<51788){if(e<51761){if(e===51760)return n.CLUSTER_BREAK.LV}else if(51761<=e&&e<=51787)return n.CLUSTER_BREAK.LVT}else if(e<51789){if(e===51788)return n.CLUSTER_BREAK.LV}else if(e<51816){if(51789<=e&&e<=51815)return n.CLUSTER_BREAK.LVT}else if(e===51816)return n.CLUSTER_BREAK.LV}else if(e<51872){if(e<51844){if(51817<=e&&e<=51843)return n.CLUSTER_BREAK.LVT}else if(e<51845){if(e===51844)return n.CLUSTER_BREAK.LV}else if(51845<=e&&e<=51871)return n.CLUSTER_BREAK.LVT}else if(e<51873){if(e===51872)return n.CLUSTER_BREAK.LV}else if(e<51900){if(51873<=e&&e<=51899)return n.CLUSTER_BREAK.LVT}else if(e===51900)return n.CLUSTER_BREAK.LV}else if(e<52208){if(e<52041){if(e<51984){if(e<51929){if(e<51928){if(51901<=e&&e<=51927)return n.CLUSTER_BREAK.LVT}else if(e===51928)return n.CLUSTER_BREAK.LV}else if(e<51956){if(51929<=e&&e<=51955)return n.CLUSTER_BREAK.LVT}else if(e<51957){if(e===51956)return n.CLUSTER_BREAK.LV}else if(51957<=e&&e<=51983)return n.CLUSTER_BREAK.LVT}else if(e<52012){if(e<51985){if(e===51984)return n.CLUSTER_BREAK.LV}else if(51985<=e&&e<=52011)return n.CLUSTER_BREAK.LVT}else if(e<52013){if(e===52012)return n.CLUSTER_BREAK.LV}else if(e<52040){if(52013<=e&&e<=52039)return n.CLUSTER_BREAK.LVT}else if(e===52040)return n.CLUSTER_BREAK.LV}else if(e<52124){if(e<52069){if(e<52068){if(52041<=e&&e<=52067)return n.CLUSTER_BREAK.LVT}else if(e===52068)return n.CLUSTER_BREAK.LV}else if(e<52096){if(52069<=e&&e<=52095)return n.CLUSTER_BREAK.LVT}else if(e<52097){if(e===52096)return n.CLUSTER_BREAK.LV}else if(52097<=e&&e<=52123)return n.CLUSTER_BREAK.LVT}else if(e<52153){if(e<52125){if(e===52124)return n.CLUSTER_BREAK.LV}else if(e<52152){if(52125<=e&&e<=52151)return n.CLUSTER_BREAK.LVT}else if(e===52152)return n.CLUSTER_BREAK.LV}else if(e<52180){if(52153<=e&&e<=52179)return n.CLUSTER_BREAK.LVT}else if(e<52181){if(e===52180)return n.CLUSTER_BREAK.LV}else if(52181<=e&&e<=52207)return n.CLUSTER_BREAK.LVT}else if(e<52349){if(e<52265){if(e<52236){if(e<52209){if(e===52208)return n.CLUSTER_BREAK.LV}else if(52209<=e&&e<=52235)return n.CLUSTER_BREAK.LVT}else if(e<52237){if(e===52236)return n.CLUSTER_BREAK.LV}else if(e<52264){if(52237<=e&&e<=52263)return n.CLUSTER_BREAK.LVT}else if(e===52264)return n.CLUSTER_BREAK.LV}else if(e<52320){if(e<52292){if(52265<=e&&e<=52291)return n.CLUSTER_BREAK.LVT}else if(e<52293){if(e===52292)return n.CLUSTER_BREAK.LV}else if(52293<=e&&e<=52319)return n.CLUSTER_BREAK.LVT}else if(e<52321){if(e===52320)return n.CLUSTER_BREAK.LV}else if(e<52348){if(52321<=e&&e<=52347)return n.CLUSTER_BREAK.LVT}else if(e===52348)return n.CLUSTER_BREAK.LV}else if(e<52432){if(e<52377){if(e<52376){if(52349<=e&&e<=52375)return n.CLUSTER_BREAK.LVT}else if(e===52376)return n.CLUSTER_BREAK.LV}else if(e<52404){if(52377<=e&&e<=52403)return n.CLUSTER_BREAK.LVT}else if(e<52405){if(e===52404)return n.CLUSTER_BREAK.LV}else if(52405<=e&&e<=52431)return n.CLUSTER_BREAK.LVT}else if(e<52461){if(e<52433){if(e===52432)return n.CLUSTER_BREAK.LV}else if(e<52460){if(52433<=e&&e<=52459)return n.CLUSTER_BREAK.LVT}else if(e===52460)return n.CLUSTER_BREAK.LV}else if(e<52488){if(52461<=e&&e<=52487)return n.CLUSTER_BREAK.LVT}else if(e<52489){if(e===52488)return n.CLUSTER_BREAK.LV}else if(52489<=e&&e<=52515)return n.CLUSTER_BREAK.LVT}else if(e<53105){if(e<52797){if(e<52656){if(e<52573){if(e<52544){if(e<52517){if(e===52516)return n.CLUSTER_BREAK.LV}else if(52517<=e&&e<=52543)return n.CLUSTER_BREAK.LVT}else if(e<52545){if(e===52544)return n.CLUSTER_BREAK.LV}else if(e<52572){if(52545<=e&&e<=52571)return n.CLUSTER_BREAK.LVT}else if(e===52572)return n.CLUSTER_BREAK.LV}else if(e<52601){if(e<52600){if(52573<=e&&e<=52599)return n.CLUSTER_BREAK.LVT}else if(e===52600)return n.CLUSTER_BREAK.LV}else if(e<52628){if(52601<=e&&e<=52627)return n.CLUSTER_BREAK.LVT}else if(e<52629){if(e===52628)return n.CLUSTER_BREAK.LV}else if(52629<=e&&e<=52655)return n.CLUSTER_BREAK.LVT}else if(e<52713){if(e<52684){if(e<52657){if(e===52656)return n.CLUSTER_BREAK.LV}else if(52657<=e&&e<=52683)return n.CLUSTER_BREAK.LVT}else if(e<52685){if(e===52684)return n.CLUSTER_BREAK.LV}else if(e<52712){if(52685<=e&&e<=52711)return n.CLUSTER_BREAK.LVT}else if(e===52712)return n.CLUSTER_BREAK.LV}else if(e<52768){if(e<52740){if(52713<=e&&e<=52739)return n.CLUSTER_BREAK.LVT}else if(e<52741){if(e===52740)return n.CLUSTER_BREAK.LV}else if(52741<=e&&e<=52767)return n.CLUSTER_BREAK.LVT}else if(e<52769){if(e===52768)return n.CLUSTER_BREAK.LV}else if(e<52796){if(52769<=e&&e<=52795)return n.CLUSTER_BREAK.LVT}else if(e===52796)return n.CLUSTER_BREAK.LV}else if(e<52964){if(e<52880){if(e<52825){if(e<52824){if(52797<=e&&e<=52823)return n.CLUSTER_BREAK.LVT}else if(e===52824)return n.CLUSTER_BREAK.LV}else if(e<52852){if(52825<=e&&e<=52851)return n.CLUSTER_BREAK.LVT}else if(e<52853){if(e===52852)return n.CLUSTER_BREAK.LV}else if(52853<=e&&e<=52879)return n.CLUSTER_BREAK.LVT}else if(e<52909){if(e<52881){if(e===52880)return n.CLUSTER_BREAK.LV}else if(e<52908){if(52881<=e&&e<=52907)return n.CLUSTER_BREAK.LVT}else if(e===52908)return n.CLUSTER_BREAK.LV}else if(e<52936){if(52909<=e&&e<=52935)return n.CLUSTER_BREAK.LVT}else if(e<52937){if(e===52936)return n.CLUSTER_BREAK.LV}else if(52937<=e&&e<=52963)return n.CLUSTER_BREAK.LVT}else if(e<53021){if(e<52992){if(e<52965){if(e===52964)return n.CLUSTER_BREAK.LV}else if(52965<=e&&e<=52991)return n.CLUSTER_BREAK.LVT}else if(e<52993){if(e===52992)return n.CLUSTER_BREAK.LV}else if(e<53020){if(52993<=e&&e<=53019)return n.CLUSTER_BREAK.LVT}else if(e===53020)return n.CLUSTER_BREAK.LV}else if(e<53076){if(e<53048){if(53021<=e&&e<=53047)return n.CLUSTER_BREAK.LVT}else if(e<53049){if(e===53048)return n.CLUSTER_BREAK.LV}else if(53049<=e&&e<=53075)return n.CLUSTER_BREAK.LVT}else if(e<53077){if(e===53076)return n.CLUSTER_BREAK.LV}else if(e<53104){if(53077<=e&&e<=53103)return n.CLUSTER_BREAK.LVT}else if(e===53104)return n.CLUSTER_BREAK.LV}else if(e<53412){if(e<53245){if(e<53188){if(e<53133){if(e<53132){if(53105<=e&&e<=53131)return n.CLUSTER_BREAK.LVT}else if(e===53132)return n.CLUSTER_BREAK.LV}else if(e<53160){if(53133<=e&&e<=53159)return n.CLUSTER_BREAK.LVT}else if(e<53161){if(e===53160)return n.CLUSTER_BREAK.LV}else if(53161<=e&&e<=53187)return n.CLUSTER_BREAK.LVT}else if(e<53216){if(e<53189){if(e===53188)return n.CLUSTER_BREAK.LV}else if(53189<=e&&e<=53215)return n.CLUSTER_BREAK.LVT}else if(e<53217){if(e===53216)return n.CLUSTER_BREAK.LV}else if(e<53244){if(53217<=e&&e<=53243)return n.CLUSTER_BREAK.LVT}else if(e===53244)return n.CLUSTER_BREAK.LV}else if(e<53328){if(e<53273){if(e<53272){if(53245<=e&&e<=53271)return n.CLUSTER_BREAK.LVT}else if(e===53272)return n.CLUSTER_BREAK.LV}else if(e<53300){if(53273<=e&&e<=53299)return n.CLUSTER_BREAK.LVT}else if(e<53301){if(e===53300)return n.CLUSTER_BREAK.LV}else if(53301<=e&&e<=53327)return n.CLUSTER_BREAK.LVT}else if(e<53357){if(e<53329){if(e===53328)return n.CLUSTER_BREAK.LV}else if(e<53356){if(53329<=e&&e<=53355)return n.CLUSTER_BREAK.LVT}else if(e===53356)return n.CLUSTER_BREAK.LV}else if(e<53384){if(53357<=e&&e<=53383)return n.CLUSTER_BREAK.LVT}else if(e<53385){if(e===53384)return n.CLUSTER_BREAK.LV}else if(53385<=e&&e<=53411)return n.CLUSTER_BREAK.LVT}else if(e<53553){if(e<53469){if(e<53440){if(e<53413){if(e===53412)return n.CLUSTER_BREAK.LV}else if(53413<=e&&e<=53439)return n.CLUSTER_BREAK.LVT}else if(e<53441){if(e===53440)return n.CLUSTER_BREAK.LV}else if(e<53468){if(53441<=e&&e<=53467)return n.CLUSTER_BREAK.LVT}else if(e===53468)return n.CLUSTER_BREAK.LV}else if(e<53524){if(e<53496){if(53469<=e&&e<=53495)return n.CLUSTER_BREAK.LVT}else if(e<53497){if(e===53496)return n.CLUSTER_BREAK.LV}else if(53497<=e&&e<=53523)return n.CLUSTER_BREAK.LVT}else if(e<53525){if(e===53524)return n.CLUSTER_BREAK.LV}else if(e<53552){if(53525<=e&&e<=53551)return n.CLUSTER_BREAK.LVT}else if(e===53552)return n.CLUSTER_BREAK.LV}else if(e<53636){if(e<53581){if(e<53580){if(53553<=e&&e<=53579)return n.CLUSTER_BREAK.LVT}else if(e===53580)return n.CLUSTER_BREAK.LV}else if(e<53608){if(53581<=e&&e<=53607)return n.CLUSTER_BREAK.LVT}else if(e<53609){if(e===53608)return n.CLUSTER_BREAK.LV}else if(53609<=e&&e<=53635)return n.CLUSTER_BREAK.LVT}else if(e<53665){if(e<53637){if(e===53636)return n.CLUSTER_BREAK.LV}else if(e<53664){if(53637<=e&&e<=53663)return n.CLUSTER_BREAK.LVT}else if(e===53664)return n.CLUSTER_BREAK.LV}else if(e<53692){if(53665<=e&&e<=53691)return n.CLUSTER_BREAK.LVT}else if(e<53693){if(e===53692)return n.CLUSTER_BREAK.LV}else if(53693<=e&&e<=53719)return n.CLUSTER_BREAK.LVT}else if(e<70459){if(e<54897){if(e<54308){if(e<54001){if(e<53860){if(e<53777){if(e<53748){if(e<53721){if(e===53720)return n.CLUSTER_BREAK.LV}else if(53721<=e&&e<=53747)return n.CLUSTER_BREAK.LVT}else if(e<53749){if(e===53748)return n.CLUSTER_BREAK.LV}else if(e<53776){if(53749<=e&&e<=53775)return n.CLUSTER_BREAK.LVT}else if(e===53776)return n.CLUSTER_BREAK.LV}else if(e<53805){if(e<53804){if(53777<=e&&e<=53803)return n.CLUSTER_BREAK.LVT}else if(e===53804)return n.CLUSTER_BREAK.LV}else if(e<53832){if(53805<=e&&e<=53831)return n.CLUSTER_BREAK.LVT}else if(e<53833){if(e===53832)return n.CLUSTER_BREAK.LV}else if(53833<=e&&e<=53859)return n.CLUSTER_BREAK.LVT}else if(e<53917){if(e<53888){if(e<53861){if(e===53860)return n.CLUSTER_BREAK.LV}else if(53861<=e&&e<=53887)return n.CLUSTER_BREAK.LVT}else if(e<53889){if(e===53888)return n.CLUSTER_BREAK.LV}else if(e<53916){if(53889<=e&&e<=53915)return n.CLUSTER_BREAK.LVT}else if(e===53916)return n.CLUSTER_BREAK.LV}else if(e<53972){if(e<53944){if(53917<=e&&e<=53943)return n.CLUSTER_BREAK.LVT}else if(e<53945){if(e===53944)return n.CLUSTER_BREAK.LV}else if(53945<=e&&e<=53971)return n.CLUSTER_BREAK.LVT}else if(e<53973){if(e===53972)return n.CLUSTER_BREAK.LV}else if(e<54e3){if(53973<=e&&e<=53999)return n.CLUSTER_BREAK.LVT}else if(e===54e3)return n.CLUSTER_BREAK.LV}else if(e<54141){if(e<54084){if(e<54029){if(e<54028){if(54001<=e&&e<=54027)return n.CLUSTER_BREAK.LVT}else if(e===54028)return n.CLUSTER_BREAK.LV}else if(e<54056){if(54029<=e&&e<=54055)return n.CLUSTER_BREAK.LVT}else if(e<54057){if(e===54056)return n.CLUSTER_BREAK.LV}else if(54057<=e&&e<=54083)return n.CLUSTER_BREAK.LVT}else if(e<54112){if(e<54085){if(e===54084)return n.CLUSTER_BREAK.LV}else if(54085<=e&&e<=54111)return n.CLUSTER_BREAK.LVT}else if(e<54113){if(e===54112)return n.CLUSTER_BREAK.LV}else if(e<54140){if(54113<=e&&e<=54139)return n.CLUSTER_BREAK.LVT}else if(e===54140)return n.CLUSTER_BREAK.LV}else if(e<54224){if(e<54169){if(e<54168){if(54141<=e&&e<=54167)return n.CLUSTER_BREAK.LVT}else if(e===54168)return n.CLUSTER_BREAK.LV}else if(e<54196){if(54169<=e&&e<=54195)return n.CLUSTER_BREAK.LVT}else if(e<54197){if(e===54196)return n.CLUSTER_BREAK.LV}else if(54197<=e&&e<=54223)return n.CLUSTER_BREAK.LVT}else if(e<54253){if(e<54225){if(e===54224)return n.CLUSTER_BREAK.LV}else if(e<54252){if(54225<=e&&e<=54251)return n.CLUSTER_BREAK.LVT}else if(e===54252)return n.CLUSTER_BREAK.LV}else if(e<54280){if(54253<=e&&e<=54279)return n.CLUSTER_BREAK.LVT}else if(e<54281){if(e===54280)return n.CLUSTER_BREAK.LV}else if(54281<=e&&e<=54307)return n.CLUSTER_BREAK.LVT}else if(e<54589){if(e<54448){if(e<54365){if(e<54336){if(e<54309){if(e===54308)return n.CLUSTER_BREAK.LV}else if(54309<=e&&e<=54335)return n.CLUSTER_BREAK.LVT}else if(e<54337){if(e===54336)return n.CLUSTER_BREAK.LV}else if(e<54364){if(54337<=e&&e<=54363)return n.CLUSTER_BREAK.LVT}else if(e===54364)return n.CLUSTER_BREAK.LV}else if(e<54393){if(e<54392){if(54365<=e&&e<=54391)return n.CLUSTER_BREAK.LVT}else if(e===54392)return n.CLUSTER_BREAK.LV}else if(e<54420){if(54393<=e&&e<=54419)return n.CLUSTER_BREAK.LVT}else if(e<54421){if(e===54420)return n.CLUSTER_BREAK.LV}else if(54421<=e&&e<=54447)return n.CLUSTER_BREAK.LVT}else if(e<54505){if(e<54476){if(e<54449){if(e===54448)return n.CLUSTER_BREAK.LV}else if(54449<=e&&e<=54475)return n.CLUSTER_BREAK.LVT}else if(e<54477){if(e===54476)return n.CLUSTER_BREAK.LV}else if(e<54504){if(54477<=e&&e<=54503)return n.CLUSTER_BREAK.LVT}else if(e===54504)return n.CLUSTER_BREAK.LV}else if(e<54560){if(e<54532){if(54505<=e&&e<=54531)return n.CLUSTER_BREAK.LVT}else if(e<54533){if(e===54532)return n.CLUSTER_BREAK.LV}else if(54533<=e&&e<=54559)return n.CLUSTER_BREAK.LVT}else if(e<54561){if(e===54560)return n.CLUSTER_BREAK.LV}else if(e<54588){if(54561<=e&&e<=54587)return n.CLUSTER_BREAK.LVT}else if(e===54588)return n.CLUSTER_BREAK.LV}else if(e<54756){if(e<54672){if(e<54617){if(e<54616){if(54589<=e&&e<=54615)return n.CLUSTER_BREAK.LVT}else if(e===54616)return n.CLUSTER_BREAK.LV}else if(e<54644){if(54617<=e&&e<=54643)return n.CLUSTER_BREAK.LVT}else if(e<54645){if(e===54644)return n.CLUSTER_BREAK.LV}else if(54645<=e&&e<=54671)return n.CLUSTER_BREAK.LVT}else if(e<54701){if(e<54673){if(e===54672)return n.CLUSTER_BREAK.LV}else if(e<54700){if(54673<=e&&e<=54699)return n.CLUSTER_BREAK.LVT}else if(e===54700)return n.CLUSTER_BREAK.LV}else if(e<54728){if(54701<=e&&e<=54727)return n.CLUSTER_BREAK.LVT}else if(e<54729){if(e===54728)return n.CLUSTER_BREAK.LV}else if(54729<=e&&e<=54755)return n.CLUSTER_BREAK.LVT}else if(e<54813){if(e<54784){if(e<54757){if(e===54756)return n.CLUSTER_BREAK.LV}else if(54757<=e&&e<=54783)return n.CLUSTER_BREAK.LVT}else if(e<54785){if(e===54784)return n.CLUSTER_BREAK.LV}else if(e<54812){if(54785<=e&&e<=54811)return n.CLUSTER_BREAK.LVT}else if(e===54812)return n.CLUSTER_BREAK.LV}else if(e<54868){if(e<54840){if(54813<=e&&e<=54839)return n.CLUSTER_BREAK.LVT}else if(e<54841){if(e===54840)return n.CLUSTER_BREAK.LV}else if(54841<=e&&e<=54867)return n.CLUSTER_BREAK.LVT}else if(e<54869){if(e===54868)return n.CLUSTER_BREAK.LV}else if(e<54896){if(54869<=e&&e<=54895)return n.CLUSTER_BREAK.LVT}else if(e===54896)return n.CLUSTER_BREAK.LV}else if(e<69632){if(e<55216){if(e<55037){if(e<54980){if(e<54925){if(e<54924){if(54897<=e&&e<=54923)return n.CLUSTER_BREAK.LVT}else if(e===54924)return n.CLUSTER_BREAK.LV}else if(e<54952){if(54925<=e&&e<=54951)return n.CLUSTER_BREAK.LVT}else if(e<54953){if(e===54952)return n.CLUSTER_BREAK.LV}else if(54953<=e&&e<=54979)return n.CLUSTER_BREAK.LVT}else if(e<55008){if(e<54981){if(e===54980)return n.CLUSTER_BREAK.LV}else if(54981<=e&&e<=55007)return n.CLUSTER_BREAK.LVT}else if(e<55009){if(e===55008)return n.CLUSTER_BREAK.LV}else if(e<55036){if(55009<=e&&e<=55035)return n.CLUSTER_BREAK.LVT}else if(e===55036)return n.CLUSTER_BREAK.LV}else if(e<55120){if(e<55065){if(e<55064){if(55037<=e&&e<=55063)return n.CLUSTER_BREAK.LVT}else if(e===55064)return n.CLUSTER_BREAK.LV}else if(e<55092){if(55065<=e&&e<=55091)return n.CLUSTER_BREAK.LVT}else if(e<55093){if(e===55092)return n.CLUSTER_BREAK.LV}else if(55093<=e&&e<=55119)return n.CLUSTER_BREAK.LVT}else if(e<55149){if(e<55121){if(e===55120)return n.CLUSTER_BREAK.LV}else if(e<55148){if(55121<=e&&e<=55147)return n.CLUSTER_BREAK.LVT}else if(e===55148)return n.CLUSTER_BREAK.LV}else if(e<55176){if(55149<=e&&e<=55175)return n.CLUSTER_BREAK.LVT}else if(e<55177){if(e===55176)return n.CLUSTER_BREAK.LV}else if(55177<=e&&e<=55203)return n.CLUSTER_BREAK.LVT}else if(e<68097){if(e<65279){if(e<64286){if(e<55243){if(55216<=e&&e<=55238)return n.CLUSTER_BREAK.V}else if(55243<=e&&e<=55291)return n.CLUSTER_BREAK.T}else if(e<65024){if(e===64286)return n.CLUSTER_BREAK.EXTEND}else if(e<65056){if(65024<=e&&e<=65039)return n.CLUSTER_BREAK.EXTEND}else if(65056<=e&&e<=65071)return n.CLUSTER_BREAK.EXTEND}else if(e<66045){if(e<65438){if(e===65279)return n.CLUSTER_BREAK.CONTROL}else if(e<65520){if(65438<=e&&e<=65439)return n.CLUSTER_BREAK.EXTEND}else if(65520<=e&&e<=65531)return n.CLUSTER_BREAK.CONTROL}else if(e<66272){if(e===66045)return n.CLUSTER_BREAK.EXTEND}else if(e<66422){if(e===66272)return n.CLUSTER_BREAK.EXTEND}else if(66422<=e&&e<=66426)return n.CLUSTER_BREAK.EXTEND}else if(e<68325){if(e<68108){if(e<68101){if(68097<=e&&e<=68099)return n.CLUSTER_BREAK.EXTEND}else if(68101<=e&&e<=68102)return n.CLUSTER_BREAK.EXTEND}else if(e<68152){if(68108<=e&&e<=68111)return n.CLUSTER_BREAK.EXTEND}else if(e<68159){if(68152<=e&&e<=68154)return n.CLUSTER_BREAK.EXTEND}else if(e===68159)return n.CLUSTER_BREAK.EXTEND}else if(e<69373){if(e<68900){if(68325<=e&&e<=68326)return n.CLUSTER_BREAK.EXTEND}else if(e<69291){if(68900<=e&&e<=68903)return n.CLUSTER_BREAK.EXTEND}else if(69291<=e&&e<=69292)return n.CLUSTER_BREAK.EXTEND}else if(e<69446){if(69373<=e&&e<=69375)return n.CLUSTER_BREAK.EXTEND}else if(e<69506){if(69446<=e&&e<=69456)return n.CLUSTER_BREAK.EXTEND}else if(69506<=e&&e<=69509)return n.CLUSTER_BREAK.EXTEND}else if(e<70016){if(e<69815){if(e<69747){if(e<69634){if(e===69632)return n.CLUSTER_BREAK.SPACINGMARK;if(e===69633)return n.CLUSTER_BREAK.EXTEND}else if(e<69688){if(e===69634)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<69744){if(69688<=e&&e<=69702)return n.CLUSTER_BREAK.EXTEND}else if(e===69744)return n.CLUSTER_BREAK.EXTEND}else if(e<69762){if(e<69759){if(69747<=e&&e<=69748)return n.CLUSTER_BREAK.EXTEND}else if(69759<=e&&e<=69761)return n.CLUSTER_BREAK.EXTEND}else if(e<69808){if(e===69762)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<69811){if(69808<=e&&e<=69810)return n.CLUSTER_BREAK.SPACINGMARK}else if(69811<=e&&e<=69814)return n.CLUSTER_BREAK.EXTEND}else if(e<69888)if(e<69821){if(e<69817){if(69815<=e&&e<=69816)return n.CLUSTER_BREAK.SPACINGMARK}else if(69817<=e&&e<=69818)return n.CLUSTER_BREAK.EXTEND}else if(e<69826){if(e===69821)return n.CLUSTER_BREAK.PREPEND}else{if(e===69826)return n.CLUSTER_BREAK.EXTEND;if(e===69837)return n.CLUSTER_BREAK.PREPEND}else if(e<69933){if(e<69927){if(69888<=e&&e<=69890)return n.CLUSTER_BREAK.EXTEND}else if(e<69932){if(69927<=e&&e<=69931)return n.CLUSTER_BREAK.EXTEND}else if(e===69932)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<69957){if(69933<=e&&e<=69940)return n.CLUSTER_BREAK.EXTEND}else if(e<70003){if(69957<=e&&e<=69958)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===70003)return n.CLUSTER_BREAK.EXTEND}else if(e<70194){if(e<70082){if(e<70067){if(e<70018){if(70016<=e&&e<=70017)return n.CLUSTER_BREAK.EXTEND}else if(e===70018)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<70070){if(70067<=e&&e<=70069)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<70079){if(70070<=e&&e<=70078)return n.CLUSTER_BREAK.EXTEND}else if(70079<=e&&e<=70080)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<70095){if(e<70089){if(70082<=e&&e<=70083)return n.CLUSTER_BREAK.PREPEND}else if(e<70094){if(70089<=e&&e<=70092)return n.CLUSTER_BREAK.EXTEND}else if(e===70094)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<70188){if(e===70095)return n.CLUSTER_BREAK.EXTEND}else if(e<70191){if(70188<=e&&e<=70190)return n.CLUSTER_BREAK.SPACINGMARK}else if(70191<=e&&e<=70193)return n.CLUSTER_BREAK.EXTEND}else if(e<70209){if(e<70197){if(e<70196){if(70194<=e&&e<=70195)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===70196)return n.CLUSTER_BREAK.EXTEND}else if(e<70198){if(e===70197)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<70206){if(70198<=e&&e<=70199)return n.CLUSTER_BREAK.EXTEND}else if(e===70206)return n.CLUSTER_BREAK.EXTEND}else if(e<70371){if(e<70367){if(e===70209)return n.CLUSTER_BREAK.EXTEND}else if(e<70368){if(e===70367)return n.CLUSTER_BREAK.EXTEND}else if(70368<=e&&e<=70370)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<70400){if(70371<=e&&e<=70378)return n.CLUSTER_BREAK.EXTEND}else if(e<70402){if(70400<=e&&e<=70401)return n.CLUSTER_BREAK.EXTEND}else if(70402<=e&&e<=70403)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<72343){if(e<71339){if(e<70841){if(e<70512){if(e<70471){if(e<70463){if(e<70462){if(70459<=e&&e<=70460)return n.CLUSTER_BREAK.EXTEND}else if(e===70462)return n.CLUSTER_BREAK.EXTEND}else if(e<70464){if(e===70463)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<70465){if(e===70464)return n.CLUSTER_BREAK.EXTEND}else if(70465<=e&&e<=70468)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<70487){if(e<70475){if(70471<=e&&e<=70472)return n.CLUSTER_BREAK.SPACINGMARK}else if(70475<=e&&e<=70477)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<70498){if(e===70487)return n.CLUSTER_BREAK.EXTEND}else if(e<70502){if(70498<=e&&e<=70499)return n.CLUSTER_BREAK.SPACINGMARK}else if(70502<=e&&e<=70508)return n.CLUSTER_BREAK.EXTEND}else if(e<70725){if(e<70712){if(e<70709){if(70512<=e&&e<=70516)return n.CLUSTER_BREAK.EXTEND}else if(70709<=e&&e<=70711)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<70720){if(70712<=e&&e<=70719)return n.CLUSTER_BREAK.EXTEND}else if(e<70722){if(70720<=e&&e<=70721)return n.CLUSTER_BREAK.SPACINGMARK}else if(70722<=e&&e<=70724)return n.CLUSTER_BREAK.EXTEND}else if(e<70832){if(e<70726){if(e===70725)return n.CLUSTER_BREAK.SPACINGMARK}else if(e===70726||e===70750)return n.CLUSTER_BREAK.EXTEND}else if(e<70833){if(e===70832)return n.CLUSTER_BREAK.EXTEND}else if(e<70835){if(70833<=e&&e<=70834)return n.CLUSTER_BREAK.SPACINGMARK}else if(70835<=e&&e<=70840)return n.CLUSTER_BREAK.EXTEND}else if(e<71096){if(e<70847)if(e<70843){if(e===70841)return n.CLUSTER_BREAK.SPACINGMARK;if(e===70842)return n.CLUSTER_BREAK.EXTEND}else if(e<70845){if(70843<=e&&e<=70844)return n.CLUSTER_BREAK.SPACINGMARK}else{if(e===70845)return n.CLUSTER_BREAK.EXTEND;if(e===70846)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<71087){if(e<70849){if(70847<=e&&e<=70848)return n.CLUSTER_BREAK.EXTEND}else if(e<70850){if(e===70849)return n.CLUSTER_BREAK.SPACINGMARK}else if(70850<=e&&e<=70851)return n.CLUSTER_BREAK.EXTEND}else if(e<71088){if(e===71087)return n.CLUSTER_BREAK.EXTEND}else if(e<71090){if(71088<=e&&e<=71089)return n.CLUSTER_BREAK.SPACINGMARK}else if(71090<=e&&e<=71093)return n.CLUSTER_BREAK.EXTEND}else if(e<71216){if(e<71102){if(e<71100){if(71096<=e&&e<=71099)return n.CLUSTER_BREAK.SPACINGMARK}else if(71100<=e&&e<=71101)return n.CLUSTER_BREAK.EXTEND}else if(e<71103){if(e===71102)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<71132){if(71103<=e&&e<=71104)return n.CLUSTER_BREAK.EXTEND}else if(71132<=e&&e<=71133)return n.CLUSTER_BREAK.EXTEND}else if(e<71229){if(e<71219){if(71216<=e&&e<=71218)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<71227){if(71219<=e&&e<=71226)return n.CLUSTER_BREAK.EXTEND}else if(71227<=e&&e<=71228)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<71230){if(e===71229)return n.CLUSTER_BREAK.EXTEND}else if(e<71231){if(e===71230)return n.CLUSTER_BREAK.SPACINGMARK}else if(71231<=e&&e<=71232)return n.CLUSTER_BREAK.EXTEND}else if(e<71999)if(e<71463){if(e<71350){if(e<71341){if(e===71339)return n.CLUSTER_BREAK.EXTEND;if(e===71340)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<71342){if(e===71341)return n.CLUSTER_BREAK.EXTEND}else if(e<71344){if(71342<=e&&e<=71343)return n.CLUSTER_BREAK.SPACINGMARK}else if(71344<=e&&e<=71349)return n.CLUSTER_BREAK.EXTEND}else if(e<71453){if(e===71350)return n.CLUSTER_BREAK.SPACINGMARK;if(e===71351)return n.CLUSTER_BREAK.EXTEND}else if(e<71458){if(71453<=e&&e<=71455)return n.CLUSTER_BREAK.EXTEND}else if(e<71462){if(71458<=e&&e<=71461)return n.CLUSTER_BREAK.EXTEND}else if(e===71462)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<71984){if(e<71727){if(e<71724){if(71463<=e&&e<=71467)return n.CLUSTER_BREAK.EXTEND}else if(71724<=e&&e<=71726)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<71736){if(71727<=e&&e<=71735)return n.CLUSTER_BREAK.EXTEND}else if(e<71737){if(e===71736)return n.CLUSTER_BREAK.SPACINGMARK}else if(71737<=e&&e<=71738)return n.CLUSTER_BREAK.EXTEND}else if(e<71995){if(e<71985){if(e===71984)return n.CLUSTER_BREAK.EXTEND}else if(e<71991){if(71985<=e&&e<=71989)return n.CLUSTER_BREAK.SPACINGMARK}else if(71991<=e&&e<=71992)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<71997){if(71995<=e&&e<=71996)return n.CLUSTER_BREAK.EXTEND}else{if(e===71997)return n.CLUSTER_BREAK.SPACINGMARK;if(e===71998)return n.CLUSTER_BREAK.EXTEND}else if(e<72193)if(e<72145)if(e<72001){if(e===71999)return n.CLUSTER_BREAK.PREPEND;if(e===72e3)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<72002){if(e===72001)return n.CLUSTER_BREAK.PREPEND}else{if(e===72002)return n.CLUSTER_BREAK.SPACINGMARK;if(e===72003)return n.CLUSTER_BREAK.EXTEND}else if(e<72156){if(e<72148){if(72145<=e&&e<=72147)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<72154){if(72148<=e&&e<=72151)return n.CLUSTER_BREAK.EXTEND}else if(72154<=e&&e<=72155)return n.CLUSTER_BREAK.EXTEND}else if(e<72160){if(72156<=e&&e<=72159)return n.CLUSTER_BREAK.SPACINGMARK}else{if(e===72160)return n.CLUSTER_BREAK.EXTEND;if(e===72164)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<72263){if(e<72249){if(e<72243){if(72193<=e&&e<=72202)return n.CLUSTER_BREAK.EXTEND}else if(72243<=e&&e<=72248)return n.CLUSTER_BREAK.EXTEND}else if(e<72250){if(e===72249)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<72251){if(e===72250)return n.CLUSTER_BREAK.PREPEND}else if(72251<=e&&e<=72254)return n.CLUSTER_BREAK.EXTEND}else if(e<72281){if(e<72273){if(e===72263)return n.CLUSTER_BREAK.EXTEND}else if(e<72279){if(72273<=e&&e<=72278)return n.CLUSTER_BREAK.EXTEND}else if(72279<=e&&e<=72280)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<72324){if(72281<=e&&e<=72283)return n.CLUSTER_BREAK.EXTEND}else if(e<72330){if(72324<=e&&e<=72329)return n.CLUSTER_BREAK.PREPEND}else if(72330<=e&&e<=72342)return n.CLUSTER_BREAK.EXTEND}else if(e<94033){if(e<73104){if(e<72881){if(e<72766){if(e<72751){if(e<72344){if(e===72343)return n.CLUSTER_BREAK.SPACINGMARK}else if(72344<=e&&e<=72345)return n.CLUSTER_BREAK.EXTEND}else if(e<72752){if(e===72751)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<72760){if(72752<=e&&e<=72758)return n.CLUSTER_BREAK.EXTEND}else if(72760<=e&&e<=72765)return n.CLUSTER_BREAK.EXTEND}else if(e<72850){if(e===72766)return n.CLUSTER_BREAK.SPACINGMARK;if(e===72767)return n.CLUSTER_BREAK.EXTEND}else if(e<72873){if(72850<=e&&e<=72871)return n.CLUSTER_BREAK.EXTEND}else if(e<72874){if(e===72873)return n.CLUSTER_BREAK.SPACINGMARK}else if(72874<=e&&e<=72880)return n.CLUSTER_BREAK.EXTEND}else if(e<73018){if(e<72884){if(e<72882){if(e===72881)return n.CLUSTER_BREAK.SPACINGMARK}else if(72882<=e&&e<=72883)return n.CLUSTER_BREAK.EXTEND}else if(e<72885){if(e===72884)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<73009){if(72885<=e&&e<=72886)return n.CLUSTER_BREAK.EXTEND}else if(73009<=e&&e<=73014)return n.CLUSTER_BREAK.EXTEND}else if(e<73030){if(e<73020){if(e===73018)return n.CLUSTER_BREAK.EXTEND}else if(e<73023){if(73020<=e&&e<=73021)return n.CLUSTER_BREAK.EXTEND}else if(73023<=e&&e<=73029)return n.CLUSTER_BREAK.EXTEND}else if(e<73031){if(e===73030)return n.CLUSTER_BREAK.PREPEND}else if(e<73098){if(e===73031)return n.CLUSTER_BREAK.EXTEND}else if(73098<=e&&e<=73102)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<73526){if(e<73459)if(e<73109){if(e<73107){if(73104<=e&&e<=73105)return n.CLUSTER_BREAK.EXTEND}else if(73107<=e&&e<=73108)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<73110){if(e===73109)return n.CLUSTER_BREAK.EXTEND}else{if(e===73110)return n.CLUSTER_BREAK.SPACINGMARK;if(e===73111)return n.CLUSTER_BREAK.EXTEND}else if(e<73474){if(e<73461){if(73459<=e&&e<=73460)return n.CLUSTER_BREAK.EXTEND}else if(e<73472){if(73461<=e&&e<=73462)return n.CLUSTER_BREAK.SPACINGMARK}else if(73472<=e&&e<=73473)return n.CLUSTER_BREAK.EXTEND}else if(e<73475){if(e===73474)return n.CLUSTER_BREAK.PREPEND}else if(e<73524){if(e===73475)return n.CLUSTER_BREAK.SPACINGMARK}else if(73524<=e&&e<=73525)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<78896)if(e<73536){if(e<73534){if(73526<=e&&e<=73530)return n.CLUSTER_BREAK.EXTEND}else if(73534<=e&&e<=73535)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<73537){if(e===73536)return n.CLUSTER_BREAK.EXTEND}else{if(e===73537)return n.CLUSTER_BREAK.SPACINGMARK;if(e===73538)return n.CLUSTER_BREAK.EXTEND}else if(e<92912){if(e<78912){if(78896<=e&&e<=78911)return n.CLUSTER_BREAK.CONTROL}else if(e<78919){if(e===78912)return n.CLUSTER_BREAK.EXTEND}else if(78919<=e&&e<=78933)return n.CLUSTER_BREAK.EXTEND}else if(e<92976){if(92912<=e&&e<=92916)return n.CLUSTER_BREAK.EXTEND}else if(e<94031){if(92976<=e&&e<=92982)return n.CLUSTER_BREAK.EXTEND}else if(e===94031)return n.CLUSTER_BREAK.EXTEND}else if(e<121476){if(e<119143)if(e<113824){if(e<94180){if(e<94095){if(94033<=e&&e<=94087)return n.CLUSTER_BREAK.SPACINGMARK}else if(94095<=e&&e<=94098)return n.CLUSTER_BREAK.EXTEND}else if(e<94192){if(e===94180)return n.CLUSTER_BREAK.EXTEND}else if(e<113821){if(94192<=e&&e<=94193)return n.CLUSTER_BREAK.SPACINGMARK}else if(113821<=e&&e<=113822)return n.CLUSTER_BREAK.EXTEND}else if(e<118576){if(e<118528){if(113824<=e&&e<=113827)return n.CLUSTER_BREAK.CONTROL}else if(118528<=e&&e<=118573)return n.CLUSTER_BREAK.EXTEND}else if(e<119141){if(118576<=e&&e<=118598)return n.CLUSTER_BREAK.EXTEND}else{if(e===119141)return n.CLUSTER_BREAK.EXTEND;if(e===119142)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<119173){if(e<119150){if(e<119149){if(119143<=e&&e<=119145)return n.CLUSTER_BREAK.EXTEND}else if(e===119149)return n.CLUSTER_BREAK.SPACINGMARK}else if(e<119155){if(119150<=e&&e<=119154)return n.CLUSTER_BREAK.EXTEND}else if(e<119163){if(119155<=e&&e<=119162)return n.CLUSTER_BREAK.CONTROL}else if(119163<=e&&e<=119170)return n.CLUSTER_BREAK.EXTEND}else if(e<121344){if(e<119210){if(119173<=e&&e<=119179)return n.CLUSTER_BREAK.EXTEND}else if(e<119362){if(119210<=e&&e<=119213)return n.CLUSTER_BREAK.EXTEND}else if(119362<=e&&e<=119364)return n.CLUSTER_BREAK.EXTEND}else if(e<121403){if(121344<=e&&e<=121398)return n.CLUSTER_BREAK.EXTEND}else if(e<121461){if(121403<=e&&e<=121452)return n.CLUSTER_BREAK.EXTEND}else if(e===121461)return n.CLUSTER_BREAK.EXTEND}else if(e<123628){if(e<122907){if(e<121505){if(e<121499){if(e===121476)return n.CLUSTER_BREAK.EXTEND}else if(121499<=e&&e<=121503)return n.CLUSTER_BREAK.EXTEND}else if(e<122880){if(121505<=e&&e<=121519)return n.CLUSTER_BREAK.EXTEND}else if(e<122888){if(122880<=e&&e<=122886)return n.CLUSTER_BREAK.EXTEND}else if(122888<=e&&e<=122904)return n.CLUSTER_BREAK.EXTEND}else if(e<123023){if(e<122915){if(122907<=e&&e<=122913)return n.CLUSTER_BREAK.EXTEND}else if(e<122918){if(122915<=e&&e<=122916)return n.CLUSTER_BREAK.EXTEND}else if(122918<=e&&e<=122922)return n.CLUSTER_BREAK.EXTEND}else if(e<123184){if(e===123023)return n.CLUSTER_BREAK.EXTEND}else if(e<123566){if(123184<=e&&e<=123190)return n.CLUSTER_BREAK.EXTEND}else if(e===123566)return n.CLUSTER_BREAK.EXTEND}else if(e<127995){if(e<125136){if(e<124140){if(123628<=e&&e<=123631)return n.CLUSTER_BREAK.EXTEND}else if(124140<=e&&e<=124143)return n.CLUSTER_BREAK.EXTEND}else if(e<125252){if(125136<=e&&e<=125142)return n.CLUSTER_BREAK.EXTEND}else if(e<127462){if(125252<=e&&e<=125258)return n.CLUSTER_BREAK.EXTEND}else if(127462<=e&&e<=127487)return n.CLUSTER_BREAK.REGIONAL_INDICATOR}else if(e<917632){if(e<917504){if(127995<=e&&e<=127999)return n.CLUSTER_BREAK.EXTEND}else if(e<917536){if(917504<=e&&e<=917535)return n.CLUSTER_BREAK.CONTROL}else if(917536<=e&&e<=917631)return n.CLUSTER_BREAK.EXTEND}else if(e<917760){if(917632<=e&&e<=917759)return n.CLUSTER_BREAK.CONTROL}else if(e<918e3){if(917760<=e&&e<=917999)return n.CLUSTER_BREAK.EXTEND}else if(918e3<=e&&e<=921599)return n.CLUSTER_BREAK.CONTROL;return n.CLUSTER_BREAK.OTHER}static getEmojiProperty(e){if(e<10160){if(e<9728){if(e<9e3){if(e<8482){if(e<8252){if(e===169||e===174)return n.EXTENDED_PICTOGRAPHIC}else if(e===8252||e===8265)return n.EXTENDED_PICTOGRAPHIC}else if(e<8596){if(e===8482||e===8505)return n.EXTENDED_PICTOGRAPHIC}else if(e<8617){if(8596<=e&&e<=8601)return n.EXTENDED_PICTOGRAPHIC}else if(e<8986){if(8617<=e&&e<=8618)return n.EXTENDED_PICTOGRAPHIC}else if(8986<=e&&e<=8987)return n.EXTENDED_PICTOGRAPHIC}else if(e<9410){if(e<9167){if(e===9e3||e===9096)return n.EXTENDED_PICTOGRAPHIC}else if(e<9193){if(e===9167)return n.EXTENDED_PICTOGRAPHIC}else if(e<9208){if(9193<=e&&e<=9203)return n.EXTENDED_PICTOGRAPHIC}else if(9208<=e&&e<=9210)return n.EXTENDED_PICTOGRAPHIC}else if(e<9654){if(e<9642){if(e===9410)return n.EXTENDED_PICTOGRAPHIC}else if(9642<=e&&e<=9643)return n.EXTENDED_PICTOGRAPHIC}else if(e<9664){if(e===9654)return n.EXTENDED_PICTOGRAPHIC}else if(e<9723){if(e===9664)return n.EXTENDED_PICTOGRAPHIC}else if(9723<=e&&e<=9726)return n.EXTENDED_PICTOGRAPHIC}else if(e<10035){if(e<10004){if(e<9748){if(e<9735){if(9728<=e&&e<=9733)return n.EXTENDED_PICTOGRAPHIC}else if(9735<=e&&e<=9746)return n.EXTENDED_PICTOGRAPHIC}else if(e<9872){if(9748<=e&&e<=9861)return n.EXTENDED_PICTOGRAPHIC}else if(e<9992){if(9872<=e&&e<=9989)return n.EXTENDED_PICTOGRAPHIC}else if(9992<=e&&e<=10002)return n.EXTENDED_PICTOGRAPHIC}else if(e<10013){if(e===10004||e===10006)return n.EXTENDED_PICTOGRAPHIC}else if(e<10017){if(e===10013)return n.EXTENDED_PICTOGRAPHIC}else if(e===10017||e===10024)return n.EXTENDED_PICTOGRAPHIC}else if(e<10067){if(e<10055){if(e<10052){if(10035<=e&&e<=10036)return n.EXTENDED_PICTOGRAPHIC}else if(e===10052)return n.EXTENDED_PICTOGRAPHIC}else if(e<10060){if(e===10055)return n.EXTENDED_PICTOGRAPHIC}else if(e===10060||e===10062)return n.EXTENDED_PICTOGRAPHIC}else if(e<10083){if(e<10071){if(10067<=e&&e<=10069)return n.EXTENDED_PICTOGRAPHIC}else if(e===10071)return n.EXTENDED_PICTOGRAPHIC}else if(e<10133){if(10083<=e&&e<=10087)return n.EXTENDED_PICTOGRAPHIC}else if(e<10145){if(10133<=e&&e<=10135)return n.EXTENDED_PICTOGRAPHIC}else if(e===10145)return n.EXTENDED_PICTOGRAPHIC}else if(e<127489){if(e<12951){if(e<11035){if(e<10548){if(e===10160||e===10175)return n.EXTENDED_PICTOGRAPHIC}else if(e<11013){if(10548<=e&&e<=10549)return n.EXTENDED_PICTOGRAPHIC}else if(11013<=e&&e<=11015)return n.EXTENDED_PICTOGRAPHIC}else if(e<11093){if(e<11088){if(11035<=e&&e<=11036)return n.EXTENDED_PICTOGRAPHIC}else if(e===11088)return n.EXTENDED_PICTOGRAPHIC}else if(e<12336){if(e===11093)return n.EXTENDED_PICTOGRAPHIC}else if(e===12336||e===12349)return n.EXTENDED_PICTOGRAPHIC}else if(e<127340){if(e<126976){if(e===12951||e===12953)return n.EXTENDED_PICTOGRAPHIC}else if(e<127245){if(126976<=e&&e<=127231)return n.EXTENDED_PICTOGRAPHIC}else if(e<127279){if(127245<=e&&e<=127247)return n.EXTENDED_PICTOGRAPHIC}else if(e===127279)return n.EXTENDED_PICTOGRAPHIC}else if(e<127374){if(e<127358){if(127340<=e&&e<=127345)return n.EXTENDED_PICTOGRAPHIC}else if(127358<=e&&e<=127359)return n.EXTENDED_PICTOGRAPHIC}else if(e<127377){if(e===127374)return n.EXTENDED_PICTOGRAPHIC}else if(e<127405){if(127377<=e&&e<=127386)return n.EXTENDED_PICTOGRAPHIC}else if(127405<=e&&e<=127461)return n.EXTENDED_PICTOGRAPHIC}else if(e<128981){if(e<127561){if(e<127535){if(e<127514){if(127489<=e&&e<=127503)return n.EXTENDED_PICTOGRAPHIC}else if(e===127514)return n.EXTENDED_PICTOGRAPHIC}else if(e<127538){if(e===127535)return n.EXTENDED_PICTOGRAPHIC}else if(e<127548){if(127538<=e&&e<=127546)return n.EXTENDED_PICTOGRAPHIC}else if(127548<=e&&e<=127551)return n.EXTENDED_PICTOGRAPHIC}else if(e<128326){if(e<128e3){if(127561<=e&&e<=127994)return n.EXTENDED_PICTOGRAPHIC}else if(128e3<=e&&e<=128317)return n.EXTENDED_PICTOGRAPHIC}else if(e<128640){if(128326<=e&&e<=128591)return n.EXTENDED_PICTOGRAPHIC}else if(e<128884){if(128640<=e&&e<=128767)return n.EXTENDED_PICTOGRAPHIC}else if(128884<=e&&e<=128895)return n.EXTENDED_PICTOGRAPHIC}else if(e<129198){if(e<129096){if(e<129036){if(128981<=e&&e<=129023)return n.EXTENDED_PICTOGRAPHIC}else if(129036<=e&&e<=129039)return n.EXTENDED_PICTOGRAPHIC}else if(e<129114){if(129096<=e&&e<=129103)return n.EXTENDED_PICTOGRAPHIC}else if(e<129160){if(129114<=e&&e<=129119)return n.EXTENDED_PICTOGRAPHIC}else if(129160<=e&&e<=129167)return n.EXTENDED_PICTOGRAPHIC}else if(e<129340){if(e<129292){if(129198<=e&&e<=129279)return n.EXTENDED_PICTOGRAPHIC}else if(129292<=e&&e<=129338)return n.EXTENDED_PICTOGRAPHIC}else if(e<129351){if(129340<=e&&e<=129349)return n.EXTENDED_PICTOGRAPHIC}else if(e<130048){if(129351<=e&&e<=129791)return n.EXTENDED_PICTOGRAPHIC}else if(130048<=e&&e<=131069)return n.EXTENDED_PICTOGRAPHIC;return n.CLUSTER_BREAK.OTHER}};return Pd.default=f,Pd}var lA;function M5(){if(lA)return kd;lA=1;var i=kd&&kd.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(kd,"__esModule",{value:!0});const n=i(B5());return kd.default=n.default,kd}var uA;function z5(){if(uA)return ji;uA=1;var i=ji&&ji.__createBinding||(Object.create?(function(L,O,q,G){G===void 0&&(G=q);var j=Object.getOwnPropertyDescriptor(O,q);(!j||("get"in j?!O.__esModule:j.writable||j.configurable))&&(j={enumerable:!0,get:function(){return O[q]}}),Object.defineProperty(L,G,j)}):(function(L,O,q,G){G===void 0&&(G=q),L[G]=O[q]})),n=ji&&ji.__setModuleDefault||(Object.create?(function(L,O){Object.defineProperty(L,"default",{enumerable:!0,value:O})}):function(L,O){L.default=O}),a=ji&&ji.__importStar||(function(){var L=function(O){return L=Object.getOwnPropertyNames||function(q){var G=[];for(var j in q)Object.prototype.hasOwnProperty.call(q,j)&&(G[G.length]=j);return G},L(O)};return function(O){if(O&&O.__esModule)return O;var q={};if(O!=null)for(var G=L(O),j=0;j<G.length;j++)G[j]!=="default"&&i(q,O,G[j]);return n(q,O),q}})(),c=ji&&ji.__importDefault||function(L){return L&&L.__esModule?L:{default:L}};Object.defineProperty(ji,"__esModule",{value:!0}),ji.validateLanguage=ji.parseLanguage=ji.b64UrlToUtf8=ji.utf8ToB64Url=ji.graphemeLen=ji.utf8Len=void 0;const f=c(M5()),y=a(WD),e=L=>new TextEncoder().encode(L).byteLength;ji.utf8Len=e;const l=L=>new f.default().countGraphemes(L);ji.graphemeLen=l;const _=L=>y.toString(y.fromString(L,"utf8"),"base64url");ji.utf8ToB64Url=_;const w=L=>y.toString(y.fromString(L,"base64url"),"utf8");ji.b64UrlToUtf8=w;const R=L=>{const O=L.match(I);if(!O?.groups)return null;const q=O.groups;return{grandfathered:q.grandfathered,language:q.language,extlang:q.extlang,script:q.script,region:q.region,variant:q.variant,extension:q.extension,privateUse:q.privateUseA||q.privateUseB}};ji.parseLanguage=R;const C=L=>I.test(L);ji.validateLanguage=C;const I=/^((?<grandfathered>(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)|(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|zh-min|zh-min-nan|zh-xiang))|((?<language>([A-Za-z]{2,3}(-(?<extlang>[A-Za-z]{3}(-[A-Za-z]{3}){0,2}))?)|[A-Za-z]{4}|[A-Za-z]{5,8})(-(?<script>[A-Za-z]{4}))?(-(?<region>[A-Za-z]{2}|[0-9]{3}))?(-(?<variant>[A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-(?<extension>[0-9A-WY-Za-wy-z](-[A-Za-z0-9]{2,8})+))*(-(?<privateUseA>x(-[A-Za-z0-9]{1,8})+))?)|(?<privateUseB>x(-[A-Za-z0-9]{1,8})+))$/;return ji}var U0={},cA;function O5(){return cA||(cA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.didDocument=i.getServiceEndpoint=i.getNotifEndpoint=i.getFeedGenEndpoint=i.getPdsEndpoint=i.getSigningDidKey=i.getVerificationMaterial=i.getSigningKey=i.getHandle=i.getDid=i.isValidDidDoc=void 0;const n=bc(),a=j=>i.didDocument.safeParse(j).success;i.isValidDidDoc=a;const c=j=>{const ne=j.id;if(typeof ne!="string")throw new Error("No `id` on document");return ne};i.getDid=c;const f=j=>{const ne=j.alsoKnownAs;if(ne)for(let he=0;he<ne.length;he++){const Q=ne[he];if(Q.startsWith("at://"))return Q.slice(5)}};i.getHandle=f;const y=j=>(0,i.getVerificationMaterial)(j,"atproto");i.getSigningKey=y;const e=(j,ne)=>{const he=I(j,"verificationMethod",`#${ne}`);if(he&&he.publicKeyMultibase)return{type:he.type,publicKeyMultibase:he.publicKeyMultibase}};i.getVerificationMaterial=e;const l=j=>{const ne=(0,i.getSigningKey)(j);if(ne)return`did:key:${ne.publicKeyMultibase}`};i.getSigningDidKey=l;const _=j=>(0,i.getServiceEndpoint)(j,{id:"#atproto_pds",type:"AtprotoPersonalDataServer"});i.getPdsEndpoint=_;const w=j=>(0,i.getServiceEndpoint)(j,{id:"#bsky_fg",type:"BskyFeedGenerator"});i.getFeedGenEndpoint=w;const R=j=>(0,i.getServiceEndpoint)(j,{id:"#bsky_notif",type:"BskyNotificationService"});i.getNotifEndpoint=R;const C=(j,ne)=>{const he=I(j,"service",ne.id);if(he&&!(ne.type&&he.type!==ne.type)&&typeof he.serviceEndpoint=="string")return L(he.serviceEndpoint)};i.getServiceEndpoint=C;function I(j,ne,he){const Q=j[ne];if(Q)for(let Be=0;Be<Q.length;Be++){const we=Q[Be],ze=we.id;if(ze[0]==="#"?ze===he:ze.length===j.id.length+he.length&&ze[j.id.length]==="#"&&ze.endsWith(he)&&ze.startsWith(j.id))return we}}const L=j=>{if(!(!j.startsWith("http://")&&!j.startsWith("https://"))&&O(j))return j},O=URL.canParse??(j=>{try{return new URL(j),!0}catch{return!1}}),q=n.z.object({id:n.z.string(),type:n.z.string(),controller:n.z.string(),publicKeyMultibase:n.z.string().optional()}),G=n.z.object({id:n.z.string(),type:n.z.string(),serviceEndpoint:n.z.union([n.z.string(),n.z.record(n.z.unknown())])});i.didDocument=n.z.object({id:n.z.string(),alsoKnownAs:n.z.array(n.z.string()).optional(),verificationMethod:n.z.array(q).optional(),service:n.z.array(G).optional()})})(U0)),U0}var dA;function $a(){return dA||(dA=1,(function(i){var n=bo&&bo.__createBinding||(Object.create?(function(y,e,l,_){_===void 0&&(_=l);var w=Object.getOwnPropertyDescriptor(e,l);(!w||("get"in w?!e.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return e[l]}}),Object.defineProperty(y,_,w)}):(function(y,e,l,_){_===void 0&&(_=l),y[_]=e[l]})),a=bo&&bo.__setModuleDefault||(Object.create?(function(y,e){Object.defineProperty(y,"default",{enumerable:!0,value:e})}):function(y,e){y.default=e}),c=bo&&bo.__importStar||(function(){var y=function(e){return y=Object.getOwnPropertyNames||function(l){var _=[];for(var w in l)Object.prototype.hasOwnProperty.call(l,w)&&(_[_.length]=w);return _},y(e)};return function(e){if(e&&e.__esModule)return e;var l={};if(e!=null)for(var _=y(e),w=0;w<_.length;w++)_[w]!=="default"&&n(l,e,_[w]);return a(l,e),l}})(),f=bo&&bo.__exportStar||function(y,e){for(var l in y)l!=="default"&&!Object.prototype.hasOwnProperty.call(e,l)&&n(e,y,l)};Object.defineProperty(i,"__esModule",{value:!0}),i.util=i.check=void 0,i.check=c(Wj()),i.util=c(im()),f(Yj(),i),f(Jj(),i),f(im(),i),f(Qj(),i),f(C5(),i),f(k5(),i),f(P5(),i),f(L5(),i),f(z5(),i),f(O5(),i)})(bo)),bo}var Vu={},j0={},pA;function JD(){return pA||(pA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.DisallowedDomainError=i.UnsupportedDomainError=i.ReservedHandleError=i.InvalidHandleError=i.isValidTld=i.isValidHandle=i.normalizeAndEnsureValidHandle=i.normalizeHandle=i.ensureValidHandleRegex=i.ensureValidHandle=i.DISALLOWED_TLDS=i.INVALID_HANDLE=void 0,i.INVALID_HANDLE="handle.invalid",i.DISALLOWED_TLDS=[".local",".arpa",".invalid",".localhost",".internal",".example",".alt",".onion"];const n=C=>{if(!/^[a-zA-Z0-9.-]*$/.test(C))throw new l("Disallowed characters in handle (ASCII letters, digits, dashes, periods only)");if(C.length>253)throw new l("Handle is too long (253 chars max)");const I=C.split(".");if(I.length<2)throw new l("Handle domain needs at least two parts");for(let L=0;L<I.length;L++){const O=I[L];if(O.length<1)throw new l("Handle parts can not be empty");if(O.length>63)throw new l("Handle part too long (max 63 chars)");if(O.endsWith("-")||O.startsWith("-"))throw new l("Handle parts can not start or end with hyphens");if(L+1===I.length&&!/^[a-zA-Z]/.test(O))throw new l("Handle final component (TLD) must start with ASCII letter")}};i.ensureValidHandle=n;const a=C=>{if(!/^([a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?$/.test(C))throw new l("Handle didn't validate via regex");if(C.length>253)throw new l("Handle is too long (253 chars max)")};i.ensureValidHandleRegex=a;const c=C=>C.toLowerCase();i.normalizeHandle=c;const f=C=>{const I=(0,i.normalizeHandle)(C);return(0,i.ensureValidHandle)(I),I};i.normalizeAndEnsureValidHandle=f;const y=C=>{try{(0,i.ensureValidHandle)(C)}catch(I){if(I instanceof l)return!1;throw I}return!0};i.isValidHandle=y;const e=C=>!i.DISALLOWED_TLDS.some(I=>C.endsWith(I));i.isValidTld=e;class l extends Error{}i.InvalidHandleError=l;class _ extends Error{}i.ReservedHandleError=_;class w extends Error{}i.UnsupportedDomainError=w;class R extends Error{}i.DisallowedDomainError=R})(j0)),j0}var Ia={},fA;function QD(){if(fA)return Ia;fA=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.InvalidDidError=Ia.ensureValidDidRegex=Ia.ensureValidDid=void 0;const i=c=>{if(!c.startsWith("did:"))throw new a('DID requires "did:" prefix');if(!/^[a-zA-Z0-9._:%-]*$/.test(c))throw new a("Disallowed characters in DID (ASCII letters, digits, and a couple other characters only)");const{length:f,1:y}=c.split(":");if(f<3)throw new a("DID requires prefix, method, and method-specific content");if(!/^[a-z]+$/.test(y))throw new a("DID method must be lower-case letters");if(c.endsWith(":")||c.endsWith("%"))throw new a('DID can not end with ":" or "%"');if(c.length>2*1024)throw new a("DID is too long (2048 chars max)")};Ia.ensureValidDid=i;const n=c=>{if(!/^did:[a-z]+:[a-zA-Z0-9._:%-]*[a-zA-Z0-9._-]$/.test(c))throw new a("DID didn't validate via regex");if(c.length>2*1024)throw new a("DID is too long (2048 chars max)")};Ia.ensureValidDidRegex=n;class a extends Error{}return Ia.InvalidDidError=a,Ia}var zs={},hA;function eI(){if(hA)return zs;hA=1,Object.defineProperty(zs,"__esModule",{value:!0}),zs.InvalidNsidError=zs.NSID=void 0,zs.ensureValidNsid=n,zs.parseNsid=a,zs.isValidNsid=c,zs.validateNsid=f,zs.ensureValidNsidRegex=R,zs.validateNsidRegex=C;class i{static parse(O){return new i(O)}static create(O,q){const G=[...O.split(".").reverse(),q].join(".");return new i(G)}static isValid(O){return c(O)}static from(O){return O instanceof i?O:Array.isArray(O)?new i(O.join(".")):new i(String(O))}constructor(O){Object.defineProperty(this,"segments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.segments=a(O)}get authority(){return this.segments.slice(0,this.segments.length-1).reverse().join(".")}get name(){return this.segments.at(this.segments.length-1)}toString(){return this.segments.join(".")}}zs.NSID=i;function n(L){const O=f(L);if(!O.success)throw new I(O.message)}function a(L){const O=f(L);if(!O.success)throw new I(O.message);return O.value}function c(L){return C(L).success}function f(L){if(L.length>317)return{success:!1,message:"NSID is too long (317 chars max)"};if(y(L))return{success:!1,message:"Disallowed characters in NSID (ASCII letters, digits, dashes, periods only)"};const O=L.split(".");if(O.length<3)return{success:!1,message:"NSID needs at least three parts"};for(const q of O){if(q.length<1)return{success:!1,message:"NSID parts can not be empty"};if(q.length>63)return{success:!1,message:"NSID part too long (max 63 chars)"};if(l(q)||_(q))return{success:!1,message:"NSID parts can not start or end with hyphen"}}return e(O[0])?{success:!1,message:"NSID first part may not start with a digit"}:w(O[O.length-1])?{success:!0,value:O}:{success:!1,message:"NSID name part must be only letters and digits (and no leading digit)"}}function y(L){return!/^[a-zA-Z0-9.-]*$/.test(L)}function e(L){const O=L.charCodeAt(0);return O>=48&&O<=57}function l(L){return L.charCodeAt(0)===45}function _(L){return L.charCodeAt(L.length-1)===45}function w(L){return!e(L)&&!L.includes("-")}function R(L){const O=C(L);if(!O.success)throw new I(O.message)}function C(L){return L.length>317?{success:!1,message:"NSID is too long (317 chars max)"}:/^[a-zA-Z](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?:\.[a-zA-Z](?:[a-zA-Z0-9]{0,62})?)$/.test(L)?{success:!0,value:L}:{success:!1,message:"NSID didn't validate via regex"}}class I extends Error{}return zs.InvalidNsidError=I,zs}var Uu={},ju={},mA;function V5(){if(mA)return ju;mA=1,Object.defineProperty(ju,"__esModule",{value:!0}),ju.ensureValidAtUriRegex=ju.ensureValidAtUri=void 0;const i=QD(),n=JD(),a=eI(),c=y=>{const e=y.split("#");if(e.length>2)throw new Error('ATURI can have at most one "#", separating fragment out');const l=e[1]||null;if(y=e[0],!/^[a-zA-Z0-9._~:@!$&')(*+,;=%/-]*$/.test(y))throw new Error("Disallowed characters in ATURI (ASCII)");const _=y.split("/");if(_.length>=3&&(_[0]!=="at:"||_[1].length!==0))throw new Error('ATURI must start with "at://"');if(_.length<3)throw new Error("ATURI requires at least method and authority sections");try{_[2].startsWith("did:")?(0,i.ensureValidDid)(_[2]):(0,n.ensureValidHandle)(_[2])}catch{throw new Error("ATURI authority must be a valid handle or DID")}if(_.length>=4){if(_[3].length===0)throw new Error("ATURI can not have a slash after authority without a path segment");if(!(0,a.isValidNsid)(_[3]))throw new Error("ATURI requires first path segment (if supplied) to be valid NSID")}if(_.length>=5&&_[4].length===0)throw new Error("ATURI can not have a slash after collection, unless record key is provided");if(_.length>=6)throw new Error("ATURI path can have at most two parts, and no trailing slash");if(e.length>=2&&l==null)throw new Error("ATURI fragment must be non-empty and start with slash");if(l!=null){if(l.length===0||l[0]!=="/")throw new Error("ATURI fragment must be non-empty and start with slash");if(!/^\/[a-zA-Z0-9._~:@!$&')(*+,;=%[\]/-]*$/.test(l))throw new Error("Disallowed characters in ATURI fragment (ASCII)")}if(y.length>8*1024)throw new Error("ATURI is far too long")};ju.ensureValidAtUri=c;const f=y=>{const e=/^at:\/\/(?<authority>[a-zA-Z0-9._:%-]+)(\/(?<collection>[a-zA-Z0-9-.]+)(\/(?<rkey>[a-zA-Z0-9._~:@!$&%')(*+,;=-]+))?)?(#(?<fragment>\/[a-zA-Z0-9._~:@!$&%')(*+,;=\-[\]/\\]*))?$/,l=y.match(e);if(!l||!l.groups)throw new Error("ATURI didn't validate via regex");const _=l.groups;try{(0,n.ensureValidHandleRegex)(_.authority)}catch{try{(0,i.ensureValidDidRegex)(_.authority)}catch{throw new Error("ATURI authority must be a valid handle or DID")}}if(_.collection&&!(0,a.isValidNsid)(_.collection))throw new Error("ATURI collection path segment must be a valid NSID");if(y.length>8*1024)throw new Error("ATURI is far too long")};return ju.ensureValidAtUriRegex=f,ju}var yA;function U5(){return yA||(yA=1,(function(i){var n=Uu&&Uu.__createBinding||(Object.create?(function(l,_,w,R){R===void 0&&(R=w);var C=Object.getOwnPropertyDescriptor(_,w);(!C||("get"in C?!_.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return _[w]}}),Object.defineProperty(l,R,C)}):(function(l,_,w,R){R===void 0&&(R=w),l[R]=_[w]})),a=Uu&&Uu.__exportStar||function(l,_){for(var w in l)w!=="default"&&!Object.prototype.hasOwnProperty.call(_,w)&&n(_,l,w)};Object.defineProperty(i,"__esModule",{value:!0}),i.AtUri=i.ATP_URI_REGEX=void 0,a(V5(),i),i.ATP_URI_REGEX=/^(at:\/\/)?((?:did:[a-z0-9:%-]+)|(?:[a-z0-9][a-z0-9.:-]*))(\/[^?#\s]*)?(\?[^#\s]+)?(#[^\s]+)?$/i;const c=/^(\/[^?#\s]*)?(\?[^#\s]+)?(#[^\s]+)?$/i;class f{constructor(_,w){Object.defineProperty(this,"hash",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"host",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pathname",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"searchParams",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let R;if(w){if(R=y(w),!R)throw new Error(`Invalid at uri: ${w}`);const C=e(_);if(!C)throw new Error(`Invalid path: ${_}`);Object.assign(R,C)}else if(R=y(_),!R)throw new Error(`Invalid at uri: ${_}`);this.hash=R.hash,this.host=R.host,this.pathname=R.pathname,this.searchParams=R.searchParams}static make(_,w,R){let C=_;return w&&(C+="/"+w),R&&(C+="/"+R),new f(C)}get protocol(){return"at:"}get origin(){return`at://${this.host}`}get hostname(){return this.host}set hostname(_){this.host=_}get search(){return this.searchParams.toString()}set search(_){this.searchParams=new URLSearchParams(_)}get collection(){return this.pathname.split("/").filter(Boolean)[0]||""}set collection(_){const w=this.pathname.split("/").filter(Boolean);w[0]=_,this.pathname=w.join("/")}get rkey(){return this.pathname.split("/").filter(Boolean)[1]||""}set rkey(_){const w=this.pathname.split("/").filter(Boolean);w[0]||(w[0]="undefined"),w[1]=_,this.pathname=w.join("/")}get href(){return this.toString()}toString(){let _=this.pathname||"/";_.startsWith("/")||(_=`/${_}`);let w=this.searchParams.toString();w&&!w.startsWith("?")&&(w=`?${w}`);let R=this.hash;return R&&!R.startsWith("#")&&(R=`#${R}`),`at://${this.host}${_}${w}${R}`}}i.AtUri=f;function y(l){const _=i.ATP_URI_REGEX.exec(l);if(_)return{hash:_[5]||"",host:_[2]||"",pathname:_[3]||"",searchParams:new URLSearchParams(_[4]||"")}}function e(l){const _=c.exec(l);if(_)return{hash:_[3]||"",pathname:_[1]||"",searchParams:new URLSearchParams(_[2]||"")}}})(Uu)),Uu}var Ba={},gA;function j5(){if(gA)return Ba;gA=1,Object.defineProperty(Ba,"__esModule",{value:!0}),Ba.InvalidTidError=Ba.isValidTid=Ba.ensureValidTid=void 0;const i=13,n=/^[234567abcdefghij][234567abcdefghijklmnopqrstuvwxyz]{12}$/,a=y=>{if(y.length!==i)throw new f(`TID must be ${i} characters`);if(!n.test(y))throw new f("TID syntax not valid (regex)")};Ba.ensureValidTid=a;const c=y=>y.length===i&&n.test(y);Ba.isValidTid=c;class f extends Error{}return Ba.InvalidTidError=f,Ba}var N0={},_A;function N5(){return _A||(_A=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.InvalidRecordKeyError=i.isValidRecordKey=i.ensureValidRecordKey=void 0;const n=f=>{if(f.length>512||f.length<1)throw new c("record key must be 1 to 512 characters");if(!/^[a-zA-Z0-9_~.:-]{1,512}$/.test(f))throw new c("record key syntax not valid (regex)");if(f==="."||f==="..")throw new c('record key can not be "." or ".."')};i.ensureValidRecordKey=n;const a=f=>{try{(0,i.ensureValidRecordKey)(f)}catch(y){if(y instanceof c)return!1;throw y}return!0};i.isValidRecordKey=a;class c extends Error{}i.InvalidRecordKeyError=c})(N0)),N0}var F0={},bA;function F5(){return bA||(bA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.InvalidDatetimeError=i.normalizeDatetimeAlways=i.normalizeDatetime=i.isValidDatetime=i.ensureValidDatetime=void 0;const n=e=>{const l=new Date(e);if(isNaN(l.getTime()))throw new y("datetime did not parse as ISO 8601");if(l.toISOString().startsWith("-"))throw new y("datetime normalized to a negative time");if(!/^[0-9]{4}-[01][0-9]-[0-3][0-9]T[0-2][0-9]:[0-6][0-9]:[0-6][0-9](.[0-9]{1,20})?(Z|([+-][0-2][0-9]:[0-5][0-9]))$/.test(e))throw new y("datetime didn't validate via regex");if(e.length>64)throw new y("datetime is too long (64 chars max)");if(e.endsWith("-00:00"))throw new y('datetime can not use "-00:00" for UTC timezone');if(e.startsWith("000"))throw new y("datetime so close to year zero not allowed")};i.ensureValidDatetime=n;const a=e=>{try{(0,i.ensureValidDatetime)(e)}catch(l){if(l instanceof y)return!1;throw l}return!0};i.isValidDatetime=a;const c=e=>{if((0,i.isValidDatetime)(e)){const w=new Date(e).toISOString();if((0,i.isValidDatetime)(w))return w}if(!/.*(([+-]\d\d:?\d\d)|[a-zA-Z])$/.test(e)){const w=new Date(e+"Z");if(!isNaN(w.getTime())){const R=w.toISOString();if((0,i.isValidDatetime)(R))return R}}const l=new Date(e);if(isNaN(l.getTime()))throw new y("datetime did not parse as any timestamp format");const _=l.toISOString();if((0,i.isValidDatetime)(_))return _;throw new y("datetime normalized to invalid timestamp string")};i.normalizeDatetime=c;const f=e=>{try{return(0,i.normalizeDatetime)(e)}catch(l){if(l instanceof y)return new Date(0).toISOString();throw l}};i.normalizeDatetimeAlways=f;class y extends Error{}i.InvalidDatetimeError=y})(F0)),F0}var vA;function Hp(){return vA||(vA=1,(function(i){var n=Vu&&Vu.__createBinding||(Object.create?(function(c,f,y,e){e===void 0&&(e=y);var l=Object.getOwnPropertyDescriptor(f,y);(!l||("get"in l?!f.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return f[y]}}),Object.defineProperty(c,e,l)}):(function(c,f,y,e){e===void 0&&(e=y),c[e]=f[y]})),a=Vu&&Vu.__exportStar||function(c,f){for(var y in c)y!=="default"&&!Object.prototype.hasOwnProperty.call(f,y)&&n(f,c,y)};Object.defineProperty(i,"__esModule",{value:!0}),a(JD(),i),a(QD(),i),a(eI(),i),a(U5(),i),a(j5(),i),a(N5(),i),a(F5(),i)})(Vu)),Vu}var dh={},xA;function e1(){if(xA)return dh;xA=1,Object.defineProperty(dh,"__esModule",{value:!0}),dh.toLexUri=n,dh.requiredPropertiesRefinement=a;const i=bc();function n(c,f){if(c.split("#").length>2)throw new Error("Uri can only have one hash segment");if(c.startsWith("lex:"))return c;if(c.startsWith("#")){if(!f)throw new Error(`Unable to resolve uri without anchor: ${c}`);return`${f}${c}`}return`lex:${c}`}function a(c,f){if(c.required!==void 0){if(!Array.isArray(c.required)){f.addIssue({code:i.z.ZodIssueCode.invalid_type,received:typeof c.required,expected:"array"});return}if(c.properties===void 0){c.required.length>0&&f.addIssue({code:i.z.ZodIssueCode.custom,message:"Required fields defined but no properties defined"});return}for(const y of c.required)c.properties[y]===void 0&&f.addIssue({code:i.z.ZodIssueCode.custom,message:`Required field "${y}" not defined`})}}return dh}var wA;function vc(){return wA||(wA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.LexiconDefNotFoundError=i.InvalidLexiconError=i.ValidationError=i.lexiconDoc=i.lexUserType=i.lexRecord=i.lexXrpcSubscription=i.lexXrpcProcedure=i.lexXrpcQuery=i.lexXrpcError=i.lexXrpcSubscriptionMessage=i.lexXrpcBody=i.lexXrpcParameters=i.lexPermissionSet=i.lexObject=i.lexToken=i.lexPrimitiveArray=i.lexArray=i.lexBlob=i.lexRefVariant=i.lexRefUnion=i.lexRef=i.lexIpldType=i.lexCidLink=i.lexBytes=i.lexPrimitive=i.lexUnknown=i.lexString=i.lexStringFormat=i.lexInteger=i.lexBoolean=i.lexLang=i.languageSchema=void 0,i.isValidLexiconDoc=e,i.isObj=l,i.isDiscriminatedObject=_,i.parseLexiconDoc=w;const n=bc(),a=$a(),c=Hp(),f=e1();i.languageSchema=n.z.string().refine(a.validateLanguage,"Invalid BCP47 language tag"),i.lexLang=n.z.record(i.languageSchema,n.z.string().optional()),i.lexBoolean=n.z.object({type:n.z.literal("boolean"),description:n.z.string().optional(),default:n.z.boolean().optional(),const:n.z.boolean().optional()}),i.lexInteger=n.z.object({type:n.z.literal("integer"),description:n.z.string().optional(),default:n.z.number().int().optional(),minimum:n.z.number().int().optional(),maximum:n.z.number().int().optional(),enum:n.z.number().int().array().optional(),const:n.z.number().int().optional()}),i.lexStringFormat=n.z.enum(["datetime","uri","at-uri","did","handle","at-identifier","nsid","cid","language","tid","record-key"]),i.lexString=n.z.object({type:n.z.literal("string"),format:i.lexStringFormat.optional(),description:n.z.string().optional(),default:n.z.string().optional(),minLength:n.z.number().int().optional(),maxLength:n.z.number().int().optional(),minGraphemes:n.z.number().int().optional(),maxGraphemes:n.z.number().int().optional(),enum:n.z.string().array().optional(),const:n.z.string().optional(),knownValues:n.z.string().array().optional()}),i.lexUnknown=n.z.object({type:n.z.literal("unknown"),description:n.z.string().optional()}),i.lexPrimitive=n.z.discriminatedUnion("type",[i.lexBoolean,i.lexInteger,i.lexString,i.lexUnknown]),i.lexBytes=n.z.object({type:n.z.literal("bytes"),description:n.z.string().optional(),maxLength:n.z.number().optional(),minLength:n.z.number().optional()}),i.lexCidLink=n.z.object({type:n.z.literal("cid-link"),description:n.z.string().optional()}),i.lexIpldType=n.z.discriminatedUnion("type",[i.lexBytes,i.lexCidLink]),i.lexRef=n.z.object({type:n.z.literal("ref"),description:n.z.string().optional(),ref:n.z.string()}),i.lexRefUnion=n.z.object({type:n.z.literal("union"),description:n.z.string().optional(),refs:n.z.string().array(),closed:n.z.boolean().optional()}),i.lexRefVariant=n.z.discriminatedUnion("type",[i.lexRef,i.lexRefUnion]),i.lexBlob=n.z.object({type:n.z.literal("blob"),description:n.z.string().optional(),accept:n.z.string().array().optional(),maxSize:n.z.number().optional()}),i.lexArray=n.z.object({type:n.z.literal("array"),description:n.z.string().optional(),items:n.z.discriminatedUnion("type",[i.lexBoolean,i.lexInteger,i.lexString,i.lexUnknown,i.lexBytes,i.lexCidLink,i.lexRef,i.lexRefUnion,i.lexBlob]),minLength:n.z.number().int().optional(),maxLength:n.z.number().int().optional()}),i.lexPrimitiveArray=i.lexArray.merge(n.z.object({items:i.lexPrimitive})),i.lexToken=n.z.object({type:n.z.literal("token"),description:n.z.string().optional()}),i.lexObject=n.z.object({type:n.z.literal("object"),description:n.z.string().optional(),required:n.z.string().array().optional(),nullable:n.z.string().array().optional(),properties:n.z.record(n.z.string(),n.z.discriminatedUnion("type",[i.lexArray,i.lexBoolean,i.lexInteger,i.lexString,i.lexUnknown,i.lexBytes,i.lexCidLink,i.lexRef,i.lexRefUnion,i.lexBlob]))}).superRefine(f.requiredPropertiesRefinement);const y=n.z.intersection(n.z.object({type:n.z.literal("permission"),resource:n.z.string().nonempty()}),n.z.record(n.z.string(),n.z.union([n.z.array(n.z.union([n.z.string(),n.z.number().int(),n.z.boolean()])),n.z.boolean(),n.z.number().int(),n.z.string()]).optional()));i.lexPermissionSet=n.z.object({type:n.z.literal("permission-set"),description:n.z.string().optional(),title:n.z.string().optional(),"title:lang":i.lexLang.optional(),detail:n.z.string().optional(),"detail:lang":i.lexLang.optional(),permissions:n.z.array(y)}),i.lexXrpcParameters=n.z.object({type:n.z.literal("params"),description:n.z.string().optional(),required:n.z.string().array().optional(),properties:n.z.record(n.z.string(),n.z.discriminatedUnion("type",[i.lexPrimitiveArray,i.lexBoolean,i.lexInteger,i.lexString,i.lexUnknown]))}).superRefine(f.requiredPropertiesRefinement),i.lexXrpcBody=n.z.object({description:n.z.string().optional(),encoding:n.z.string(),schema:n.z.union([i.lexRefVariant,i.lexObject]).optional()}),i.lexXrpcSubscriptionMessage=n.z.object({description:n.z.string().optional(),schema:n.z.union([i.lexRefVariant,i.lexObject]).optional()}),i.lexXrpcError=n.z.object({name:n.z.string(),description:n.z.string().optional()}),i.lexXrpcQuery=n.z.object({type:n.z.literal("query"),description:n.z.string().optional(),parameters:i.lexXrpcParameters.optional(),output:i.lexXrpcBody.optional(),errors:i.lexXrpcError.array().optional()}),i.lexXrpcProcedure=n.z.object({type:n.z.literal("procedure"),description:n.z.string().optional(),parameters:i.lexXrpcParameters.optional(),input:i.lexXrpcBody.optional(),output:i.lexXrpcBody.optional(),errors:i.lexXrpcError.array().optional()}),i.lexXrpcSubscription=n.z.object({type:n.z.literal("subscription"),description:n.z.string().optional(),parameters:i.lexXrpcParameters.optional(),message:i.lexXrpcSubscriptionMessage.optional(),errors:i.lexXrpcError.array().optional()}),i.lexRecord=n.z.object({type:n.z.literal("record"),description:n.z.string().optional(),key:n.z.string().optional(),record:i.lexObject}),i.lexUserType=n.z.custom(L=>{if(!(!L||typeof L!="object")&&L.type!==void 0)switch(L.type){case"record":return i.lexRecord.parse(L);case"permission-set":return i.lexPermissionSet.parse(L);case"query":return i.lexXrpcQuery.parse(L);case"procedure":return i.lexXrpcProcedure.parse(L);case"subscription":return i.lexXrpcSubscription.parse(L);case"blob":return i.lexBlob.parse(L);case"array":return i.lexArray.parse(L);case"token":return i.lexToken.parse(L);case"object":return i.lexObject.parse(L);case"boolean":return i.lexBoolean.parse(L);case"integer":return i.lexInteger.parse(L);case"string":return i.lexString.parse(L);case"bytes":return i.lexBytes.parse(L);case"cid-link":return i.lexCidLink.parse(L);case"unknown":return i.lexUnknown.parse(L)}},L=>!L||typeof L!="object"?{message:"Must be an object",fatal:!0}:L.type===void 0?{message:"Must have a type",fatal:!0}:typeof L.type!="string"?{message:"Type property must be a string",fatal:!0}:{message:`Invalid type: ${L.type} must be one of: record, query, procedure, subscription, blob, array, token, object, boolean, integer, string, bytes, cid-link, unknown`,fatal:!0}),i.lexiconDoc=n.z.object({lexicon:n.z.literal(1),id:n.z.string().refine(c.isValidNsid,{message:"Must be a valid NSID"}),revision:n.z.number().optional(),description:n.z.string().optional(),defs:n.z.record(n.z.string(),i.lexUserType)}).refine(L=>{for(const[O,q]of Object.entries(L.defs))if(O!=="main"&&(q.type==="record"||q.type==="permission-set"||q.type==="procedure"||q.type==="query"||q.type==="subscription"))return!1;return!0},{message:"Records, permission sets, procedures, queries, and subscriptions must be the main definition."});function e(L){return i.lexiconDoc.safeParse(L).success}function l(L){return L!=null&&typeof L=="object"}function _(L){return l(L)&&"$type"in L&&typeof L.$type=="string"}function w(L){return i.lexiconDoc.parse(L),L}class R extends Error{}i.ValidationError=R;class C extends Error{}i.InvalidLexiconError=C;class I extends Error{}i.LexiconDefNotFoundError=I})(P0)),P0}var ph={},xl={},Nu={},By={},q0={},EA;function t1(){return EA||(EA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.BlobRef=i.jsonBlobRef=i.untypedJsonBlobRef=i.typedJsonBlobRef=void 0;const n=Zp,a=bc(),c=$a();i.typedJsonBlobRef=a.z.object({$type:a.z.literal("blob"),ref:c.schema.cid,mimeType:a.z.string(),size:a.z.number()}).strict(),i.untypedJsonBlobRef=a.z.object({cid:a.z.string(),mimeType:a.z.string()}).strict(),i.jsonBlobRef=a.z.union([i.typedJsonBlobRef,i.untypedJsonBlobRef]);class f{constructor(e,l,_,w){Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"mimeType",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:_}),Object.defineProperty(this,"original",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.original=w??{$type:"blob",ref:e,mimeType:l,size:_}}static asBlobRef(e){return c.check.is(e,i.jsonBlobRef)?f.fromJsonRef(e):null}static fromJsonRef(e){return c.check.is(e,i.typedJsonBlobRef)?new f(e.ref,e.mimeType,e.size):new f(n.CID.parse(e.cid),e.mimeType,-1,e)}ipld(){return{$type:"blob",ref:this.ref,mimeType:this.mimeType,size:this.size}}toJSON(){return(0,c.ipldToJson)(this.ipld())}}i.BlobRef=f})(q0)),q0}var AA;function q5(){if(AA)return By;AA=1,Object.defineProperty(By,"__esModule",{value:!0}),By.blob=a;const i=t1(),n=vc();function a(c,f,y,e){return!e||!(e instanceof i.BlobRef)?{success:!1,error:new n.ValidationError(`${f} should be a blob ref`)}:{success:!0,value:e}}return By}var $o={},_s={},K0={},RA;function K5(){return RA||(RA=1,(function(i){(()=>{var n={d:(R,C)=>{for(var I in C)n.o(C,I)&&!n.o(R,I)&&Object.defineProperty(R,I,{enumerable:!0,get:C[I]})},o:(R,C)=>Object.prototype.hasOwnProperty.call(R,C),r:R=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(R,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(R,"__esModule",{value:!0})}},a={};function c(R,C){return C===void 0&&(C="-"),new RegExp("^(?!0{4}"+C+"0{2}"+C+"0{2})((?=[0-9]{4}"+C+"(((0[^2])|1[0-2])|02(?="+C+"(([0-1][0-9])|2[0-8])))"+C+"[0-9]{2})|(?=((([13579][26])|([2468][048])|(0[48]))0{2})|([0-9]{2}((((0|[2468])[48])|[2468][048])|([13579][26])))"+C+"02"+C+"29))([0-9]{4})"+C+"(?!((0[469])|11)"+C+"31)((0[1,3-9]|1[0-2])|(02(?!"+C+"3)))"+C+"(0[1-9]|[1-2][0-9]|3[0-1])$").test(R)}function f(R){var C=/\D/.exec(R);return C?C[0]:""}function y(R,C,I){C===void 0&&(C=":"),I===void 0&&(I=!1);var L=new RegExp("^([0-1]|2(?=([0-3])|4"+C+"00))[0-9]"+C+"[0-5][0-9]("+C+"([0-5]|6(?=0))[0-9])?(.[0-9]{1,9})?$");if(!I||!/[Z+\-]/.test(R))return L.test(R);if(/Z$/.test(R))return L.test(R.replace("Z",""));var O=R.includes("+"),q=R.split(/[+-]/),G=q[0],j=q[1];return L.test(G)&&(function(ne,he,Q){return Q===void 0&&(Q=":"),new RegExp(he?"^(0(?!(2"+Q+"4)|0"+Q+"3)|1(?=([0-1]|2(?="+Q+"[04])|[34](?="+Q+"0))))([03469](?="+Q+"[03])|[17](?="+Q+"0)|2(?="+Q+"[04])|5(?="+Q+"[034])|8(?="+Q+"[04]))"+Q+"([03](?=0)|4(?=5))[05]$":"^(0(?=[^0])|1(?=[0-2]))([39](?="+Q+"[03])|[0-24-8](?="+Q+"00))"+Q+"[03]0$").test(ne)})(j,O,f(j))}function e(R){var C=R.split("T"),I=C[0],L=C[1],O=c(I,f(I));if(!L)return!1;var q,G=(q=L.match(/([^Z+\-\d])(?=\d+\1)/),Array.isArray(q)?q[0]:"");return O&&y(L,G,!0)}function l(R,C){return C===void 0&&(C="-"),new RegExp("^[0-9]{4}"+C+"(0(?=[^0])|1(?=[0-2]))[0-9]$").test(R)}n.r(a),n.d(a,{isValidDate:()=>c,isValidISODateString:()=>e,isValidTime:()=>y,isValidYearMonth:()=>l});var _=i;for(var w in a)_[w]=a[w];a.__esModule&&Object.defineProperty(_,"__esModule",{value:!0})})()})(K0)),K0}var SA;function G5(){if(SA)return _s;SA=1,Object.defineProperty(_s,"__esModule",{value:!0}),_s.datetime=y,_s.uri=e,_s.atUri=l,_s.did=_,_s.handle=w,_s.atIdentifier=R,_s.nsid=C,_s.cid=I,_s.language=L,_s.tid=O,_s.recordKey=q;const i=K5(),n=Zp,a=$a(),c=Hp(),f=vc();function y(G,j){try{if(!(0,i.isValidISODateString)(j))throw new Error}catch{return{success:!1,error:new f.ValidationError(`${G} must be an valid atproto datetime (both RFC-3339 and ISO-8601)`)}}return{success:!0,value:j}}function e(G,j){return j.match(/^\w+:(?:\/\/)?[^\s/][^\s]*$/)!==null?{success:!0,value:j}:{success:!1,error:new f.ValidationError(`${G} must be a uri`)}}function l(G,j){try{(0,c.ensureValidAtUri)(j)}catch{return{success:!1,error:new f.ValidationError(`${G} must be a valid at-uri`)}}return{success:!0,value:j}}function _(G,j){try{(0,c.ensureValidDid)(j)}catch{return{success:!1,error:new f.ValidationError(`${G} must be a valid did`)}}return{success:!0,value:j}}function w(G,j){try{(0,c.ensureValidHandle)(j)}catch{return{success:!1,error:new f.ValidationError(`${G} must be a valid handle`)}}return{success:!0,value:j}}function R(G,j){if(j.startsWith("did:")){const ne=_(G,j);if(ne.success)return ne}else{const ne=w(G,j);if(ne.success)return ne}return{success:!1,error:new f.ValidationError(`${G} must be a valid did or a handle`)}}function C(G,j){return(0,c.isValidNsid)(j)?{success:!0,value:j}:{success:!1,error:new f.ValidationError(`${G} must be a valid nsid`)}}function I(G,j){try{n.CID.parse(j)}catch{return{success:!1,error:new f.ValidationError(`${G} must be a cid string`)}}return{success:!0,value:j}}function L(G,j){return(0,a.validateLanguage)(j)?{success:!0,value:j}:{success:!1,error:new f.ValidationError(`${G} must be a well-formed BCP 47 language tag`)}}function O(G,j){return(0,c.isValidTid)(j)?{success:!0,value:j}:{success:!1,error:new f.ValidationError(`${G} must be a valid TID`)}}function q(G,j){try{(0,c.ensureValidRecordKey)(j)}catch{return{success:!1,error:new f.ValidationError(`${G} must be a valid Record Key`)}}return{success:!0,value:j}}return _s}var TA;function tI(){if(TA)return $o;TA=1;var i=$o&&$o.__createBinding||(Object.create?(function(O,q,G,j){j===void 0&&(j=G);var ne=Object.getOwnPropertyDescriptor(q,G);(!ne||("get"in ne?!q.__esModule:ne.writable||ne.configurable))&&(ne={enumerable:!0,get:function(){return q[G]}}),Object.defineProperty(O,j,ne)}):(function(O,q,G,j){j===void 0&&(j=G),O[j]=q[G]})),n=$o&&$o.__setModuleDefault||(Object.create?(function(O,q){Object.defineProperty(O,"default",{enumerable:!0,value:q})}):function(O,q){O.default=q}),a=$o&&$o.__importStar||(function(){var O=function(q){return O=Object.getOwnPropertyNames||function(G){var j=[];for(var ne in G)Object.prototype.hasOwnProperty.call(G,ne)&&(j[j.length]=ne);return j},O(q)};return function(q){if(q&&q.__esModule)return q;var G={};if(q!=null)for(var j=O(q),ne=0;ne<j.length;ne++)j[ne]!=="default"&&i(G,q,j[ne]);return n(G,q),G}})();Object.defineProperty($o,"__esModule",{value:!0}),$o.validate=l;const c=Zp,f=$a(),y=vc(),e=a(G5());function l(O,q,G,j){switch(G.type){case"boolean":return _(O,q,G,j);case"integer":return w(O,q,G,j);case"string":return R(O,q,G,j);case"bytes":return C(O,q,G,j);case"cid-link":return I(O,q,G,j);case"unknown":return L(O,q,G,j);default:return{success:!1,error:new y.ValidationError(`Unexpected lexicon type: ${G.type}`)}}}function _(O,q,G,j){G=G;const ne=typeof j;return ne==="undefined"?typeof G.default=="boolean"?{success:!0,value:G.default}:{success:!1,error:new y.ValidationError(`${q} must be a boolean`)}:ne!=="boolean"?{success:!1,error:new y.ValidationError(`${q} must be a boolean`)}:typeof G.const=="boolean"&&j!==G.const?{success:!1,error:new y.ValidationError(`${q} must be ${G.const}`)}:{success:!0,value:j}}function w(O,q,G,j){return G=G,typeof j==="undefined"?typeof G.default=="number"?{success:!0,value:G.default}:{success:!1,error:new y.ValidationError(`${q} must be an integer`)}:Number.isInteger(j)?typeof G.const=="number"&&j!==G.const?{success:!1,error:new y.ValidationError(`${q} must be ${G.const}`)}:Array.isArray(G.enum)&&!G.enum.includes(j)?{success:!1,error:new y.ValidationError(`${q} must be one of (${G.enum.join("|")})`)}:typeof G.maximum=="number"&&j>G.maximum?{success:!1,error:new y.ValidationError(`${q} can not be greater than ${G.maximum}`)}:typeof G.minimum=="number"&&j<G.minimum?{success:!1,error:new y.ValidationError(`${q} can not be less than ${G.minimum}`)}:{success:!0,value:j}:{success:!1,error:new y.ValidationError(`${q} must be an integer`)}}function R(O,q,G,j){if(G=G,typeof j>"u")return typeof G.default=="string"?{success:!0,value:G.default}:{success:!1,error:new y.ValidationError(`${q} must be a string`)};if(typeof j!="string")return{success:!1,error:new y.ValidationError(`${q} must be a string`)};if(typeof G.const=="string"&&j!==G.const)return{success:!1,error:new y.ValidationError(`${q} must be ${G.const}`)};if(Array.isArray(G.enum)&&!G.enum.includes(j))return{success:!1,error:new y.ValidationError(`${q} must be one of (${G.enum.join("|")})`)};if(typeof G.minLength=="number"||typeof G.maxLength=="number"){if(typeof G.minLength=="number"&&j.length*3<G.minLength)return{success:!1,error:new y.ValidationError(`${q} must not be shorter than ${G.minLength} characters`)};let ne=!1;if(typeof G.minLength>"u"&&typeof G.maxLength=="number"&&j.length*3<=G.maxLength&&(ne=!0),!ne){const he=(0,f.utf8Len)(j);if(typeof G.maxLength=="number"&&he>G.maxLength)return{success:!1,error:new y.ValidationError(`${q} must not be longer than ${G.maxLength} characters`)};if(typeof G.minLength=="number"&&he<G.minLength)return{success:!1,error:new y.ValidationError(`${q} must not be shorter than ${G.minLength} characters`)}}}if(typeof G.maxGraphemes=="number"||typeof G.minGraphemes=="number"){let ne=!1,he=!1;if(typeof G.maxGraphemes=="number"&&(j.length<=G.maxGraphemes?ne=!1:ne=!0),typeof G.minGraphemes=="number"){if(j.length<G.minGraphemes)return{success:!1,error:new y.ValidationError(`${q} must not be shorter than ${G.minGraphemes} graphemes`)};he=!0}if(ne||he){const Q=(0,f.graphemeLen)(j);if(typeof G.maxGraphemes=="number"&&Q>G.maxGraphemes)return{success:!1,error:new y.ValidationError(`${q} must not be longer than ${G.maxGraphemes} graphemes`)};if(typeof G.minGraphemes=="number"&&Q<G.minGraphemes)return{success:!1,error:new y.ValidationError(`${q} must not be shorter than ${G.minGraphemes} graphemes`)}}}if(typeof G.format=="string")switch(G.format){case"datetime":return e.datetime(q,j);case"uri":return e.uri(q,j);case"at-uri":return e.atUri(q,j);case"did":return e.did(q,j);case"handle":return e.handle(q,j);case"at-identifier":return e.atIdentifier(q,j);case"nsid":return e.nsid(q,j);case"cid":return e.cid(q,j);case"language":return e.language(q,j);case"tid":return e.tid(q,j);case"record-key":return e.recordKey(q,j)}return{success:!0,value:j}}function C(O,q,G,j){return G=G,!j||!(j instanceof Uint8Array)?{success:!1,error:new y.ValidationError(`${q} must be a byte array`)}:typeof G.maxLength=="number"&&j.byteLength>G.maxLength?{success:!1,error:new y.ValidationError(`${q} must not be larger than ${G.maxLength} bytes`)}:typeof G.minLength=="number"&&j.byteLength<G.minLength?{success:!1,error:new y.ValidationError(`${q} must not be smaller than ${G.minLength} bytes`)}:{success:!0,value:j}}function I(O,q,G,j){return c.CID.asCID(j)===null?{success:!1,error:new y.ValidationError(`${q} must be a CID`)}:{success:!0,value:j}}function L(O,q,G,j){return!j||typeof j!="object"?{success:!1,error:new y.ValidationError(`${q} must be an object`)}:{success:!0,value:j}}return $o}var CA;function r1(){if(CA)return Nu;CA=1,Object.defineProperty(Nu,"__esModule",{value:!0}),Nu.validate=f,Nu.array=y,Nu.object=e,Nu.validateOneOf=l;const i=vc(),n=e1(),a=q5(),c=tI();function f(w,R,C,I){switch(C.type){case"object":return e(w,R,C,I);case"array":return y(w,R,C,I);case"blob":return(0,a.blob)(w,R,C,I);default:return(0,c.validate)(w,R,C,I)}}function y(w,R,C,I){if(!Array.isArray(I))return{success:!1,error:new i.ValidationError(`${R} must be an array`)};if(typeof C.maxLength=="number"&&I.length>C.maxLength)return{success:!1,error:new i.ValidationError(`${R} must not have more than ${C.maxLength} elements`)};if(typeof C.minLength=="number"&&I.length<C.minLength)return{success:!1,error:new i.ValidationError(`${R} must not have fewer than ${C.minLength} elements`)};const L=C.items;for(let O=0;O<I.length;O++){const q=I[O],G=`${R}/${O}`,j=l(w,G,L,q);if(!j.success)return j}return{success:!0,value:I}}function e(w,R,C,I){if(!(0,i.isObj)(I))return{success:!1,error:new i.ValidationError(`${R} must be an object`)};let L=I;if("properties"in C&&C.properties!=null)for(const O in C.properties){const q=I[O];if(q===null&&C.nullable?.includes(O))continue;const G=C.properties[O];if(q===void 0&&!C.required?.includes(O))if(G.type==="integer"||G.type==="boolean"||G.type==="string"){if(G.default===void 0)continue}else continue;const j=`${R}/${O}`,ne=l(w,j,G,q),he=ne.success?ne.value:q;if(he===void 0){if(C.required?.includes(O))return{success:!1,error:new i.ValidationError(`${R} must have the property "${O}"`)}}else if(!ne.success)return ne;he!==q&&(L===I&&(L={...I}),L[O]=he)}return{success:!0,value:L}}function l(w,R,C,I,L=!1){let O;if(C.type==="union"){if(!(0,i.isDiscriminatedObject)(I))return{success:!1,error:new i.ValidationError(`${R} must be an object which includes the "$type" property`)};if(_(C.refs,I.$type))O=w.getDefOrThrow(I.$type);else return C.closed?{success:!1,error:new i.ValidationError(`${R} $type must be one of ${C.refs.join(", ")}`)}:{success:!0,value:I}}else C.type==="ref"?O=w.getDefOrThrow(C.ref):O=C;return L?e(w,R,O,I):f(w,R,O,I)}const _=(w,R)=>{const C=(0,n.toLexUri)(R);return w.includes(C)?!0:C.endsWith("#main")?w.includes(C.slice(0,-5)):!C.includes("#")&&w.includes(`${C}#main`)};return Nu}var Zo={},kA;function $5(){if(kA)return Zo;kA=1;var i=Zo&&Zo.__createBinding||(Object.create?(function(l,_,w,R){R===void 0&&(R=w);var C=Object.getOwnPropertyDescriptor(_,w);(!C||("get"in C?!_.__esModule:C.writable||C.configurable))&&(C={enumerable:!0,get:function(){return _[w]}}),Object.defineProperty(l,R,C)}):(function(l,_,w,R){R===void 0&&(R=w),l[R]=_[w]})),n=Zo&&Zo.__setModuleDefault||(Object.create?(function(l,_){Object.defineProperty(l,"default",{enumerable:!0,value:_})}):function(l,_){l.default=_}),a=Zo&&Zo.__importStar||(function(){var l=function(_){return l=Object.getOwnPropertyNames||function(w){var R=[];for(var C in w)Object.prototype.hasOwnProperty.call(w,C)&&(R[R.length]=C);return R},l(_)};return function(_){if(_&&_.__esModule)return _;var w={};if(_!=null)for(var R=l(_),C=0;C<R.length;C++)R[C]!=="default"&&i(w,_,R[C]);return n(w,_),w}})();Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.params=e;const c=vc(),f=r1(),y=a(tI());function e(l,_,w,R){const C=R&&typeof R=="object"?R:{},I=new Set(w.required??[]);let L=C;if(typeof w.properties=="object")for(const O in w.properties){const q=w.properties[O],G=q.type==="array"?(0,f.array)(l,O,q,C[O]):y.validate(l,O,q,C[O]),j=G.success?G.value:C[O],ne=typeof j>"u";if(ne&&I.has(O))return{success:!1,error:new c.ValidationError(`${_} must have the property "${O}"`)};if(!ne&&!G.success)return G;j!==C[O]&&(L===C&&(L={...C}),L[O]=j)}return{success:!0,value:L}}return Zo}var PA;function Z5(){if(PA)return xl;PA=1,Object.defineProperty(xl,"__esModule",{value:!0}),xl.assertValidRecord=a,xl.assertValidXrpcParams=c,xl.assertValidXrpcInput=f,xl.assertValidXrpcOutput=y,xl.assertValidXrpcMessage=e;const i=r1(),n=$5();function a(_,w,R){const C=(0,i.object)(_,"Record",w.record,R);if(!C.success)throw C.error;return C.value}function c(_,w,R){if(w.parameters){const C=(0,n.params)(_,"Params",w.parameters,R);if(!C.success)throw C.error;return C.value}}function f(_,w,R){if(w.input?.schema)return l(_,"Input",w.input.schema,R,!0)}function y(_,w,R){if(w.output?.schema)return l(_,"Output",w.output.schema,R,!0)}function e(_,w,R){if(w.message?.schema)return l(_,"Message",w.message.schema,R,!0)}function l(_,w,R,C,I=!1){const L=(0,i.validateOneOf)(_,w,R,C,I);if(!L.success)throw L.error;return L.value}return xl}var LA;function H5(){if(LA)return ph;LA=1,Object.defineProperty(ph,"__esModule",{value:!0}),ph.Lexicons=void 0;const i=vc(),n=e1(),a=Z5(),c=r1();class f{constructor(_){if(Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"defs",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),_)for(const w of _)this.add(w)}[Symbol.iterator](){return this.docs.values()}add(_){const w=(0,n.toLexUri)(_.id);if(this.docs.has(w))throw new Error(`${w} has already been registered`);e(_,w),this.docs.set(w,_);for(const[R,C]of y(_))this.defs.set(R,C)}remove(_){_=(0,n.toLexUri)(_);const w=this.docs.get(_);if(!w)throw new Error(`Unable to remove "${_}": does not exist`);for(const[R,C]of y(w))this.defs.delete(R);this.docs.delete(_)}get(_){return _=(0,n.toLexUri)(_),this.docs.get(_)}getDef(_){return _=(0,n.toLexUri)(_),this.defs.get(_)}getDefOrThrow(_,w){const R=this.getDef(_);if(!R)throw new i.LexiconDefNotFoundError(`Lexicon not found: ${_}`);if(w&&!w.includes(R.type))throw new i.InvalidLexiconError(`Not a ${w.join(" or ")} lexicon: ${_}`);return R}validate(_,w){if(!(0,i.isObj)(w))throw new i.ValidationError("Value must be an object");const R=(0,n.toLexUri)(_),C=this.getDefOrThrow(R,["record","object"]);if(C.type==="record")return(0,c.object)(this,"Record",C.record,w);if(C.type==="object")return(0,c.object)(this,"Object",C,w);throw new i.InvalidLexiconError("Definition must be a record or object")}assertValidRecord(_,w){if(!(0,i.isObj)(w))throw new i.ValidationError("Record must be an object");if(!("$type"in w))throw new i.ValidationError("Record/$type must be a string");const{$type:R}=w;if(typeof R!="string")throw new i.ValidationError("Record/$type must be a string");const C=(0,n.toLexUri)(_);if((0,n.toLexUri)(R)!==C)throw new i.ValidationError(`Invalid $type: must be ${C}, got ${R}`);const I=this.getDefOrThrow(C,["record"]);return(0,a.assertValidRecord)(this,I,w)}assertValidXrpcParams(_,w){_=(0,n.toLexUri)(_);const R=this.getDefOrThrow(_,["query","procedure","subscription"]);return(0,a.assertValidXrpcParams)(this,R,w)}assertValidXrpcInput(_,w){_=(0,n.toLexUri)(_);const R=this.getDefOrThrow(_,["procedure"]);return(0,a.assertValidXrpcInput)(this,R,w)}assertValidXrpcOutput(_,w){_=(0,n.toLexUri)(_);const R=this.getDefOrThrow(_,["query","procedure"]);return(0,a.assertValidXrpcOutput)(this,R,w)}assertValidXrpcMessage(_,w){_=(0,n.toLexUri)(_);const R=this.getDefOrThrow(_,["subscription"]);return(0,a.assertValidXrpcMessage)(this,R,w)}resolveLexUri(_,w){return _=(0,n.toLexUri)(_),(0,n.toLexUri)(w,_)}}ph.Lexicons=f;function*y(l){for(const _ in l.defs)yield[`lex:${l.id}#${_}`,l.defs[_]],_==="main"&&(yield[`lex:${l.id}`,l.defs[_]])}function e(l,_){for(const w in l)l.type==="ref"?l.ref=(0,n.toLexUri)(l.ref,_):l.type==="union"?l.refs=l.refs.map(R=>(0,n.toLexUri)(R,_)):Array.isArray(l[w])?l[w]=l[w].map(R=>typeof R=="string"?R.startsWith("#")?(0,n.toLexUri)(R,_):R:R&&typeof R=="object"?e(R,_):R):l[w]&&typeof l[w]=="object"&&(l[w]=e(l[w],_));return l}return ph}var G0={},DA;function X5(){return DA||(DA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.jsonStringToLex=i.jsonToLex=i.stringifyLex=i.lexToJson=i.ipldToLex=i.lexToIpld=void 0;const n=Zp,a=$a(),c=t1(),f=R=>{if(Array.isArray(R))return R.map(C=>(0,i.lexToIpld)(C));if(R&&typeof R=="object"){if(R instanceof c.BlobRef)return R.original;if(n.CID.asCID(R)||R instanceof Uint8Array)return R;const C={};for(const I of Object.keys(R))C[I]=(0,i.lexToIpld)(R[I]);return C}return R};i.lexToIpld=f;const y=R=>{if(Array.isArray(R))return R.map(C=>(0,i.ipldToLex)(C));if(R&&typeof R=="object"){if((R.$type==="blob"||typeof R.cid=="string"&&typeof R.mimeType=="string")&&a.check.is(R,c.jsonBlobRef))return c.BlobRef.fromJsonRef(R);if(n.CID.asCID(R)||R instanceof Uint8Array)return R;const C={};for(const I of Object.keys(R))C[I]=(0,i.ipldToLex)(R[I]);return C}return R};i.ipldToLex=y;const e=R=>(0,a.ipldToJson)((0,i.lexToIpld)(R));i.lexToJson=e;const l=R=>JSON.stringify((0,i.lexToJson)(R));i.stringifyLex=l;const _=R=>(0,i.ipldToLex)((0,a.jsonToIpld)(R));i.jsonToLex=_;const w=R=>(0,i.jsonToLex)(JSON.parse(R));i.jsonStringToLex=w})(G0)),G0}var IA;function Np(){return IA||(IA=1,(function(i){var n=zu&&zu.__createBinding||(Object.create?(function(c,f,y,e){e===void 0&&(e=y);var l=Object.getOwnPropertyDescriptor(f,y);(!l||("get"in l?!f.__esModule:l.writable||l.configurable))&&(l={enumerable:!0,get:function(){return f[y]}}),Object.defineProperty(c,e,l)}):(function(c,f,y,e){e===void 0&&(e=y),c[e]=f[y]})),a=zu&&zu.__exportStar||function(c,f){for(var y in c)y!=="default"&&!Object.prototype.hasOwnProperty.call(f,y)&&n(f,c,y)};Object.defineProperty(i,"__esModule",{value:!0}),a(vc(),i),a(H5(),i),a(t1(),i),a(X5(),i)})(zu)),zu}var $0={},Ld={},BA;function fe(){if(BA)return Ld;BA=1,Object.defineProperty(Ld,"__esModule",{value:!0}),Ld.is$typed=a,Ld.maybe$typed=c,Ld.asPredicate=f;function i(y){return y!=null&&typeof y=="object"}function n(y,e,l){return l==="main"?y===e:typeof y=="string"&&y.length===e.length+1+l.length&&y.charCodeAt(e.length)===35&&y.startsWith(e)&&y.endsWith(l)}function a(y,e,l){return i(y)&&"$type"in y&&n(y.$type,e,l)}function c(y,e,l){return i(y)&&("$type"in y?y.$type===void 0||n(y.$type,e,l):!0)}function f(y){return function(e){return y(e).success}}return Ld}var MA;function pe(){return MA||(MA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ids=i.lexicons=i.schemas=i.schemaDict=void 0,i.validate=c;const n=Np(),a=fe();i.schemaDict={AppBskyActorDefs:{lexicon:1,id:"app.bsky.actor.defs",defs:{profileViewBasic:{type:"object",required:["did","handle"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},displayName:{type:"string",maxGraphemes:64,maxLength:640},pronouns:{type:"string"},avatar:{type:"string",format:"uri"},associated:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociated"},viewer:{type:"ref",ref:"lex:app.bsky.actor.defs#viewerState"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},createdAt:{type:"string",format:"datetime"},verification:{type:"ref",ref:"lex:app.bsky.actor.defs#verificationState"},status:{type:"ref",ref:"lex:app.bsky.actor.defs#statusView"}}},profileView:{type:"object",required:["did","handle"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},displayName:{type:"string",maxGraphemes:64,maxLength:640},pronouns:{type:"string"},description:{type:"string",maxGraphemes:256,maxLength:2560},avatar:{type:"string",format:"uri"},associated:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociated"},indexedAt:{type:"string",format:"datetime"},createdAt:{type:"string",format:"datetime"},viewer:{type:"ref",ref:"lex:app.bsky.actor.defs#viewerState"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},verification:{type:"ref",ref:"lex:app.bsky.actor.defs#verificationState"},status:{type:"ref",ref:"lex:app.bsky.actor.defs#statusView"}}},profileViewDetailed:{type:"object",required:["did","handle"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},displayName:{type:"string",maxGraphemes:64,maxLength:640},description:{type:"string",maxGraphemes:256,maxLength:2560},pronouns:{type:"string"},website:{type:"string",format:"uri"},avatar:{type:"string",format:"uri"},banner:{type:"string",format:"uri"},followersCount:{type:"integer"},followsCount:{type:"integer"},postsCount:{type:"integer"},associated:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociated"},joinedViaStarterPack:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackViewBasic"},indexedAt:{type:"string",format:"datetime"},createdAt:{type:"string",format:"datetime"},viewer:{type:"ref",ref:"lex:app.bsky.actor.defs#viewerState"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},pinnedPost:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},verification:{type:"ref",ref:"lex:app.bsky.actor.defs#verificationState"},status:{type:"ref",ref:"lex:app.bsky.actor.defs#statusView"}}},profileAssociated:{type:"object",properties:{lists:{type:"integer"},feedgens:{type:"integer"},starterPacks:{type:"integer"},labeler:{type:"boolean"},chat:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociatedChat"},activitySubscription:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociatedActivitySubscription"}}},profileAssociatedChat:{type:"object",required:["allowIncoming"],properties:{allowIncoming:{type:"string",knownValues:["all","none","following"]}}},profileAssociatedActivitySubscription:{type:"object",required:["allowSubscriptions"],properties:{allowSubscriptions:{type:"string",knownValues:["followers","mutuals","none"]}}},viewerState:{type:"object",description:"Metadata about the requesting account's relationship with the subject account. Only has meaningful content for authed requests.",properties:{muted:{type:"boolean"},mutedByList:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewBasic"},blockedBy:{type:"boolean"},blocking:{type:"string",format:"at-uri"},blockingByList:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewBasic"},following:{type:"string",format:"at-uri"},followedBy:{type:"string",format:"at-uri"},knownFollowers:{description:"This property is present only in selected cases, as an optimization.",type:"ref",ref:"lex:app.bsky.actor.defs#knownFollowers"},activitySubscription:{description:"This property is present only in selected cases, as an optimization.",type:"ref",ref:"lex:app.bsky.notification.defs#activitySubscription"}}},knownFollowers:{type:"object",description:"The subject's followers whom you also follow",required:["count","followers"],properties:{count:{type:"integer"},followers:{type:"array",minLength:0,maxLength:5,items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"}}}},verificationState:{type:"object",description:"Represents the verification information about the user this object is attached to.",required:["verifications","verifiedStatus","trustedVerifierStatus"],properties:{verifications:{type:"array",description:"All verifications issued by trusted verifiers on behalf of this user. Verifications by untrusted verifiers are not included.",items:{type:"ref",ref:"lex:app.bsky.actor.defs#verificationView"}},verifiedStatus:{type:"string",description:"The user's status as a verified account.",knownValues:["valid","invalid","none"]},trustedVerifierStatus:{type:"string",description:"The user's status as a trusted verifier.",knownValues:["valid","invalid","none"]}}},verificationView:{type:"object",description:"An individual verification for an associated subject.",required:["issuer","uri","isValid","createdAt"],properties:{issuer:{type:"string",description:"The user who issued this verification.",format:"did"},uri:{type:"string",description:"The AT-URI of the verification record.",format:"at-uri"},isValid:{type:"boolean",description:"True if the verification passes validation, otherwise false."},createdAt:{type:"string",description:"Timestamp when the verification was created.",format:"datetime"}}},preferences:{type:"array",items:{type:"union",refs:["lex:app.bsky.actor.defs#adultContentPref","lex:app.bsky.actor.defs#contentLabelPref","lex:app.bsky.actor.defs#savedFeedsPref","lex:app.bsky.actor.defs#savedFeedsPrefV2","lex:app.bsky.actor.defs#personalDetailsPref","lex:app.bsky.actor.defs#feedViewPref","lex:app.bsky.actor.defs#threadViewPref","lex:app.bsky.actor.defs#interestsPref","lex:app.bsky.actor.defs#mutedWordsPref","lex:app.bsky.actor.defs#hiddenPostsPref","lex:app.bsky.actor.defs#bskyAppStatePref","lex:app.bsky.actor.defs#labelersPref","lex:app.bsky.actor.defs#postInteractionSettingsPref","lex:app.bsky.actor.defs#verificationPrefs"]}},adultContentPref:{type:"object",required:["enabled"],properties:{enabled:{type:"boolean",default:!1}}},contentLabelPref:{type:"object",required:["label","visibility"],properties:{labelerDid:{type:"string",description:"Which labeler does this preference apply to? If undefined, applies globally.",format:"did"},label:{type:"string"},visibility:{type:"string",knownValues:["ignore","show","warn","hide"]}}},savedFeed:{type:"object",required:["id","type","value","pinned"],properties:{id:{type:"string"},type:{type:"string",knownValues:["feed","list","timeline"]},value:{type:"string"},pinned:{type:"boolean"}}},savedFeedsPrefV2:{type:"object",required:["items"],properties:{items:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#savedFeed"}}}},savedFeedsPref:{type:"object",required:["pinned","saved"],properties:{pinned:{type:"array",items:{type:"string",format:"at-uri"}},saved:{type:"array",items:{type:"string",format:"at-uri"}},timelineIndex:{type:"integer"}}},personalDetailsPref:{type:"object",properties:{birthDate:{type:"string",format:"datetime",description:"The birth date of account owner."}}},feedViewPref:{type:"object",required:["feed"],properties:{feed:{type:"string",description:"The URI of the feed, or an identifier which describes the feed."},hideReplies:{type:"boolean",description:"Hide replies in the feed."},hideRepliesByUnfollowed:{type:"boolean",description:"Hide replies in the feed if they are not by followed users.",default:!0},hideRepliesByLikeCount:{type:"integer",description:"Hide replies in the feed if they do not have this number of likes."},hideReposts:{type:"boolean",description:"Hide reposts in the feed."},hideQuotePosts:{type:"boolean",description:"Hide quote posts in the feed."}}},threadViewPref:{type:"object",properties:{sort:{type:"string",description:"Sorting mode for threads.",knownValues:["oldest","newest","most-likes","random","hotness"]},prioritizeFollowedUsers:{type:"boolean",description:"Show followed users at the top of all replies."}}},interestsPref:{type:"object",required:["tags"],properties:{tags:{type:"array",maxLength:100,items:{type:"string",maxLength:640,maxGraphemes:64},description:"A list of tags which describe the account owner's interests gathered during onboarding."}}},mutedWordTarget:{type:"string",knownValues:["content","tag"],maxLength:640,maxGraphemes:64},mutedWord:{type:"object",description:"A word that the account owner has muted.",required:["value","targets"],properties:{id:{type:"string"},value:{type:"string",description:"The muted word itself.",maxLength:1e4,maxGraphemes:1e3},targets:{type:"array",description:"The intended targets of the muted word.",items:{type:"ref",ref:"lex:app.bsky.actor.defs#mutedWordTarget"}},actorTarget:{type:"string",description:"Groups of users to apply the muted word to. If undefined, applies to all users.",knownValues:["all","exclude-following"],default:"all"},expiresAt:{type:"string",format:"datetime",description:"The date and time at which the muted word will expire and no longer be applied."}}},mutedWordsPref:{type:"object",required:["items"],properties:{items:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#mutedWord"},description:"A list of words the account owner has muted."}}},hiddenPostsPref:{type:"object",required:["items"],properties:{items:{type:"array",items:{type:"string",format:"at-uri"},description:"A list of URIs of posts the account owner has hidden."}}},labelersPref:{type:"object",required:["labelers"],properties:{labelers:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#labelerPrefItem"}}}},labelerPrefItem:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},bskyAppStatePref:{description:"A grab bag of state that's specific to the bsky.app program. Third-party apps shouldn't use this.",type:"object",properties:{activeProgressGuide:{type:"ref",ref:"lex:app.bsky.actor.defs#bskyAppProgressGuide"},queuedNudges:{description:"An array of tokens which identify nudges (modals, popups, tours, highlight dots) that should be shown to the user.",type:"array",maxLength:1e3,items:{type:"string",maxLength:100}},nuxs:{description:"Storage for NUXs the user has encountered.",type:"array",maxLength:100,items:{type:"ref",ref:"lex:app.bsky.actor.defs#nux"}}}},bskyAppProgressGuide:{description:"If set, an active progress guide. Once completed, can be set to undefined. Should have unspecced fields tracking progress.",type:"object",required:["guide"],properties:{guide:{type:"string",maxLength:100}}},nux:{type:"object",description:"A new user experiences (NUX) storage object",required:["id","completed"],properties:{id:{type:"string",maxLength:100},completed:{type:"boolean",default:!1},data:{description:"Arbitrary data for the NUX. The structure is defined by the NUX itself. Limited to 300 characters.",type:"string",maxLength:3e3,maxGraphemes:300},expiresAt:{type:"string",format:"datetime",description:"The date and time at which the NUX will expire and should be considered completed."}}},verificationPrefs:{type:"object",description:"Preferences for how verified accounts appear in the app.",required:[],properties:{hideBadges:{description:"Hide the blue check badges for verified accounts and trusted verifiers.",type:"boolean",default:!1}}},postInteractionSettingsPref:{type:"object",description:"Default post interaction settings for the account. These values should be applied as default values when creating new posts. These refs should mirror the threadgate and postgate records exactly.",required:[],properties:{threadgateAllowRules:{description:"Matches threadgate record. List of rules defining who can reply to this users posts. If value is an empty array, no one can reply. If value is undefined, anyone can reply.",type:"array",maxLength:5,items:{type:"union",refs:["lex:app.bsky.feed.threadgate#mentionRule","lex:app.bsky.feed.threadgate#followerRule","lex:app.bsky.feed.threadgate#followingRule","lex:app.bsky.feed.threadgate#listRule"]}},postgateEmbeddingRules:{description:"Matches postgate record. List of rules defining who can embed this users posts. If value is an empty array or is undefined, no particular rules apply and anyone can embed.",type:"array",maxLength:5,items:{type:"union",refs:["lex:app.bsky.feed.postgate#disableRule"]}}}},statusView:{type:"object",required:["status","record"],properties:{status:{type:"string",description:"The status for the account.",knownValues:["app.bsky.actor.status#live"]},record:{type:"unknown"},embed:{type:"union",description:"An optional embed associated with the status.",refs:["lex:app.bsky.embed.external#view"]},expiresAt:{type:"string",description:"The date when this status will expire. The application might choose to no longer return the status after expiration.",format:"datetime"},isActive:{type:"boolean",description:"True if the status is not expired, false if it is expired. Only present if expiration was set."}}}}},AppBskyActorGetPreferences:{lexicon:1,id:"app.bsky.actor.getPreferences",defs:{main:{type:"query",description:"Get private preferences attached to the current account. Expected use is synchronization between multiple devices, and import/export during account migration. Requires auth.",parameters:{type:"params",properties:{}},output:{encoding:"application/json",schema:{type:"object",required:["preferences"],properties:{preferences:{type:"ref",ref:"lex:app.bsky.actor.defs#preferences"}}}}}}},AppBskyActorGetProfile:{lexicon:1,id:"app.bsky.actor.getProfile",defs:{main:{type:"query",description:"Get detailed profile view of an actor. Does not require auth, but contains relevant metadata with auth.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier",description:"Handle or DID of account to fetch profile of."}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewDetailed"}}}}},AppBskyActorGetProfiles:{lexicon:1,id:"app.bsky.actor.getProfiles",defs:{main:{type:"query",description:"Get detailed profile views of multiple actors.",parameters:{type:"params",required:["actors"],properties:{actors:{type:"array",items:{type:"string",format:"at-identifier"},maxLength:25}}},output:{encoding:"application/json",schema:{type:"object",required:["profiles"],properties:{profiles:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewDetailed"}}}}}}}},AppBskyActorGetSuggestions:{lexicon:1,id:"app.bsky.actor.getSuggestions",defs:{main:{type:"query",description:"Get a list of suggested actors. Expected use is discovery of accounts to follow during new account onboarding.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{cursor:{type:"string"},actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}},recId:{type:"integer",description:"Snowflake for this recommendation, use when submitting recommendation events."}}}}}}},AppBskyActorProfile:{lexicon:1,id:"app.bsky.actor.profile",defs:{main:{type:"record",description:"A declaration of a Bluesky account profile.",key:"literal:self",record:{type:"object",properties:{displayName:{type:"string",maxGraphemes:64,maxLength:640},description:{type:"string",description:"Free-form profile description text.",maxGraphemes:256,maxLength:2560},pronouns:{type:"string",description:"Free-form pronouns text.",maxGraphemes:20,maxLength:200},website:{type:"string",format:"uri"},avatar:{type:"blob",description:"Small image to be displayed next to posts from account. AKA, 'profile picture'",accept:["image/png","image/jpeg"],maxSize:1e6},banner:{type:"blob",description:"Larger horizontal image to display behind profile view.",accept:["image/png","image/jpeg"],maxSize:1e6},labels:{type:"union",description:"Self-label values, specific to the Bluesky application, on the overall account.",refs:["lex:com.atproto.label.defs#selfLabels"]},joinedViaStarterPack:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},pinnedPost:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyActorPutPreferences:{lexicon:1,id:"app.bsky.actor.putPreferences",defs:{main:{type:"procedure",description:"Set the private preferences attached to the account.",input:{encoding:"application/json",schema:{type:"object",required:["preferences"],properties:{preferences:{type:"ref",ref:"lex:app.bsky.actor.defs#preferences"}}}}}}},AppBskyActorSearchActors:{lexicon:1,id:"app.bsky.actor.searchActors",defs:{main:{type:"query",description:"Find actors (profiles) matching search criteria. Does not require auth.",parameters:{type:"params",properties:{term:{type:"string",description:"DEPRECATED: use 'q' instead."},q:{type:"string",description:"Search query string. Syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{cursor:{type:"string"},actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyActorSearchActorsTypeahead:{lexicon:1,id:"app.bsky.actor.searchActorsTypeahead",defs:{main:{type:"query",description:"Find actor suggestions for a prefix search term. Expected use is for auto-completion during text field entry. Does not require auth.",parameters:{type:"params",properties:{term:{type:"string",description:"DEPRECATED: use 'q' instead."},q:{type:"string",description:"Search query prefix; not a full query string."},limit:{type:"integer",minimum:1,maximum:100,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"}}}}}}}},AppBskyActorStatus:{lexicon:1,id:"app.bsky.actor.status",defs:{main:{type:"record",description:"A declaration of a Bluesky account status.",key:"literal:self",record:{type:"object",required:["status","createdAt"],properties:{status:{type:"string",description:"The status for the account.",knownValues:["app.bsky.actor.status#live"]},embed:{type:"union",description:"An optional embed associated with the status.",refs:["lex:app.bsky.embed.external"]},durationMinutes:{type:"integer",description:"The duration of the status in minutes. Applications can choose to impose minimum and maximum limits.",minimum:1},createdAt:{type:"string",format:"datetime"}}}},live:{type:"token",description:"Advertises an account as currently offering live content."}}},AppBskyBookmarkCreateBookmark:{lexicon:1,id:"app.bsky.bookmark.createBookmark",defs:{main:{type:"procedure",description:"Creates a private bookmark for the specified record. Currently, only `app.bsky.feed.post` records are supported. Requires authentication.",input:{encoding:"application/json",schema:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"}}}},errors:[{name:"UnsupportedCollection",description:"The URI to be bookmarked is for an unsupported collection."}]}}},AppBskyBookmarkDefs:{lexicon:1,id:"app.bsky.bookmark.defs",defs:{bookmark:{description:"Object used to store bookmark data in stash.",type:"object",required:["subject"],properties:{subject:{description:"A strong ref to the record to be bookmarked. Currently, only `app.bsky.feed.post` records are supported.",type:"ref",ref:"lex:com.atproto.repo.strongRef"}}},bookmarkView:{type:"object",required:["subject","item"],properties:{subject:{description:"A strong ref to the bookmarked record.",type:"ref",ref:"lex:com.atproto.repo.strongRef"},createdAt:{type:"string",format:"datetime"},item:{type:"union",refs:["lex:app.bsky.feed.defs#blockedPost","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#postView"]}}}}},AppBskyBookmarkDeleteBookmark:{lexicon:1,id:"app.bsky.bookmark.deleteBookmark",defs:{main:{type:"procedure",description:"Deletes a private bookmark for the specified record. Currently, only `app.bsky.feed.post` records are supported. Requires authentication.",input:{encoding:"application/json",schema:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}}},errors:[{name:"UnsupportedCollection",description:"The URI to be bookmarked is for an unsupported collection."}]}}},AppBskyBookmarkGetBookmarks:{lexicon:1,id:"app.bsky.bookmark.getBookmarks",defs:{main:{type:"query",description:"Gets views of records bookmarked by the authenticated user. Requires authentication.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["bookmarks"],properties:{cursor:{type:"string"},bookmarks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.bookmark.defs#bookmarkView"}}}}}}}},AppBskyEmbedDefs:{lexicon:1,id:"app.bsky.embed.defs",defs:{aspectRatio:{type:"object",description:"width:height represents an aspect ratio. It may be approximate, and may not correspond to absolute dimensions in any given unit.",required:["width","height"],properties:{width:{type:"integer",minimum:1},height:{type:"integer",minimum:1}}}}},AppBskyEmbedExternal:{lexicon:1,id:"app.bsky.embed.external",defs:{main:{type:"object",description:"A representation of some externally linked content (eg, a URL and 'card'), embedded in a Bluesky record (eg, a post).",required:["external"],properties:{external:{type:"ref",ref:"lex:app.bsky.embed.external#external"}}},external:{type:"object",required:["uri","title","description"],properties:{uri:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},thumb:{type:"blob",accept:["image/*"],maxSize:1e6}}},view:{type:"object",required:["external"],properties:{external:{type:"ref",ref:"lex:app.bsky.embed.external#viewExternal"}}},viewExternal:{type:"object",required:["uri","title","description"],properties:{uri:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},thumb:{type:"string",format:"uri"}}}}},AppBskyEmbedImages:{lexicon:1,id:"app.bsky.embed.images",description:"A set of images embedded in a Bluesky record (eg, a post).",defs:{main:{type:"object",required:["images"],properties:{images:{type:"array",items:{type:"ref",ref:"lex:app.bsky.embed.images#image"},maxLength:4}}},image:{type:"object",required:["image","alt"],properties:{image:{type:"blob",accept:["image/*"],maxSize:1e6},alt:{type:"string",description:"Alt text description of the image, for accessibility."},aspectRatio:{type:"ref",ref:"lex:app.bsky.embed.defs#aspectRatio"}}},view:{type:"object",required:["images"],properties:{images:{type:"array",items:{type:"ref",ref:"lex:app.bsky.embed.images#viewImage"},maxLength:4}}},viewImage:{type:"object",required:["thumb","fullsize","alt"],properties:{thumb:{type:"string",format:"uri",description:"Fully-qualified URL where a thumbnail of the image can be fetched. For example, CDN location provided by the App View."},fullsize:{type:"string",format:"uri",description:"Fully-qualified URL where a large version of the image can be fetched. May or may not be the exact original blob. For example, CDN location provided by the App View."},alt:{type:"string",description:"Alt text description of the image, for accessibility."},aspectRatio:{type:"ref",ref:"lex:app.bsky.embed.defs#aspectRatio"}}}}},AppBskyEmbedRecord:{lexicon:1,id:"app.bsky.embed.record",description:"A representation of a record embedded in a Bluesky record (eg, a post). For example, a quote-post, or sharing a feed generator record.",defs:{main:{type:"object",required:["record"],properties:{record:{type:"ref",ref:"lex:com.atproto.repo.strongRef"}}},view:{type:"object",required:["record"],properties:{record:{type:"union",refs:["lex:app.bsky.embed.record#viewRecord","lex:app.bsky.embed.record#viewNotFound","lex:app.bsky.embed.record#viewBlocked","lex:app.bsky.embed.record#viewDetached","lex:app.bsky.feed.defs#generatorView","lex:app.bsky.graph.defs#listView","lex:app.bsky.labeler.defs#labelerView","lex:app.bsky.graph.defs#starterPackViewBasic"]}}},viewRecord:{type:"object",required:["uri","cid","author","value","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},author:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"},value:{type:"unknown",description:"The record data itself."},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},replyCount:{type:"integer"},repostCount:{type:"integer"},likeCount:{type:"integer"},quoteCount:{type:"integer"},embeds:{type:"array",items:{type:"union",refs:["lex:app.bsky.embed.images#view","lex:app.bsky.embed.video#view","lex:app.bsky.embed.external#view","lex:app.bsky.embed.record#view","lex:app.bsky.embed.recordWithMedia#view"]}},indexedAt:{type:"string",format:"datetime"}}},viewNotFound:{type:"object",required:["uri","notFound"],properties:{uri:{type:"string",format:"at-uri"},notFound:{type:"boolean",const:!0}}},viewBlocked:{type:"object",required:["uri","blocked","author"],properties:{uri:{type:"string",format:"at-uri"},blocked:{type:"boolean",const:!0},author:{type:"ref",ref:"lex:app.bsky.feed.defs#blockedAuthor"}}},viewDetached:{type:"object",required:["uri","detached"],properties:{uri:{type:"string",format:"at-uri"},detached:{type:"boolean",const:!0}}}}},AppBskyEmbedRecordWithMedia:{lexicon:1,id:"app.bsky.embed.recordWithMedia",description:"A representation of a record embedded in a Bluesky record (eg, a post), alongside other compatible embeds. For example, a quote post and image, or a quote post and external URL card.",defs:{main:{type:"object",required:["record","media"],properties:{record:{type:"ref",ref:"lex:app.bsky.embed.record"},media:{type:"union",refs:["lex:app.bsky.embed.images","lex:app.bsky.embed.video","lex:app.bsky.embed.external"]}}},view:{type:"object",required:["record","media"],properties:{record:{type:"ref",ref:"lex:app.bsky.embed.record#view"},media:{type:"union",refs:["lex:app.bsky.embed.images#view","lex:app.bsky.embed.video#view","lex:app.bsky.embed.external#view"]}}}}},AppBskyEmbedVideo:{lexicon:1,id:"app.bsky.embed.video",description:"A video embedded in a Bluesky record (eg, a post).",defs:{main:{type:"object",required:["video"],properties:{video:{type:"blob",description:"The mp4 video file. May be up to 100mb, formerly limited to 50mb.",accept:["video/mp4"],maxSize:1e8},captions:{type:"array",items:{type:"ref",ref:"lex:app.bsky.embed.video#caption"},maxLength:20},alt:{type:"string",description:"Alt text description of the video, for accessibility.",maxGraphemes:1e3,maxLength:1e4},aspectRatio:{type:"ref",ref:"lex:app.bsky.embed.defs#aspectRatio"}}},caption:{type:"object",required:["lang","file"],properties:{lang:{type:"string",format:"language"},file:{type:"blob",accept:["text/vtt"],maxSize:2e4}}},view:{type:"object",required:["cid","playlist"],properties:{cid:{type:"string",format:"cid"},playlist:{type:"string",format:"uri"},thumbnail:{type:"string",format:"uri"},alt:{type:"string",maxGraphemes:1e3,maxLength:1e4},aspectRatio:{type:"ref",ref:"lex:app.bsky.embed.defs#aspectRatio"}}}}},AppBskyFeedDefs:{lexicon:1,id:"app.bsky.feed.defs",defs:{postView:{type:"object",required:["uri","cid","author","record","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},author:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"},record:{type:"unknown"},embed:{type:"union",refs:["lex:app.bsky.embed.images#view","lex:app.bsky.embed.video#view","lex:app.bsky.embed.external#view","lex:app.bsky.embed.record#view","lex:app.bsky.embed.recordWithMedia#view"]},bookmarkCount:{type:"integer"},replyCount:{type:"integer"},repostCount:{type:"integer"},likeCount:{type:"integer"},quoteCount:{type:"integer"},indexedAt:{type:"string",format:"datetime"},viewer:{type:"ref",ref:"lex:app.bsky.feed.defs#viewerState"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},threadgate:{type:"ref",ref:"lex:app.bsky.feed.defs#threadgateView"}}},viewerState:{type:"object",description:"Metadata about the requesting account's relationship with the subject content. Only has meaningful content for authed requests.",properties:{repost:{type:"string",format:"at-uri"},like:{type:"string",format:"at-uri"},bookmarked:{type:"boolean"},threadMuted:{type:"boolean"},replyDisabled:{type:"boolean"},embeddingDisabled:{type:"boolean"},pinned:{type:"boolean"}}},threadContext:{type:"object",description:"Metadata about this post within the context of the thread it is in.",properties:{rootAuthorLike:{type:"string",format:"at-uri"}}},feedViewPost:{type:"object",required:["post"],properties:{post:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"},reply:{type:"ref",ref:"lex:app.bsky.feed.defs#replyRef"},reason:{type:"union",refs:["lex:app.bsky.feed.defs#reasonRepost","lex:app.bsky.feed.defs#reasonPin"]},feedContext:{type:"string",description:"Context provided by feed generator that may be passed back alongside interactions.",maxLength:2e3},reqId:{type:"string",description:"Unique identifier per request that may be passed back alongside interactions.",maxLength:100}}},replyRef:{type:"object",required:["root","parent"],properties:{root:{type:"union",refs:["lex:app.bsky.feed.defs#postView","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#blockedPost"]},parent:{type:"union",refs:["lex:app.bsky.feed.defs#postView","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#blockedPost"]},grandparentAuthor:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic",description:"When parent is a reply to another post, this is the author of that post."}}},reasonRepost:{type:"object",required:["by","indexedAt"],properties:{by:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"},uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},indexedAt:{type:"string",format:"datetime"}}},reasonPin:{type:"object",properties:{}},threadViewPost:{type:"object",required:["post"],properties:{post:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"},parent:{type:"union",refs:["lex:app.bsky.feed.defs#threadViewPost","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#blockedPost"]},replies:{type:"array",items:{type:"union",refs:["lex:app.bsky.feed.defs#threadViewPost","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#blockedPost"]}},threadContext:{type:"ref",ref:"lex:app.bsky.feed.defs#threadContext"}}},notFoundPost:{type:"object",required:["uri","notFound"],properties:{uri:{type:"string",format:"at-uri"},notFound:{type:"boolean",const:!0}}},blockedPost:{type:"object",required:["uri","blocked","author"],properties:{uri:{type:"string",format:"at-uri"},blocked:{type:"boolean",const:!0},author:{type:"ref",ref:"lex:app.bsky.feed.defs#blockedAuthor"}}},blockedAuthor:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"},viewer:{type:"ref",ref:"lex:app.bsky.actor.defs#viewerState"}}},generatorView:{type:"object",required:["uri","cid","did","creator","displayName","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},did:{type:"string",format:"did"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},displayName:{type:"string"},description:{type:"string",maxGraphemes:300,maxLength:3e3},descriptionFacets:{type:"array",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},avatar:{type:"string",format:"uri"},likeCount:{type:"integer",minimum:0},acceptsInteractions:{type:"boolean"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},viewer:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorViewerState"},contentMode:{type:"string",knownValues:["app.bsky.feed.defs#contentModeUnspecified","app.bsky.feed.defs#contentModeVideo"]},indexedAt:{type:"string",format:"datetime"}}},generatorViewerState:{type:"object",properties:{like:{type:"string",format:"at-uri"}}},skeletonFeedPost:{type:"object",required:["post"],properties:{post:{type:"string",format:"at-uri"},reason:{type:"union",refs:["lex:app.bsky.feed.defs#skeletonReasonRepost","lex:app.bsky.feed.defs#skeletonReasonPin"]},feedContext:{type:"string",description:"Context that will be passed through to client and may be passed to feed generator back alongside interactions.",maxLength:2e3}}},skeletonReasonRepost:{type:"object",required:["repost"],properties:{repost:{type:"string",format:"at-uri"}}},skeletonReasonPin:{type:"object",properties:{}},threadgateView:{type:"object",properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},record:{type:"unknown"},lists:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewBasic"}}}},interaction:{type:"object",properties:{item:{type:"string",format:"at-uri"},event:{type:"string",knownValues:["app.bsky.feed.defs#requestLess","app.bsky.feed.defs#requestMore","app.bsky.feed.defs#clickthroughItem","app.bsky.feed.defs#clickthroughAuthor","app.bsky.feed.defs#clickthroughReposter","app.bsky.feed.defs#clickthroughEmbed","app.bsky.feed.defs#interactionSeen","app.bsky.feed.defs#interactionLike","app.bsky.feed.defs#interactionRepost","app.bsky.feed.defs#interactionReply","app.bsky.feed.defs#interactionQuote","app.bsky.feed.defs#interactionShare"]},feedContext:{type:"string",description:"Context on a feed item that was originally supplied by the feed generator on getFeedSkeleton.",maxLength:2e3},reqId:{type:"string",description:"Unique identifier per request that may be passed back alongside interactions.",maxLength:100}}},requestLess:{type:"token",description:"Request that less content like the given feed item be shown in the feed"},requestMore:{type:"token",description:"Request that more content like the given feed item be shown in the feed"},clickthroughItem:{type:"token",description:"User clicked through to the feed item"},clickthroughAuthor:{type:"token",description:"User clicked through to the author of the feed item"},clickthroughReposter:{type:"token",description:"User clicked through to the reposter of the feed item"},clickthroughEmbed:{type:"token",description:"User clicked through to the embedded content of the feed item"},contentModeUnspecified:{type:"token",description:"Declares the feed generator returns any types of posts."},contentModeVideo:{type:"token",description:"Declares the feed generator returns posts containing app.bsky.embed.video embeds."},interactionSeen:{type:"token",description:"Feed item was seen by user"},interactionLike:{type:"token",description:"User liked the feed item"},interactionRepost:{type:"token",description:"User reposted the feed item"},interactionReply:{type:"token",description:"User replied to the feed item"},interactionQuote:{type:"token",description:"User quoted the feed item"},interactionShare:{type:"token",description:"User shared the feed item"}}},AppBskyFeedDescribeFeedGenerator:{lexicon:1,id:"app.bsky.feed.describeFeedGenerator",defs:{main:{type:"query",description:"Get information about a feed generator, including policies and offered feed URIs. Does not require auth; implemented by Feed Generator services (not App View).",output:{encoding:"application/json",schema:{type:"object",required:["did","feeds"],properties:{did:{type:"string",format:"did"},feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.describeFeedGenerator#feed"}},links:{type:"ref",ref:"lex:app.bsky.feed.describeFeedGenerator#links"}}}}},feed:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}},links:{type:"object",properties:{privacyPolicy:{type:"string"},termsOfService:{type:"string"}}}}},AppBskyFeedGenerator:{lexicon:1,id:"app.bsky.feed.generator",defs:{main:{type:"record",description:"Record declaring of the existence of a feed generator, and containing metadata about it. The record can exist in any repository.",key:"any",record:{type:"object",required:["did","displayName","createdAt"],properties:{did:{type:"string",format:"did"},displayName:{type:"string",maxGraphemes:24,maxLength:240},description:{type:"string",maxGraphemes:300,maxLength:3e3},descriptionFacets:{type:"array",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},avatar:{type:"blob",accept:["image/png","image/jpeg"],maxSize:1e6},acceptsInteractions:{type:"boolean",description:"Declaration that a feed accepts feedback interactions from a client through app.bsky.feed.sendInteractions"},labels:{type:"union",description:"Self-label values",refs:["lex:com.atproto.label.defs#selfLabels"]},contentMode:{type:"string",knownValues:["app.bsky.feed.defs#contentModeUnspecified","app.bsky.feed.defs#contentModeVideo"]},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyFeedGetActorFeeds:{lexicon:1,id:"app.bsky.feed.getActorFeeds",defs:{main:{type:"query",description:"Get a list of feeds (feed generator records) created by the actor (in the actor's repo).",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{cursor:{type:"string"},feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}}}}}}}},AppBskyFeedGetActorLikes:{lexicon:1,id:"app.bsky.feed.getActorLikes",defs:{main:{type:"query",description:"Get a list of posts liked by an actor. Requires auth, actor must be the requesting account.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#feedViewPost"}}}}},errors:[{name:"BlockedActor"},{name:"BlockedByActor"}]}}},AppBskyFeedGetAuthorFeed:{lexicon:1,id:"app.bsky.feed.getAuthorFeed",defs:{main:{type:"query",description:"Get a view of an actor's 'author feed' (post and reposts by the author). Does not require auth.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},filter:{type:"string",description:"Combinations of post/repost types to include in response.",knownValues:["posts_with_replies","posts_no_replies","posts_with_media","posts_and_author_threads","posts_with_video"],default:"posts_with_replies"},includePins:{type:"boolean",default:!1}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#feedViewPost"}}}}},errors:[{name:"BlockedActor"},{name:"BlockedByActor"}]}}},AppBskyFeedGetFeed:{lexicon:1,id:"app.bsky.feed.getFeed",defs:{main:{type:"query",description:"Get a hydrated feed from an actor's selected feed generator. Implemented by App View.",parameters:{type:"params",required:["feed"],properties:{feed:{type:"string",format:"at-uri"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#feedViewPost"}}}}},errors:[{name:"UnknownFeed"}]}}},AppBskyFeedGetFeedGenerator:{lexicon:1,id:"app.bsky.feed.getFeedGenerator",defs:{main:{type:"query",description:"Get information about a feed generator. Implemented by AppView.",parameters:{type:"params",required:["feed"],properties:{feed:{type:"string",format:"at-uri",description:"AT-URI of the feed generator record."}}},output:{encoding:"application/json",schema:{type:"object",required:["view","isOnline","isValid"],properties:{view:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"},isOnline:{type:"boolean",description:"Indicates whether the feed generator service has been online recently, or else seems to be inactive."},isValid:{type:"boolean",description:"Indicates whether the feed generator service is compatible with the record declaration."}}}}}}},AppBskyFeedGetFeedGenerators:{lexicon:1,id:"app.bsky.feed.getFeedGenerators",defs:{main:{type:"query",description:"Get information about a list of feed generators.",parameters:{type:"params",required:["feeds"],properties:{feeds:{type:"array",items:{type:"string",format:"at-uri"}}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}}}}}}}},AppBskyFeedGetFeedSkeleton:{lexicon:1,id:"app.bsky.feed.getFeedSkeleton",defs:{main:{type:"query",description:"Get a skeleton of a feed provided by a feed generator. Auth is optional, depending on provider requirements, and provides the DID of the requester. Implemented by Feed Generator Service.",parameters:{type:"params",required:["feed"],properties:{feed:{type:"string",format:"at-uri",description:"Reference to feed generator record describing the specific feed being requested."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#skeletonFeedPost"}},reqId:{type:"string",description:"Unique identifier per request that may be passed back alongside interactions.",maxLength:100}}}},errors:[{name:"UnknownFeed"}]}}},AppBskyFeedGetLikes:{lexicon:1,id:"app.bsky.feed.getLikes",defs:{main:{type:"query",description:"Get like records which reference a subject (by AT-URI and CID).",parameters:{type:"params",required:["uri"],properties:{uri:{type:"string",format:"at-uri",description:"AT-URI of the subject (eg, a post record)."},cid:{type:"string",format:"cid",description:"CID of the subject record (aka, specific version of record), to filter likes."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","likes"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},cursor:{type:"string"},likes:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.getLikes#like"}}}}}},like:{type:"object",required:["indexedAt","createdAt","actor"],properties:{indexedAt:{type:"string",format:"datetime"},createdAt:{type:"string",format:"datetime"},actor:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}},AppBskyFeedGetListFeed:{lexicon:1,id:"app.bsky.feed.getListFeed",defs:{main:{type:"query",description:"Get a feed of recent posts from a list (posts and reposts from any actors on the list). Does not require auth.",parameters:{type:"params",required:["list"],properties:{list:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the list record."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#feedViewPost"}}}}},errors:[{name:"UnknownList"}]}}},AppBskyFeedGetPostThread:{lexicon:1,id:"app.bsky.feed.getPostThread",defs:{main:{type:"query",description:"Get posts in a thread. Does not require auth, but additional metadata and filtering will be applied for authed requests.",parameters:{type:"params",required:["uri"],properties:{uri:{type:"string",format:"at-uri",description:"Reference (AT-URI) to post record."},depth:{type:"integer",description:"How many levels of reply depth should be included in response.",default:6,minimum:0,maximum:1e3},parentHeight:{type:"integer",description:"How many levels of parent (and grandparent, etc) post to include.",default:80,minimum:0,maximum:1e3}}},output:{encoding:"application/json",schema:{type:"object",required:["thread"],properties:{thread:{type:"union",refs:["lex:app.bsky.feed.defs#threadViewPost","lex:app.bsky.feed.defs#notFoundPost","lex:app.bsky.feed.defs#blockedPost"]},threadgate:{type:"ref",ref:"lex:app.bsky.feed.defs#threadgateView"}}}},errors:[{name:"NotFound"}]}}},AppBskyFeedGetPosts:{lexicon:1,id:"app.bsky.feed.getPosts",defs:{main:{type:"query",description:"Gets post views for a specified list of posts (by AT-URI). This is sometimes referred to as 'hydrating' a 'feed skeleton'.",parameters:{type:"params",required:["uris"],properties:{uris:{type:"array",description:"List of post AT-URIs to return hydrated views for.",items:{type:"string",format:"at-uri"},maxLength:25}}},output:{encoding:"application/json",schema:{type:"object",required:["posts"],properties:{posts:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"}}}}}}}},AppBskyFeedGetQuotes:{lexicon:1,id:"app.bsky.feed.getQuotes",defs:{main:{type:"query",description:"Get a list of quotes for a given post.",parameters:{type:"params",required:["uri"],properties:{uri:{type:"string",format:"at-uri",description:"Reference (AT-URI) of post record"},cid:{type:"string",format:"cid",description:"If supplied, filters to quotes of specific version (by CID) of the post record."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","posts"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},cursor:{type:"string"},posts:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"}}}}}}}},AppBskyFeedGetRepostedBy:{lexicon:1,id:"app.bsky.feed.getRepostedBy",defs:{main:{type:"query",description:"Get a list of reposts for a given post.",parameters:{type:"params",required:["uri"],properties:{uri:{type:"string",format:"at-uri",description:"Reference (AT-URI) of post record"},cid:{type:"string",format:"cid",description:"If supplied, filters to reposts of specific version (by CID) of the post record."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","repostedBy"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},cursor:{type:"string"},repostedBy:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyFeedGetSuggestedFeeds:{lexicon:1,id:"app.bsky.feed.getSuggestedFeeds",defs:{main:{type:"query",description:"Get a list of suggested feeds (feed generators) for the requesting account.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{cursor:{type:"string"},feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}}}}}}}},AppBskyFeedGetTimeline:{lexicon:1,id:"app.bsky.feed.getTimeline",defs:{main:{type:"query",description:"Get a view of the requesting account's home timeline. This is expected to be some form of reverse-chronological feed.",parameters:{type:"params",properties:{algorithm:{type:"string",description:"Variant 'algorithm' for timeline. Implementation-specific. NOTE: most feed flexibility has been moved to feed generator mechanism."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feed"],properties:{cursor:{type:"string"},feed:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#feedViewPost"}}}}}}}},AppBskyFeedLike:{lexicon:1,id:"app.bsky.feed.like",defs:{main:{type:"record",description:"Record declaring a 'like' of a piece of subject content.",key:"tid",record:{type:"object",required:["subject","createdAt"],properties:{subject:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},createdAt:{type:"string",format:"datetime"},via:{type:"ref",ref:"lex:com.atproto.repo.strongRef"}}}}}},AppBskyFeedPost:{lexicon:1,id:"app.bsky.feed.post",defs:{main:{type:"record",description:"Record containing a Bluesky post.",key:"tid",record:{type:"object",required:["text","createdAt"],properties:{text:{type:"string",maxLength:3e3,maxGraphemes:300,description:"The primary post content. May be an empty string, if there are embeds."},entities:{type:"array",description:"DEPRECATED: replaced by app.bsky.richtext.facet.",items:{type:"ref",ref:"lex:app.bsky.feed.post#entity"}},facets:{type:"array",description:"Annotations of text (mentions, URLs, hashtags, etc)",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},reply:{type:"ref",ref:"lex:app.bsky.feed.post#replyRef"},embed:{type:"union",refs:["lex:app.bsky.embed.images","lex:app.bsky.embed.video","lex:app.bsky.embed.external","lex:app.bsky.embed.record","lex:app.bsky.embed.recordWithMedia"]},langs:{type:"array",description:"Indicates human language of post primary text content.",maxLength:3,items:{type:"string",format:"language"}},labels:{type:"union",description:"Self-label values for this post. Effectively content warnings.",refs:["lex:com.atproto.label.defs#selfLabels"]},tags:{type:"array",description:"Additional hashtags, in addition to any included in post text and facets.",maxLength:8,items:{type:"string",maxLength:640,maxGraphemes:64}},createdAt:{type:"string",format:"datetime",description:"Client-declared timestamp when this post was originally created."}}}},replyRef:{type:"object",required:["root","parent"],properties:{root:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},parent:{type:"ref",ref:"lex:com.atproto.repo.strongRef"}}},entity:{type:"object",description:"Deprecated: use facets instead.",required:["index","type","value"],properties:{index:{type:"ref",ref:"lex:app.bsky.feed.post#textSlice"},type:{type:"string",description:"Expected values are 'mention' and 'link'."},value:{type:"string"}}},textSlice:{type:"object",description:"Deprecated. Use app.bsky.richtext instead -- A text segment. Start is inclusive, end is exclusive. Indices are for utf16-encoded strings.",required:["start","end"],properties:{start:{type:"integer",minimum:0},end:{type:"integer",minimum:0}}}}},AppBskyFeedPostgate:{lexicon:1,id:"app.bsky.feed.postgate",defs:{main:{type:"record",key:"tid",description:"Record defining interaction rules for a post. The record key (rkey) of the postgate record must match the record key of the post, and that record must be in the same repository.",record:{type:"object",required:["post","createdAt"],properties:{createdAt:{type:"string",format:"datetime"},post:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the post record."},detachedEmbeddingUris:{type:"array",maxLength:50,items:{type:"string",format:"at-uri"},description:"List of AT-URIs embedding this post that the author has detached from."},embeddingRules:{description:"List of rules defining who can embed this post. If value is an empty array or is undefined, no particular rules apply and anyone can embed.",type:"array",maxLength:5,items:{type:"union",refs:["lex:app.bsky.feed.postgate#disableRule"]}}}}},disableRule:{type:"object",description:"Disables embedding of this post.",properties:{}}}},AppBskyFeedRepost:{lexicon:1,id:"app.bsky.feed.repost",defs:{main:{description:"Record representing a 'repost' of an existing Bluesky post.",type:"record",key:"tid",record:{type:"object",required:["subject","createdAt"],properties:{subject:{type:"ref",ref:"lex:com.atproto.repo.strongRef"},createdAt:{type:"string",format:"datetime"},via:{type:"ref",ref:"lex:com.atproto.repo.strongRef"}}}}}},AppBskyFeedSearchPosts:{lexicon:1,id:"app.bsky.feed.searchPosts",defs:{main:{type:"query",description:"Find posts matching search criteria, returning views of those posts. Note that this API endpoint may require authentication (eg, not public) for some service providers and implementations.",parameters:{type:"params",required:["q"],properties:{q:{type:"string",description:"Search query string; syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended."},sort:{type:"string",knownValues:["top","latest"],default:"latest",description:"Specifies the ranking order of results."},since:{type:"string",description:"Filter results for posts after the indicated datetime (inclusive). Expected to use 'sortAt' timestamp, which may not match 'createdAt'. Can be a datetime, or just an ISO date (YYYY-MM-DD)."},until:{type:"string",description:"Filter results for posts before the indicated datetime (not inclusive). Expected to use 'sortAt' timestamp, which may not match 'createdAt'. Can be a datetime, or just an ISO date (YYY-MM-DD)."},mentions:{type:"string",format:"at-identifier",description:"Filter to posts which mention the given account. Handles are resolved to DID before query-time. Only matches rich-text facet mentions."},author:{type:"string",format:"at-identifier",description:"Filter to posts by the given account. Handles are resolved to DID before query-time."},lang:{type:"string",format:"language",description:"Filter to posts in the given language. Expected to be based on post language field, though server may override language detection."},domain:{type:"string",description:"Filter to posts with URLs (facet links or embeds) linking to the given domain (hostname). Server may apply hostname normalization."},url:{type:"string",format:"uri",description:"Filter to posts with links (facet links or embeds) pointing to this URL. Server may apply URL normalization or fuzzy matching."},tag:{type:"array",items:{type:"string",maxLength:640,maxGraphemes:64},description:"Filter to posts with the given tag (hashtag), based on rich-text facet or tag field. Do not include the hash (#) prefix. Multiple tags can be specified, with 'AND' matching."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string",description:"Optional pagination mechanism; may not necessarily allow scrolling through entire result set."}}},output:{encoding:"application/json",schema:{type:"object",required:["posts"],properties:{cursor:{type:"string"},hitsTotal:{type:"integer",description:"Count of search hits. Optional, may be rounded/truncated, and may not be possible to paginate through all hits."},posts:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"}}}}},errors:[{name:"BadQueryString"}]}}},AppBskyFeedSendInteractions:{lexicon:1,id:"app.bsky.feed.sendInteractions",defs:{main:{type:"procedure",description:"Send information about interactions with feed items back to the feed generator that served them.",input:{encoding:"application/json",schema:{type:"object",required:["interactions"],properties:{interactions:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#interaction"}}}}},output:{encoding:"application/json",schema:{type:"object",properties:{}}}}}},AppBskyFeedThreadgate:{lexicon:1,id:"app.bsky.feed.threadgate",defs:{main:{type:"record",key:"tid",description:"Record defining interaction gating rules for a thread (aka, reply controls). The record key (rkey) of the threadgate record must match the record key of the thread's root post, and that record must be in the same repository.",record:{type:"object",required:["post","createdAt"],properties:{post:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the post record."},allow:{description:"List of rules defining who can reply to this post. If value is an empty array, no one can reply. If value is undefined, anyone can reply.",type:"array",maxLength:5,items:{type:"union",refs:["lex:app.bsky.feed.threadgate#mentionRule","lex:app.bsky.feed.threadgate#followerRule","lex:app.bsky.feed.threadgate#followingRule","lex:app.bsky.feed.threadgate#listRule"]}},createdAt:{type:"string",format:"datetime"},hiddenReplies:{type:"array",maxLength:300,items:{type:"string",format:"at-uri"},description:"List of hidden reply URIs."}}}},mentionRule:{type:"object",description:"Allow replies from actors mentioned in your post.",properties:{}},followerRule:{type:"object",description:"Allow replies from actors who follow you.",properties:{}},followingRule:{type:"object",description:"Allow replies from actors you follow.",properties:{}},listRule:{type:"object",description:"Allow replies from actors on a list.",required:["list"],properties:{list:{type:"string",format:"at-uri"}}}}},AppBskyGraphBlock:{lexicon:1,id:"app.bsky.graph.block",defs:{main:{type:"record",description:"Record declaring a 'block' relationship against another account. NOTE: blocks are public in Bluesky; see blog posts for details.",key:"tid",record:{type:"object",required:["subject","createdAt"],properties:{subject:{type:"string",format:"did",description:"DID of the account to be blocked."},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyGraphDefs:{lexicon:1,id:"app.bsky.graph.defs",defs:{listViewBasic:{type:"object",required:["uri","cid","name","purpose"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},name:{type:"string",maxLength:64,minLength:1},purpose:{type:"ref",ref:"lex:app.bsky.graph.defs#listPurpose"},avatar:{type:"string",format:"uri"},listItemCount:{type:"integer",minimum:0},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},viewer:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewerState"},indexedAt:{type:"string",format:"datetime"}}},listView:{type:"object",required:["uri","cid","creator","name","purpose","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},name:{type:"string",maxLength:64,minLength:1},purpose:{type:"ref",ref:"lex:app.bsky.graph.defs#listPurpose"},description:{type:"string",maxGraphemes:300,maxLength:3e3},descriptionFacets:{type:"array",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},avatar:{type:"string",format:"uri"},listItemCount:{type:"integer",minimum:0},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},viewer:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewerState"},indexedAt:{type:"string",format:"datetime"}}},listItemView:{type:"object",required:["uri","subject"],properties:{uri:{type:"string",format:"at-uri"},subject:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}},starterPackView:{type:"object",required:["uri","cid","record","creator","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},record:{type:"unknown"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"},list:{type:"ref",ref:"lex:app.bsky.graph.defs#listViewBasic"},listItemsSample:{type:"array",maxLength:12,items:{type:"ref",ref:"lex:app.bsky.graph.defs#listItemView"}},feeds:{type:"array",maxLength:3,items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}},joinedWeekCount:{type:"integer",minimum:0},joinedAllTimeCount:{type:"integer",minimum:0},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},indexedAt:{type:"string",format:"datetime"}}},starterPackViewBasic:{type:"object",required:["uri","cid","record","creator","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},record:{type:"unknown"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"},listItemCount:{type:"integer",minimum:0},joinedWeekCount:{type:"integer",minimum:0},joinedAllTimeCount:{type:"integer",minimum:0},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},indexedAt:{type:"string",format:"datetime"}}},listPurpose:{type:"string",knownValues:["app.bsky.graph.defs#modlist","app.bsky.graph.defs#curatelist","app.bsky.graph.defs#referencelist"]},modlist:{type:"token",description:"A list of actors to apply an aggregate moderation action (mute/block) on."},curatelist:{type:"token",description:"A list of actors used for curation purposes such as list feeds or interaction gating."},referencelist:{type:"token",description:"A list of actors used for only for reference purposes such as within a starter pack."},listViewerState:{type:"object",properties:{muted:{type:"boolean"},blocked:{type:"string",format:"at-uri"}}},notFoundActor:{type:"object",description:"indicates that a handle or DID could not be resolved",required:["actor","notFound"],properties:{actor:{type:"string",format:"at-identifier"},notFound:{type:"boolean",const:!0}}},relationship:{type:"object",description:"lists the bi-directional graph relationships between one actor (not indicated in the object), and the target actors (the DID included in the object)",required:["did"],properties:{did:{type:"string",format:"did"},following:{type:"string",format:"at-uri",description:"if the actor follows this DID, this is the AT-URI of the follow record"},followedBy:{type:"string",format:"at-uri",description:"if the actor is followed by this DID, contains the AT-URI of the follow record"}}}}},AppBskyGraphFollow:{lexicon:1,id:"app.bsky.graph.follow",defs:{main:{type:"record",description:"Record declaring a social 'follow' relationship of another account. Duplicate follows will be ignored by the AppView.",key:"tid",record:{type:"object",required:["subject","createdAt"],properties:{subject:{type:"string",format:"did"},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyGraphGetActorStarterPacks:{lexicon:1,id:"app.bsky.graph.getActorStarterPacks",defs:{main:{type:"query",description:"Get a list of starter packs created by the actor.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{cursor:{type:"string"},starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackViewBasic"}}}}}}}},AppBskyGraphGetBlocks:{lexicon:1,id:"app.bsky.graph.getBlocks",defs:{main:{type:"query",description:"Enumerates which accounts the requesting account is currently blocking. Requires auth.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["blocks"],properties:{cursor:{type:"string"},blocks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyGraphGetFollowers:{lexicon:1,id:"app.bsky.graph.getFollowers",defs:{main:{type:"query",description:"Enumerates accounts which follow a specified account (actor).",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["subject","followers"],properties:{subject:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},cursor:{type:"string"},followers:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyGraphGetFollows:{lexicon:1,id:"app.bsky.graph.getFollows",defs:{main:{type:"query",description:"Enumerates accounts which a specified account (actor) follows.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["subject","follows"],properties:{subject:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},cursor:{type:"string"},follows:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyGraphGetKnownFollowers:{lexicon:1,id:"app.bsky.graph.getKnownFollowers",defs:{main:{type:"query",description:"Enumerates accounts which follow a specified account (actor) and are followed by the viewer.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["subject","followers"],properties:{subject:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},cursor:{type:"string"},followers:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyGraphGetList:{lexicon:1,id:"app.bsky.graph.getList",defs:{main:{type:"query",description:"Gets a 'view' (with additional context) of a specified list.",parameters:{type:"params",required:["list"],properties:{list:{type:"string",format:"at-uri",description:"Reference (AT-URI) of the list record to hydrate."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["list","items"],properties:{cursor:{type:"string"},list:{type:"ref",ref:"lex:app.bsky.graph.defs#listView"},items:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#listItemView"}}}}}}}},AppBskyGraphGetListBlocks:{lexicon:1,id:"app.bsky.graph.getListBlocks",defs:{main:{type:"query",description:"Get mod lists that the requesting account (actor) is blocking. Requires auth.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["lists"],properties:{cursor:{type:"string"},lists:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#listView"}}}}}}}},AppBskyGraphGetListMutes:{lexicon:1,id:"app.bsky.graph.getListMutes",defs:{main:{type:"query",description:"Enumerates mod lists that the requesting account (actor) currently has muted. Requires auth.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["lists"],properties:{cursor:{type:"string"},lists:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#listView"}}}}}}}},AppBskyGraphGetLists:{lexicon:1,id:"app.bsky.graph.getLists",defs:{main:{type:"query",description:"Enumerates the lists created by a specified account (actor).",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier",description:"The account (actor) to enumerate lists from."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},purposes:{type:"array",description:"Optional filter by list purpose. If not specified, all supported types are returned.",items:{type:"string",knownValues:["modlist","curatelist"]}}}},output:{encoding:"application/json",schema:{type:"object",required:["lists"],properties:{cursor:{type:"string"},lists:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#listView"}}}}}}}},AppBskyGraphGetListsWithMembership:{lexicon:1,id:"app.bsky.graph.getListsWithMembership",defs:{main:{type:"query",description:"Enumerates the lists created by the session user, and includes membership information about `actor` in those lists. Only supports curation and moderation lists (no reference lists, used in starter packs). Requires auth.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier",description:"The account (actor) to check for membership."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},purposes:{type:"array",description:"Optional filter by list purpose. If not specified, all supported types are returned.",items:{type:"string",knownValues:["modlist","curatelist"]}}}},output:{encoding:"application/json",schema:{type:"object",required:["listsWithMembership"],properties:{cursor:{type:"string"},listsWithMembership:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.getListsWithMembership#listWithMembership"}}}}}},listWithMembership:{description:"A list and an optional list item indicating membership of a target user to that list.",type:"object",required:["list"],properties:{list:{type:"ref",ref:"lex:app.bsky.graph.defs#listView"},listItem:{type:"ref",ref:"lex:app.bsky.graph.defs#listItemView"}}}}},AppBskyGraphGetMutes:{lexicon:1,id:"app.bsky.graph.getMutes",defs:{main:{type:"query",description:"Enumerates accounts that the requesting account (actor) currently has muted. Requires auth.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["mutes"],properties:{cursor:{type:"string"},mutes:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyGraphGetRelationships:{lexicon:1,id:"app.bsky.graph.getRelationships",defs:{main:{type:"query",description:"Enumerates public relationships between one account, and a list of other accounts. Does not require auth.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier",description:"Primary account requesting relationships for."},others:{type:"array",description:"List of 'other' accounts to be related back to the primary.",maxLength:30,items:{type:"string",format:"at-identifier"}}}},output:{encoding:"application/json",schema:{type:"object",required:["relationships"],properties:{actor:{type:"string",format:"did"},relationships:{type:"array",items:{type:"union",refs:["lex:app.bsky.graph.defs#relationship","lex:app.bsky.graph.defs#notFoundActor"]}}}}},errors:[{name:"ActorNotFound",description:"the primary actor at-identifier could not be resolved"}]}}},AppBskyGraphGetStarterPack:{lexicon:1,id:"app.bsky.graph.getStarterPack",defs:{main:{type:"query",description:"Gets a view of a starter pack.",parameters:{type:"params",required:["starterPack"],properties:{starterPack:{type:"string",format:"at-uri",description:"Reference (AT-URI) of the starter pack record."}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPack"],properties:{starterPack:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackView"}}}}}}},AppBskyGraphGetStarterPacks:{lexicon:1,id:"app.bsky.graph.getStarterPacks",defs:{main:{type:"query",description:"Get views for a list of starter packs.",parameters:{type:"params",required:["uris"],properties:{uris:{type:"array",items:{type:"string",format:"at-uri"},maxLength:25}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackViewBasic"}}}}}}}},AppBskyGraphGetStarterPacksWithMembership:{lexicon:1,id:"app.bsky.graph.getStarterPacksWithMembership",defs:{main:{type:"query",description:"Enumerates the starter packs created by the session user, and includes membership information about `actor` in those starter packs. Requires auth.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier",description:"The account (actor) to check for membership."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacksWithMembership"],properties:{cursor:{type:"string"},starterPacksWithMembership:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.getStarterPacksWithMembership#starterPackWithMembership"}}}}}},starterPackWithMembership:{description:"A starter pack and an optional list item indicating membership of a target user to that starter pack.",type:"object",required:["starterPack"],properties:{starterPack:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackView"},listItem:{type:"ref",ref:"lex:app.bsky.graph.defs#listItemView"}}}}},AppBskyGraphGetSuggestedFollowsByActor:{lexicon:1,id:"app.bsky.graph.getSuggestedFollowsByActor",defs:{main:{type:"query",description:"Enumerates follows similar to a given account (actor). Expected use is to recommend additional accounts immediately after following one account.",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"}}},output:{encoding:"application/json",schema:{type:"object",required:["suggestions"],properties:{suggestions:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}},isFallback:{type:"boolean",description:"If true, response has fallen-back to generic results, and is not scoped using relativeToDid",default:!1},recId:{type:"integer",description:"Snowflake for this recommendation, use when submitting recommendation events."}}}}}}},AppBskyGraphList:{lexicon:1,id:"app.bsky.graph.list",defs:{main:{type:"record",description:"Record representing a list of accounts (actors). Scope includes both moderation-oriented lists and curration-oriented lists.",key:"tid",record:{type:"object",required:["name","purpose","createdAt"],properties:{purpose:{type:"ref",description:"Defines the purpose of the list (aka, moderation-oriented or curration-oriented)",ref:"lex:app.bsky.graph.defs#listPurpose"},name:{type:"string",maxLength:64,minLength:1,description:"Display name for list; can not be empty."},description:{type:"string",maxGraphemes:300,maxLength:3e3},descriptionFacets:{type:"array",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},avatar:{type:"blob",accept:["image/png","image/jpeg"],maxSize:1e6},labels:{type:"union",refs:["lex:com.atproto.label.defs#selfLabels"]},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyGraphListblock:{lexicon:1,id:"app.bsky.graph.listblock",defs:{main:{type:"record",description:"Record representing a block relationship against an entire an entire list of accounts (actors).",key:"tid",record:{type:"object",required:["subject","createdAt"],properties:{subject:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the mod list record."},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyGraphListitem:{lexicon:1,id:"app.bsky.graph.listitem",defs:{main:{type:"record",description:"Record representing an account's inclusion on a specific list. The AppView will ignore duplicate listitem records.",key:"tid",record:{type:"object",required:["subject","list","createdAt"],properties:{subject:{type:"string",format:"did",description:"The account which is included on the list."},list:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the list record (app.bsky.graph.list)."},createdAt:{type:"string",format:"datetime"}}}}}},AppBskyGraphMuteActor:{lexicon:1,id:"app.bsky.graph.muteActor",defs:{main:{type:"procedure",description:"Creates a mute relationship for the specified account. Mutes are private in Bluesky. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"}}}}}}},AppBskyGraphMuteActorList:{lexicon:1,id:"app.bsky.graph.muteActorList",defs:{main:{type:"procedure",description:"Creates a mute relationship for the specified list of accounts. Mutes are private in Bluesky. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["list"],properties:{list:{type:"string",format:"at-uri"}}}}}}},AppBskyGraphMuteThread:{lexicon:1,id:"app.bsky.graph.muteThread",defs:{main:{type:"procedure",description:"Mutes a thread preventing notifications from the thread and any of its children. Mutes are private in Bluesky. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["root"],properties:{root:{type:"string",format:"at-uri"}}}}}}},AppBskyGraphSearchStarterPacks:{lexicon:1,id:"app.bsky.graph.searchStarterPacks",defs:{main:{type:"query",description:"Find starter packs matching search criteria. Does not require auth.",parameters:{type:"params",required:["q"],properties:{q:{type:"string",description:"Search query string. Syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{cursor:{type:"string"},starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackViewBasic"}}}}}}}},AppBskyGraphStarterpack:{lexicon:1,id:"app.bsky.graph.starterpack",defs:{main:{type:"record",description:"Record defining a starter pack of actors and feeds for new users.",key:"tid",record:{type:"object",required:["name","list","createdAt"],properties:{name:{type:"string",maxGraphemes:50,maxLength:500,minLength:1,description:"Display name for starter pack; can not be empty."},description:{type:"string",maxGraphemes:300,maxLength:3e3},descriptionFacets:{type:"array",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},list:{type:"string",format:"at-uri",description:"Reference (AT-URI) to the list record."},feeds:{type:"array",maxLength:3,items:{type:"ref",ref:"lex:app.bsky.graph.starterpack#feedItem"}},createdAt:{type:"string",format:"datetime"}}}},feedItem:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}}}},AppBskyGraphUnmuteActor:{lexicon:1,id:"app.bsky.graph.unmuteActor",defs:{main:{type:"procedure",description:"Unmutes the specified account. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["actor"],properties:{actor:{type:"string",format:"at-identifier"}}}}}}},AppBskyGraphUnmuteActorList:{lexicon:1,id:"app.bsky.graph.unmuteActorList",defs:{main:{type:"procedure",description:"Unmutes the specified list of accounts. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["list"],properties:{list:{type:"string",format:"at-uri"}}}}}}},AppBskyGraphUnmuteThread:{lexicon:1,id:"app.bsky.graph.unmuteThread",defs:{main:{type:"procedure",description:"Unmutes the specified thread. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["root"],properties:{root:{type:"string",format:"at-uri"}}}}}}},AppBskyGraphVerification:{lexicon:1,id:"app.bsky.graph.verification",defs:{main:{type:"record",description:"Record declaring a verification relationship between two accounts. Verifications are only considered valid by an app if issued by an account the app considers trusted.",key:"tid",record:{type:"object",required:["subject","handle","displayName","createdAt"],properties:{subject:{description:"DID of the subject the verification applies to.",type:"string",format:"did"},handle:{description:"Handle of the subject the verification applies to at the moment of verifying, which might not be the same at the time of viewing. The verification is only valid if the current handle matches the one at the time of verifying.",type:"string",format:"handle"},displayName:{description:"Display name of the subject the verification applies to at the moment of verifying, which might not be the same at the time of viewing. The verification is only valid if the current displayName matches the one at the time of verifying.",type:"string"},createdAt:{description:"Date of when the verification was created.",type:"string",format:"datetime"}}}}}},AppBskyLabelerDefs:{lexicon:1,id:"app.bsky.labeler.defs",defs:{labelerView:{type:"object",required:["uri","cid","creator","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},likeCount:{type:"integer",minimum:0},viewer:{type:"ref",ref:"lex:app.bsky.labeler.defs#labelerViewerState"},indexedAt:{type:"string",format:"datetime"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}}}},labelerViewDetailed:{type:"object",required:["uri","cid","creator","policies","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},creator:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},policies:{type:"ref",ref:"lex:app.bsky.labeler.defs#labelerPolicies"},likeCount:{type:"integer",minimum:0},viewer:{type:"ref",ref:"lex:app.bsky.labeler.defs#labelerViewerState"},indexedAt:{type:"string",format:"datetime"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},reasonTypes:{description:"The set of report reason 'codes' which are in-scope for this service to review and action. These usually align to policy categories. If not defined (distinct from empty array), all reason types are allowed.",type:"array",items:{type:"ref",ref:"lex:com.atproto.moderation.defs#reasonType"}},subjectTypes:{description:"The set of subject types (account, record, etc) this service accepts reports on.",type:"array",items:{type:"ref",ref:"lex:com.atproto.moderation.defs#subjectType"}},subjectCollections:{type:"array",description:"Set of record types (collection NSIDs) which can be reported to this service. If not defined (distinct from empty array), default is any record type.",items:{type:"string",format:"nsid"}}}},labelerViewerState:{type:"object",properties:{like:{type:"string",format:"at-uri"}}},labelerPolicies:{type:"object",required:["labelValues"],properties:{labelValues:{type:"array",description:"The label values which this labeler publishes. May include global or custom labels.",items:{type:"ref",ref:"lex:com.atproto.label.defs#labelValue"}},labelValueDefinitions:{type:"array",description:"Label values created by this labeler and scoped exclusively to it. Labels defined here will override global label definitions for this labeler.",items:{type:"ref",ref:"lex:com.atproto.label.defs#labelValueDefinition"}}}}}},AppBskyLabelerGetServices:{lexicon:1,id:"app.bsky.labeler.getServices",defs:{main:{type:"query",description:"Get information about a list of labeler services.",parameters:{type:"params",required:["dids"],properties:{dids:{type:"array",items:{type:"string",format:"did"}},detailed:{type:"boolean",default:!1}}},output:{encoding:"application/json",schema:{type:"object",required:["views"],properties:{views:{type:"array",items:{type:"union",refs:["lex:app.bsky.labeler.defs#labelerView","lex:app.bsky.labeler.defs#labelerViewDetailed"]}}}}}}}},AppBskyLabelerService:{lexicon:1,id:"app.bsky.labeler.service",defs:{main:{type:"record",description:"A declaration of the existence of labeler service.",key:"literal:self",record:{type:"object",required:["policies","createdAt"],properties:{policies:{type:"ref",ref:"lex:app.bsky.labeler.defs#labelerPolicies"},labels:{type:"union",refs:["lex:com.atproto.label.defs#selfLabels"]},createdAt:{type:"string",format:"datetime"},reasonTypes:{description:"The set of report reason 'codes' which are in-scope for this service to review and action. These usually align to policy categories. If not defined (distinct from empty array), all reason types are allowed.",type:"array",items:{type:"ref",ref:"lex:com.atproto.moderation.defs#reasonType"}},subjectTypes:{description:"The set of subject types (account, record, etc) this service accepts reports on.",type:"array",items:{type:"ref",ref:"lex:com.atproto.moderation.defs#subjectType"}},subjectCollections:{type:"array",description:"Set of record types (collection NSIDs) which can be reported to this service. If not defined (distinct from empty array), default is any record type.",items:{type:"string",format:"nsid"}}}}}}},AppBskyNotificationDeclaration:{lexicon:1,id:"app.bsky.notification.declaration",defs:{main:{type:"record",description:"A declaration of the user's choices related to notifications that can be produced by them.",key:"literal:self",record:{type:"object",required:["allowSubscriptions"],properties:{allowSubscriptions:{type:"string",description:"A declaration of the user's preference for allowing activity subscriptions from other users. Absence of a record implies 'followers'.",knownValues:["followers","mutuals","none"]}}}}}},AppBskyNotificationDefs:{lexicon:1,id:"app.bsky.notification.defs",defs:{recordDeleted:{type:"object",properties:{}},chatPreference:{type:"object",required:["include","push"],properties:{include:{type:"string",knownValues:["all","accepted"]},push:{type:"boolean"}}},filterablePreference:{type:"object",required:["include","list","push"],properties:{include:{type:"string",knownValues:["all","follows"]},list:{type:"boolean"},push:{type:"boolean"}}},preference:{type:"object",required:["list","push"],properties:{list:{type:"boolean"},push:{type:"boolean"}}},preferences:{type:"object",required:["chat","follow","like","likeViaRepost","mention","quote","reply","repost","repostViaRepost","starterpackJoined","subscribedPost","unverified","verified"],properties:{chat:{type:"ref",ref:"lex:app.bsky.notification.defs#chatPreference"},follow:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},like:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},likeViaRepost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},mention:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},quote:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},reply:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},repost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},repostViaRepost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},starterpackJoined:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},subscribedPost:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},unverified:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},verified:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"}}},activitySubscription:{type:"object",required:["post","reply"],properties:{post:{type:"boolean"},reply:{type:"boolean"}}},subjectActivitySubscription:{description:"Object used to store activity subscription data in stash.",type:"object",required:["subject","activitySubscription"],properties:{subject:{type:"string",format:"did"},activitySubscription:{type:"ref",ref:"lex:app.bsky.notification.defs#activitySubscription"}}}}},AppBskyNotificationGetPreferences:{lexicon:1,id:"app.bsky.notification.getPreferences",defs:{main:{type:"query",description:"Get notification-related preferences for an account. Requires auth.",parameters:{type:"params",properties:{}},output:{encoding:"application/json",schema:{type:"object",required:["preferences"],properties:{preferences:{type:"ref",ref:"lex:app.bsky.notification.defs#preferences"}}}}}}},AppBskyNotificationGetUnreadCount:{lexicon:1,id:"app.bsky.notification.getUnreadCount",defs:{main:{type:"query",description:"Count the number of unread notifications for the requesting account. Requires auth.",parameters:{type:"params",properties:{priority:{type:"boolean"},seenAt:{type:"string",format:"datetime"}}},output:{encoding:"application/json",schema:{type:"object",required:["count"],properties:{count:{type:"integer"}}}}}}},AppBskyNotificationListActivitySubscriptions:{lexicon:1,id:"app.bsky.notification.listActivitySubscriptions",defs:{main:{type:"query",description:"Enumerate all accounts to which the requesting account is subscribed to receive notifications for. Requires auth.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["subscriptions"],properties:{cursor:{type:"string"},subscriptions:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyNotificationListNotifications:{lexicon:1,id:"app.bsky.notification.listNotifications",defs:{main:{type:"query",description:"Enumerate notifications for the requesting account. Requires auth.",parameters:{type:"params",properties:{reasons:{description:"Notification reasons to include in response.",type:"array",items:{type:"string",description:"A reason that matches the reason property of #notification."}},limit:{type:"integer",minimum:1,maximum:100,default:50},priority:{type:"boolean"},cursor:{type:"string"},seenAt:{type:"string",format:"datetime"}}},output:{encoding:"application/json",schema:{type:"object",required:["notifications"],properties:{cursor:{type:"string"},notifications:{type:"array",items:{type:"ref",ref:"lex:app.bsky.notification.listNotifications#notification"}},priority:{type:"boolean"},seenAt:{type:"string",format:"datetime"}}}}},notification:{type:"object",required:["uri","cid","author","reason","record","isRead","indexedAt"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},author:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"},reason:{type:"string",description:"The reason why this notification was delivered - e.g. your post was liked, or you received a new follower.",knownValues:["like","repost","follow","mention","reply","quote","starterpack-joined","verified","unverified","like-via-repost","repost-via-repost","subscribed-post"]},reasonSubject:{type:"string",format:"at-uri"},record:{type:"unknown"},isRead:{type:"boolean"},indexedAt:{type:"string",format:"datetime"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}}}}}},AppBskyNotificationPutActivitySubscription:{lexicon:1,id:"app.bsky.notification.putActivitySubscription",defs:{main:{type:"procedure",description:"Puts an activity subscription entry. The key should be omitted for creation and provided for updates. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["subject","activitySubscription"],properties:{subject:{type:"string",format:"did"},activitySubscription:{type:"ref",ref:"lex:app.bsky.notification.defs#activitySubscription"}}}},output:{encoding:"application/json",schema:{type:"object",required:["subject"],properties:{subject:{type:"string",format:"did"},activitySubscription:{type:"ref",ref:"lex:app.bsky.notification.defs#activitySubscription"}}}}}}},AppBskyNotificationPutPreferences:{lexicon:1,id:"app.bsky.notification.putPreferences",defs:{main:{type:"procedure",description:"Set notification-related preferences for an account. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["priority"],properties:{priority:{type:"boolean"}}}}}}},AppBskyNotificationPutPreferencesV2:{lexicon:1,id:"app.bsky.notification.putPreferencesV2",defs:{main:{type:"procedure",description:"Set notification-related preferences for an account. Requires auth.",input:{encoding:"application/json",schema:{type:"object",properties:{chat:{type:"ref",ref:"lex:app.bsky.notification.defs#chatPreference"},follow:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},like:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},likeViaRepost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},mention:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},quote:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},reply:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},repost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},repostViaRepost:{type:"ref",ref:"lex:app.bsky.notification.defs#filterablePreference"},starterpackJoined:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},subscribedPost:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},unverified:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"},verified:{type:"ref",ref:"lex:app.bsky.notification.defs#preference"}}}},output:{encoding:"application/json",schema:{type:"object",required:["preferences"],properties:{preferences:{type:"ref",ref:"lex:app.bsky.notification.defs#preferences"}}}}}}},AppBskyNotificationRegisterPush:{lexicon:1,id:"app.bsky.notification.registerPush",defs:{main:{type:"procedure",description:"Register to receive push notifications, via a specified service, for the requesting account. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["serviceDid","token","platform","appId"],properties:{serviceDid:{type:"string",format:"did"},token:{type:"string"},platform:{type:"string",knownValues:["ios","android","web"]},appId:{type:"string"},ageRestricted:{type:"boolean",description:"Set to true when the actor is age restricted"}}}}}}},AppBskyNotificationUnregisterPush:{lexicon:1,id:"app.bsky.notification.unregisterPush",defs:{main:{type:"procedure",description:"The inverse of registerPush - inform a specified service that push notifications should no longer be sent to the given token for the requesting account. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["serviceDid","token","platform","appId"],properties:{serviceDid:{type:"string",format:"did"},token:{type:"string"},platform:{type:"string",knownValues:["ios","android","web"]},appId:{type:"string"}}}}}}},AppBskyNotificationUpdateSeen:{lexicon:1,id:"app.bsky.notification.updateSeen",defs:{main:{type:"procedure",description:"Notify server that the requesting account has seen notifications. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["seenAt"],properties:{seenAt:{type:"string",format:"datetime"}}}}}}},AppBskyRichtextFacet:{lexicon:1,id:"app.bsky.richtext.facet",defs:{main:{type:"object",description:"Annotation of a sub-string within rich text.",required:["index","features"],properties:{index:{type:"ref",ref:"lex:app.bsky.richtext.facet#byteSlice"},features:{type:"array",items:{type:"union",refs:["lex:app.bsky.richtext.facet#mention","lex:app.bsky.richtext.facet#link","lex:app.bsky.richtext.facet#tag"]}}}},mention:{type:"object",description:"Facet feature for mention of another account. The text is usually a handle, including a '@' prefix, but the facet reference is a DID.",required:["did"],properties:{did:{type:"string",format:"did"}}},link:{type:"object",description:"Facet feature for a URL. The text URL may have been simplified or truncated, but the facet reference should be a complete URL.",required:["uri"],properties:{uri:{type:"string",format:"uri"}}},tag:{type:"object",description:"Facet feature for a hashtag. The text usually includes a '#' prefix, but the facet reference should not (except in the case of 'double hash tags').",required:["tag"],properties:{tag:{type:"string",maxLength:640,maxGraphemes:64}}},byteSlice:{type:"object",description:"Specifies the sub-string range a facet feature applies to. Start index is inclusive, end index is exclusive. Indices are zero-indexed, counting bytes of the UTF-8 encoded text. NOTE: some languages, like Javascript, use UTF-16 or Unicode codepoints for string slice indexing; in these languages, convert to byte arrays before working with facets.",required:["byteStart","byteEnd"],properties:{byteStart:{type:"integer",minimum:0},byteEnd:{type:"integer",minimum:0}}}}},AppBskyUnspeccedDefs:{lexicon:1,id:"app.bsky.unspecced.defs",defs:{skeletonSearchPost:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}},skeletonSearchActor:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},skeletonSearchStarterPack:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}},trendingTopic:{type:"object",required:["topic","link"],properties:{topic:{type:"string"},displayName:{type:"string"},description:{type:"string"},link:{type:"string"}}},skeletonTrend:{type:"object",required:["topic","displayName","link","startedAt","postCount","dids"],properties:{topic:{type:"string"},displayName:{type:"string"},link:{type:"string"},startedAt:{type:"string",format:"datetime"},postCount:{type:"integer"},status:{type:"string",knownValues:["hot"]},category:{type:"string"},dids:{type:"array",items:{type:"string",format:"did"}}}},trendView:{type:"object",required:["topic","displayName","link","startedAt","postCount","actors"],properties:{topic:{type:"string"},displayName:{type:"string"},link:{type:"string"},startedAt:{type:"string",format:"datetime"},postCount:{type:"integer"},status:{type:"string",knownValues:["hot"]},category:{type:"string"},actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewBasic"}}}},threadItemPost:{type:"object",required:["post","moreParents","moreReplies","opThread","hiddenByThreadgate","mutedByViewer"],properties:{post:{type:"ref",ref:"lex:app.bsky.feed.defs#postView"},moreParents:{type:"boolean",description:"This post has more parents that were not present in the response. This is just a boolean, without the number of parents."},moreReplies:{type:"integer",description:"This post has more replies that were not present in the response. This is a numeric value, which is best-effort and might not be accurate."},opThread:{type:"boolean",description:"This post is part of a contiguous thread by the OP from the thread root. Many different OP threads can happen in the same thread."},hiddenByThreadgate:{type:"boolean",description:"The threadgate created by the author indicates this post as a reply to be hidden for everyone consuming the thread."},mutedByViewer:{type:"boolean",description:"This is by an account muted by the viewer requesting it."}}},threadItemNoUnauthenticated:{type:"object",properties:{}},threadItemNotFound:{type:"object",properties:{}},threadItemBlocked:{type:"object",required:["author"],properties:{author:{type:"ref",ref:"lex:app.bsky.feed.defs#blockedAuthor"}}},ageAssuranceState:{type:"object",description:"The computed state of the age assurance process, returned to the user in question on certain authenticated requests.",required:["status"],properties:{lastInitiatedAt:{type:"string",format:"datetime",description:"The timestamp when this state was last updated."},status:{type:"string",description:"The status of the age assurance process.",knownValues:["unknown","pending","assured","blocked"]}}},ageAssuranceEvent:{type:"object",description:"Object used to store age assurance data in stash.",required:["createdAt","status","attemptId"],properties:{createdAt:{type:"string",format:"datetime",description:"The date and time of this write operation."},status:{type:"string",description:"The status of the age assurance process.",knownValues:["unknown","pending","assured"]},attemptId:{type:"string",description:"The unique identifier for this instance of the age assurance flow, in UUID format."},email:{type:"string",description:"The email used for AA."},initIp:{type:"string",description:"The IP address used when initiating the AA flow."},initUa:{type:"string",description:"The user agent used when initiating the AA flow."},completeIp:{type:"string",description:"The IP address used when completing the AA flow."},completeUa:{type:"string",description:"The user agent used when completing the AA flow."}}}}},AppBskyUnspeccedGetAgeAssuranceState:{lexicon:1,id:"app.bsky.unspecced.getAgeAssuranceState",defs:{main:{type:"query",description:"Returns the current state of the age assurance process for an account. This is used to check if the user has completed age assurance or if further action is required.",output:{encoding:"application/json",schema:{type:"ref",ref:"lex:app.bsky.unspecced.defs#ageAssuranceState"}}}}},AppBskyUnspeccedGetConfig:{lexicon:1,id:"app.bsky.unspecced.getConfig",defs:{main:{type:"query",description:"Get miscellaneous runtime configuration.",output:{encoding:"application/json",schema:{type:"object",required:[],properties:{checkEmailConfirmed:{type:"boolean"},liveNow:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.getConfig#liveNowConfig"}}}}}},liveNowConfig:{type:"object",required:["did","domains"],properties:{did:{type:"string",format:"did"},domains:{type:"array",items:{type:"string"}}}}}},AppBskyUnspeccedGetOnboardingSuggestedStarterPacks:{lexicon:1,id:"app.bsky.unspecced.getOnboardingSuggestedStarterPacks",defs:{main:{type:"query",description:"Get a list of suggested starterpacks for onboarding",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackView"}}}}}}}},AppBskyUnspeccedGetOnboardingSuggestedStarterPacksSkeleton:{lexicon:1,id:"app.bsky.unspecced.getOnboardingSuggestedStarterPacksSkeleton",defs:{main:{type:"query",description:"Get a skeleton of suggested starterpacks for onboarding. Intended to be called and hydrated by app.bsky.unspecced.getOnboardingSuggestedStarterPacks",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{starterPacks:{type:"array",items:{type:"string",format:"at-uri"}}}}}}}},AppBskyUnspeccedGetPopularFeedGenerators:{lexicon:1,id:"app.bsky.unspecced.getPopularFeedGenerators",defs:{main:{type:"query",description:"An unspecced view of globally popular feed generators.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},query:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{cursor:{type:"string"},feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}}}}}}}},AppBskyUnspeccedGetPostThreadOtherV2:{lexicon:1,id:"app.bsky.unspecced.getPostThreadOtherV2",defs:{main:{type:"query",description:"(NOTE: this endpoint is under development and WILL change without notice. Don't use it until it is moved out of `unspecced` or your application WILL break) Get additional posts under a thread e.g. replies hidden by threadgate. Based on an anchor post at any depth of the tree, returns top-level replies below that anchor. It does not include ancestors nor the anchor itself. This should be called after exhausting `app.bsky.unspecced.getPostThreadV2`. Does not require auth, but additional metadata and filtering will be applied for authed requests.",parameters:{type:"params",required:["anchor"],properties:{anchor:{type:"string",format:"at-uri",description:"Reference (AT-URI) to post record. This is the anchor post."},prioritizeFollowedUsers:{type:"boolean",description:"Whether to prioritize posts from followed users. It only has effect when the user is authenticated.",default:!1}}},output:{encoding:"application/json",schema:{type:"object",required:["thread"],properties:{thread:{type:"array",description:"A flat list of other thread items. The depth of each item is indicated by the depth property inside the item.",items:{type:"ref",ref:"lex:app.bsky.unspecced.getPostThreadOtherV2#threadItem"}}}}}},threadItem:{type:"object",required:["uri","depth","value"],properties:{uri:{type:"string",format:"at-uri"},depth:{type:"integer",description:"The nesting level of this item in the thread. Depth 0 means the anchor item. Items above have negative depths, items below have positive depths."},value:{type:"union",refs:["lex:app.bsky.unspecced.defs#threadItemPost"]}}}}},AppBskyUnspeccedGetPostThreadV2:{lexicon:1,id:"app.bsky.unspecced.getPostThreadV2",defs:{main:{type:"query",description:"(NOTE: this endpoint is under development and WILL change without notice. Don't use it until it is moved out of `unspecced` or your application WILL break) Get posts in a thread. It is based in an anchor post at any depth of the tree, and returns posts above it (recursively resolving the parent, without further branching to their replies) and below it (recursive replies, with branching to their replies). Does not require auth, but additional metadata and filtering will be applied for authed requests.",parameters:{type:"params",required:["anchor"],properties:{anchor:{type:"string",format:"at-uri",description:"Reference (AT-URI) to post record. This is the anchor post, and the thread will be built around it. It can be any post in the tree, not necessarily a root post."},above:{type:"boolean",description:"Whether to include parents above the anchor.",default:!0},below:{type:"integer",description:"How many levels of replies to include below the anchor.",default:6,minimum:0,maximum:20},branchingFactor:{type:"integer",description:"Maximum of replies to include at each level of the thread, except for the direct replies to the anchor, which are (NOTE: currently, during unspecced phase) all returned (NOTE: later they might be paginated).",default:10,minimum:0,maximum:100},prioritizeFollowedUsers:{type:"boolean",description:"Whether to prioritize posts from followed users. It only has effect when the user is authenticated.",default:!1},sort:{type:"string",description:"Sorting for the thread replies.",knownValues:["newest","oldest","top"],default:"oldest"}}},output:{encoding:"application/json",schema:{type:"object",required:["thread","hasOtherReplies"],properties:{thread:{type:"array",description:"A flat list of thread items. The depth of each item is indicated by the depth property inside the item.",items:{type:"ref",ref:"lex:app.bsky.unspecced.getPostThreadV2#threadItem"}},threadgate:{type:"ref",ref:"lex:app.bsky.feed.defs#threadgateView"},hasOtherReplies:{type:"boolean",description:"Whether this thread has additional replies. If true, a call can be made to the `getPostThreadOtherV2` endpoint to retrieve them."}}}}},threadItem:{type:"object",required:["uri","depth","value"],properties:{uri:{type:"string",format:"at-uri"},depth:{type:"integer",description:"The nesting level of this item in the thread. Depth 0 means the anchor item. Items above have negative depths, items below have positive depths."},value:{type:"union",refs:["lex:app.bsky.unspecced.defs#threadItemPost","lex:app.bsky.unspecced.defs#threadItemNoUnauthenticated","lex:app.bsky.unspecced.defs#threadItemNotFound","lex:app.bsky.unspecced.defs#threadItemBlocked"]}}}}},AppBskyUnspeccedGetSuggestedFeeds:{lexicon:1,id:"app.bsky.unspecced.getSuggestedFeeds",defs:{main:{type:"query",description:"Get a list of suggested feeds",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{feeds:{type:"array",items:{type:"ref",ref:"lex:app.bsky.feed.defs#generatorView"}}}}}}}},AppBskyUnspeccedGetSuggestedFeedsSkeleton:{lexicon:1,id:"app.bsky.unspecced.getSuggestedFeedsSkeleton",defs:{main:{type:"query",description:"Get a skeleton of suggested feeds. Intended to be called and hydrated by app.bsky.unspecced.getSuggestedFeeds",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["feeds"],properties:{feeds:{type:"array",items:{type:"string",format:"at-uri"}}}}}}}},AppBskyUnspeccedGetSuggestedStarterPacks:{lexicon:1,id:"app.bsky.unspecced.getSuggestedStarterPacks",defs:{main:{type:"query",description:"Get a list of suggested starterpacks",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.graph.defs#starterPackView"}}}}}}}},AppBskyUnspeccedGetSuggestedStarterPacksSkeleton:{lexicon:1,id:"app.bsky.unspecced.getSuggestedStarterPacksSkeleton",defs:{main:{type:"query",description:"Get a skeleton of suggested starterpacks. Intended to be called and hydrated by app.bsky.unspecced.getSuggestedStarterpacks",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{starterPacks:{type:"array",items:{type:"string",format:"at-uri"}}}}}}}},AppBskyUnspeccedGetSuggestedUsers:{lexicon:1,id:"app.bsky.unspecced.getSuggestedUsers",defs:{main:{type:"query",description:"Get a list of suggested users",parameters:{type:"params",properties:{category:{type:"string",description:"Category of users to get suggestions for."},limit:{type:"integer",minimum:1,maximum:50,default:25}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.actor.defs#profileView"}}}}}}}},AppBskyUnspeccedGetSuggestedUsersSkeleton:{lexicon:1,id:"app.bsky.unspecced.getSuggestedUsersSkeleton",defs:{main:{type:"query",description:"Get a skeleton of suggested users. Intended to be called and hydrated by app.bsky.unspecced.getSuggestedUsers",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},category:{type:"string",description:"Category of users to get suggestions for."},limit:{type:"integer",minimum:1,maximum:50,default:25}}},output:{encoding:"application/json",schema:{type:"object",required:["dids"],properties:{dids:{type:"array",items:{type:"string",format:"did"}}}}}}}},AppBskyUnspeccedGetSuggestionsSkeleton:{lexicon:1,id:"app.bsky.unspecced.getSuggestionsSkeleton",defs:{main:{type:"query",description:"Get a skeleton of suggested actors. Intended to be called and then hydrated through app.bsky.actor.getSuggestions",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries). Used to boost followed accounts in ranking."},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},relativeToDid:{type:"string",format:"did",description:"DID of the account to get suggestions relative to. If not provided, suggestions will be based on the viewer."}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{cursor:{type:"string"},actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#skeletonSearchActor"}},relativeToDid:{type:"string",format:"did",description:"DID of the account these suggestions are relative to. If this is returned undefined, suggestions are based on the viewer."},recId:{type:"integer",description:"Snowflake for this recommendation, use when submitting recommendation events."}}}}}}},AppBskyUnspeccedGetTaggedSuggestions:{lexicon:1,id:"app.bsky.unspecced.getTaggedSuggestions",defs:{main:{type:"query",description:"Get a list of suggestions (feeds and users) tagged with categories",parameters:{type:"params",properties:{}},output:{encoding:"application/json",schema:{type:"object",required:["suggestions"],properties:{suggestions:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.getTaggedSuggestions#suggestion"}}}}}},suggestion:{type:"object",required:["tag","subjectType","subject"],properties:{tag:{type:"string"},subjectType:{type:"string",knownValues:["actor","feed"]},subject:{type:"string",format:"uri"}}}}},AppBskyUnspeccedGetTrendingTopics:{lexicon:1,id:"app.bsky.unspecced.getTrendingTopics",defs:{main:{type:"query",description:"Get a list of trending topics",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries). Used to boost followed accounts in ranking."},limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["topics","suggested"],properties:{topics:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#trendingTopic"}},suggested:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#trendingTopic"}}}}}}}},AppBskyUnspeccedGetTrends:{lexicon:1,id:"app.bsky.unspecced.getTrends",defs:{main:{type:"query",description:"Get the current trends on the network",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["trends"],properties:{trends:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#trendView"}}}}}}}},AppBskyUnspeccedGetTrendsSkeleton:{lexicon:1,id:"app.bsky.unspecced.getTrendsSkeleton",defs:{main:{type:"query",description:"Get the skeleton of trends on the network. Intended to be called and then hydrated through app.bsky.unspecced.getTrends",parameters:{type:"params",properties:{viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},limit:{type:"integer",minimum:1,maximum:25,default:10}}},output:{encoding:"application/json",schema:{type:"object",required:["trends"],properties:{trends:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#skeletonTrend"}}}}}}}},AppBskyUnspeccedInitAgeAssurance:{lexicon:1,id:"app.bsky.unspecced.initAgeAssurance",defs:{main:{type:"procedure",description:"Initiate age assurance for an account. This is a one-time action that will start the process of verifying the user's age.",input:{encoding:"application/json",schema:{type:"object",required:["email","language","countryCode"],properties:{email:{type:"string",description:"The user's email address to receive assurance instructions."},language:{type:"string",description:"The user's preferred language for communication during the assurance process."},countryCode:{type:"string",description:"An ISO 3166-1 alpha-2 code of the user's location."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:app.bsky.unspecced.defs#ageAssuranceState"}},errors:[{name:"InvalidEmail"},{name:"DidTooLong"},{name:"InvalidInitiation"}]}}},AppBskyUnspeccedSearchActorsSkeleton:{lexicon:1,id:"app.bsky.unspecced.searchActorsSkeleton",defs:{main:{type:"query",description:"Backend Actors (profile) search, returns only skeleton.",parameters:{type:"params",required:["q"],properties:{q:{type:"string",description:"Search query string; syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended. For typeahead search, only simple term match is supported, not full syntax."},viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries). Used to boost followed accounts in ranking."},typeahead:{type:"boolean",description:"If true, acts as fast/simple 'typeahead' query."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string",description:"Optional pagination mechanism; may not necessarily allow scrolling through entire result set."}}},output:{encoding:"application/json",schema:{type:"object",required:["actors"],properties:{cursor:{type:"string"},hitsTotal:{type:"integer",description:"Count of search hits. Optional, may be rounded/truncated, and may not be possible to paginate through all hits."},actors:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#skeletonSearchActor"}}}}},errors:[{name:"BadQueryString"}]}}},AppBskyUnspeccedSearchPostsSkeleton:{lexicon:1,id:"app.bsky.unspecced.searchPostsSkeleton",defs:{main:{type:"query",description:"Backend Posts search, returns only skeleton",parameters:{type:"params",required:["q"],properties:{q:{type:"string",description:"Search query string; syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended."},sort:{type:"string",knownValues:["top","latest"],default:"latest",description:"Specifies the ranking order of results."},since:{type:"string",description:"Filter results for posts after the indicated datetime (inclusive). Expected to use 'sortAt' timestamp, which may not match 'createdAt'. Can be a datetime, or just an ISO date (YYYY-MM-DD)."},until:{type:"string",description:"Filter results for posts before the indicated datetime (not inclusive). Expected to use 'sortAt' timestamp, which may not match 'createdAt'. Can be a datetime, or just an ISO date (YYY-MM-DD)."},mentions:{type:"string",format:"at-identifier",description:"Filter to posts which mention the given account. Handles are resolved to DID before query-time. Only matches rich-text facet mentions."},author:{type:"string",format:"at-identifier",description:"Filter to posts by the given account. Handles are resolved to DID before query-time."},lang:{type:"string",format:"language",description:"Filter to posts in the given language. Expected to be based on post language field, though server may override language detection."},domain:{type:"string",description:"Filter to posts with URLs (facet links or embeds) linking to the given domain (hostname). Server may apply hostname normalization."},url:{type:"string",format:"uri",description:"Filter to posts with links (facet links or embeds) pointing to this URL. Server may apply URL normalization or fuzzy matching."},tag:{type:"array",items:{type:"string",maxLength:640,maxGraphemes:64},description:"Filter to posts with the given tag (hashtag), based on rich-text facet or tag field. Do not include the hash (#) prefix. Multiple tags can be specified, with 'AND' matching."},viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries). Used for 'from:me' queries."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string",description:"Optional pagination mechanism; may not necessarily allow scrolling through entire result set."}}},output:{encoding:"application/json",schema:{type:"object",required:["posts"],properties:{cursor:{type:"string"},hitsTotal:{type:"integer",description:"Count of search hits. Optional, may be rounded/truncated, and may not be possible to paginate through all hits."},posts:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#skeletonSearchPost"}}}}},errors:[{name:"BadQueryString"}]}}},AppBskyUnspeccedSearchStarterPacksSkeleton:{lexicon:1,id:"app.bsky.unspecced.searchStarterPacksSkeleton",defs:{main:{type:"query",description:"Backend Starter Pack search, returns only skeleton.",parameters:{type:"params",required:["q"],properties:{q:{type:"string",description:"Search query string; syntax, phrase, boolean, and faceting is unspecified, but Lucene query syntax is recommended."},viewer:{type:"string",format:"did",description:"DID of the account making the request (not included for public/unauthenticated queries)."},limit:{type:"integer",minimum:1,maximum:100,default:25},cursor:{type:"string",description:"Optional pagination mechanism; may not necessarily allow scrolling through entire result set."}}},output:{encoding:"application/json",schema:{type:"object",required:["starterPacks"],properties:{cursor:{type:"string"},hitsTotal:{type:"integer",description:"Count of search hits. Optional, may be rounded/truncated, and may not be possible to paginate through all hits."},starterPacks:{type:"array",items:{type:"ref",ref:"lex:app.bsky.unspecced.defs#skeletonSearchStarterPack"}}}}},errors:[{name:"BadQueryString"}]}}},AppBskyVideoDefs:{lexicon:1,id:"app.bsky.video.defs",defs:{jobStatus:{type:"object",required:["jobId","did","state"],properties:{jobId:{type:"string"},did:{type:"string",format:"did"},state:{type:"string",description:"The state of the video processing job. All values not listed as a known value indicate that the job is in process.",knownValues:["JOB_STATE_COMPLETED","JOB_STATE_FAILED"]},progress:{type:"integer",minimum:0,maximum:100,description:"Progress within the current processing state."},blob:{type:"blob"},error:{type:"string"},message:{type:"string"}}}}},AppBskyVideoGetJobStatus:{lexicon:1,id:"app.bsky.video.getJobStatus",defs:{main:{type:"query",description:"Get status details for a video processing job.",parameters:{type:"params",required:["jobId"],properties:{jobId:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["jobStatus"],properties:{jobStatus:{type:"ref",ref:"lex:app.bsky.video.defs#jobStatus"}}}}}}},AppBskyVideoGetUploadLimits:{lexicon:1,id:"app.bsky.video.getUploadLimits",defs:{main:{type:"query",description:"Get video upload limits for the authenticated user.",output:{encoding:"application/json",schema:{type:"object",required:["canUpload"],properties:{canUpload:{type:"boolean"},remainingDailyVideos:{type:"integer"},remainingDailyBytes:{type:"integer"},message:{type:"string"},error:{type:"string"}}}}}}},AppBskyVideoUploadVideo:{lexicon:1,id:"app.bsky.video.uploadVideo",defs:{main:{type:"procedure",description:"Upload a video to be processed then stored on the PDS.",input:{encoding:"video/mp4"},output:{encoding:"application/json",schema:{type:"object",required:["jobStatus"],properties:{jobStatus:{type:"ref",ref:"lex:app.bsky.video.defs#jobStatus"}}}}}}},ChatBskyActorDeclaration:{lexicon:1,id:"chat.bsky.actor.declaration",defs:{main:{type:"record",description:"A declaration of a Bluesky chat account.",key:"literal:self",record:{type:"object",required:["allowIncoming"],properties:{allowIncoming:{type:"string",knownValues:["all","none","following"]}}}}}},ChatBskyActorDefs:{lexicon:1,id:"chat.bsky.actor.defs",defs:{profileViewBasic:{type:"object",required:["did","handle"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},displayName:{type:"string",maxGraphemes:64,maxLength:640},avatar:{type:"string",format:"uri"},associated:{type:"ref",ref:"lex:app.bsky.actor.defs#profileAssociated"},viewer:{type:"ref",ref:"lex:app.bsky.actor.defs#viewerState"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},chatDisabled:{type:"boolean",description:"Set to true when the actor cannot actively participate in conversations"},verification:{type:"ref",ref:"lex:app.bsky.actor.defs#verificationState"}}}}},ChatBskyActorDeleteAccount:{lexicon:1,id:"chat.bsky.actor.deleteAccount",defs:{main:{type:"procedure",output:{encoding:"application/json",schema:{type:"object",properties:{}}}}}},ChatBskyActorExportAccountData:{lexicon:1,id:"chat.bsky.actor.exportAccountData",defs:{main:{type:"query",output:{encoding:"application/jsonl"}}}},ChatBskyConvoAcceptConvo:{lexicon:1,id:"chat.bsky.convo.acceptConvo",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId"],properties:{convoId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",properties:{rev:{description:"Rev when the convo was accepted. If not present, the convo was already accepted.",type:"string"}}}}}}},ChatBskyConvoAddReaction:{lexicon:1,id:"chat.bsky.convo.addReaction",defs:{main:{type:"procedure",description:"Adds an emoji reaction to a message. Requires authentication. It is idempotent, so multiple calls from the same user with the same emoji result in a single reaction.",input:{encoding:"application/json",schema:{type:"object",required:["convoId","messageId","value"],properties:{convoId:{type:"string"},messageId:{type:"string"},value:{type:"string",minLength:1,maxLength:64,minGraphemes:1,maxGraphemes:1}}}},output:{encoding:"application/json",schema:{type:"object",required:["message"],properties:{message:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageView"}}}},errors:[{name:"ReactionMessageDeleted",description:"Indicates that the message has been deleted and reactions can no longer be added/removed."},{name:"ReactionLimitReached",description:"Indicates that the message has the maximum number of reactions allowed for a single user, and the requested reaction wasn't yet present. If it was already present, the request will not fail since it is idempotent."},{name:"ReactionInvalidValue",description:"Indicates the value for the reaction is not acceptable. In general, this means it is not an emoji."}]}}},ChatBskyConvoDefs:{lexicon:1,id:"chat.bsky.convo.defs",defs:{messageRef:{type:"object",required:["did","messageId","convoId"],properties:{did:{type:"string",format:"did"},convoId:{type:"string"},messageId:{type:"string"}}},messageInput:{type:"object",required:["text"],properties:{text:{type:"string",maxLength:1e4,maxGraphemes:1e3},facets:{type:"array",description:"Annotations of text (mentions, URLs, hashtags, etc)",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},embed:{type:"union",refs:["lex:app.bsky.embed.record"]}}},messageView:{type:"object",required:["id","rev","text","sender","sentAt"],properties:{id:{type:"string"},rev:{type:"string"},text:{type:"string",maxLength:1e4,maxGraphemes:1e3},facets:{type:"array",description:"Annotations of text (mentions, URLs, hashtags, etc)",items:{type:"ref",ref:"lex:app.bsky.richtext.facet"}},embed:{type:"union",refs:["lex:app.bsky.embed.record#view"]},reactions:{type:"array",description:"Reactions to this message, in ascending order of creation time.",items:{type:"ref",ref:"lex:chat.bsky.convo.defs#reactionView"}},sender:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageViewSender"},sentAt:{type:"string",format:"datetime"}}},deletedMessageView:{type:"object",required:["id","rev","sender","sentAt"],properties:{id:{type:"string"},rev:{type:"string"},sender:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageViewSender"},sentAt:{type:"string",format:"datetime"}}},messageViewSender:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},reactionView:{type:"object",required:["value","sender","createdAt"],properties:{value:{type:"string"},sender:{type:"ref",ref:"lex:chat.bsky.convo.defs#reactionViewSender"},createdAt:{type:"string",format:"datetime"}}},reactionViewSender:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},messageAndReactionView:{type:"object",required:["message","reaction"],properties:{message:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageView"},reaction:{type:"ref",ref:"lex:chat.bsky.convo.defs#reactionView"}}},convoView:{type:"object",required:["id","rev","members","muted","unreadCount"],properties:{id:{type:"string"},rev:{type:"string"},members:{type:"array",items:{type:"ref",ref:"lex:chat.bsky.actor.defs#profileViewBasic"}},lastMessage:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]},lastReaction:{type:"union",refs:["lex:chat.bsky.convo.defs#messageAndReactionView"]},muted:{type:"boolean"},status:{type:"string",knownValues:["request","accepted"]},unreadCount:{type:"integer"}}},logBeginConvo:{type:"object",required:["rev","convoId"],properties:{rev:{type:"string"},convoId:{type:"string"}}},logAcceptConvo:{type:"object",required:["rev","convoId"],properties:{rev:{type:"string"},convoId:{type:"string"}}},logLeaveConvo:{type:"object",required:["rev","convoId"],properties:{rev:{type:"string"},convoId:{type:"string"}}},logMuteConvo:{type:"object",required:["rev","convoId"],properties:{rev:{type:"string"},convoId:{type:"string"}}},logUnmuteConvo:{type:"object",required:["rev","convoId"],properties:{rev:{type:"string"},convoId:{type:"string"}}},logCreateMessage:{type:"object",required:["rev","convoId","message"],properties:{rev:{type:"string"},convoId:{type:"string"},message:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]}}},logDeleteMessage:{type:"object",required:["rev","convoId","message"],properties:{rev:{type:"string"},convoId:{type:"string"},message:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]}}},logReadMessage:{type:"object",required:["rev","convoId","message"],properties:{rev:{type:"string"},convoId:{type:"string"},message:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]}}},logAddReaction:{type:"object",required:["rev","convoId","message","reaction"],properties:{rev:{type:"string"},convoId:{type:"string"},message:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]},reaction:{type:"ref",ref:"lex:chat.bsky.convo.defs#reactionView"}}},logRemoveReaction:{type:"object",required:["rev","convoId","message","reaction"],properties:{rev:{type:"string"},convoId:{type:"string"},message:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]},reaction:{type:"ref",ref:"lex:chat.bsky.convo.defs#reactionView"}}}}},ChatBskyConvoDeleteMessageForSelf:{lexicon:1,id:"chat.bsky.convo.deleteMessageForSelf",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId","messageId"],properties:{convoId:{type:"string"},messageId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:chat.bsky.convo.defs#deletedMessageView"}}}}},ChatBskyConvoGetConvo:{lexicon:1,id:"chat.bsky.convo.getConvo",defs:{main:{type:"query",parameters:{type:"params",required:["convoId"],properties:{convoId:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["convo"],properties:{convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyConvoGetConvoAvailability:{lexicon:1,id:"chat.bsky.convo.getConvoAvailability",defs:{main:{type:"query",description:"Get whether the requester and the other members can chat. If an existing convo is found for these members, it is returned.",parameters:{type:"params",required:["members"],properties:{members:{type:"array",minLength:1,maxLength:10,items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["canChat"],properties:{canChat:{type:"boolean"},convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyConvoGetConvoForMembers:{lexicon:1,id:"chat.bsky.convo.getConvoForMembers",defs:{main:{type:"query",parameters:{type:"params",required:["members"],properties:{members:{type:"array",minLength:1,maxLength:10,items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["convo"],properties:{convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyConvoGetLog:{lexicon:1,id:"chat.bsky.convo.getLog",defs:{main:{type:"query",parameters:{type:"params",required:[],properties:{cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["logs"],properties:{cursor:{type:"string"},logs:{type:"array",items:{type:"union",refs:["lex:chat.bsky.convo.defs#logBeginConvo","lex:chat.bsky.convo.defs#logAcceptConvo","lex:chat.bsky.convo.defs#logLeaveConvo","lex:chat.bsky.convo.defs#logMuteConvo","lex:chat.bsky.convo.defs#logUnmuteConvo","lex:chat.bsky.convo.defs#logCreateMessage","lex:chat.bsky.convo.defs#logDeleteMessage","lex:chat.bsky.convo.defs#logReadMessage","lex:chat.bsky.convo.defs#logAddReaction","lex:chat.bsky.convo.defs#logRemoveReaction"]}}}}}}}},ChatBskyConvoGetMessages:{lexicon:1,id:"chat.bsky.convo.getMessages",defs:{main:{type:"query",parameters:{type:"params",required:["convoId"],properties:{convoId:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["messages"],properties:{cursor:{type:"string"},messages:{type:"array",items:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]}}}}}}}},ChatBskyConvoLeaveConvo:{lexicon:1,id:"chat.bsky.convo.leaveConvo",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId"],properties:{convoId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",required:["convoId","rev"],properties:{convoId:{type:"string"},rev:{type:"string"}}}}}}},ChatBskyConvoListConvos:{lexicon:1,id:"chat.bsky.convo.listConvos",defs:{main:{type:"query",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},readState:{type:"string",knownValues:["unread"]},status:{type:"string",knownValues:["request","accepted"]}}},output:{encoding:"application/json",schema:{type:"object",required:["convos"],properties:{cursor:{type:"string"},convos:{type:"array",items:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}}},ChatBskyConvoMuteConvo:{lexicon:1,id:"chat.bsky.convo.muteConvo",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId"],properties:{convoId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",required:["convo"],properties:{convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyConvoRemoveReaction:{lexicon:1,id:"chat.bsky.convo.removeReaction",defs:{main:{type:"procedure",description:"Removes an emoji reaction from a message. Requires authentication. It is idempotent, so multiple calls from the same user with the same emoji result in that reaction not being present, even if it already wasn't.",input:{encoding:"application/json",schema:{type:"object",required:["convoId","messageId","value"],properties:{convoId:{type:"string"},messageId:{type:"string"},value:{type:"string",minLength:1,maxLength:64,minGraphemes:1,maxGraphemes:1}}}},output:{encoding:"application/json",schema:{type:"object",required:["message"],properties:{message:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageView"}}}},errors:[{name:"ReactionMessageDeleted",description:"Indicates that the message has been deleted and reactions can no longer be added/removed."},{name:"ReactionInvalidValue",description:"Indicates the value for the reaction is not acceptable. In general, this means it is not an emoji."}]}}},ChatBskyConvoSendMessage:{lexicon:1,id:"chat.bsky.convo.sendMessage",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId","message"],properties:{convoId:{type:"string"},message:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageInput"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageView"}}}}},ChatBskyConvoSendMessageBatch:{lexicon:1,id:"chat.bsky.convo.sendMessageBatch",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["items"],properties:{items:{type:"array",maxLength:100,items:{type:"ref",ref:"lex:chat.bsky.convo.sendMessageBatch#batchItem"}}}}},output:{encoding:"application/json",schema:{type:"object",required:["items"],properties:{items:{type:"array",items:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageView"}}}}}},batchItem:{type:"object",required:["convoId","message"],properties:{convoId:{type:"string"},message:{type:"ref",ref:"lex:chat.bsky.convo.defs#messageInput"}}}}},ChatBskyConvoUnmuteConvo:{lexicon:1,id:"chat.bsky.convo.unmuteConvo",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId"],properties:{convoId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",required:["convo"],properties:{convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyConvoUpdateAllRead:{lexicon:1,id:"chat.bsky.convo.updateAllRead",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",properties:{status:{type:"string",knownValues:["request","accepted"]}}}},output:{encoding:"application/json",schema:{type:"object",required:["updatedCount"],properties:{updatedCount:{description:"The count of updated convos.",type:"integer"}}}}}}},ChatBskyConvoUpdateRead:{lexicon:1,id:"chat.bsky.convo.updateRead",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["convoId"],properties:{convoId:{type:"string"},messageId:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",required:["convo"],properties:{convo:{type:"ref",ref:"lex:chat.bsky.convo.defs#convoView"}}}}}}},ChatBskyModerationGetActorMetadata:{lexicon:1,id:"chat.bsky.moderation.getActorMetadata",defs:{main:{type:"query",parameters:{type:"params",required:["actor"],properties:{actor:{type:"string",format:"did"}}},output:{encoding:"application/json",schema:{type:"object",required:["day","month","all"],properties:{day:{type:"ref",ref:"lex:chat.bsky.moderation.getActorMetadata#metadata"},month:{type:"ref",ref:"lex:chat.bsky.moderation.getActorMetadata#metadata"},all:{type:"ref",ref:"lex:chat.bsky.moderation.getActorMetadata#metadata"}}}}},metadata:{type:"object",required:["messagesSent","messagesReceived","convos","convosStarted"],properties:{messagesSent:{type:"integer"},messagesReceived:{type:"integer"},convos:{type:"integer"},convosStarted:{type:"integer"}}}}},ChatBskyModerationGetMessageContext:{lexicon:1,id:"chat.bsky.moderation.getMessageContext",defs:{main:{type:"query",parameters:{type:"params",required:["messageId"],properties:{convoId:{type:"string",description:"Conversation that the message is from. NOTE: this field will eventually be required."},messageId:{type:"string"},before:{type:"integer",default:5},after:{type:"integer",default:5}}},output:{encoding:"application/json",schema:{type:"object",required:["messages"],properties:{messages:{type:"array",items:{type:"union",refs:["lex:chat.bsky.convo.defs#messageView","lex:chat.bsky.convo.defs#deletedMessageView"]}}}}}}}},ChatBskyModerationUpdateActorAccess:{lexicon:1,id:"chat.bsky.moderation.updateActorAccess",defs:{main:{type:"procedure",input:{encoding:"application/json",schema:{type:"object",required:["actor","allowAccess"],properties:{actor:{type:"string",format:"did"},allowAccess:{type:"boolean"},ref:{type:"string"}}}}}}},ComAtprotoAdminDefs:{lexicon:1,id:"com.atproto.admin.defs",defs:{statusAttr:{type:"object",required:["applied"],properties:{applied:{type:"boolean"},ref:{type:"string"}}},accountView:{type:"object",required:["did","handle","indexedAt"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},email:{type:"string"},relatedRecords:{type:"array",items:{type:"unknown"}},indexedAt:{type:"string",format:"datetime"},invitedBy:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"},invites:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"}},invitesDisabled:{type:"boolean"},emailConfirmedAt:{type:"string",format:"datetime"},inviteNote:{type:"string"},deactivatedAt:{type:"string",format:"datetime"},threatSignatures:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#threatSignature"}}}},repoRef:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},repoBlobRef:{type:"object",required:["did","cid"],properties:{did:{type:"string",format:"did"},cid:{type:"string",format:"cid"},recordUri:{type:"string",format:"at-uri"}}},threatSignature:{type:"object",required:["property","value"],properties:{property:{type:"string"},value:{type:"string"}}}}},ComAtprotoAdminDeleteAccount:{lexicon:1,id:"com.atproto.admin.deleteAccount",defs:{main:{type:"procedure",description:"Delete a user account as an administrator.",input:{encoding:"application/json",schema:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}}}}}},ComAtprotoAdminDisableAccountInvites:{lexicon:1,id:"com.atproto.admin.disableAccountInvites",defs:{main:{type:"procedure",description:"Disable an account from receiving new invite codes, but does not invalidate existing codes.",input:{encoding:"application/json",schema:{type:"object",required:["account"],properties:{account:{type:"string",format:"did"},note:{type:"string",description:"Optional reason for disabled invites."}}}}}}},ComAtprotoAdminDisableInviteCodes:{lexicon:1,id:"com.atproto.admin.disableInviteCodes",defs:{main:{type:"procedure",description:"Disable some set of codes and/or all codes associated with a set of users.",input:{encoding:"application/json",schema:{type:"object",properties:{codes:{type:"array",items:{type:"string"}},accounts:{type:"array",items:{type:"string"}}}}}}}},ComAtprotoAdminEnableAccountInvites:{lexicon:1,id:"com.atproto.admin.enableAccountInvites",defs:{main:{type:"procedure",description:"Re-enable an account's ability to receive invite codes.",input:{encoding:"application/json",schema:{type:"object",required:["account"],properties:{account:{type:"string",format:"did"},note:{type:"string",description:"Optional reason for enabled invites."}}}}}}},ComAtprotoAdminGetAccountInfo:{lexicon:1,id:"com.atproto.admin.getAccountInfo",defs:{main:{type:"query",description:"Get details about an account.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did"}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:com.atproto.admin.defs#accountView"}}}}},ComAtprotoAdminGetAccountInfos:{lexicon:1,id:"com.atproto.admin.getAccountInfos",defs:{main:{type:"query",description:"Get details about some accounts.",parameters:{type:"params",required:["dids"],properties:{dids:{type:"array",items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["infos"],properties:{infos:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#accountView"}}}}}}}},ComAtprotoAdminGetInviteCodes:{lexicon:1,id:"com.atproto.admin.getInviteCodes",defs:{main:{type:"query",description:"Get an admin view of invite codes.",parameters:{type:"params",properties:{sort:{type:"string",knownValues:["recent","usage"],default:"recent"},limit:{type:"integer",minimum:1,maximum:500,default:100},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["codes"],properties:{cursor:{type:"string"},codes:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"}}}}}}}},ComAtprotoAdminGetSubjectStatus:{lexicon:1,id:"com.atproto.admin.getSubjectStatus",defs:{main:{type:"query",description:"Get the service-specific admin status of a subject (account, record, or blob).",parameters:{type:"params",properties:{did:{type:"string",format:"did"},uri:{type:"string",format:"at-uri"},blob:{type:"string",format:"cid"}}},output:{encoding:"application/json",schema:{type:"object",required:["subject"],properties:{subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef","lex:com.atproto.admin.defs#repoBlobRef"]},takedown:{type:"ref",ref:"lex:com.atproto.admin.defs#statusAttr"},deactivated:{type:"ref",ref:"lex:com.atproto.admin.defs#statusAttr"}}}}}}},ComAtprotoAdminSearchAccounts:{lexicon:1,id:"com.atproto.admin.searchAccounts",defs:{main:{type:"query",description:"Get list of accounts that matches your search query.",parameters:{type:"params",properties:{email:{type:"string"},cursor:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50}}},output:{encoding:"application/json",schema:{type:"object",required:["accounts"],properties:{cursor:{type:"string"},accounts:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#accountView"}}}}}}}},ComAtprotoAdminSendEmail:{lexicon:1,id:"com.atproto.admin.sendEmail",defs:{main:{type:"procedure",description:"Send email to a user's account email address.",input:{encoding:"application/json",schema:{type:"object",required:["recipientDid","content","senderDid"],properties:{recipientDid:{type:"string",format:"did"},content:{type:"string"},subject:{type:"string"},senderDid:{type:"string",format:"did"},comment:{type:"string",description:"Additional comment by the sender that won't be used in the email itself but helpful to provide more context for moderators/reviewers"}}}},output:{encoding:"application/json",schema:{type:"object",required:["sent"],properties:{sent:{type:"boolean"}}}}}}},ComAtprotoAdminUpdateAccountEmail:{lexicon:1,id:"com.atproto.admin.updateAccountEmail",defs:{main:{type:"procedure",description:"Administrative action to update an account's email.",input:{encoding:"application/json",schema:{type:"object",required:["account","email"],properties:{account:{type:"string",format:"at-identifier",description:"The handle or DID of the repo."},email:{type:"string"}}}}}}},ComAtprotoAdminUpdateAccountHandle:{lexicon:1,id:"com.atproto.admin.updateAccountHandle",defs:{main:{type:"procedure",description:"Administrative action to update an account's handle.",input:{encoding:"application/json",schema:{type:"object",required:["did","handle"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"}}}}}}},ComAtprotoAdminUpdateAccountPassword:{lexicon:1,id:"com.atproto.admin.updateAccountPassword",defs:{main:{type:"procedure",description:"Update the password for a user account as an administrator.",input:{encoding:"application/json",schema:{type:"object",required:["did","password"],properties:{did:{type:"string",format:"did"},password:{type:"string"}}}}}}},ComAtprotoAdminUpdateAccountSigningKey:{lexicon:1,id:"com.atproto.admin.updateAccountSigningKey",defs:{main:{type:"procedure",description:"Administrative action to update an account's signing key in their Did document.",input:{encoding:"application/json",schema:{type:"object",required:["did","signingKey"],properties:{did:{type:"string",format:"did"},signingKey:{type:"string",format:"did",description:"Did-key formatted public key"}}}}}}},ComAtprotoAdminUpdateSubjectStatus:{lexicon:1,id:"com.atproto.admin.updateSubjectStatus",defs:{main:{type:"procedure",description:"Update the service-specific admin status of a subject (account, record, or blob).",input:{encoding:"application/json",schema:{type:"object",required:["subject"],properties:{subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef","lex:com.atproto.admin.defs#repoBlobRef"]},takedown:{type:"ref",ref:"lex:com.atproto.admin.defs#statusAttr"},deactivated:{type:"ref",ref:"lex:com.atproto.admin.defs#statusAttr"}}}},output:{encoding:"application/json",schema:{type:"object",required:["subject"],properties:{subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef","lex:com.atproto.admin.defs#repoBlobRef"]},takedown:{type:"ref",ref:"lex:com.atproto.admin.defs#statusAttr"}}}}}}},ComAtprotoIdentityDefs:{lexicon:1,id:"com.atproto.identity.defs",defs:{identityInfo:{type:"object",required:["did","handle","didDoc"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle",description:"The validated handle of the account; or 'handle.invalid' if the handle did not bi-directionally match the DID document."},didDoc:{type:"unknown",description:"The complete DID document for the identity."}}}}},ComAtprotoIdentityGetRecommendedDidCredentials:{lexicon:1,id:"com.atproto.identity.getRecommendedDidCredentials",defs:{main:{type:"query",description:"Describe the credentials that should be included in the DID doc of an account that is migrating to this service.",output:{encoding:"application/json",schema:{type:"object",properties:{rotationKeys:{description:"Recommended rotation keys for PLC dids. Should be undefined (or ignored) for did:webs.",type:"array",items:{type:"string"}},alsoKnownAs:{type:"array",items:{type:"string"}},verificationMethods:{type:"unknown"},services:{type:"unknown"}}}}}}},ComAtprotoIdentityRefreshIdentity:{lexicon:1,id:"com.atproto.identity.refreshIdentity",defs:{main:{type:"procedure",description:"Request that the server re-resolve an identity (DID and handle). The server may ignore this request, or require authentication, depending on the role, implementation, and policy of the server.",input:{encoding:"application/json",schema:{type:"object",required:["identifier"],properties:{identifier:{type:"string",format:"at-identifier"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:com.atproto.identity.defs#identityInfo"}},errors:[{name:"HandleNotFound",description:"The resolution process confirmed that the handle does not resolve to any DID."},{name:"DidNotFound",description:"The DID resolution process confirmed that there is no current DID."},{name:"DidDeactivated",description:"The DID previously existed, but has been deactivated."}]}}},ComAtprotoIdentityRequestPlcOperationSignature:{lexicon:1,id:"com.atproto.identity.requestPlcOperationSignature",defs:{main:{type:"procedure",description:"Request an email with a code to in order to request a signed PLC operation. Requires Auth."}}},ComAtprotoIdentityResolveDid:{lexicon:1,id:"com.atproto.identity.resolveDid",defs:{main:{type:"query",description:"Resolves DID to DID document. Does not bi-directionally verify handle.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"DID to resolve."}}},output:{encoding:"application/json",schema:{type:"object",required:["didDoc"],properties:{didDoc:{type:"unknown",description:"The complete DID document for the identity."}}}},errors:[{name:"DidNotFound",description:"The DID resolution process confirmed that there is no current DID."},{name:"DidDeactivated",description:"The DID previously existed, but has been deactivated."}]}}},ComAtprotoIdentityResolveHandle:{lexicon:1,id:"com.atproto.identity.resolveHandle",defs:{main:{type:"query",description:"Resolves an atproto handle (hostname) to a DID. Does not necessarily bi-directionally verify against the the DID document.",parameters:{type:"params",required:["handle"],properties:{handle:{type:"string",format:"handle",description:"The handle to resolve."}}},output:{encoding:"application/json",schema:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}}},errors:[{name:"HandleNotFound",description:"The resolution process confirmed that the handle does not resolve to any DID."}]}}},ComAtprotoIdentityResolveIdentity:{lexicon:1,id:"com.atproto.identity.resolveIdentity",defs:{main:{type:"query",description:"Resolves an identity (DID or Handle) to a full identity (DID document and verified handle).",parameters:{type:"params",required:["identifier"],properties:{identifier:{type:"string",format:"at-identifier",description:"Handle or DID to resolve."}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:com.atproto.identity.defs#identityInfo"}},errors:[{name:"HandleNotFound",description:"The resolution process confirmed that the handle does not resolve to any DID."},{name:"DidNotFound",description:"The DID resolution process confirmed that there is no current DID."},{name:"DidDeactivated",description:"The DID previously existed, but has been deactivated."}]}}},ComAtprotoIdentitySignPlcOperation:{lexicon:1,id:"com.atproto.identity.signPlcOperation",defs:{main:{type:"procedure",description:"Signs a PLC operation to update some value(s) in the requesting DID's document.",input:{encoding:"application/json",schema:{type:"object",properties:{token:{description:"A token received through com.atproto.identity.requestPlcOperationSignature",type:"string"},rotationKeys:{type:"array",items:{type:"string"}},alsoKnownAs:{type:"array",items:{type:"string"}},verificationMethods:{type:"unknown"},services:{type:"unknown"}}}},output:{encoding:"application/json",schema:{type:"object",required:["operation"],properties:{operation:{type:"unknown",description:"A signed DID PLC operation."}}}}}}},ComAtprotoIdentitySubmitPlcOperation:{lexicon:1,id:"com.atproto.identity.submitPlcOperation",defs:{main:{type:"procedure",description:"Validates a PLC operation to ensure that it doesn't violate a service's constraints or get the identity into a bad state, then submits it to the PLC registry",input:{encoding:"application/json",schema:{type:"object",required:["operation"],properties:{operation:{type:"unknown"}}}}}}},ComAtprotoIdentityUpdateHandle:{lexicon:1,id:"com.atproto.identity.updateHandle",defs:{main:{type:"procedure",description:"Updates the current account's handle. Verifies handle validity, and updates did:plc document if necessary. Implemented by PDS, and requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["handle"],properties:{handle:{type:"string",format:"handle",description:"The new handle."}}}}}}},ComAtprotoLabelDefs:{lexicon:1,id:"com.atproto.label.defs",defs:{label:{type:"object",description:"Metadata tag on an atproto resource (eg, repo or record).",required:["src","uri","val","cts"],properties:{ver:{type:"integer",description:"The AT Protocol version of the label object."},src:{type:"string",format:"did",description:"DID of the actor who created this label."},uri:{type:"string",format:"uri",description:"AT URI of the record, repository (account), or other resource that this label applies to."},cid:{type:"string",format:"cid",description:"Optionally, CID specifying the specific version of 'uri' resource this label applies to."},val:{type:"string",maxLength:128,description:"The short string name of the value or type of this label."},neg:{type:"boolean",description:"If true, this is a negation label, overwriting a previous label."},cts:{type:"string",format:"datetime",description:"Timestamp when this label was created."},exp:{type:"string",format:"datetime",description:"Timestamp at which this label expires (no longer applies)."},sig:{type:"bytes",description:"Signature of dag-cbor encoded label."}}},selfLabels:{type:"object",description:"Metadata tags on an atproto record, published by the author within the record.",required:["values"],properties:{values:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#selfLabel"},maxLength:10}}},selfLabel:{type:"object",description:"Metadata tag on an atproto record, published by the author within the record. Note that schemas should use #selfLabels, not #selfLabel.",required:["val"],properties:{val:{type:"string",maxLength:128,description:"The short string name of the value or type of this label."}}},labelValueDefinition:{type:"object",description:"Declares a label value and its expected interpretations and behaviors.",required:["identifier","severity","blurs","locales"],properties:{identifier:{type:"string",description:"The value of the label being defined. Must only include lowercase ascii and the '-' character ([a-z-]+).",maxLength:100,maxGraphemes:100},severity:{type:"string",description:"How should a client visually convey this label? 'inform' means neutral and informational; 'alert' means negative and warning; 'none' means show nothing.",knownValues:["inform","alert","none"]},blurs:{type:"string",description:"What should this label hide in the UI, if applied? 'content' hides all of the target; 'media' hides the images/video/audio; 'none' hides nothing.",knownValues:["content","media","none"]},defaultSetting:{type:"string",description:"The default setting for this label.",knownValues:["ignore","warn","hide"],default:"warn"},adultOnly:{type:"boolean",description:"Does the user need to have adult content enabled in order to configure this label?"},locales:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#labelValueDefinitionStrings"}}}},labelValueDefinitionStrings:{type:"object",description:"Strings which describe the label in the UI, localized into a specific language.",required:["lang","name","description"],properties:{lang:{type:"string",description:"The code of the language these strings are written in.",format:"language"},name:{type:"string",description:"A short human-readable name for the label.",maxGraphemes:64,maxLength:640},description:{type:"string",description:"A longer description of what the label means and why it might be applied.",maxGraphemes:1e4,maxLength:1e5}}},labelValue:{type:"string",knownValues:["!hide","!no-promote","!warn","!no-unauthenticated","dmca-violation","doxxing","porn","sexual","nudity","nsfl","gore"]}}},ComAtprotoLabelQueryLabels:{lexicon:1,id:"com.atproto.label.queryLabels",defs:{main:{type:"query",description:"Find labels relevant to the provided AT-URI patterns. Public endpoint for moderation services, though may return different or additional results with auth.",parameters:{type:"params",required:["uriPatterns"],properties:{uriPatterns:{type:"array",items:{type:"string"},description:"List of AT URI patterns to match (boolean 'OR'). Each may be a prefix (ending with '*'; will match inclusive of the string leading to '*'), or a full URI."},sources:{type:"array",items:{type:"string",format:"did"},description:"Optional list of label sources (DIDs) to filter on."},limit:{type:"integer",minimum:1,maximum:250,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["labels"],properties:{cursor:{type:"string"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}}}}}}}},ComAtprotoLabelSubscribeLabels:{lexicon:1,id:"com.atproto.label.subscribeLabels",defs:{main:{type:"subscription",description:"Subscribe to stream of labels (and negations). Public endpoint implemented by mod services. Uses same sequencing scheme as repo event stream.",parameters:{type:"params",properties:{cursor:{type:"integer",description:"The last known event seq number to backfill from."}}},message:{schema:{type:"union",refs:["lex:com.atproto.label.subscribeLabels#labels","lex:com.atproto.label.subscribeLabels#info"]}},errors:[{name:"FutureCursor"}]},labels:{type:"object",required:["seq","labels"],properties:{seq:{type:"integer"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}}}},info:{type:"object",required:["name"],properties:{name:{type:"string",knownValues:["OutdatedCursor"]},message:{type:"string"}}}}},ComAtprotoLexiconSchema:{lexicon:1,id:"com.atproto.lexicon.schema",defs:{main:{type:"record",description:"Representation of Lexicon schemas themselves, when published as atproto records. Note that the schema language is not defined in Lexicon; this meta schema currently only includes a single version field ('lexicon'). See the atproto specifications for description of the other expected top-level fields ('id', 'defs', etc).",key:"nsid",record:{type:"object",required:["lexicon"],properties:{lexicon:{type:"integer",description:"Indicates the 'version' of the Lexicon language. Must be '1' for the current atproto/Lexicon schema system."}}}}}},ComAtprotoModerationCreateReport:{lexicon:1,id:"com.atproto.moderation.createReport",defs:{main:{type:"procedure",description:"Submit a moderation report regarding an atproto account or record. Implemented by moderation services (with PDS proxying), and requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["reasonType","subject"],properties:{reasonType:{type:"ref",description:"Indicates the broad category of violation the report is for.",ref:"lex:com.atproto.moderation.defs#reasonType"},reason:{type:"string",maxGraphemes:2e3,maxLength:2e4,description:"Additional context about the content and violation."},subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef"]},modTool:{type:"ref",ref:"lex:com.atproto.moderation.createReport#modTool"}}}},output:{encoding:"application/json",schema:{type:"object",required:["id","reasonType","subject","reportedBy","createdAt"],properties:{id:{type:"integer"},reasonType:{type:"ref",ref:"lex:com.atproto.moderation.defs#reasonType"},reason:{type:"string",maxGraphemes:2e3,maxLength:2e4},subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef"]},reportedBy:{type:"string",format:"did"},createdAt:{type:"string",format:"datetime"}}}}},modTool:{type:"object",description:"Moderation tool information for tracing the source of the action",required:["name"],properties:{name:{type:"string",description:"Name/identifier of the source (e.g., 'bsky-app/android', 'bsky-web/chrome')"},meta:{type:"unknown",description:"Additional arbitrary metadata about the source"}}}}},ComAtprotoModerationDefs:{lexicon:1,id:"com.atproto.moderation.defs",defs:{reasonType:{type:"string",knownValues:["com.atproto.moderation.defs#reasonSpam","com.atproto.moderation.defs#reasonViolation","com.atproto.moderation.defs#reasonMisleading","com.atproto.moderation.defs#reasonSexual","com.atproto.moderation.defs#reasonRude","com.atproto.moderation.defs#reasonOther","com.atproto.moderation.defs#reasonAppeal","tools.ozone.report.defs#reasonAppeal","tools.ozone.report.defs#reasonOther","tools.ozone.report.defs#reasonViolenceAnimal","tools.ozone.report.defs#reasonViolenceThreats","tools.ozone.report.defs#reasonViolenceGraphicContent","tools.ozone.report.defs#reasonViolenceGlorification","tools.ozone.report.defs#reasonViolenceExtremistContent","tools.ozone.report.defs#reasonViolenceTrafficking","tools.ozone.report.defs#reasonViolenceOther","tools.ozone.report.defs#reasonSexualAbuseContent","tools.ozone.report.defs#reasonSexualNCII","tools.ozone.report.defs#reasonSexualDeepfake","tools.ozone.report.defs#reasonSexualAnimal","tools.ozone.report.defs#reasonSexualUnlabeled","tools.ozone.report.defs#reasonSexualOther","tools.ozone.report.defs#reasonChildSafetyCSAM","tools.ozone.report.defs#reasonChildSafetyGroom","tools.ozone.report.defs#reasonChildSafetyPrivacy","tools.ozone.report.defs#reasonChildSafetyHarassment","tools.ozone.report.defs#reasonChildSafetyOther","tools.ozone.report.defs#reasonHarassmentTroll","tools.ozone.report.defs#reasonHarassmentTargeted","tools.ozone.report.defs#reasonHarassmentHateSpeech","tools.ozone.report.defs#reasonHarassmentDoxxing","tools.ozone.report.defs#reasonHarassmentOther","tools.ozone.report.defs#reasonMisleadingBot","tools.ozone.report.defs#reasonMisleadingImpersonation","tools.ozone.report.defs#reasonMisleadingSpam","tools.ozone.report.defs#reasonMisleadingScam","tools.ozone.report.defs#reasonMisleadingElections","tools.ozone.report.defs#reasonMisleadingOther","tools.ozone.report.defs#reasonRuleSiteSecurity","tools.ozone.report.defs#reasonRuleProhibitedSales","tools.ozone.report.defs#reasonRuleBanEvasion","tools.ozone.report.defs#reasonRuleOther","tools.ozone.report.defs#reasonSelfHarmContent","tools.ozone.report.defs#reasonSelfHarmED","tools.ozone.report.defs#reasonSelfHarmStunts","tools.ozone.report.defs#reasonSelfHarmSubstances","tools.ozone.report.defs#reasonSelfHarmOther"]},reasonSpam:{type:"token",description:"Spam: frequent unwanted promotion, replies, mentions. Prefer new lexicon definition `tools.ozone.report.defs#reasonMisleadingSpam`."},reasonViolation:{type:"token",description:"Direct violation of server rules, laws, terms of service. Prefer new lexicon definition `tools.ozone.report.defs#reasonRuleOther`."},reasonMisleading:{type:"token",description:"Misleading identity, affiliation, or content. Prefer new lexicon definition `tools.ozone.report.defs#reasonMisleadingOther`."},reasonSexual:{type:"token",description:"Unwanted or mislabeled sexual content. Prefer new lexicon definition `tools.ozone.report.defs#reasonSexualUnlabeled`."},reasonRude:{type:"token",description:"Rude, harassing, explicit, or otherwise unwelcoming behavior. Prefer new lexicon definition `tools.ozone.report.defs#reasonHarassmentOther`."},reasonOther:{type:"token",description:"Reports not falling under another report category. Prefer new lexicon definition `tools.ozone.report.defs#reasonOther`."},reasonAppeal:{type:"token",description:"Appeal a previously taken moderation action"},subjectType:{type:"string",description:"Tag describing a type of subject that might be reported.",knownValues:["account","record","chat"]}}},ComAtprotoRepoApplyWrites:{lexicon:1,id:"com.atproto.repo.applyWrites",defs:{main:{type:"procedure",description:"Apply a batch transaction of repository creates, updates, and deletes. Requires auth, implemented by PDS.",input:{encoding:"application/json",schema:{type:"object",required:["repo","writes"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo (aka, current account)."},validate:{type:"boolean",description:"Can be set to 'false' to skip Lexicon schema validation of record data across all operations, 'true' to require it, or leave unset to validate only for known Lexicons."},writes:{type:"array",items:{type:"union",refs:["lex:com.atproto.repo.applyWrites#create","lex:com.atproto.repo.applyWrites#update","lex:com.atproto.repo.applyWrites#delete"],closed:!0}},swapCommit:{type:"string",description:"If provided, the entire operation will fail if the current repo commit CID does not match this value. Used to prevent conflicting repo mutations.",format:"cid"}}}},output:{encoding:"application/json",schema:{type:"object",required:[],properties:{commit:{type:"ref",ref:"lex:com.atproto.repo.defs#commitMeta"},results:{type:"array",items:{type:"union",refs:["lex:com.atproto.repo.applyWrites#createResult","lex:com.atproto.repo.applyWrites#updateResult","lex:com.atproto.repo.applyWrites#deleteResult"],closed:!0}}}}},errors:[{name:"InvalidSwap",description:"Indicates that the 'swapCommit' parameter did not match current commit."}]},create:{type:"object",description:"Operation which creates a new record.",required:["collection","value"],properties:{collection:{type:"string",format:"nsid"},rkey:{type:"string",maxLength:512,format:"record-key",description:"NOTE: maxLength is redundant with record-key format. Keeping it temporarily to ensure backwards compatibility."},value:{type:"unknown"}}},update:{type:"object",description:"Operation which updates an existing record.",required:["collection","rkey","value"],properties:{collection:{type:"string",format:"nsid"},rkey:{type:"string",format:"record-key"},value:{type:"unknown"}}},delete:{type:"object",description:"Operation which deletes an existing record.",required:["collection","rkey"],properties:{collection:{type:"string",format:"nsid"},rkey:{type:"string",format:"record-key"}}},createResult:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},validationStatus:{type:"string",knownValues:["valid","unknown"]}}},updateResult:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},validationStatus:{type:"string",knownValues:["valid","unknown"]}}},deleteResult:{type:"object",required:[],properties:{}}}},ComAtprotoRepoCreateRecord:{lexicon:1,id:"com.atproto.repo.createRecord",defs:{main:{type:"procedure",description:"Create a single new repository record. Requires auth, implemented by PDS.",input:{encoding:"application/json",schema:{type:"object",required:["repo","collection","record"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo (aka, current account)."},collection:{type:"string",format:"nsid",description:"The NSID of the record collection."},rkey:{type:"string",format:"record-key",description:"The Record Key.",maxLength:512},validate:{type:"boolean",description:"Can be set to 'false' to skip Lexicon schema validation of record data, 'true' to require it, or leave unset to validate only for known Lexicons."},record:{type:"unknown",description:"The record itself. Must contain a $type field."},swapCommit:{type:"string",format:"cid",description:"Compare and swap with the previous commit by CID."}}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},commit:{type:"ref",ref:"lex:com.atproto.repo.defs#commitMeta"},validationStatus:{type:"string",knownValues:["valid","unknown"]}}}},errors:[{name:"InvalidSwap",description:"Indicates that 'swapCommit' didn't match current repo commit."}]}}},ComAtprotoRepoDefs:{lexicon:1,id:"com.atproto.repo.defs",defs:{commitMeta:{type:"object",required:["cid","rev"],properties:{cid:{type:"string",format:"cid"},rev:{type:"string",format:"tid"}}}}},ComAtprotoRepoDeleteRecord:{lexicon:1,id:"com.atproto.repo.deleteRecord",defs:{main:{type:"procedure",description:"Delete a repository record, or ensure it doesn't exist. Requires auth, implemented by PDS.",input:{encoding:"application/json",schema:{type:"object",required:["repo","collection","rkey"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo (aka, current account)."},collection:{type:"string",format:"nsid",description:"The NSID of the record collection."},rkey:{type:"string",format:"record-key",description:"The Record Key."},swapRecord:{type:"string",format:"cid",description:"Compare and swap with the previous record by CID."},swapCommit:{type:"string",format:"cid",description:"Compare and swap with the previous commit by CID."}}}},output:{encoding:"application/json",schema:{type:"object",properties:{commit:{type:"ref",ref:"lex:com.atproto.repo.defs#commitMeta"}}}},errors:[{name:"InvalidSwap"}]}}},ComAtprotoRepoDescribeRepo:{lexicon:1,id:"com.atproto.repo.describeRepo",defs:{main:{type:"query",description:"Get information about an account and repository, including the list of collections. Does not require auth.",parameters:{type:"params",required:["repo"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo."}}},output:{encoding:"application/json",schema:{type:"object",required:["handle","did","didDoc","collections","handleIsCorrect"],properties:{handle:{type:"string",format:"handle"},did:{type:"string",format:"did"},didDoc:{type:"unknown",description:"The complete DID document for this account."},collections:{type:"array",description:"List of all the collections (NSIDs) for which this repo contains at least one record.",items:{type:"string",format:"nsid"}},handleIsCorrect:{type:"boolean",description:"Indicates if handle is currently valid (resolves bi-directionally)"}}}}}}},ComAtprotoRepoGetRecord:{lexicon:1,id:"com.atproto.repo.getRecord",defs:{main:{type:"query",description:"Get a single record from a repository. Does not require auth.",parameters:{type:"params",required:["repo","collection","rkey"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo."},collection:{type:"string",format:"nsid",description:"The NSID of the record collection."},rkey:{type:"string",description:"The Record Key.",format:"record-key"},cid:{type:"string",format:"cid",description:"The CID of the version of the record. If not specified, then return the most recent version."}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","value"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},value:{type:"unknown"}}}},errors:[{name:"RecordNotFound"}]}}},ComAtprotoRepoImportRepo:{lexicon:1,id:"com.atproto.repo.importRepo",defs:{main:{type:"procedure",description:"Import a repo in the form of a CAR file. Requires Content-Length HTTP header to be set.",input:{encoding:"application/vnd.ipld.car"}}}},ComAtprotoRepoListMissingBlobs:{lexicon:1,id:"com.atproto.repo.listMissingBlobs",defs:{main:{type:"query",description:"Returns a list of missing blobs for the requesting account. Intended to be used in the account migration flow.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:1e3,default:500},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["blobs"],properties:{cursor:{type:"string"},blobs:{type:"array",items:{type:"ref",ref:"lex:com.atproto.repo.listMissingBlobs#recordBlob"}}}}}},recordBlob:{type:"object",required:["cid","recordUri"],properties:{cid:{type:"string",format:"cid"},recordUri:{type:"string",format:"at-uri"}}}}},ComAtprotoRepoListRecords:{lexicon:1,id:"com.atproto.repo.listRecords",defs:{main:{type:"query",description:"List a range of records in a repository, matching a specific collection. Does not require auth.",parameters:{type:"params",required:["repo","collection"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo."},collection:{type:"string",format:"nsid",description:"The NSID of the record type."},limit:{type:"integer",minimum:1,maximum:100,default:50,description:"The number of records to return."},cursor:{type:"string"},reverse:{type:"boolean",description:"Flag to reverse the order of the returned records."}}},output:{encoding:"application/json",schema:{type:"object",required:["records"],properties:{cursor:{type:"string"},records:{type:"array",items:{type:"ref",ref:"lex:com.atproto.repo.listRecords#record"}}}}}},record:{type:"object",required:["uri","cid","value"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},value:{type:"unknown"}}}}},ComAtprotoRepoPutRecord:{lexicon:1,id:"com.atproto.repo.putRecord",defs:{main:{type:"procedure",description:"Write a repository record, creating or updating it as needed. Requires auth, implemented by PDS.",input:{encoding:"application/json",schema:{type:"object",required:["repo","collection","rkey","record"],nullable:["swapRecord"],properties:{repo:{type:"string",format:"at-identifier",description:"The handle or DID of the repo (aka, current account)."},collection:{type:"string",format:"nsid",description:"The NSID of the record collection."},rkey:{type:"string",format:"record-key",description:"The Record Key.",maxLength:512},validate:{type:"boolean",description:"Can be set to 'false' to skip Lexicon schema validation of record data, 'true' to require it, or leave unset to validate only for known Lexicons."},record:{type:"unknown",description:"The record to write."},swapRecord:{type:"string",format:"cid",description:"Compare and swap with the previous record by CID. WARNING: nullable and optional field; may cause problems with golang implementation"},swapCommit:{type:"string",format:"cid",description:"Compare and swap with the previous commit by CID."}}}},output:{encoding:"application/json",schema:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},commit:{type:"ref",ref:"lex:com.atproto.repo.defs#commitMeta"},validationStatus:{type:"string",knownValues:["valid","unknown"]}}}},errors:[{name:"InvalidSwap"}]}}},ComAtprotoRepoStrongRef:{lexicon:1,id:"com.atproto.repo.strongRef",description:"A URI with a content-hash fingerprint.",defs:{main:{type:"object",required:["uri","cid"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"}}}}},ComAtprotoRepoUploadBlob:{lexicon:1,id:"com.atproto.repo.uploadBlob",defs:{main:{type:"procedure",description:"Upload a new blob, to be referenced from a repository record. The blob will be deleted if it is not referenced within a time window (eg, minutes). Blob restrictions (mimetype, size, etc) are enforced when the reference is created. Requires auth, implemented by PDS.",input:{encoding:"*/*"},output:{encoding:"application/json",schema:{type:"object",required:["blob"],properties:{blob:{type:"blob"}}}}}}},ComAtprotoServerActivateAccount:{lexicon:1,id:"com.atproto.server.activateAccount",defs:{main:{type:"procedure",description:"Activates a currently deactivated account. Used to finalize account migration after the account's repo is imported and identity is setup."}}},ComAtprotoServerCheckAccountStatus:{lexicon:1,id:"com.atproto.server.checkAccountStatus",defs:{main:{type:"query",description:"Returns the status of an account, especially as pertaining to import or recovery. Can be called many times over the course of an account migration. Requires auth and can only be called pertaining to oneself.",output:{encoding:"application/json",schema:{type:"object",required:["activated","validDid","repoCommit","repoRev","repoBlocks","indexedRecords","privateStateValues","expectedBlobs","importedBlobs"],properties:{activated:{type:"boolean"},validDid:{type:"boolean"},repoCommit:{type:"string",format:"cid"},repoRev:{type:"string"},repoBlocks:{type:"integer"},indexedRecords:{type:"integer"},privateStateValues:{type:"integer"},expectedBlobs:{type:"integer"},importedBlobs:{type:"integer"}}}}}}},ComAtprotoServerConfirmEmail:{lexicon:1,id:"com.atproto.server.confirmEmail",defs:{main:{type:"procedure",description:"Confirm an email using a token from com.atproto.server.requestEmailConfirmation.",input:{encoding:"application/json",schema:{type:"object",required:["email","token"],properties:{email:{type:"string"},token:{type:"string"}}}},errors:[{name:"AccountNotFound"},{name:"ExpiredToken"},{name:"InvalidToken"},{name:"InvalidEmail"}]}}},ComAtprotoServerCreateAccount:{lexicon:1,id:"com.atproto.server.createAccount",defs:{main:{type:"procedure",description:"Create an account. Implemented by PDS.",input:{encoding:"application/json",schema:{type:"object",required:["handle"],properties:{email:{type:"string"},handle:{type:"string",format:"handle",description:"Requested handle for the account."},did:{type:"string",format:"did",description:"Pre-existing atproto DID, being imported to a new account."},inviteCode:{type:"string"},verificationCode:{type:"string"},verificationPhone:{type:"string"},password:{type:"string",description:"Initial account password. May need to meet instance-specific password strength requirements."},recoveryKey:{type:"string",description:"DID PLC rotation key (aka, recovery key) to be included in PLC creation operation."},plcOp:{type:"unknown",description:"A signed DID PLC operation to be submitted as part of importing an existing account to this instance. NOTE: this optional field may be updated when full account migration is implemented."}}}},output:{encoding:"application/json",schema:{type:"object",description:"Account login session returned on successful account creation.",required:["accessJwt","refreshJwt","handle","did"],properties:{accessJwt:{type:"string"},refreshJwt:{type:"string"},handle:{type:"string",format:"handle"},did:{type:"string",format:"did",description:"The DID of the new account."},didDoc:{type:"unknown",description:"Complete DID document."}}}},errors:[{name:"InvalidHandle"},{name:"InvalidPassword"},{name:"InvalidInviteCode"},{name:"HandleNotAvailable"},{name:"UnsupportedDomain"},{name:"UnresolvableDid"},{name:"IncompatibleDidDoc"}]}}},ComAtprotoServerCreateAppPassword:{lexicon:1,id:"com.atproto.server.createAppPassword",defs:{main:{type:"procedure",description:"Create an App Password.",input:{encoding:"application/json",schema:{type:"object",required:["name"],properties:{name:{type:"string",description:"A short name for the App Password, to help distinguish them."},privileged:{type:"boolean",description:"If an app password has 'privileged' access to possibly sensitive account state. Meant for use with trusted clients."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:com.atproto.server.createAppPassword#appPassword"}},errors:[{name:"AccountTakedown"}]},appPassword:{type:"object",required:["name","password","createdAt"],properties:{name:{type:"string"},password:{type:"string"},createdAt:{type:"string",format:"datetime"},privileged:{type:"boolean"}}}}},ComAtprotoServerCreateInviteCode:{lexicon:1,id:"com.atproto.server.createInviteCode",defs:{main:{type:"procedure",description:"Create an invite code.",input:{encoding:"application/json",schema:{type:"object",required:["useCount"],properties:{useCount:{type:"integer"},forAccount:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["code"],properties:{code:{type:"string"}}}}}}},ComAtprotoServerCreateInviteCodes:{lexicon:1,id:"com.atproto.server.createInviteCodes",defs:{main:{type:"procedure",description:"Create invite codes.",input:{encoding:"application/json",schema:{type:"object",required:["codeCount","useCount"],properties:{codeCount:{type:"integer",default:1},useCount:{type:"integer"},forAccounts:{type:"array",items:{type:"string",format:"did"}}}}},output:{encoding:"application/json",schema:{type:"object",required:["codes"],properties:{codes:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.createInviteCodes#accountCodes"}}}}}},accountCodes:{type:"object",required:["account","codes"],properties:{account:{type:"string"},codes:{type:"array",items:{type:"string"}}}}}},ComAtprotoServerCreateSession:{lexicon:1,id:"com.atproto.server.createSession",defs:{main:{type:"procedure",description:"Create an authentication session.",input:{encoding:"application/json",schema:{type:"object",required:["identifier","password"],properties:{identifier:{type:"string",description:"Handle or other identifier supported by the server for the authenticating user."},password:{type:"string"},authFactorToken:{type:"string"},allowTakendown:{type:"boolean",description:"When true, instead of throwing error for takendown accounts, a valid response with a narrow scoped token will be returned"}}}},output:{encoding:"application/json",schema:{type:"object",required:["accessJwt","refreshJwt","handle","did"],properties:{accessJwt:{type:"string"},refreshJwt:{type:"string"},handle:{type:"string",format:"handle"},did:{type:"string",format:"did"},didDoc:{type:"unknown"},email:{type:"string"},emailConfirmed:{type:"boolean"},emailAuthFactor:{type:"boolean"},active:{type:"boolean"},status:{type:"string",description:"If active=false, this optional field indicates a possible reason for why the account is not active. If active=false and no status is supplied, then the host makes no claim for why the repository is no longer being hosted.",knownValues:["takendown","suspended","deactivated"]}}}},errors:[{name:"AccountTakedown"},{name:"AuthFactorTokenRequired"}]}}},ComAtprotoServerDeactivateAccount:{lexicon:1,id:"com.atproto.server.deactivateAccount",defs:{main:{type:"procedure",description:"Deactivates a currently active account. Stops serving of repo, and future writes to repo until reactivated. Used to finalize account migration with the old host after the account has been activated on the new host.",input:{encoding:"application/json",schema:{type:"object",properties:{deleteAfter:{type:"string",format:"datetime",description:"A recommendation to server as to how long they should hold onto the deactivated account before deleting."}}}}}}},ComAtprotoServerDefs:{lexicon:1,id:"com.atproto.server.defs",defs:{inviteCode:{type:"object",required:["code","available","disabled","forAccount","createdBy","createdAt","uses"],properties:{code:{type:"string"},available:{type:"integer"},disabled:{type:"boolean"},forAccount:{type:"string"},createdBy:{type:"string"},createdAt:{type:"string",format:"datetime"},uses:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCodeUse"}}}},inviteCodeUse:{type:"object",required:["usedBy","usedAt"],properties:{usedBy:{type:"string",format:"did"},usedAt:{type:"string",format:"datetime"}}}}},ComAtprotoServerDeleteAccount:{lexicon:1,id:"com.atproto.server.deleteAccount",defs:{main:{type:"procedure",description:"Delete an actor's account with a token and password. Can only be called after requesting a deletion token. Requires auth.",input:{encoding:"application/json",schema:{type:"object",required:["did","password","token"],properties:{did:{type:"string",format:"did"},password:{type:"string"},token:{type:"string"}}}},errors:[{name:"ExpiredToken"},{name:"InvalidToken"}]}}},ComAtprotoServerDeleteSession:{lexicon:1,id:"com.atproto.server.deleteSession",defs:{main:{type:"procedure",description:"Delete the current session. Requires auth."}}},ComAtprotoServerDescribeServer:{lexicon:1,id:"com.atproto.server.describeServer",defs:{main:{type:"query",description:"Describes the server's account creation requirements and capabilities. Implemented by PDS.",output:{encoding:"application/json",schema:{type:"object",required:["did","availableUserDomains"],properties:{inviteCodeRequired:{type:"boolean",description:"If true, an invite code must be supplied to create an account on this instance."},phoneVerificationRequired:{type:"boolean",description:"If true, a phone verification token must be supplied to create an account on this instance."},availableUserDomains:{type:"array",description:"List of domain suffixes that can be used in account handles.",items:{type:"string"}},links:{type:"ref",description:"URLs of service policy documents.",ref:"lex:com.atproto.server.describeServer#links"},contact:{type:"ref",description:"Contact information",ref:"lex:com.atproto.server.describeServer#contact"},did:{type:"string",format:"did"}}}}},links:{type:"object",properties:{privacyPolicy:{type:"string",format:"uri"},termsOfService:{type:"string",format:"uri"}}},contact:{type:"object",properties:{email:{type:"string"}}}}},ComAtprotoServerGetAccountInviteCodes:{lexicon:1,id:"com.atproto.server.getAccountInviteCodes",defs:{main:{type:"query",description:"Get all invite codes for the current account. Requires auth.",parameters:{type:"params",properties:{includeUsed:{type:"boolean",default:!0},createAvailable:{type:"boolean",default:!0,description:"Controls whether any new 'earned' but not 'created' invites should be created."}}},output:{encoding:"application/json",schema:{type:"object",required:["codes"],properties:{codes:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"}}}}},errors:[{name:"DuplicateCreate"}]}}},ComAtprotoServerGetServiceAuth:{lexicon:1,id:"com.atproto.server.getServiceAuth",defs:{main:{type:"query",description:"Get a signed token on behalf of the requesting DID for the requested service.",parameters:{type:"params",required:["aud"],properties:{aud:{type:"string",format:"did",description:"The DID of the service that the token will be used to authenticate with"},exp:{type:"integer",description:"The time in Unix Epoch seconds that the JWT expires. Defaults to 60 seconds in the future. The service may enforce certain time bounds on tokens depending on the requested scope."},lxm:{type:"string",format:"nsid",description:"Lexicon (XRPC) method to bind the requested token to"}}},output:{encoding:"application/json",schema:{type:"object",required:["token"],properties:{token:{type:"string"}}}},errors:[{name:"BadExpiration",description:"Indicates that the requested expiration date is not a valid. May be in the past or may be reliant on the requested scopes."}]}}},ComAtprotoServerGetSession:{lexicon:1,id:"com.atproto.server.getSession",defs:{main:{type:"query",description:"Get information about the current auth session. Requires auth.",output:{encoding:"application/json",schema:{type:"object",required:["handle","did"],properties:{handle:{type:"string",format:"handle"},did:{type:"string",format:"did"},email:{type:"string"},emailConfirmed:{type:"boolean"},emailAuthFactor:{type:"boolean"},didDoc:{type:"unknown"},active:{type:"boolean"},status:{type:"string",description:"If active=false, this optional field indicates a possible reason for why the account is not active. If active=false and no status is supplied, then the host makes no claim for why the repository is no longer being hosted.",knownValues:["takendown","suspended","deactivated"]}}}}}}},ComAtprotoServerListAppPasswords:{lexicon:1,id:"com.atproto.server.listAppPasswords",defs:{main:{type:"query",description:"List all App Passwords.",output:{encoding:"application/json",schema:{type:"object",required:["passwords"],properties:{passwords:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.listAppPasswords#appPassword"}}}}},errors:[{name:"AccountTakedown"}]},appPassword:{type:"object",required:["name","createdAt"],properties:{name:{type:"string"},createdAt:{type:"string",format:"datetime"},privileged:{type:"boolean"}}}}},ComAtprotoServerRefreshSession:{lexicon:1,id:"com.atproto.server.refreshSession",defs:{main:{type:"procedure",description:"Refresh an authentication session. Requires auth using the 'refreshJwt' (not the 'accessJwt').",output:{encoding:"application/json",schema:{type:"object",required:["accessJwt","refreshJwt","handle","did"],properties:{accessJwt:{type:"string"},refreshJwt:{type:"string"},handle:{type:"string",format:"handle"},did:{type:"string",format:"did"},didDoc:{type:"unknown"},active:{type:"boolean"},status:{type:"string",description:"Hosting status of the account. If not specified, then assume 'active'.",knownValues:["takendown","suspended","deactivated"]}}}},errors:[{name:"AccountTakedown"}]}}},ComAtprotoServerRequestAccountDelete:{lexicon:1,id:"com.atproto.server.requestAccountDelete",defs:{main:{type:"procedure",description:"Initiate a user account deletion via email."}}},ComAtprotoServerRequestEmailConfirmation:{lexicon:1,id:"com.atproto.server.requestEmailConfirmation",defs:{main:{type:"procedure",description:"Request an email with a code to confirm ownership of email."}}},ComAtprotoServerRequestEmailUpdate:{lexicon:1,id:"com.atproto.server.requestEmailUpdate",defs:{main:{type:"procedure",description:"Request a token in order to update email.",output:{encoding:"application/json",schema:{type:"object",required:["tokenRequired"],properties:{tokenRequired:{type:"boolean"}}}}}}},ComAtprotoServerRequestPasswordReset:{lexicon:1,id:"com.atproto.server.requestPasswordReset",defs:{main:{type:"procedure",description:"Initiate a user account password reset via email.",input:{encoding:"application/json",schema:{type:"object",required:["email"],properties:{email:{type:"string"}}}}}}},ComAtprotoServerReserveSigningKey:{lexicon:1,id:"com.atproto.server.reserveSigningKey",defs:{main:{type:"procedure",description:"Reserve a repo signing key, for use with account creation. Necessary so that a DID PLC update operation can be constructed during an account migraiton. Public and does not require auth; implemented by PDS. NOTE: this endpoint may change when full account migration is implemented.",input:{encoding:"application/json",schema:{type:"object",properties:{did:{type:"string",format:"did",description:"The DID to reserve a key for."}}}},output:{encoding:"application/json",schema:{type:"object",required:["signingKey"],properties:{signingKey:{type:"string",description:"The public key for the reserved signing key, in did:key serialization."}}}}}}},ComAtprotoServerResetPassword:{lexicon:1,id:"com.atproto.server.resetPassword",defs:{main:{type:"procedure",description:"Reset a user account password using a token.",input:{encoding:"application/json",schema:{type:"object",required:["token","password"],properties:{token:{type:"string"},password:{type:"string"}}}},errors:[{name:"ExpiredToken"},{name:"InvalidToken"}]}}},ComAtprotoServerRevokeAppPassword:{lexicon:1,id:"com.atproto.server.revokeAppPassword",defs:{main:{type:"procedure",description:"Revoke an App Password by name.",input:{encoding:"application/json",schema:{type:"object",required:["name"],properties:{name:{type:"string"}}}}}}},ComAtprotoServerUpdateEmail:{lexicon:1,id:"com.atproto.server.updateEmail",defs:{main:{type:"procedure",description:"Update an account's email.",input:{encoding:"application/json",schema:{type:"object",required:["email"],properties:{email:{type:"string"},emailAuthFactor:{type:"boolean"},token:{type:"string",description:"Requires a token from com.atproto.sever.requestEmailUpdate if the account's email has been confirmed."}}}},errors:[{name:"ExpiredToken"},{name:"InvalidToken"},{name:"TokenRequired"}]}}},ComAtprotoSyncDefs:{lexicon:1,id:"com.atproto.sync.defs",defs:{hostStatus:{type:"string",knownValues:["active","idle","offline","throttled","banned"]}}},ComAtprotoSyncGetBlob:{lexicon:1,id:"com.atproto.sync.getBlob",defs:{main:{type:"query",description:"Get a blob associated with a given account. Returns the full blob as originally uploaded. Does not require auth; implemented by PDS.",parameters:{type:"params",required:["did","cid"],properties:{did:{type:"string",format:"did",description:"The DID of the account."},cid:{type:"string",format:"cid",description:"The CID of the blob to fetch"}}},output:{encoding:"*/*"},errors:[{name:"BlobNotFound"},{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncGetBlocks:{lexicon:1,id:"com.atproto.sync.getBlocks",defs:{main:{type:"query",description:"Get data blocks from a given repo, by CID. For example, intermediate MST nodes, or records. Does not require auth; implemented by PDS.",parameters:{type:"params",required:["did","cids"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."},cids:{type:"array",items:{type:"string",format:"cid"}}}},output:{encoding:"application/vnd.ipld.car"},errors:[{name:"BlockNotFound"},{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncGetCheckout:{lexicon:1,id:"com.atproto.sync.getCheckout",defs:{main:{type:"query",description:"DEPRECATED - please use com.atproto.sync.getRepo instead",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."}}},output:{encoding:"application/vnd.ipld.car"}}}},ComAtprotoSyncGetHead:{lexicon:1,id:"com.atproto.sync.getHead",defs:{main:{type:"query",description:"DEPRECATED - please use com.atproto.sync.getLatestCommit instead",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."}}},output:{encoding:"application/json",schema:{type:"object",required:["root"],properties:{root:{type:"string",format:"cid"}}}},errors:[{name:"HeadNotFound"}]}}},ComAtprotoSyncGetHostStatus:{lexicon:1,id:"com.atproto.sync.getHostStatus",defs:{main:{type:"query",description:"Returns information about a specified upstream host, as consumed by the server. Implemented by relays.",parameters:{type:"params",required:["hostname"],properties:{hostname:{type:"string",description:"Hostname of the host (eg, PDS or relay) being queried."}}},output:{encoding:"application/json",schema:{type:"object",required:["hostname"],properties:{hostname:{type:"string"},seq:{type:"integer",description:"Recent repo stream event sequence number. May be delayed from actual stream processing (eg, persisted cursor not in-memory cursor)."},accountCount:{type:"integer",description:"Number of accounts on the server which are associated with the upstream host. Note that the upstream may actually have more accounts."},status:{type:"ref",ref:"lex:com.atproto.sync.defs#hostStatus"}}}},errors:[{name:"HostNotFound"}]}}},ComAtprotoSyncGetLatestCommit:{lexicon:1,id:"com.atproto.sync.getLatestCommit",defs:{main:{type:"query",description:"Get the current commit CID & revision of the specified repo. Does not require auth.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."}}},output:{encoding:"application/json",schema:{type:"object",required:["cid","rev"],properties:{cid:{type:"string",format:"cid"},rev:{type:"string",format:"tid"}}}},errors:[{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncGetRecord:{lexicon:1,id:"com.atproto.sync.getRecord",defs:{main:{type:"query",description:"Get data blocks needed to prove the existence or non-existence of record in the current version of repo. Does not require auth.",parameters:{type:"params",required:["did","collection","rkey"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."},collection:{type:"string",format:"nsid"},rkey:{type:"string",description:"Record Key",format:"record-key"}}},output:{encoding:"application/vnd.ipld.car"},errors:[{name:"RecordNotFound"},{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncGetRepo:{lexicon:1,id:"com.atproto.sync.getRepo",defs:{main:{type:"query",description:"Download a repository export as CAR file. Optionally only a 'diff' since a previous revision. Does not require auth; implemented by PDS.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."},since:{type:"string",format:"tid",description:"The revision ('rev') of the repo to create a diff from."}}},output:{encoding:"application/vnd.ipld.car"},errors:[{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncGetRepoStatus:{lexicon:1,id:"com.atproto.sync.getRepoStatus",defs:{main:{type:"query",description:"Get the hosting status for a repository, on this server. Expected to be implemented by PDS and Relay.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."}}},output:{encoding:"application/json",schema:{type:"object",required:["did","active"],properties:{did:{type:"string",format:"did"},active:{type:"boolean"},status:{type:"string",description:"If active=false, this optional field indicates a possible reason for why the account is not active. If active=false and no status is supplied, then the host makes no claim for why the repository is no longer being hosted.",knownValues:["takendown","suspended","deleted","deactivated","desynchronized","throttled"]},rev:{type:"string",format:"tid",description:"Optional field, the current rev of the repo, if active=true"}}}},errors:[{name:"RepoNotFound"}]}}},ComAtprotoSyncListBlobs:{lexicon:1,id:"com.atproto.sync.listBlobs",defs:{main:{type:"query",description:"List blob CIDs for an account, since some repo revision. Does not require auth; implemented by PDS.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did",description:"The DID of the repo."},since:{type:"string",format:"tid",description:"Optional revision of the repo to list blobs since."},limit:{type:"integer",minimum:1,maximum:1e3,default:500},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["cids"],properties:{cursor:{type:"string"},cids:{type:"array",items:{type:"string",format:"cid"}}}}},errors:[{name:"RepoNotFound"},{name:"RepoTakendown"},{name:"RepoSuspended"},{name:"RepoDeactivated"}]}}},ComAtprotoSyncListHosts:{lexicon:1,id:"com.atproto.sync.listHosts",defs:{main:{type:"query",description:"Enumerates upstream hosts (eg, PDS or relay instances) that this service consumes from. Implemented by relays.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:1e3,default:200},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["hosts"],properties:{cursor:{type:"string"},hosts:{type:"array",items:{type:"ref",ref:"lex:com.atproto.sync.listHosts#host"},description:"Sort order is not formally specified. Recommended order is by time host was first seen by the server, with oldest first."}}}}},host:{type:"object",required:["hostname"],properties:{hostname:{type:"string",description:"hostname of server; not a URL (no scheme)"},seq:{type:"integer",description:"Recent repo stream event sequence number. May be delayed from actual stream processing (eg, persisted cursor not in-memory cursor)."},accountCount:{type:"integer"},status:{type:"ref",ref:"lex:com.atproto.sync.defs#hostStatus"}}}}},ComAtprotoSyncListRepos:{lexicon:1,id:"com.atproto.sync.listRepos",defs:{main:{type:"query",description:"Enumerates all the DID, rev, and commit CID for all repos hosted by this service. Does not require auth; implemented by PDS and Relay.",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:1e3,default:500},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["repos"],properties:{cursor:{type:"string"},repos:{type:"array",items:{type:"ref",ref:"lex:com.atproto.sync.listRepos#repo"}}}}}},repo:{type:"object",required:["did","head","rev"],properties:{did:{type:"string",format:"did"},head:{type:"string",format:"cid",description:"Current repo commit CID"},rev:{type:"string",format:"tid"},active:{type:"boolean"},status:{type:"string",description:"If active=false, this optional field indicates a possible reason for why the account is not active. If active=false and no status is supplied, then the host makes no claim for why the repository is no longer being hosted.",knownValues:["takendown","suspended","deleted","deactivated","desynchronized","throttled"]}}}}},ComAtprotoSyncListReposByCollection:{lexicon:1,id:"com.atproto.sync.listReposByCollection",defs:{main:{type:"query",description:"Enumerates all the DIDs which have records with the given collection NSID.",parameters:{type:"params",required:["collection"],properties:{collection:{type:"string",format:"nsid"},limit:{type:"integer",description:"Maximum size of response set. Recommend setting a large maximum (1000+) when enumerating large DID lists.",minimum:1,maximum:2e3,default:500},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["repos"],properties:{cursor:{type:"string"},repos:{type:"array",items:{type:"ref",ref:"lex:com.atproto.sync.listReposByCollection#repo"}}}}}},repo:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}}}},ComAtprotoSyncNotifyOfUpdate:{lexicon:1,id:"com.atproto.sync.notifyOfUpdate",defs:{main:{type:"procedure",description:"Notify a crawling service of a recent update, and that crawling should resume. Intended use is after a gap between repo stream events caused the crawling service to disconnect. Does not require auth; implemented by Relay. DEPRECATED: just use com.atproto.sync.requestCrawl",input:{encoding:"application/json",schema:{type:"object",required:["hostname"],properties:{hostname:{type:"string",description:"Hostname of the current service (usually a PDS) that is notifying of update."}}}}}}},ComAtprotoSyncRequestCrawl:{lexicon:1,id:"com.atproto.sync.requestCrawl",defs:{main:{type:"procedure",description:"Request a service to persistently crawl hosted repos. Expected use is new PDS instances declaring their existence to Relays. Does not require auth.",input:{encoding:"application/json",schema:{type:"object",required:["hostname"],properties:{hostname:{type:"string",description:"Hostname of the current service (eg, PDS) that is requesting to be crawled."}}}},errors:[{name:"HostBanned"}]}}},ComAtprotoSyncSubscribeRepos:{lexicon:1,id:"com.atproto.sync.subscribeRepos",defs:{main:{type:"subscription",description:"Repository event stream, aka Firehose endpoint. Outputs repo commits with diff data, and identity update events, for all repositories on the current server. See the atproto specifications for details around stream sequencing, repo versioning, CAR diff format, and more. Public and does not require auth; implemented by PDS and Relay.",parameters:{type:"params",properties:{cursor:{type:"integer",description:"The last known event seq number to backfill from."}}},message:{schema:{type:"union",refs:["lex:com.atproto.sync.subscribeRepos#commit","lex:com.atproto.sync.subscribeRepos#sync","lex:com.atproto.sync.subscribeRepos#identity","lex:com.atproto.sync.subscribeRepos#account","lex:com.atproto.sync.subscribeRepos#info"]}},errors:[{name:"FutureCursor"},{name:"ConsumerTooSlow",description:"If the consumer of the stream can not keep up with events, and a backlog gets too large, the server will drop the connection."}]},commit:{type:"object",description:"Represents an update of repository state. Note that empty commits are allowed, which include no repo data changes, but an update to rev and signature.",required:["seq","rebase","tooBig","repo","commit","rev","since","blocks","ops","blobs","time"],nullable:["since"],properties:{seq:{type:"integer",description:"The stream sequence number of this message."},rebase:{type:"boolean",description:"DEPRECATED -- unused"},tooBig:{type:"boolean",description:"DEPRECATED -- replaced by #sync event and data limits. Indicates that this commit contained too many ops, or data size was too large. Consumers will need to make a separate request to get missing data."},repo:{type:"string",format:"did",description:"The repo this event comes from. Note that all other message types name this field 'did'."},commit:{type:"cid-link",description:"Repo commit object CID."},rev:{type:"string",format:"tid",description:"The rev of the emitted commit. Note that this information is also in the commit object included in blocks, unless this is a tooBig event."},since:{type:"string",format:"tid",description:"The rev of the last emitted commit from this repo (if any)."},blocks:{type:"bytes",description:"CAR file containing relevant blocks, as a diff since the previous repo state. The commit must be included as a block, and the commit block CID must be the first entry in the CAR header 'roots' list.",maxLength:2e6},ops:{type:"array",items:{type:"ref",ref:"lex:com.atproto.sync.subscribeRepos#repoOp",description:"List of repo mutation operations in this commit (eg, records created, updated, or deleted)."},maxLength:200},blobs:{type:"array",items:{type:"cid-link",description:"DEPRECATED -- will soon always be empty. List of new blobs (by CID) referenced by records in this commit."}},prevData:{type:"cid-link",description:"The root CID of the MST tree for the previous commit from this repo (indicated by the 'since' revision field in this message). Corresponds to the 'data' field in the repo commit object. NOTE: this field is effectively required for the 'inductive' version of firehose."},time:{type:"string",format:"datetime",description:"Timestamp of when this message was originally broadcast."}}},sync:{type:"object",description:"Updates the repo to a new state, without necessarily including that state on the firehose. Used to recover from broken commit streams, data loss incidents, or in situations where upstream host does not know recent state of the repository.",required:["seq","did","blocks","rev","time"],properties:{seq:{type:"integer",description:"The stream sequence number of this message."},did:{type:"string",format:"did",description:"The account this repo event corresponds to. Must match that in the commit object."},blocks:{type:"bytes",description:"CAR file containing the commit, as a block. The CAR header must include the commit block CID as the first 'root'.",maxLength:1e4},rev:{type:"string",description:"The rev of the commit. This value must match that in the commit object."},time:{type:"string",format:"datetime",description:"Timestamp of when this message was originally broadcast."}}},identity:{type:"object",description:"Represents a change to an account's identity. Could be an updated handle, signing key, or pds hosting endpoint. Serves as a prod to all downstream services to refresh their identity cache.",required:["seq","did","time"],properties:{seq:{type:"integer"},did:{type:"string",format:"did"},time:{type:"string",format:"datetime"},handle:{type:"string",format:"handle",description:"The current handle for the account, or 'handle.invalid' if validation fails. This field is optional, might have been validated or passed-through from an upstream source. Semantics and behaviors for PDS vs Relay may evolve in the future; see atproto specs for more details."}}},account:{type:"object",description:"Represents a change to an account's status on a host (eg, PDS or Relay). The semantics of this event are that the status is at the host which emitted the event, not necessarily that at the currently active PDS. Eg, a Relay takedown would emit a takedown with active=false, even if the PDS is still active.",required:["seq","did","time","active"],properties:{seq:{type:"integer"},did:{type:"string",format:"did"},time:{type:"string",format:"datetime"},active:{type:"boolean",description:"Indicates that the account has a repository which can be fetched from the host that emitted this event."},status:{type:"string",description:"If active=false, this optional field indicates a reason for why the account is not active.",knownValues:["takendown","suspended","deleted","deactivated","desynchronized","throttled"]}}},info:{type:"object",required:["name"],properties:{name:{type:"string",knownValues:["OutdatedCursor"]},message:{type:"string"}}},repoOp:{type:"object",description:"A repo operation, ie a mutation of a single record.",required:["action","path","cid"],nullable:["cid"],properties:{action:{type:"string",knownValues:["create","update","delete"]},path:{type:"string"},cid:{type:"cid-link",description:"For creates and updates, the new record CID. For deletions, null."},prev:{type:"cid-link",description:"For updates and deletes, the previous record CID (required for inductive firehose). For creations, field should not be defined."}}}}},ComAtprotoTempAddReservedHandle:{lexicon:1,id:"com.atproto.temp.addReservedHandle",defs:{main:{type:"procedure",description:"Add a handle to the set of reserved handles.",input:{encoding:"application/json",schema:{type:"object",required:["handle"],properties:{handle:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",properties:{}}}}}},ComAtprotoTempCheckHandleAvailability:{lexicon:1,id:"com.atproto.temp.checkHandleAvailability",defs:{main:{type:"query",description:"Checks whether the provided handle is available. If the handle is not available, available suggestions will be returned. Optional inputs will be used to generate suggestions.",parameters:{type:"params",required:["handle"],properties:{handle:{type:"string",format:"handle",description:"Tentative handle. Will be checked for availability or used to build handle suggestions."},email:{type:"string",description:"User-provided email. Might be used to build handle suggestions."},birthDate:{type:"string",format:"datetime",description:"User-provided birth date. Might be used to build handle suggestions."}}},output:{encoding:"application/json",schema:{type:"object",required:["handle","result"],properties:{handle:{type:"string",format:"handle",description:"Echo of the input handle."},result:{type:"union",refs:["lex:com.atproto.temp.checkHandleAvailability#resultAvailable","lex:com.atproto.temp.checkHandleAvailability#resultUnavailable"]}}}},errors:[{name:"InvalidEmail",description:"An invalid email was provided."}]},resultAvailable:{type:"object",description:"Indicates the provided handle is available.",properties:{}},resultUnavailable:{type:"object",description:"Indicates the provided handle is unavailable and gives suggestions of available handles.",required:["suggestions"],properties:{suggestions:{type:"array",description:"List of suggested handles based on the provided inputs.",items:{type:"ref",ref:"lex:com.atproto.temp.checkHandleAvailability#suggestion"}}}},suggestion:{type:"object",required:["handle","method"],properties:{handle:{type:"string",format:"handle"},method:{type:"string",description:"Method used to build this suggestion. Should be considered opaque to clients. Can be used for metrics."}}}}},ComAtprotoTempCheckSignupQueue:{lexicon:1,id:"com.atproto.temp.checkSignupQueue",defs:{main:{type:"query",description:"Check accounts location in signup queue.",output:{encoding:"application/json",schema:{type:"object",required:["activated"],properties:{activated:{type:"boolean"},placeInQueue:{type:"integer"},estimatedTimeMs:{type:"integer"}}}}}}},ComAtprotoTempDereferenceScope:{lexicon:1,id:"com.atproto.temp.dereferenceScope",defs:{main:{type:"query",description:"Allows finding the oauth permission scope from a reference",parameters:{type:"params",required:["scope"],properties:{scope:{type:"string",description:"The scope reference (starts with 'ref:')"}}},output:{encoding:"application/json",schema:{type:"object",required:["scope"],properties:{scope:{type:"string",description:"The full oauth permission scope"}}}},errors:[{name:"InvalidScopeReference",description:"An invalid scope reference was provided."}]}}},ComAtprotoTempFetchLabels:{lexicon:1,id:"com.atproto.temp.fetchLabels",defs:{main:{type:"query",description:"DEPRECATED: use queryLabels or subscribeLabels instead -- Fetch all labels from a labeler created after a certain date.",parameters:{type:"params",properties:{since:{type:"integer"},limit:{type:"integer",minimum:1,maximum:250,default:50}}},output:{encoding:"application/json",schema:{type:"object",required:["labels"],properties:{labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}}}}}}}},ComAtprotoTempRequestPhoneVerification:{lexicon:1,id:"com.atproto.temp.requestPhoneVerification",defs:{main:{type:"procedure",description:"Request a verification code to be sent to the supplied phone number",input:{encoding:"application/json",schema:{type:"object",required:["phoneNumber"],properties:{phoneNumber:{type:"string"}}}}}}},ComAtprotoTempRevokeAccountCredentials:{lexicon:1,id:"com.atproto.temp.revokeAccountCredentials",defs:{main:{type:"procedure",description:"Revoke sessions, password, and app passwords associated with account. May be resolved by a password reset.",input:{encoding:"application/json",schema:{type:"object",required:["account"],properties:{account:{type:"string",format:"at-identifier"}}}}}}},ToolsOzoneCommunicationCreateTemplate:{lexicon:1,id:"tools.ozone.communication.createTemplate",defs:{main:{type:"procedure",description:"Administrative action to create a new, re-usable communication (email for now) template.",input:{encoding:"application/json",schema:{type:"object",required:["subject","contentMarkdown","name"],properties:{name:{type:"string",description:"Name of the template."},contentMarkdown:{type:"string",description:"Content of the template, markdown supported, can contain variable placeholders."},subject:{type:"string",description:"Subject of the message, used in emails."},lang:{type:"string",format:"language",description:"Message language."},createdBy:{type:"string",format:"did",description:"DID of the user who is creating the template."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.communication.defs#templateView"}},errors:[{name:"DuplicateTemplateName"}]}}},ToolsOzoneCommunicationDefs:{lexicon:1,id:"tools.ozone.communication.defs",defs:{templateView:{type:"object",required:["id","name","contentMarkdown","disabled","lastUpdatedBy","createdAt","updatedAt"],properties:{id:{type:"string"},name:{type:"string",description:"Name of the template."},subject:{type:"string",description:"Content of the template, can contain markdown and variable placeholders."},contentMarkdown:{type:"string",description:"Subject of the message, used in emails."},disabled:{type:"boolean"},lang:{type:"string",format:"language",description:"Message language."},lastUpdatedBy:{type:"string",format:"did",description:"DID of the user who last updated the template."},createdAt:{type:"string",format:"datetime"},updatedAt:{type:"string",format:"datetime"}}}}},ToolsOzoneCommunicationDeleteTemplate:{lexicon:1,id:"tools.ozone.communication.deleteTemplate",defs:{main:{type:"procedure",description:"Delete a communication template.",input:{encoding:"application/json",schema:{type:"object",required:["id"],properties:{id:{type:"string"}}}}}}},ToolsOzoneCommunicationListTemplates:{lexicon:1,id:"tools.ozone.communication.listTemplates",defs:{main:{type:"query",description:"Get list of all communication templates.",output:{encoding:"application/json",schema:{type:"object",required:["communicationTemplates"],properties:{communicationTemplates:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.communication.defs#templateView"}}}}}}}},ToolsOzoneCommunicationUpdateTemplate:{lexicon:1,id:"tools.ozone.communication.updateTemplate",defs:{main:{type:"procedure",description:"Administrative action to update an existing communication template. Allows passing partial fields to patch specific fields only.",input:{encoding:"application/json",schema:{type:"object",required:["id"],properties:{id:{type:"string",description:"ID of the template to be updated."},name:{type:"string",description:"Name of the template."},lang:{type:"string",format:"language",description:"Message language."},contentMarkdown:{type:"string",description:"Content of the template, markdown supported, can contain variable placeholders."},subject:{type:"string",description:"Subject of the message, used in emails."},updatedBy:{type:"string",format:"did",description:"DID of the user who is updating the template."},disabled:{type:"boolean"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.communication.defs#templateView"}},errors:[{name:"DuplicateTemplateName"}]}}},ToolsOzoneHostingGetAccountHistory:{lexicon:1,id:"tools.ozone.hosting.getAccountHistory",defs:{main:{type:"query",description:"Get account history, e.g. log of updated email addresses or other identity information.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did"},events:{type:"array",items:{type:"string",knownValues:["accountCreated","emailUpdated","emailConfirmed","passwordUpdated","handleUpdated"]}},cursor:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50}}},output:{encoding:"application/json",schema:{type:"object",required:["events"],properties:{cursor:{type:"string"},events:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.hosting.getAccountHistory#event"}}}}}},event:{type:"object",required:["details","createdBy","createdAt"],properties:{details:{type:"union",refs:["lex:tools.ozone.hosting.getAccountHistory#accountCreated","lex:tools.ozone.hosting.getAccountHistory#emailUpdated","lex:tools.ozone.hosting.getAccountHistory#emailConfirmed","lex:tools.ozone.hosting.getAccountHistory#passwordUpdated","lex:tools.ozone.hosting.getAccountHistory#handleUpdated"]},createdBy:{type:"string"},createdAt:{type:"string",format:"datetime"}}},accountCreated:{type:"object",required:[],properties:{email:{type:"string"},handle:{type:"string",format:"handle"}}},emailUpdated:{type:"object",required:["email"],properties:{email:{type:"string"}}},emailConfirmed:{type:"object",required:["email"],properties:{email:{type:"string"}}},passwordUpdated:{type:"object",required:[],properties:{}},handleUpdated:{type:"object",required:["handle"],properties:{handle:{type:"string",format:"handle"}}}}},ToolsOzoneModerationCancelScheduledActions:{lexicon:1,id:"tools.ozone.moderation.cancelScheduledActions",defs:{main:{type:"procedure",description:"Cancel all pending scheduled moderation actions for specified subjects",input:{encoding:"application/json",schema:{type:"object",required:["subjects"],properties:{subjects:{type:"array",maxLength:100,items:{type:"string",format:"did"},description:"Array of DID subjects to cancel scheduled actions for"},comment:{type:"string",description:"Optional comment describing the reason for cancellation"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.cancelScheduledActions#cancellationResults"}}},cancellationResults:{type:"object",required:["succeeded","failed"],properties:{succeeded:{type:"array",items:{type:"string",format:"did"},description:"DIDs for which all pending scheduled actions were successfully cancelled"},failed:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.cancelScheduledActions#failedCancellation"},description:"DIDs for which cancellation failed with error details"}}},failedCancellation:{type:"object",required:["did","error"],properties:{did:{type:"string",format:"did"},error:{type:"string"},errorCode:{type:"string"}}}}},ToolsOzoneModerationDefs:{lexicon:1,id:"tools.ozone.moderation.defs",defs:{modEventView:{type:"object",required:["id","event","subject","subjectBlobCids","createdBy","createdAt"],properties:{id:{type:"integer"},event:{type:"union",refs:["lex:tools.ozone.moderation.defs#modEventTakedown","lex:tools.ozone.moderation.defs#modEventReverseTakedown","lex:tools.ozone.moderation.defs#modEventComment","lex:tools.ozone.moderation.defs#modEventReport","lex:tools.ozone.moderation.defs#modEventLabel","lex:tools.ozone.moderation.defs#modEventAcknowledge","lex:tools.ozone.moderation.defs#modEventEscalate","lex:tools.ozone.moderation.defs#modEventMute","lex:tools.ozone.moderation.defs#modEventUnmute","lex:tools.ozone.moderation.defs#modEventMuteReporter","lex:tools.ozone.moderation.defs#modEventUnmuteReporter","lex:tools.ozone.moderation.defs#modEventEmail","lex:tools.ozone.moderation.defs#modEventResolveAppeal","lex:tools.ozone.moderation.defs#modEventDivert","lex:tools.ozone.moderation.defs#modEventTag","lex:tools.ozone.moderation.defs#accountEvent","lex:tools.ozone.moderation.defs#identityEvent","lex:tools.ozone.moderation.defs#recordEvent","lex:tools.ozone.moderation.defs#modEventPriorityScore","lex:tools.ozone.moderation.defs#ageAssuranceEvent","lex:tools.ozone.moderation.defs#ageAssuranceOverrideEvent","lex:tools.ozone.moderation.defs#revokeAccountCredentialsEvent","lex:tools.ozone.moderation.defs#scheduleTakedownEvent","lex:tools.ozone.moderation.defs#cancelScheduledTakedownEvent"]},subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef","lex:chat.bsky.convo.defs#messageRef"]},subjectBlobCids:{type:"array",items:{type:"string"}},createdBy:{type:"string",format:"did"},createdAt:{type:"string",format:"datetime"},creatorHandle:{type:"string"},subjectHandle:{type:"string"},modTool:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modTool"}}},modEventViewDetail:{type:"object",required:["id","event","subject","subjectBlobs","createdBy","createdAt"],properties:{id:{type:"integer"},event:{type:"union",refs:["lex:tools.ozone.moderation.defs#modEventTakedown","lex:tools.ozone.moderation.defs#modEventReverseTakedown","lex:tools.ozone.moderation.defs#modEventComment","lex:tools.ozone.moderation.defs#modEventReport","lex:tools.ozone.moderation.defs#modEventLabel","lex:tools.ozone.moderation.defs#modEventAcknowledge","lex:tools.ozone.moderation.defs#modEventEscalate","lex:tools.ozone.moderation.defs#modEventMute","lex:tools.ozone.moderation.defs#modEventUnmute","lex:tools.ozone.moderation.defs#modEventMuteReporter","lex:tools.ozone.moderation.defs#modEventUnmuteReporter","lex:tools.ozone.moderation.defs#modEventEmail","lex:tools.ozone.moderation.defs#modEventResolveAppeal","lex:tools.ozone.moderation.defs#modEventDivert","lex:tools.ozone.moderation.defs#modEventTag","lex:tools.ozone.moderation.defs#accountEvent","lex:tools.ozone.moderation.defs#identityEvent","lex:tools.ozone.moderation.defs#recordEvent","lex:tools.ozone.moderation.defs#modEventPriorityScore","lex:tools.ozone.moderation.defs#ageAssuranceEvent","lex:tools.ozone.moderation.defs#ageAssuranceOverrideEvent","lex:tools.ozone.moderation.defs#revokeAccountCredentialsEvent","lex:tools.ozone.moderation.defs#scheduleTakedownEvent","lex:tools.ozone.moderation.defs#cancelScheduledTakedownEvent"]},subject:{type:"union",refs:["lex:tools.ozone.moderation.defs#repoView","lex:tools.ozone.moderation.defs#repoViewNotFound","lex:tools.ozone.moderation.defs#recordView","lex:tools.ozone.moderation.defs#recordViewNotFound"]},subjectBlobs:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#blobView"}},createdBy:{type:"string",format:"did"},createdAt:{type:"string",format:"datetime"},modTool:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modTool"}}},subjectStatusView:{type:"object",required:["id","subject","createdAt","updatedAt","reviewState"],properties:{id:{type:"integer"},subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef","lex:chat.bsky.convo.defs#messageRef"]},hosting:{type:"union",refs:["lex:tools.ozone.moderation.defs#accountHosting","lex:tools.ozone.moderation.defs#recordHosting"]},subjectBlobCids:{type:"array",items:{type:"string",format:"cid"}},subjectRepoHandle:{type:"string"},updatedAt:{type:"string",format:"datetime",description:"Timestamp referencing when the last update was made to the moderation status of the subject"},createdAt:{type:"string",format:"datetime",description:"Timestamp referencing the first moderation status impacting event was emitted on the subject"},reviewState:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectReviewState"},comment:{type:"string",description:"Sticky comment on the subject."},priorityScore:{type:"integer",description:"Numeric value representing the level of priority. Higher score means higher priority.",minimum:0,maximum:100},muteUntil:{type:"string",format:"datetime"},muteReportingUntil:{type:"string",format:"datetime"},lastReviewedBy:{type:"string",format:"did"},lastReviewedAt:{type:"string",format:"datetime"},lastReportedAt:{type:"string",format:"datetime"},lastAppealedAt:{type:"string",format:"datetime",description:"Timestamp referencing when the author of the subject appealed a moderation action"},takendown:{type:"boolean"},appealed:{type:"boolean",description:"True indicates that the a previously taken moderator action was appealed against, by the author of the content. False indicates last appeal was resolved by moderators."},suspendUntil:{type:"string",format:"datetime"},tags:{type:"array",items:{type:"string"}},accountStats:{description:"Statistics related to the account subject",type:"ref",ref:"lex:tools.ozone.moderation.defs#accountStats"},recordsStats:{description:"Statistics related to the record subjects authored by the subject's account",type:"ref",ref:"lex:tools.ozone.moderation.defs#recordsStats"},ageAssuranceState:{type:"string",description:"Current age assurance state of the subject.",knownValues:["pending","assured","unknown","reset","blocked"]},ageAssuranceUpdatedBy:{type:"string",description:"Whether or not the last successful update to age assurance was made by the user or admin.",knownValues:["admin","user"]}}},subjectView:{description:"Detailed view of a subject. For record subjects, the author's repo and profile will be returned.",type:"object",required:["type","subject"],properties:{type:{type:"ref",ref:"lex:com.atproto.moderation.defs#subjectType"},subject:{type:"string"},status:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectStatusView"},repo:{type:"ref",ref:"lex:tools.ozone.moderation.defs#repoViewDetail"},profile:{type:"union",refs:[]},record:{type:"ref",ref:"lex:tools.ozone.moderation.defs#recordViewDetail"}}},accountStats:{description:"Statistics about a particular account subject",type:"object",properties:{reportCount:{description:"Total number of reports on the account",type:"integer"},appealCount:{description:"Total number of appeals against a moderation action on the account",type:"integer"},suspendCount:{description:"Number of times the account was suspended",type:"integer"},escalateCount:{description:"Number of times the account was escalated",type:"integer"},takedownCount:{description:"Number of times the account was taken down",type:"integer"}}},recordsStats:{description:"Statistics about a set of record subject items",type:"object",properties:{totalReports:{description:"Cumulative sum of the number of reports on the items in the set",type:"integer"},reportedCount:{description:"Number of items that were reported at least once",type:"integer"},escalatedCount:{description:"Number of items that were escalated at least once",type:"integer"},appealedCount:{description:"Number of items that were appealed at least once",type:"integer"},subjectCount:{description:"Total number of item in the set",type:"integer"},pendingCount:{description:'Number of item currently in "reviewOpen" or "reviewEscalated" state',type:"integer"},processedCount:{description:'Number of item currently in "reviewNone" or "reviewClosed" state',type:"integer"},takendownCount:{description:"Number of item currently taken down",type:"integer"}}},subjectReviewState:{type:"string",knownValues:["lex:tools.ozone.moderation.defs#reviewOpen","lex:tools.ozone.moderation.defs#reviewEscalated","lex:tools.ozone.moderation.defs#reviewClosed","lex:tools.ozone.moderation.defs#reviewNone"]},reviewOpen:{type:"token",description:"Moderator review status of a subject: Open. Indicates that the subject needs to be reviewed by a moderator"},reviewEscalated:{type:"token",description:"Moderator review status of a subject: Escalated. Indicates that the subject was escalated for review by a moderator"},reviewClosed:{type:"token",description:"Moderator review status of a subject: Closed. Indicates that the subject was already reviewed and resolved by a moderator"},reviewNone:{type:"token",description:"Moderator review status of a subject: Unnecessary. Indicates that the subject does not need a review at the moment but there is probably some moderation related metadata available for it"},modEventTakedown:{type:"object",description:"Take down a subject permanently or temporarily",properties:{comment:{type:"string"},durationInHours:{type:"integer",description:"Indicates how long the takedown should be in effect before automatically expiring."},acknowledgeAccountSubjects:{type:"boolean",description:"If true, all other reports on content authored by this account will be resolved (acknowledged)."},policies:{type:"array",maxLength:5,items:{type:"string"},description:"Names/Keywords of the policies that drove the decision."}}},modEventReverseTakedown:{type:"object",description:"Revert take down action on a subject",properties:{comment:{type:"string",description:"Describe reasoning behind the reversal."}}},modEventResolveAppeal:{type:"object",description:"Resolve appeal on a subject",properties:{comment:{type:"string",description:"Describe resolution."}}},modEventComment:{type:"object",description:"Add a comment to a subject. An empty comment will clear any previously set sticky comment.",properties:{comment:{type:"string"},sticky:{type:"boolean",description:"Make the comment persistent on the subject"}}},modEventReport:{type:"object",description:"Report a subject",required:["reportType"],properties:{comment:{type:"string"},isReporterMuted:{type:"boolean",description:"Set to true if the reporter was muted from reporting at the time of the event. These reports won't impact the reviewState of the subject."},reportType:{type:"ref",ref:"lex:com.atproto.moderation.defs#reasonType"}}},modEventLabel:{type:"object",description:"Apply/Negate labels on a subject",required:["createLabelVals","negateLabelVals"],properties:{comment:{type:"string"},createLabelVals:{type:"array",items:{type:"string"}},negateLabelVals:{type:"array",items:{type:"string"}},durationInHours:{type:"integer",description:"Indicates how long the label will remain on the subject. Only applies on labels that are being added."}}},modEventPriorityScore:{type:"object",description:"Set priority score of the subject. Higher score means higher priority.",required:["score"],properties:{comment:{type:"string"},score:{type:"integer",minimum:0,maximum:100}}},ageAssuranceEvent:{type:"object",description:"Age assurance info coming directly from users. Only works on DID subjects.",required:["createdAt","status","attemptId"],properties:{createdAt:{type:"string",format:"datetime",description:"The date and time of this write operation."},status:{type:"string",description:"The status of the age assurance process.",knownValues:["unknown","pending","assured"]},attemptId:{type:"string",description:"The unique identifier for this instance of the age assurance flow, in UUID format."},initIp:{type:"string",description:"The IP address used when initiating the AA flow."},initUa:{type:"string",description:"The user agent used when initiating the AA flow."},completeIp:{type:"string",description:"The IP address used when completing the AA flow."},completeUa:{type:"string",description:"The user agent used when completing the AA flow."}}},ageAssuranceOverrideEvent:{type:"object",description:"Age assurance status override by moderators. Only works on DID subjects.",required:["comment","status"],properties:{status:{type:"string",description:"The status to be set for the user decided by a moderator, overriding whatever value the user had previously. Use reset to default to original state.",knownValues:["assured","reset","blocked"]},comment:{type:"string",description:"Comment describing the reason for the override."}}},revokeAccountCredentialsEvent:{type:"object",description:"Account credentials revocation by moderators. Only works on DID subjects.",required:["comment"],properties:{comment:{type:"string",description:"Comment describing the reason for the revocation."}}},modEventAcknowledge:{type:"object",properties:{comment:{type:"string"},acknowledgeAccountSubjects:{type:"boolean",description:"If true, all other reports on content authored by this account will be resolved (acknowledged)."}}},modEventEscalate:{type:"object",properties:{comment:{type:"string"}}},modEventMute:{type:"object",description:"Mute incoming reports on a subject",required:["durationInHours"],properties:{comment:{type:"string"},durationInHours:{type:"integer",description:"Indicates how long the subject should remain muted."}}},modEventUnmute:{type:"object",description:"Unmute action on a subject",properties:{comment:{type:"string",description:"Describe reasoning behind the reversal."}}},modEventMuteReporter:{type:"object",description:"Mute incoming reports from an account",properties:{comment:{type:"string"},durationInHours:{type:"integer",description:"Indicates how long the account should remain muted. Falsy value here means a permanent mute."}}},modEventUnmuteReporter:{type:"object",description:"Unmute incoming reports from an account",properties:{comment:{type:"string",description:"Describe reasoning behind the reversal."}}},modEventEmail:{type:"object",description:"Keep a log of outgoing email to a user",required:["subjectLine"],properties:{subjectLine:{type:"string",description:"The subject line of the email sent to the user."},content:{type:"string",description:"The content of the email sent to the user."},comment:{type:"string",description:"Additional comment about the outgoing comm."}}},modEventDivert:{type:"object",description:"Divert a record's blobs to a 3rd party service for further scanning/tagging",properties:{comment:{type:"string"}}},modEventTag:{type:"object",description:"Add/Remove a tag on a subject",required:["add","remove"],properties:{add:{type:"array",items:{type:"string"},description:"Tags to be added to the subject. If already exists, won't be duplicated."},remove:{type:"array",items:{type:"string"},description:"Tags to be removed to the subject. Ignores a tag If it doesn't exist, won't be duplicated."},comment:{type:"string",description:"Additional comment about added/removed tags."}}},accountEvent:{type:"object",description:"Logs account status related events on a repo subject. Normally captured by automod from the firehose and emitted to ozone for historical tracking.",required:["timestamp","active"],properties:{comment:{type:"string"},active:{type:"boolean",description:"Indicates that the account has a repository which can be fetched from the host that emitted this event."},status:{type:"string",knownValues:["unknown","deactivated","deleted","takendown","suspended","tombstoned"]},timestamp:{type:"string",format:"datetime"}}},identityEvent:{type:"object",description:"Logs identity related events on a repo subject. Normally captured by automod from the firehose and emitted to ozone for historical tracking.",required:["timestamp"],properties:{comment:{type:"string"},handle:{type:"string",format:"handle"},pdsHost:{type:"string",format:"uri"},tombstone:{type:"boolean"},timestamp:{type:"string",format:"datetime"}}},recordEvent:{type:"object",description:"Logs lifecycle event on a record subject. Normally captured by automod from the firehose and emitted to ozone for historical tracking.",required:["timestamp","op"],properties:{comment:{type:"string"},op:{type:"string",knownValues:["create","update","delete"]},cid:{type:"string",format:"cid"},timestamp:{type:"string",format:"datetime"}}},scheduleTakedownEvent:{type:"object",description:"Logs a scheduled takedown action for an account.",properties:{comment:{type:"string"},executeAt:{type:"string",format:"datetime"},executeAfter:{type:"string",format:"datetime"},executeUntil:{type:"string",format:"datetime"}}},cancelScheduledTakedownEvent:{type:"object",description:"Logs cancellation of a scheduled takedown action for an account.",properties:{comment:{type:"string"}}},repoView:{type:"object",required:["did","handle","relatedRecords","indexedAt","moderation"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},email:{type:"string"},relatedRecords:{type:"array",items:{type:"unknown"}},indexedAt:{type:"string",format:"datetime"},moderation:{type:"ref",ref:"lex:tools.ozone.moderation.defs#moderation"},invitedBy:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"},invitesDisabled:{type:"boolean"},inviteNote:{type:"string"},deactivatedAt:{type:"string",format:"datetime"},threatSignatures:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#threatSignature"}}}},repoViewDetail:{type:"object",required:["did","handle","relatedRecords","indexedAt","moderation"],properties:{did:{type:"string",format:"did"},handle:{type:"string",format:"handle"},email:{type:"string"},relatedRecords:{type:"array",items:{type:"unknown"}},indexedAt:{type:"string",format:"datetime"},moderation:{type:"ref",ref:"lex:tools.ozone.moderation.defs#moderationDetail"},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},invitedBy:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"},invites:{type:"array",items:{type:"ref",ref:"lex:com.atproto.server.defs#inviteCode"}},invitesDisabled:{type:"boolean"},inviteNote:{type:"string"},emailConfirmedAt:{type:"string",format:"datetime"},deactivatedAt:{type:"string",format:"datetime"},threatSignatures:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#threatSignature"}}}},repoViewNotFound:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}},recordView:{type:"object",required:["uri","cid","value","blobCids","indexedAt","moderation","repo"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},value:{type:"unknown"},blobCids:{type:"array",items:{type:"string",format:"cid"}},indexedAt:{type:"string",format:"datetime"},moderation:{type:"ref",ref:"lex:tools.ozone.moderation.defs#moderation"},repo:{type:"ref",ref:"lex:tools.ozone.moderation.defs#repoView"}}},recordViewDetail:{type:"object",required:["uri","cid","value","blobs","indexedAt","moderation","repo"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"},value:{type:"unknown"},blobs:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#blobView"}},labels:{type:"array",items:{type:"ref",ref:"lex:com.atproto.label.defs#label"}},indexedAt:{type:"string",format:"datetime"},moderation:{type:"ref",ref:"lex:tools.ozone.moderation.defs#moderationDetail"},repo:{type:"ref",ref:"lex:tools.ozone.moderation.defs#repoView"}}},recordViewNotFound:{type:"object",required:["uri"],properties:{uri:{type:"string",format:"at-uri"}}},moderation:{type:"object",properties:{subjectStatus:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectStatusView"}}},moderationDetail:{type:"object",properties:{subjectStatus:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectStatusView"}}},blobView:{type:"object",required:["cid","mimeType","size","createdAt"],properties:{cid:{type:"string",format:"cid"},mimeType:{type:"string"},size:{type:"integer"},createdAt:{type:"string",format:"datetime"},details:{type:"union",refs:["lex:tools.ozone.moderation.defs#imageDetails","lex:tools.ozone.moderation.defs#videoDetails"]},moderation:{type:"ref",ref:"lex:tools.ozone.moderation.defs#moderation"}}},imageDetails:{type:"object",required:["width","height"],properties:{width:{type:"integer"},height:{type:"integer"}}},videoDetails:{type:"object",required:["width","height","length"],properties:{width:{type:"integer"},height:{type:"integer"},length:{type:"integer"}}},accountHosting:{type:"object",required:["status"],properties:{status:{type:"string",knownValues:["takendown","suspended","deleted","deactivated","unknown"]},updatedAt:{type:"string",format:"datetime"},createdAt:{type:"string",format:"datetime"},deletedAt:{type:"string",format:"datetime"},deactivatedAt:{type:"string",format:"datetime"},reactivatedAt:{type:"string",format:"datetime"}}},recordHosting:{type:"object",required:["status"],properties:{status:{type:"string",knownValues:["deleted","unknown"]},updatedAt:{type:"string",format:"datetime"},createdAt:{type:"string",format:"datetime"},deletedAt:{type:"string",format:"datetime"}}},reporterStats:{type:"object",required:["did","accountReportCount","recordReportCount","reportedAccountCount","reportedRecordCount","takendownAccountCount","takendownRecordCount","labeledAccountCount","labeledRecordCount"],properties:{did:{type:"string",format:"did"},accountReportCount:{type:"integer",description:"The total number of reports made by the user on accounts."},recordReportCount:{type:"integer",description:"The total number of reports made by the user on records."},reportedAccountCount:{type:"integer",description:"The total number of accounts reported by the user."},reportedRecordCount:{type:"integer",description:"The total number of records reported by the user."},takendownAccountCount:{type:"integer",description:"The total number of accounts taken down as a result of the user's reports."},takendownRecordCount:{type:"integer",description:"The total number of records taken down as a result of the user's reports."},labeledAccountCount:{type:"integer",description:"The total number of accounts labeled as a result of the user's reports."},labeledRecordCount:{type:"integer",description:"The total number of records labeled as a result of the user's reports."}}},modTool:{type:"object",description:"Moderation tool information for tracing the source of the action",required:["name"],properties:{name:{type:"string",description:"Name/identifier of the source (e.g., 'automod', 'ozone/workspace')"},meta:{type:"unknown",description:"Additional arbitrary metadata about the source"}}},timelineEventPlcCreate:{type:"token",description:"Moderation event timeline event for a PLC create operation"},timelineEventPlcOperation:{type:"token",description:"Moderation event timeline event for generic PLC operation"},timelineEventPlcTombstone:{type:"token",description:"Moderation event timeline event for a PLC tombstone operation"},scheduledActionView:{type:"object",description:"View of a scheduled moderation action",required:["id","action","did","createdBy","createdAt","status"],properties:{id:{type:"integer",description:"Auto-incrementing row ID"},action:{type:"string",knownValues:["takedown"],description:"Type of action to be executed"},eventData:{type:"unknown",description:"Serialized event object that will be propagated to the event when performed"},did:{type:"string",format:"did",description:"Subject DID for the action"},executeAt:{type:"string",format:"datetime",description:"Exact time to execute the action"},executeAfter:{type:"string",format:"datetime",description:"Earliest time to execute the action (for randomized scheduling)"},executeUntil:{type:"string",format:"datetime",description:"Latest time to execute the action (for randomized scheduling)"},randomizeExecution:{type:"boolean",description:"Whether execution time should be randomized within the specified range"},createdBy:{type:"string",format:"did",description:"DID of the user who created this scheduled action"},createdAt:{type:"string",format:"datetime",description:"When the scheduled action was created"},updatedAt:{type:"string",format:"datetime",description:"When the scheduled action was last updated"},status:{type:"string",knownValues:["pending","executed","cancelled","failed"],description:"Current status of the scheduled action"},lastExecutedAt:{type:"string",format:"datetime",description:"When the action was last attempted to be executed"},lastFailureReason:{type:"string",description:"Reason for the last execution failure"},executionEventId:{type:"integer",description:"ID of the moderation event created when action was successfully executed"}}}}},ToolsOzoneModerationEmitEvent:{lexicon:1,id:"tools.ozone.moderation.emitEvent",defs:{main:{type:"procedure",description:"Take a moderation action on an actor.",input:{encoding:"application/json",schema:{type:"object",required:["event","subject","createdBy"],properties:{event:{type:"union",refs:["lex:tools.ozone.moderation.defs#modEventTakedown","lex:tools.ozone.moderation.defs#modEventAcknowledge","lex:tools.ozone.moderation.defs#modEventEscalate","lex:tools.ozone.moderation.defs#modEventComment","lex:tools.ozone.moderation.defs#modEventLabel","lex:tools.ozone.moderation.defs#modEventReport","lex:tools.ozone.moderation.defs#modEventMute","lex:tools.ozone.moderation.defs#modEventUnmute","lex:tools.ozone.moderation.defs#modEventMuteReporter","lex:tools.ozone.moderation.defs#modEventUnmuteReporter","lex:tools.ozone.moderation.defs#modEventReverseTakedown","lex:tools.ozone.moderation.defs#modEventResolveAppeal","lex:tools.ozone.moderation.defs#modEventEmail","lex:tools.ozone.moderation.defs#modEventDivert","lex:tools.ozone.moderation.defs#modEventTag","lex:tools.ozone.moderation.defs#accountEvent","lex:tools.ozone.moderation.defs#identityEvent","lex:tools.ozone.moderation.defs#recordEvent","lex:tools.ozone.moderation.defs#modEventPriorityScore","lex:tools.ozone.moderation.defs#ageAssuranceEvent","lex:tools.ozone.moderation.defs#ageAssuranceOverrideEvent","lex:tools.ozone.moderation.defs#revokeAccountCredentialsEvent","lex:tools.ozone.moderation.defs#scheduleTakedownEvent","lex:tools.ozone.moderation.defs#cancelScheduledTakedownEvent"]},subject:{type:"union",refs:["lex:com.atproto.admin.defs#repoRef","lex:com.atproto.repo.strongRef"]},subjectBlobCids:{type:"array",items:{type:"string",format:"cid"}},createdBy:{type:"string",format:"did"},modTool:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modTool"},externalId:{type:"string",description:"An optional external ID for the event, used to deduplicate events from external systems. Fails when an event of same type with the same external ID exists for the same subject."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modEventView"}},errors:[{name:"SubjectHasAction"},{name:"DuplicateExternalId",description:"An event with the same external ID already exists for the subject."}]}}},ToolsOzoneModerationGetAccountTimeline:{lexicon:1,id:"tools.ozone.moderation.getAccountTimeline",defs:{main:{type:"query",description:"Get timeline of all available events of an account. This includes moderation events, account history and did history.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did"}}},output:{encoding:"application/json",schema:{type:"object",required:["timeline"],properties:{timeline:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.getAccountTimeline#timelineItem"}}}}},errors:[{name:"RepoNotFound"}]},timelineItem:{type:"object",required:["day","summary"],properties:{day:{type:"string"},summary:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.getAccountTimeline#timelineItemSummary"}}}},timelineItemSummary:{type:"object",required:["eventSubjectType","eventType","count"],properties:{eventSubjectType:{type:"string",knownValues:["account","record","chat"]},eventType:{type:"string",knownValues:["tools.ozone.moderation.defs#modEventTakedown","tools.ozone.moderation.defs#modEventReverseTakedown","tools.ozone.moderation.defs#modEventComment","tools.ozone.moderation.defs#modEventReport","tools.ozone.moderation.defs#modEventLabel","tools.ozone.moderation.defs#modEventAcknowledge","tools.ozone.moderation.defs#modEventEscalate","tools.ozone.moderation.defs#modEventMute","tools.ozone.moderation.defs#modEventUnmute","tools.ozone.moderation.defs#modEventMuteReporter","tools.ozone.moderation.defs#modEventUnmuteReporter","tools.ozone.moderation.defs#modEventEmail","tools.ozone.moderation.defs#modEventResolveAppeal","tools.ozone.moderation.defs#modEventDivert","tools.ozone.moderation.defs#modEventTag","tools.ozone.moderation.defs#accountEvent","tools.ozone.moderation.defs#identityEvent","tools.ozone.moderation.defs#recordEvent","tools.ozone.moderation.defs#modEventPriorityScore","tools.ozone.moderation.defs#revokeAccountCredentialsEvent","tools.ozone.moderation.defs#ageAssuranceEvent","tools.ozone.moderation.defs#ageAssuranceOverrideEvent","tools.ozone.moderation.defs#timelineEventPlcCreate","tools.ozone.moderation.defs#timelineEventPlcOperation","tools.ozone.moderation.defs#timelineEventPlcTombstone","tools.ozone.hosting.getAccountHistory#accountCreated","tools.ozone.hosting.getAccountHistory#emailConfirmed","tools.ozone.hosting.getAccountHistory#passwordUpdated","tools.ozone.hosting.getAccountHistory#handleUpdated","tools.ozone.moderation.defs#scheduleTakedownEvent","tools.ozone.moderation.defs#cancelScheduledTakedownEvent"]},count:{type:"integer"}}}}},ToolsOzoneModerationGetEvent:{lexicon:1,id:"tools.ozone.moderation.getEvent",defs:{main:{type:"query",description:"Get details about a moderation event.",parameters:{type:"params",required:["id"],properties:{id:{type:"integer"}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modEventViewDetail"}}}}},ToolsOzoneModerationGetRecord:{lexicon:1,id:"tools.ozone.moderation.getRecord",defs:{main:{type:"query",description:"Get details about a record.",parameters:{type:"params",required:["uri"],properties:{uri:{type:"string",format:"at-uri"},cid:{type:"string",format:"cid"}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.defs#recordViewDetail"}},errors:[{name:"RecordNotFound"}]}}},ToolsOzoneModerationGetRecords:{lexicon:1,id:"tools.ozone.moderation.getRecords",defs:{main:{type:"query",description:"Get details about some records.",parameters:{type:"params",required:["uris"],properties:{uris:{type:"array",maxLength:100,items:{type:"string",format:"at-uri"}}}},output:{encoding:"application/json",schema:{type:"object",required:["records"],properties:{records:{type:"array",items:{type:"union",refs:["lex:tools.ozone.moderation.defs#recordViewDetail","lex:tools.ozone.moderation.defs#recordViewNotFound"]}}}}}}}},ToolsOzoneModerationGetRepo:{lexicon:1,id:"tools.ozone.moderation.getRepo",defs:{main:{type:"query",description:"Get details about a repository.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did"}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.defs#repoViewDetail"}},errors:[{name:"RepoNotFound"}]}}},ToolsOzoneModerationGetReporterStats:{lexicon:1,id:"tools.ozone.moderation.getReporterStats",defs:{main:{type:"query",description:"Get reporter stats for a list of users.",parameters:{type:"params",required:["dids"],properties:{dids:{type:"array",maxLength:100,items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["stats"],properties:{stats:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#reporterStats"}}}}}}}},ToolsOzoneModerationGetRepos:{lexicon:1,id:"tools.ozone.moderation.getRepos",defs:{main:{type:"query",description:"Get details about some repositories.",parameters:{type:"params",required:["dids"],properties:{dids:{type:"array",maxLength:100,items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["repos"],properties:{repos:{type:"array",items:{type:"union",refs:["lex:tools.ozone.moderation.defs#repoViewDetail","lex:tools.ozone.moderation.defs#repoViewNotFound"]}}}}}}}},ToolsOzoneModerationGetSubjects:{lexicon:1,id:"tools.ozone.moderation.getSubjects",defs:{main:{type:"query",description:"Get details about subjects.",parameters:{type:"params",required:["subjects"],properties:{subjects:{type:"array",maxLength:100,minLength:1,items:{type:"string"}}}},output:{encoding:"application/json",schema:{type:"object",required:["subjects"],properties:{subjects:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectView"}}}}}}}},ToolsOzoneModerationListScheduledActions:{lexicon:1,id:"tools.ozone.moderation.listScheduledActions",defs:{main:{type:"procedure",description:"List scheduled moderation actions with optional filtering",input:{encoding:"application/json",schema:{type:"object",required:["statuses"],properties:{startsAfter:{type:"string",format:"datetime",description:"Filter actions scheduled to execute after this time"},endsBefore:{type:"string",format:"datetime",description:"Filter actions scheduled to execute before this time"},subjects:{type:"array",maxLength:100,items:{type:"string",format:"did"},description:"Filter actions for specific DID subjects"},statuses:{type:"array",minLength:1,items:{type:"string",knownValues:["pending","executed","cancelled","failed"]},description:"Filter actions by status"},limit:{type:"integer",minimum:1,maximum:100,default:50,description:"Maximum number of results to return"},cursor:{type:"string",description:"Cursor for pagination"}}}},output:{encoding:"application/json",schema:{type:"object",required:["actions"],properties:{actions:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#scheduledActionView"}},cursor:{type:"string",description:"Cursor for next page of results"}}}}}}},ToolsOzoneModerationQueryEvents:{lexicon:1,id:"tools.ozone.moderation.queryEvents",defs:{main:{type:"query",description:"List moderation events related to a subject.",parameters:{type:"params",properties:{types:{type:"array",items:{type:"string"},description:"The types of events (fully qualified string in the format of tools.ozone.moderation.defs#modEvent<name>) to filter by. If not specified, all events are returned."},createdBy:{type:"string",format:"did"},sortDirection:{type:"string",default:"desc",enum:["asc","desc"],description:"Sort direction for the events. Defaults to descending order of created at timestamp."},createdAfter:{type:"string",format:"datetime",description:"Retrieve events created after a given timestamp"},createdBefore:{type:"string",format:"datetime",description:"Retrieve events created before a given timestamp"},subject:{type:"string",format:"uri"},collections:{type:"array",maxLength:20,description:"If specified, only events where the subject belongs to the given collections will be returned. When subjectType is set to 'account', this will be ignored.",items:{type:"string",format:"nsid"}},subjectType:{type:"string",description:"If specified, only events where the subject is of the given type (account or record) will be returned. When this is set to 'account' the 'collections' parameter will be ignored. When includeAllUserRecords or subject is set, this will be ignored.",knownValues:["account","record"]},includeAllUserRecords:{type:"boolean",default:!1,description:"If true, events on all record types (posts, lists, profile etc.) or records from given 'collections' param, owned by the did are returned."},limit:{type:"integer",minimum:1,maximum:100,default:50},hasComment:{type:"boolean",description:"If true, only events with comments are returned"},comment:{type:"string",description:"If specified, only events with comments containing the keyword are returned. Apply || separator to use multiple keywords and match using OR condition."},addedLabels:{type:"array",items:{type:"string"},description:"If specified, only events where all of these labels were added are returned"},removedLabels:{type:"array",items:{type:"string"},description:"If specified, only events where all of these labels were removed are returned"},addedTags:{type:"array",items:{type:"string"},description:"If specified, only events where all of these tags were added are returned"},removedTags:{type:"array",items:{type:"string"},description:"If specified, only events where all of these tags were removed are returned"},reportTypes:{type:"array",items:{type:"string"}},policies:{type:"array",items:{type:"string",description:"If specified, only events where the action policies match any of the given policies are returned"}},modTool:{type:"array",items:{type:"string"},description:"If specified, only events where the modTool name matches any of the given values are returned"},batchId:{type:"string",description:"If specified, only events where the batchId matches the given value are returned"},ageAssuranceState:{type:"string",description:"If specified, only events where the age assurance state matches the given value are returned",knownValues:["pending","assured","unknown","reset","blocked"]},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["events"],properties:{cursor:{type:"string"},events:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modEventView"}}}}}}}},ToolsOzoneModerationQueryStatuses:{lexicon:1,id:"tools.ozone.moderation.queryStatuses",defs:{main:{type:"query",description:"View moderation statuses of subjects (record or repo).",parameters:{type:"params",properties:{queueCount:{type:"integer",description:"Number of queues being used by moderators. Subjects will be split among all queues."},queueIndex:{type:"integer",description:"Index of the queue to fetch subjects from. Works only when queueCount value is specified."},queueSeed:{type:"string",description:"A seeder to shuffle/balance the queue items."},includeAllUserRecords:{type:"boolean",description:"All subjects, or subjects from given 'collections' param, belonging to the account specified in the 'subject' param will be returned."},subject:{type:"string",format:"uri",description:"The subject to get the status for."},comment:{type:"string",description:"Search subjects by keyword from comments"},reportedAfter:{type:"string",format:"datetime",description:"Search subjects reported after a given timestamp"},reportedBefore:{type:"string",format:"datetime",description:"Search subjects reported before a given timestamp"},reviewedAfter:{type:"string",format:"datetime",description:"Search subjects reviewed after a given timestamp"},hostingDeletedAfter:{type:"string",format:"datetime",description:"Search subjects where the associated record/account was deleted after a given timestamp"},hostingDeletedBefore:{type:"string",format:"datetime",description:"Search subjects where the associated record/account was deleted before a given timestamp"},hostingUpdatedAfter:{type:"string",format:"datetime",description:"Search subjects where the associated record/account was updated after a given timestamp"},hostingUpdatedBefore:{type:"string",format:"datetime",description:"Search subjects where the associated record/account was updated before a given timestamp"},hostingStatuses:{type:"array",items:{type:"string"},description:"Search subjects by the status of the associated record/account"},reviewedBefore:{type:"string",format:"datetime",description:"Search subjects reviewed before a given timestamp"},includeMuted:{type:"boolean",description:"By default, we don't include muted subjects in the results. Set this to true to include them."},onlyMuted:{type:"boolean",description:"When set to true, only muted subjects and reporters will be returned."},reviewState:{type:"string",description:"Specify when fetching subjects in a certain state"},ignoreSubjects:{type:"array",items:{type:"string",format:"uri"}},lastReviewedBy:{type:"string",format:"did",description:"Get all subject statuses that were reviewed by a specific moderator"},sortField:{type:"string",default:"lastReportedAt",enum:["lastReviewedAt","lastReportedAt","reportedRecordsCount","takendownRecordsCount","priorityScore"]},sortDirection:{type:"string",default:"desc",enum:["asc","desc"]},takendown:{type:"boolean",description:"Get subjects that were taken down"},appealed:{type:"boolean",description:"Get subjects in unresolved appealed status"},limit:{type:"integer",minimum:1,maximum:100,default:50},tags:{type:"array",maxLength:25,items:{type:"string",description:"Items in this array are applied with OR filters. To apply AND filter, put all tags in the same string and separate using && characters"}},excludeTags:{type:"array",items:{type:"string"}},cursor:{type:"string"},collections:{type:"array",maxLength:20,description:"If specified, subjects belonging to the given collections will be returned. When subjectType is set to 'account', this will be ignored.",items:{type:"string",format:"nsid"}},subjectType:{type:"string",description:"If specified, subjects of the given type (account or record) will be returned. When this is set to 'account' the 'collections' parameter will be ignored. When includeAllUserRecords or subject is set, this will be ignored.",knownValues:["account","record"]},minAccountSuspendCount:{type:"integer",description:"If specified, only subjects that belong to an account that has at least this many suspensions will be returned."},minReportedRecordsCount:{type:"integer",description:"If specified, only subjects that belong to an account that has at least this many reported records will be returned."},minTakendownRecordsCount:{type:"integer",description:"If specified, only subjects that belong to an account that has at least this many taken down records will be returned."},minPriorityScore:{minimum:0,maximum:100,type:"integer",description:"If specified, only subjects that have priority score value above the given value will be returned."},ageAssuranceState:{type:"string",description:"If specified, only subjects with the given age assurance state will be returned.",knownValues:["pending","assured","unknown","reset","blocked"]}}},output:{encoding:"application/json",schema:{type:"object",required:["subjectStatuses"],properties:{cursor:{type:"string"},subjectStatuses:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#subjectStatusView"}}}}}}}},ToolsOzoneModerationScheduleAction:{lexicon:1,id:"tools.ozone.moderation.scheduleAction",defs:{main:{type:"procedure",description:"Schedule a moderation action to be executed at a future time",input:{encoding:"application/json",schema:{type:"object",required:["action","subjects","createdBy","scheduling"],properties:{action:{type:"union",refs:["lex:tools.ozone.moderation.scheduleAction#takedown"]},subjects:{type:"array",maxLength:100,items:{type:"string",format:"did"},description:"Array of DID subjects to schedule the action for"},createdBy:{type:"string",format:"did"},scheduling:{type:"ref",ref:"lex:tools.ozone.moderation.scheduleAction#schedulingConfig"},modTool:{type:"ref",ref:"lex:tools.ozone.moderation.defs#modTool",description:"This will be propagated to the moderation event when it is applied"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.moderation.scheduleAction#scheduledActionResults"}}},takedown:{type:"object",description:"Schedule a takedown action",properties:{comment:{type:"string"},durationInHours:{type:"integer",description:"Indicates how long the takedown should be in effect before automatically expiring."},acknowledgeAccountSubjects:{type:"boolean",description:"If true, all other reports on content authored by this account will be resolved (acknowledged)."},policies:{type:"array",maxLength:5,items:{type:"string"},description:"Names/Keywords of the policies that drove the decision."}}},schedulingConfig:{type:"object",description:"Configuration for when the action should be executed",properties:{executeAt:{type:"string",format:"datetime",description:"Exact time to execute the action"},executeAfter:{type:"string",format:"datetime",description:"Earliest time to execute the action (for randomized scheduling)"},executeUntil:{type:"string",format:"datetime",description:"Latest time to execute the action (for randomized scheduling)"}}},scheduledActionResults:{type:"object",required:["succeeded","failed"],properties:{succeeded:{type:"array",items:{type:"string",format:"did"}},failed:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.scheduleAction#failedScheduling"}}}},failedScheduling:{type:"object",required:["subject","error"],properties:{subject:{type:"string",format:"did"},error:{type:"string"},errorCode:{type:"string"}}}}},ToolsOzoneModerationSearchRepos:{lexicon:1,id:"tools.ozone.moderation.searchRepos",defs:{main:{type:"query",description:"Find repositories based on a search term.",parameters:{type:"params",properties:{term:{type:"string",description:"DEPRECATED: use 'q' instead"},q:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["repos"],properties:{cursor:{type:"string"},repos:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.moderation.defs#repoView"}}}}}}}},ToolsOzoneReportDefs:{lexicon:1,id:"tools.ozone.report.defs",defs:{reasonType:{type:"string",knownValues:["tools.ozone.report.defs#reasonAppeal","tools.ozone.report.defs#reasonOther","tools.ozone.report.defs#reasonViolenceAnimal","tools.ozone.report.defs#reasonViolenceThreats","tools.ozone.report.defs#reasonViolenceGraphicContent","tools.ozone.report.defs#reasonViolenceGlorification","tools.ozone.report.defs#reasonViolenceExtremistContent","tools.ozone.report.defs#reasonViolenceTrafficking","tools.ozone.report.defs#reasonViolenceOther","tools.ozone.report.defs#reasonSexualAbuseContent","tools.ozone.report.defs#reasonSexualNCII","tools.ozone.report.defs#reasonSexualDeepfake","tools.ozone.report.defs#reasonSexualAnimal","tools.ozone.report.defs#reasonSexualUnlabeled","tools.ozone.report.defs#reasonSexualOther","tools.ozone.report.defs#reasonChildSafetyCSAM","tools.ozone.report.defs#reasonChildSafetyGroom","tools.ozone.report.defs#reasonChildSafetyPrivacy","tools.ozone.report.defs#reasonChildSafetyHarassment","tools.ozone.report.defs#reasonChildSafetyOther","tools.ozone.report.defs#reasonHarassmentTroll","tools.ozone.report.defs#reasonHarassmentTargeted","tools.ozone.report.defs#reasonHarassmentHateSpeech","tools.ozone.report.defs#reasonHarassmentDoxxing","tools.ozone.report.defs#reasonHarassmentOther","tools.ozone.report.defs#reasonMisleadingBot","tools.ozone.report.defs#reasonMisleadingImpersonation","tools.ozone.report.defs#reasonMisleadingSpam","tools.ozone.report.defs#reasonMisleadingScam","tools.ozone.report.defs#reasonMisleadingElections","tools.ozone.report.defs#reasonMisleadingOther","tools.ozone.report.defs#reasonRuleSiteSecurity","tools.ozone.report.defs#reasonRuleProhibitedSales","tools.ozone.report.defs#reasonRuleBanEvasion","tools.ozone.report.defs#reasonRuleOther","tools.ozone.report.defs#reasonSelfHarmContent","tools.ozone.report.defs#reasonSelfHarmED","tools.ozone.report.defs#reasonSelfHarmStunts","tools.ozone.report.defs#reasonSelfHarmSubstances","tools.ozone.report.defs#reasonSelfHarmOther"]},reasonAppeal:{type:"token",description:"Appeal a previously taken moderation action"},reasonOther:{type:"token",description:"An issue not included in these options"},reasonViolenceAnimal:{type:"token",description:"Animal welfare violations"},reasonViolenceThreats:{type:"token",description:"Threats or incitement"},reasonViolenceGraphicContent:{type:"token",description:"Graphic violent content"},reasonViolenceGlorification:{type:"token",description:"Glorification of violence"},reasonViolenceExtremistContent:{type:"token",description:"Extremist content. These reports will be sent only be sent to the application's Moderation Authority."},reasonViolenceTrafficking:{type:"token",description:"Human trafficking"},reasonViolenceOther:{type:"token",description:"Other violent content"},reasonSexualAbuseContent:{type:"token",description:"Adult sexual abuse content"},reasonSexualNCII:{type:"token",description:"Non-consensual intimate imagery"},reasonSexualDeepfake:{type:"token",description:"Deepfake adult content"},reasonSexualAnimal:{type:"token",description:"Animal sexual abuse"},reasonSexualUnlabeled:{type:"token",description:"Unlabelled adult content"},reasonSexualOther:{type:"token",description:"Other sexual violence content"},reasonChildSafetyCSAM:{type:"token",description:"Child sexual abuse material (CSAM). These reports will be sent only be sent to the application's Moderation Authority."},reasonChildSafetyGroom:{type:"token",description:"Grooming or predatory behavior. These reports will be sent only be sent to the application's Moderation Authority."},reasonChildSafetyPrivacy:{type:"token",description:"Privacy violation involving a minor"},reasonChildSafetyHarassment:{type:"token",description:"Harassment or bullying of minors"},reasonChildSafetyOther:{type:"token",description:"Other child safety. These reports will be sent only be sent to the application's Moderation Authority."},reasonHarassmentTroll:{type:"token",description:"Trolling"},reasonHarassmentTargeted:{type:"token",description:"Targeted harassment"},reasonHarassmentHateSpeech:{type:"token",description:"Hate speech"},reasonHarassmentDoxxing:{type:"token",description:"Doxxing"},reasonHarassmentOther:{type:"token",description:"Other harassing or hateful content"},reasonMisleadingBot:{type:"token",description:"Fake account or bot"},reasonMisleadingImpersonation:{type:"token",description:"Impersonation"},reasonMisleadingSpam:{type:"token",description:"Spam"},reasonMisleadingScam:{type:"token",description:"Scam"},reasonMisleadingElections:{type:"token",description:"False information about elections"},reasonMisleadingOther:{type:"token",description:"Other misleading content"},reasonRuleSiteSecurity:{type:"token",description:"Hacking or system attacks"},reasonRuleProhibitedSales:{type:"token",description:"Promoting or selling prohibited items or services"},reasonRuleBanEvasion:{type:"token",description:"Banned user returning"},reasonRuleOther:{type:"token",description:"Other"},reasonSelfHarmContent:{type:"token",description:"Content promoting or depicting self-harm"},reasonSelfHarmED:{type:"token",description:"Eating disorders"},reasonSelfHarmStunts:{type:"token",description:"Dangerous challenges or activities"},reasonSelfHarmSubstances:{type:"token",description:"Dangerous substances or drug abuse"},reasonSelfHarmOther:{type:"token",description:"Other dangerous content"}}},ToolsOzoneSafelinkAddRule:{lexicon:1,id:"tools.ozone.safelink.addRule",defs:{main:{type:"procedure",description:"Add a new URL safety rule",input:{encoding:"application/json",schema:{type:"object",required:["url","pattern","action","reason"],properties:{url:{type:"string",description:"The URL or domain to apply the rule to"},pattern:{type:"ref",ref:"lex:tools.ozone.safelink.defs#patternType"},action:{type:"ref",ref:"lex:tools.ozone.safelink.defs#actionType"},reason:{type:"ref",ref:"lex:tools.ozone.safelink.defs#reasonType"},comment:{type:"string",description:"Optional comment about the decision"},createdBy:{type:"string",format:"did",description:"Author DID. Only respected when using admin auth"}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.safelink.defs#event"}},errors:[{name:"InvalidUrl",description:"The provided URL is invalid"},{name:"RuleAlreadyExists",description:"A rule for this URL/domain already exists"}]}}},ToolsOzoneSafelinkDefs:{lexicon:1,id:"tools.ozone.safelink.defs",defs:{event:{type:"object",description:"An event for URL safety decisions",required:["id","eventType","url","pattern","action","reason","createdBy","createdAt"],properties:{id:{type:"integer",description:"Auto-incrementing row ID"},eventType:{type:"ref",ref:"lex:tools.ozone.safelink.defs#eventType"},url:{type:"string",description:"The URL that this rule applies to"},pattern:{type:"ref",ref:"lex:tools.ozone.safelink.defs#patternType"},action:{type:"ref",ref:"lex:tools.ozone.safelink.defs#actionType"},reason:{type:"ref",ref:"lex:tools.ozone.safelink.defs#reasonType"},createdBy:{type:"string",format:"did",description:"DID of the user who created this rule"},createdAt:{type:"string",format:"datetime"},comment:{type:"string",description:"Optional comment about the decision"}}},eventType:{type:"string",knownValues:["addRule","updateRule","removeRule"]},patternType:{type:"string",knownValues:["domain","url"]},actionType:{type:"string",knownValues:["block","warn","whitelist"]},reasonType:{type:"string",knownValues:["csam","spam","phishing","none"]},urlRule:{type:"object",description:"Input for creating a URL safety rule",required:["url","pattern","action","reason","createdBy","createdAt","updatedAt"],properties:{url:{type:"string",description:"The URL or domain to apply the rule to"},pattern:{type:"ref",ref:"lex:tools.ozone.safelink.defs#patternType"},action:{type:"ref",ref:"lex:tools.ozone.safelink.defs#actionType"},reason:{type:"ref",ref:"lex:tools.ozone.safelink.defs#reasonType"},comment:{type:"string",description:"Optional comment about the decision"},createdBy:{type:"string",format:"did",description:"DID of the user added the rule."},createdAt:{type:"string",format:"datetime",description:"Timestamp when the rule was created"},updatedAt:{type:"string",format:"datetime",description:"Timestamp when the rule was last updated"}}}}},ToolsOzoneSafelinkQueryEvents:{lexicon:1,id:"tools.ozone.safelink.queryEvents",defs:{main:{type:"procedure",description:"Query URL safety audit events",input:{encoding:"application/json",schema:{type:"object",properties:{cursor:{type:"string",description:"Cursor for pagination"},limit:{type:"integer",minimum:1,maximum:100,default:50,description:"Maximum number of results to return"},urls:{type:"array",items:{type:"string"},description:"Filter by specific URLs or domains"},patternType:{type:"string",description:"Filter by pattern type"},sortDirection:{type:"string",knownValues:["asc","desc"],default:"desc",description:"Sort direction"}}}},output:{encoding:"application/json",schema:{type:"object",required:["events"],properties:{cursor:{type:"string",description:"Next cursor for pagination. Only present if there are more results."},events:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.safelink.defs#event"}}}}}}}},ToolsOzoneSafelinkQueryRules:{lexicon:1,id:"tools.ozone.safelink.queryRules",defs:{main:{type:"procedure",description:"Query URL safety rules",input:{encoding:"application/json",schema:{type:"object",properties:{cursor:{type:"string",description:"Cursor for pagination"},limit:{type:"integer",minimum:1,maximum:100,default:50,description:"Maximum number of results to return"},urls:{type:"array",items:{type:"string"},description:"Filter by specific URLs or domains"},patternType:{type:"string",description:"Filter by pattern type"},actions:{type:"array",items:{type:"string"},description:"Filter by action types"},reason:{type:"string",description:"Filter by reason type"},createdBy:{type:"string",format:"did",description:"Filter by rule creator"},sortDirection:{type:"string",knownValues:["asc","desc"],default:"desc",description:"Sort direction"}}}},output:{encoding:"application/json",schema:{type:"object",required:["rules"],properties:{cursor:{type:"string",description:"Next cursor for pagination. Only present if there are more results."},rules:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.safelink.defs#urlRule"}}}}}}}},ToolsOzoneSafelinkRemoveRule:{lexicon:1,id:"tools.ozone.safelink.removeRule",defs:{main:{type:"procedure",description:"Remove an existing URL safety rule",input:{encoding:"application/json",schema:{type:"object",required:["url","pattern"],properties:{url:{type:"string",description:"The URL or domain to remove the rule for"},pattern:{type:"ref",ref:"lex:tools.ozone.safelink.defs#patternType"},comment:{type:"string",description:"Optional comment about why the rule is being removed"},createdBy:{type:"string",format:"did",description:"Optional DID of the user. Only respected when using admin auth."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.safelink.defs#event"}},errors:[{name:"RuleNotFound",description:"No active rule found for this URL/domain"}]}}},ToolsOzoneSafelinkUpdateRule:{lexicon:1,id:"tools.ozone.safelink.updateRule",defs:{main:{type:"procedure",description:"Update an existing URL safety rule",input:{encoding:"application/json",schema:{type:"object",required:["url","pattern","action","reason"],properties:{url:{type:"string",description:"The URL or domain to update the rule for"},pattern:{type:"ref",ref:"lex:tools.ozone.safelink.defs#patternType"},action:{type:"ref",ref:"lex:tools.ozone.safelink.defs#actionType"},reason:{type:"ref",ref:"lex:tools.ozone.safelink.defs#reasonType"},comment:{type:"string",description:"Optional comment about the update"},createdBy:{type:"string",format:"did",description:"Optional DID to credit as the creator. Only respected for admin_token authentication."}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.safelink.defs#event"}},errors:[{name:"RuleNotFound",description:"No active rule found for this URL/domain"}]}}},ToolsOzoneServerGetConfig:{lexicon:1,id:"tools.ozone.server.getConfig",defs:{main:{type:"query",description:"Get details about ozone's server configuration.",output:{encoding:"application/json",schema:{type:"object",properties:{appview:{type:"ref",ref:"lex:tools.ozone.server.getConfig#serviceConfig"},pds:{type:"ref",ref:"lex:tools.ozone.server.getConfig#serviceConfig"},blobDivert:{type:"ref",ref:"lex:tools.ozone.server.getConfig#serviceConfig"},chat:{type:"ref",ref:"lex:tools.ozone.server.getConfig#serviceConfig"},viewer:{type:"ref",ref:"lex:tools.ozone.server.getConfig#viewerConfig"},verifierDid:{type:"string",format:"did",description:"The did of the verifier used for verification."}}}}},serviceConfig:{type:"object",properties:{url:{type:"string",format:"uri"}}},viewerConfig:{type:"object",properties:{role:{type:"string",knownValues:["tools.ozone.team.defs#roleAdmin","tools.ozone.team.defs#roleModerator","tools.ozone.team.defs#roleTriage","tools.ozone.team.defs#roleVerifier"]}}}}},ToolsOzoneSetAddValues:{lexicon:1,id:"tools.ozone.set.addValues",defs:{main:{type:"procedure",description:"Add values to a specific set. Attempting to add values to a set that does not exist will result in an error.",input:{encoding:"application/json",schema:{type:"object",required:["name","values"],properties:{name:{type:"string",description:"Name of the set to add values to"},values:{type:"array",minLength:1,maxLength:1e3,items:{type:"string"},description:"Array of string values to add to the set"}}}}}}},ToolsOzoneSetDefs:{lexicon:1,id:"tools.ozone.set.defs",defs:{set:{type:"object",required:["name"],properties:{name:{type:"string",minLength:3,maxLength:128},description:{type:"string",maxGraphemes:1024,maxLength:10240}}},setView:{type:"object",required:["name","setSize","createdAt","updatedAt"],properties:{name:{type:"string",minLength:3,maxLength:128},description:{type:"string",maxGraphemes:1024,maxLength:10240},setSize:{type:"integer"},createdAt:{type:"string",format:"datetime"},updatedAt:{type:"string",format:"datetime"}}}}},ToolsOzoneSetDeleteSet:{lexicon:1,id:"tools.ozone.set.deleteSet",defs:{main:{type:"procedure",description:"Delete an entire set. Attempting to delete a set that does not exist will result in an error.",input:{encoding:"application/json",schema:{type:"object",required:["name"],properties:{name:{type:"string",description:"Name of the set to delete"}}}},output:{encoding:"application/json",schema:{type:"object",properties:{}}},errors:[{name:"SetNotFound",description:"set with the given name does not exist"}]}}},ToolsOzoneSetDeleteValues:{lexicon:1,id:"tools.ozone.set.deleteValues",defs:{main:{type:"procedure",description:"Delete values from a specific set. Attempting to delete values that are not in the set will not result in an error",input:{encoding:"application/json",schema:{type:"object",required:["name","values"],properties:{name:{type:"string",description:"Name of the set to delete values from"},values:{type:"array",minLength:1,items:{type:"string"},description:"Array of string values to delete from the set"}}}},errors:[{name:"SetNotFound",description:"set with the given name does not exist"}]}}},ToolsOzoneSetGetValues:{lexicon:1,id:"tools.ozone.set.getValues",defs:{main:{type:"query",description:"Get a specific set and its values",parameters:{type:"params",required:["name"],properties:{name:{type:"string"},limit:{type:"integer",minimum:1,maximum:1e3,default:100},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["set","values"],properties:{set:{type:"ref",ref:"lex:tools.ozone.set.defs#setView"},values:{type:"array",items:{type:"string"}},cursor:{type:"string"}}}},errors:[{name:"SetNotFound",description:"set with the given name does not exist"}]}}},ToolsOzoneSetQuerySets:{lexicon:1,id:"tools.ozone.set.querySets",defs:{main:{type:"query",description:"Query available sets",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},namePrefix:{type:"string"},sortBy:{type:"string",enum:["name","createdAt","updatedAt"],default:"name"},sortDirection:{type:"string",default:"asc",enum:["asc","desc"],description:"Defaults to ascending order of name field."}}},output:{encoding:"application/json",schema:{type:"object",required:["sets"],properties:{sets:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.set.defs#setView"}},cursor:{type:"string"}}}}}}},ToolsOzoneSetUpsertSet:{lexicon:1,id:"tools.ozone.set.upsertSet",defs:{main:{type:"procedure",description:"Create or update set metadata",input:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.set.defs#set"}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.set.defs#setView"}}}}},ToolsOzoneSettingDefs:{lexicon:1,id:"tools.ozone.setting.defs",defs:{option:{type:"object",required:["key","value","did","scope","createdBy","lastUpdatedBy"],properties:{key:{type:"string",format:"nsid"},did:{type:"string",format:"did"},value:{type:"unknown"},description:{type:"string",maxGraphemes:1024,maxLength:10240},createdAt:{type:"string",format:"datetime"},updatedAt:{type:"string",format:"datetime"},managerRole:{type:"string",knownValues:["tools.ozone.team.defs#roleModerator","tools.ozone.team.defs#roleTriage","tools.ozone.team.defs#roleAdmin","tools.ozone.team.defs#roleVerifier"]},scope:{type:"string",knownValues:["instance","personal"]},createdBy:{type:"string",format:"did"},lastUpdatedBy:{type:"string",format:"did"}}}}},ToolsOzoneSettingListOptions:{lexicon:1,id:"tools.ozone.setting.listOptions",defs:{main:{type:"query",description:"List settings with optional filtering",parameters:{type:"params",properties:{limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"},scope:{type:"string",knownValues:["instance","personal"],default:"instance"},prefix:{type:"string",description:"Filter keys by prefix"},keys:{type:"array",maxLength:100,items:{type:"string",format:"nsid"},description:"Filter for only the specified keys. Ignored if prefix is provided"}}},output:{encoding:"application/json",schema:{type:"object",required:["options"],properties:{cursor:{type:"string"},options:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.setting.defs#option"}}}}}}}},ToolsOzoneSettingRemoveOptions:{lexicon:1,id:"tools.ozone.setting.removeOptions",defs:{main:{type:"procedure",description:"Delete settings by key",input:{encoding:"application/json",schema:{type:"object",required:["keys","scope"],properties:{keys:{type:"array",minLength:1,maxLength:200,items:{type:"string",format:"nsid"}},scope:{type:"string",knownValues:["instance","personal"]}}}},output:{encoding:"application/json",schema:{type:"object",properties:{}}}}}},ToolsOzoneSettingUpsertOption:{lexicon:1,id:"tools.ozone.setting.upsertOption",defs:{main:{type:"procedure",description:"Create or update setting option",input:{encoding:"application/json",schema:{type:"object",required:["key","scope","value"],properties:{key:{type:"string",format:"nsid"},scope:{type:"string",knownValues:["instance","personal"]},value:{type:"unknown"},description:{type:"string",maxLength:2e3},managerRole:{type:"string",knownValues:["tools.ozone.team.defs#roleModerator","tools.ozone.team.defs#roleTriage","tools.ozone.team.defs#roleVerifier","tools.ozone.team.defs#roleAdmin"]}}}},output:{encoding:"application/json",schema:{type:"object",required:["option"],properties:{option:{type:"ref",ref:"lex:tools.ozone.setting.defs#option"}}}}}}},ToolsOzoneSignatureDefs:{lexicon:1,id:"tools.ozone.signature.defs",defs:{sigDetail:{type:"object",required:["property","value"],properties:{property:{type:"string"},value:{type:"string"}}}}},ToolsOzoneSignatureFindCorrelation:{lexicon:1,id:"tools.ozone.signature.findCorrelation",defs:{main:{type:"query",description:"Find all correlated threat signatures between 2 or more accounts.",parameters:{type:"params",required:["dids"],properties:{dids:{type:"array",items:{type:"string",format:"did"}}}},output:{encoding:"application/json",schema:{type:"object",required:["details"],properties:{details:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.signature.defs#sigDetail"}}}}}}}},ToolsOzoneSignatureFindRelatedAccounts:{lexicon:1,id:"tools.ozone.signature.findRelatedAccounts",defs:{main:{type:"query",description:"Get accounts that share some matching threat signatures with the root account.",parameters:{type:"params",required:["did"],properties:{did:{type:"string",format:"did"},cursor:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50}}},output:{encoding:"application/json",schema:{type:"object",required:["accounts"],properties:{cursor:{type:"string"},accounts:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.signature.findRelatedAccounts#relatedAccount"}}}}}},relatedAccount:{type:"object",required:["account"],properties:{account:{type:"ref",ref:"lex:com.atproto.admin.defs#accountView"},similarities:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.signature.defs#sigDetail"}}}}}},ToolsOzoneSignatureSearchAccounts:{lexicon:1,id:"tools.ozone.signature.searchAccounts",defs:{main:{type:"query",description:"Search for accounts that match one or more threat signature values.",parameters:{type:"params",required:["values"],properties:{values:{type:"array",items:{type:"string"}},cursor:{type:"string"},limit:{type:"integer",minimum:1,maximum:100,default:50}}},output:{encoding:"application/json",schema:{type:"object",required:["accounts"],properties:{cursor:{type:"string"},accounts:{type:"array",items:{type:"ref",ref:"lex:com.atproto.admin.defs#accountView"}}}}}}}},ToolsOzoneTeamAddMember:{lexicon:1,id:"tools.ozone.team.addMember",defs:{main:{type:"procedure",description:"Add a member to the ozone team. Requires admin role.",input:{encoding:"application/json",schema:{type:"object",required:["did","role"],properties:{did:{type:"string",format:"did"},role:{type:"string",knownValues:["tools.ozone.team.defs#roleAdmin","tools.ozone.team.defs#roleModerator","tools.ozone.team.defs#roleVerifier","tools.ozone.team.defs#roleTriage"]}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.team.defs#member"}},errors:[{name:"MemberAlreadyExists",description:"Member already exists in the team."}]}}},ToolsOzoneTeamDefs:{lexicon:1,id:"tools.ozone.team.defs",defs:{member:{type:"object",required:["did","role"],properties:{did:{type:"string",format:"did"},disabled:{type:"boolean"},profile:{type:"ref",ref:"lex:app.bsky.actor.defs#profileViewDetailed"},createdAt:{type:"string",format:"datetime"},updatedAt:{type:"string",format:"datetime"},lastUpdatedBy:{type:"string"},role:{type:"string",knownValues:["lex:tools.ozone.team.defs#roleAdmin","lex:tools.ozone.team.defs#roleModerator","lex:tools.ozone.team.defs#roleTriage","lex:tools.ozone.team.defs#roleVerifier"]}}},roleAdmin:{type:"token",description:"Admin role. Highest level of access, can perform all actions."},roleModerator:{type:"token",description:"Moderator role. Can perform most actions."},roleTriage:{type:"token",description:"Triage role. Mostly intended for monitoring and escalating issues."},roleVerifier:{type:"token",description:"Verifier role. Only allowed to issue verifications."}}},ToolsOzoneTeamDeleteMember:{lexicon:1,id:"tools.ozone.team.deleteMember",defs:{main:{type:"procedure",description:"Delete a member from ozone team. Requires admin role.",input:{encoding:"application/json",schema:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"}}}},errors:[{name:"MemberNotFound",description:"The member being deleted does not exist"},{name:"CannotDeleteSelf",description:"You can not delete yourself from the team"}]}}},ToolsOzoneTeamListMembers:{lexicon:1,id:"tools.ozone.team.listMembers",defs:{main:{type:"query",description:"List all members with access to the ozone service.",parameters:{type:"params",properties:{q:{type:"string"},disabled:{type:"boolean"},roles:{type:"array",items:{type:"string"}},limit:{type:"integer",minimum:1,maximum:100,default:50},cursor:{type:"string"}}},output:{encoding:"application/json",schema:{type:"object",required:["members"],properties:{cursor:{type:"string"},members:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.team.defs#member"}}}}}}}},ToolsOzoneTeamUpdateMember:{lexicon:1,id:"tools.ozone.team.updateMember",defs:{main:{type:"procedure",description:"Update a member in the ozone service. Requires admin role.",input:{encoding:"application/json",schema:{type:"object",required:["did"],properties:{did:{type:"string",format:"did"},disabled:{type:"boolean"},role:{type:"string",knownValues:["tools.ozone.team.defs#roleAdmin","tools.ozone.team.defs#roleModerator","tools.ozone.team.defs#roleVerifier","tools.ozone.team.defs#roleTriage"]}}}},output:{encoding:"application/json",schema:{type:"ref",ref:"lex:tools.ozone.team.defs#member"}},errors:[{name:"MemberNotFound",description:"The member being updated does not exist in the team"}]}}},ToolsOzoneVerificationDefs:{lexicon:1,id:"tools.ozone.verification.defs",defs:{verificationView:{type:"object",description:"Verification data for the associated subject.",required:["issuer","uri","subject","handle","displayName","createdAt"],properties:{issuer:{type:"string",description:"The user who issued this verification.",format:"did"},uri:{type:"string",description:"The AT-URI of the verification record.",format:"at-uri"},subject:{type:"string",format:"did",description:"The subject of the verification."},handle:{type:"string",description:"Handle of the subject the verification applies to at the moment of verifying, which might not be the same at the time of viewing. The verification is only valid if the current handle matches the one at the time of verifying.",format:"handle"},displayName:{type:"string",description:"Display name of the subject the verification applies to at the moment of verifying, which might not be the same at the time of viewing. The verification is only valid if the current displayName matches the one at the time of verifying."},createdAt:{type:"string",description:"Timestamp when the verification was created.",format:"datetime"},revokeReason:{type:"string",description:"Describes the reason for revocation, also indicating that the verification is no longer valid."},revokedAt:{type:"string",description:"Timestamp when the verification was revoked.",format:"datetime"},revokedBy:{type:"string",description:"The user who revoked this verification.",format:"did"},subjectProfile:{type:"union",refs:[]},issuerProfile:{type:"union",refs:[]},subjectRepo:{type:"union",refs:["lex:tools.ozone.moderation.defs#repoViewDetail","lex:tools.ozone.moderation.defs#repoViewNotFound"]},issuerRepo:{type:"union",refs:["lex:tools.ozone.moderation.defs#repoViewDetail","lex:tools.ozone.moderation.defs#repoViewNotFound"]}}}}},ToolsOzoneVerificationGrantVerifications:{lexicon:1,id:"tools.ozone.verification.grantVerifications",defs:{main:{type:"procedure",description:"Grant verifications to multiple subjects. Allows batch processing of up to 100 verifications at once.",input:{encoding:"application/json",schema:{type:"object",required:["verifications"],properties:{verifications:{type:"array",description:"Array of verification requests to process",maxLength:100,items:{type:"ref",ref:"lex:tools.ozone.verification.grantVerifications#verificationInput"}}}}},output:{encoding:"application/json",schema:{type:"object",required:["verifications","failedVerifications"],properties:{verifications:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.verification.defs#verificationView"}},failedVerifications:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.verification.grantVerifications#grantError"}}}}}},verificationInput:{type:"object",required:["subject","handle","displayName"],properties:{subject:{type:"string",description:"The did of the subject being verified",format:"did"},handle:{type:"string",description:"Handle of the subject the verification applies to at the moment of verifying.",format:"handle"},displayName:{type:"string",description:"Display name of the subject the verification applies to at the moment of verifying."},createdAt:{type:"string",format:"datetime",description:"Timestamp for verification record. Defaults to current time when not specified."}}},grantError:{type:"object",description:"Error object for failed verifications.",required:["error","subject"],properties:{error:{type:"string",description:"Error message describing the reason for failure."},subject:{type:"string",description:"The did of the subject being verified",format:"did"}}}}},ToolsOzoneVerificationListVerifications:{lexicon:1,id:"tools.ozone.verification.listVerifications",defs:{main:{type:"query",description:"List verifications",parameters:{type:"params",properties:{cursor:{type:"string",description:"Pagination cursor"},limit:{type:"integer",description:"Maximum number of results to return",minimum:1,maximum:100,default:50},createdAfter:{type:"string",format:"datetime",description:"Filter to verifications created after this timestamp"},createdBefore:{type:"string",format:"datetime",description:"Filter to verifications created before this timestamp"},issuers:{type:"array",maxLength:100,description:"Filter to verifications from specific issuers",items:{type:"string",format:"did"}},subjects:{type:"array",description:"Filter to specific verified DIDs",maxLength:100,items:{type:"string",format:"did"}},sortDirection:{type:"string",description:"Sort direction for creation date",enum:["asc","desc"],default:"desc"},isRevoked:{type:"boolean",description:"Filter to verifications that are revoked or not. By default, includes both."}}},output:{encoding:"application/json",schema:{type:"object",required:["verifications"],properties:{cursor:{type:"string"},verifications:{type:"array",items:{type:"ref",ref:"lex:tools.ozone.verification.defs#verificationView"}}}}}}}},ToolsOzoneVerificationRevokeVerifications:{lexicon:1,id:"tools.ozone.verification.revokeVerifications",defs:{main:{type:"procedure",description:"Revoke previously granted verifications in batches of up to 100.",input:{encoding:"application/json",schema:{type:"object",required:["uris"],properties:{uris:{type:"array",description:"Array of verification record uris to revoke",maxLength:100,items:{type:"string",description:"The AT-URI of the verification record to revoke.",format:"at-uri"}},revokeReason:{type:"string",description:"Reason for revoking the verification. This is optional and can be omitted if not needed.",maxLength:1e3}}}},output:{encoding:"application/json",schema:{type:"object",required:["revokedVerifications","failedRevocations"],properties:{revokedVerifications:{type:"array",description:"List of verification uris successfully revoked",items:{type:"string",format:"at-uri"}},failedRevocations:{type:"array",description:"List of verification uris that couldn't be revoked, including failure reasons",items:{type:"ref",ref:"lex:tools.ozone.verification.revokeVerifications#revokeError"}}}}}},revokeError:{type:"object",description:"Error object for failed revocations",required:["uri","error"],properties:{uri:{type:"string",description:"The AT-URI of the verification record that failed to revoke.",format:"at-uri"},error:{type:"string",description:"Description of the error that occurred during revocation."}}}}}},i.schemas=Object.values(i.schemaDict),i.lexicons=new n.Lexicons(i.schemas);function c(f,y,e,l){return(l?a.is$typed:a.maybe$typed)(f,y,e)?i.lexicons.validate(`${y}#${e}`,f):{success:!1,error:new n.ValidationError(`Must be an object with "${e==="main"?y:`${y}#${e}`}" $type property`)}}i.ids={AppBskyActorDefs:"app.bsky.actor.defs",AppBskyActorGetPreferences:"app.bsky.actor.getPreferences",AppBskyActorGetProfile:"app.bsky.actor.getProfile",AppBskyActorGetProfiles:"app.bsky.actor.getProfiles",AppBskyActorGetSuggestions:"app.bsky.actor.getSuggestions",AppBskyActorProfile:"app.bsky.actor.profile",AppBskyActorPutPreferences:"app.bsky.actor.putPreferences",AppBskyActorSearchActors:"app.bsky.actor.searchActors",AppBskyActorSearchActorsTypeahead:"app.bsky.actor.searchActorsTypeahead",AppBskyActorStatus:"app.bsky.actor.status",AppBskyBookmarkCreateBookmark:"app.bsky.bookmark.createBookmark",AppBskyBookmarkDefs:"app.bsky.bookmark.defs",AppBskyBookmarkDeleteBookmark:"app.bsky.bookmark.deleteBookmark",AppBskyBookmarkGetBookmarks:"app.bsky.bookmark.getBookmarks",AppBskyEmbedDefs:"app.bsky.embed.defs",AppBskyEmbedExternal:"app.bsky.embed.external",AppBskyEmbedImages:"app.bsky.embed.images",AppBskyEmbedRecord:"app.bsky.embed.record",AppBskyEmbedRecordWithMedia:"app.bsky.embed.recordWithMedia",AppBskyEmbedVideo:"app.bsky.embed.video",AppBskyFeedDefs:"app.bsky.feed.defs",AppBskyFeedDescribeFeedGenerator:"app.bsky.feed.describeFeedGenerator",AppBskyFeedGenerator:"app.bsky.feed.generator",AppBskyFeedGetActorFeeds:"app.bsky.feed.getActorFeeds",AppBskyFeedGetActorLikes:"app.bsky.feed.getActorLikes",AppBskyFeedGetAuthorFeed:"app.bsky.feed.getAuthorFeed",AppBskyFeedGetFeed:"app.bsky.feed.getFeed",AppBskyFeedGetFeedGenerator:"app.bsky.feed.getFeedGenerator",AppBskyFeedGetFeedGenerators:"app.bsky.feed.getFeedGenerators",AppBskyFeedGetFeedSkeleton:"app.bsky.feed.getFeedSkeleton",AppBskyFeedGetLikes:"app.bsky.feed.getLikes",AppBskyFeedGetListFeed:"app.bsky.feed.getListFeed",AppBskyFeedGetPostThread:"app.bsky.feed.getPostThread",AppBskyFeedGetPosts:"app.bsky.feed.getPosts",AppBskyFeedGetQuotes:"app.bsky.feed.getQuotes",AppBskyFeedGetRepostedBy:"app.bsky.feed.getRepostedBy",AppBskyFeedGetSuggestedFeeds:"app.bsky.feed.getSuggestedFeeds",AppBskyFeedGetTimeline:"app.bsky.feed.getTimeline",AppBskyFeedLike:"app.bsky.feed.like",AppBskyFeedPost:"app.bsky.feed.post",AppBskyFeedPostgate:"app.bsky.feed.postgate",AppBskyFeedRepost:"app.bsky.feed.repost",AppBskyFeedSearchPosts:"app.bsky.feed.searchPosts",AppBskyFeedSendInteractions:"app.bsky.feed.sendInteractions",AppBskyFeedThreadgate:"app.bsky.feed.threadgate",AppBskyGraphBlock:"app.bsky.graph.block",AppBskyGraphDefs:"app.bsky.graph.defs",AppBskyGraphFollow:"app.bsky.graph.follow",AppBskyGraphGetActorStarterPacks:"app.bsky.graph.getActorStarterPacks",AppBskyGraphGetBlocks:"app.bsky.graph.getBlocks",AppBskyGraphGetFollowers:"app.bsky.graph.getFollowers",AppBskyGraphGetFollows:"app.bsky.graph.getFollows",AppBskyGraphGetKnownFollowers:"app.bsky.graph.getKnownFollowers",AppBskyGraphGetList:"app.bsky.graph.getList",AppBskyGraphGetListBlocks:"app.bsky.graph.getListBlocks",AppBskyGraphGetListMutes:"app.bsky.graph.getListMutes",AppBskyGraphGetLists:"app.bsky.graph.getLists",AppBskyGraphGetListsWithMembership:"app.bsky.graph.getListsWithMembership",AppBskyGraphGetMutes:"app.bsky.graph.getMutes",AppBskyGraphGetRelationships:"app.bsky.graph.getRelationships",AppBskyGraphGetStarterPack:"app.bsky.graph.getStarterPack",AppBskyGraphGetStarterPacks:"app.bsky.graph.getStarterPacks",AppBskyGraphGetStarterPacksWithMembership:"app.bsky.graph.getStarterPacksWithMembership",AppBskyGraphGetSuggestedFollowsByActor:"app.bsky.graph.getSuggestedFollowsByActor",AppBskyGraphList:"app.bsky.graph.list",AppBskyGraphListblock:"app.bsky.graph.listblock",AppBskyGraphListitem:"app.bsky.graph.listitem",AppBskyGraphMuteActor:"app.bsky.graph.muteActor",AppBskyGraphMuteActorList:"app.bsky.graph.muteActorList",AppBskyGraphMuteThread:"app.bsky.graph.muteThread",AppBskyGraphSearchStarterPacks:"app.bsky.graph.searchStarterPacks",AppBskyGraphStarterpack:"app.bsky.graph.starterpack",AppBskyGraphUnmuteActor:"app.bsky.graph.unmuteActor",AppBskyGraphUnmuteActorList:"app.bsky.graph.unmuteActorList",AppBskyGraphUnmuteThread:"app.bsky.graph.unmuteThread",AppBskyGraphVerification:"app.bsky.graph.verification",AppBskyLabelerDefs:"app.bsky.labeler.defs",AppBskyLabelerGetServices:"app.bsky.labeler.getServices",AppBskyLabelerService:"app.bsky.labeler.service",AppBskyNotificationDeclaration:"app.bsky.notification.declaration",AppBskyNotificationDefs:"app.bsky.notification.defs",AppBskyNotificationGetPreferences:"app.bsky.notification.getPreferences",AppBskyNotificationGetUnreadCount:"app.bsky.notification.getUnreadCount",AppBskyNotificationListActivitySubscriptions:"app.bsky.notification.listActivitySubscriptions",AppBskyNotificationListNotifications:"app.bsky.notification.listNotifications",AppBskyNotificationPutActivitySubscription:"app.bsky.notification.putActivitySubscription",AppBskyNotificationPutPreferences:"app.bsky.notification.putPreferences",AppBskyNotificationPutPreferencesV2:"app.bsky.notification.putPreferencesV2",AppBskyNotificationRegisterPush:"app.bsky.notification.registerPush",AppBskyNotificationUnregisterPush:"app.bsky.notification.unregisterPush",AppBskyNotificationUpdateSeen:"app.bsky.notification.updateSeen",AppBskyRichtextFacet:"app.bsky.richtext.facet",AppBskyUnspeccedDefs:"app.bsky.unspecced.defs",AppBskyUnspeccedGetAgeAssuranceState:"app.bsky.unspecced.getAgeAssuranceState",AppBskyUnspeccedGetConfig:"app.bsky.unspecced.getConfig",AppBskyUnspeccedGetOnboardingSuggestedStarterPacks:"app.bsky.unspecced.getOnboardingSuggestedStarterPacks",AppBskyUnspeccedGetOnboardingSuggestedStarterPacksSkeleton:"app.bsky.unspecced.getOnboardingSuggestedStarterPacksSkeleton",AppBskyUnspeccedGetPopularFeedGenerators:"app.bsky.unspecced.getPopularFeedGenerators",AppBskyUnspeccedGetPostThreadOtherV2:"app.bsky.unspecced.getPostThreadOtherV2",AppBskyUnspeccedGetPostThreadV2:"app.bsky.unspecced.getPostThreadV2",AppBskyUnspeccedGetSuggestedFeeds:"app.bsky.unspecced.getSuggestedFeeds",AppBskyUnspeccedGetSuggestedFeedsSkeleton:"app.bsky.unspecced.getSuggestedFeedsSkeleton",AppBskyUnspeccedGetSuggestedStarterPacks:"app.bsky.unspecced.getSuggestedStarterPacks",AppBskyUnspeccedGetSuggestedStarterPacksSkeleton:"app.bsky.unspecced.getSuggestedStarterPacksSkeleton",AppBskyUnspeccedGetSuggestedUsers:"app.bsky.unspecced.getSuggestedUsers",AppBskyUnspeccedGetSuggestedUsersSkeleton:"app.bsky.unspecced.getSuggestedUsersSkeleton",AppBskyUnspeccedGetSuggestionsSkeleton:"app.bsky.unspecced.getSuggestionsSkeleton",AppBskyUnspeccedGetTaggedSuggestions:"app.bsky.unspecced.getTaggedSuggestions",AppBskyUnspeccedGetTrendingTopics:"app.bsky.unspecced.getTrendingTopics",AppBskyUnspeccedGetTrends:"app.bsky.unspecced.getTrends",AppBskyUnspeccedGetTrendsSkeleton:"app.bsky.unspecced.getTrendsSkeleton",AppBskyUnspeccedInitAgeAssurance:"app.bsky.unspecced.initAgeAssurance",AppBskyUnspeccedSearchActorsSkeleton:"app.bsky.unspecced.searchActorsSkeleton",AppBskyUnspeccedSearchPostsSkeleton:"app.bsky.unspecced.searchPostsSkeleton",AppBskyUnspeccedSearchStarterPacksSkeleton:"app.bsky.unspecced.searchStarterPacksSkeleton",AppBskyVideoDefs:"app.bsky.video.defs",AppBskyVideoGetJobStatus:"app.bsky.video.getJobStatus",AppBskyVideoGetUploadLimits:"app.bsky.video.getUploadLimits",AppBskyVideoUploadVideo:"app.bsky.video.uploadVideo",ChatBskyActorDeclaration:"chat.bsky.actor.declaration",ChatBskyActorDefs:"chat.bsky.actor.defs",ChatBskyActorDeleteAccount:"chat.bsky.actor.deleteAccount",ChatBskyActorExportAccountData:"chat.bsky.actor.exportAccountData",ChatBskyConvoAcceptConvo:"chat.bsky.convo.acceptConvo",ChatBskyConvoAddReaction:"chat.bsky.convo.addReaction",ChatBskyConvoDefs:"chat.bsky.convo.defs",ChatBskyConvoDeleteMessageForSelf:"chat.bsky.convo.deleteMessageForSelf",ChatBskyConvoGetConvo:"chat.bsky.convo.getConvo",ChatBskyConvoGetConvoAvailability:"chat.bsky.convo.getConvoAvailability",ChatBskyConvoGetConvoForMembers:"chat.bsky.convo.getConvoForMembers",ChatBskyConvoGetLog:"chat.bsky.convo.getLog",ChatBskyConvoGetMessages:"chat.bsky.convo.getMessages",ChatBskyConvoLeaveConvo:"chat.bsky.convo.leaveConvo",ChatBskyConvoListConvos:"chat.bsky.convo.listConvos",ChatBskyConvoMuteConvo:"chat.bsky.convo.muteConvo",ChatBskyConvoRemoveReaction:"chat.bsky.convo.removeReaction",ChatBskyConvoSendMessage:"chat.bsky.convo.sendMessage",ChatBskyConvoSendMessageBatch:"chat.bsky.convo.sendMessageBatch",ChatBskyConvoUnmuteConvo:"chat.bsky.convo.unmuteConvo",ChatBskyConvoUpdateAllRead:"chat.bsky.convo.updateAllRead",ChatBskyConvoUpdateRead:"chat.bsky.convo.updateRead",ChatBskyModerationGetActorMetadata:"chat.bsky.moderation.getActorMetadata",ChatBskyModerationGetMessageContext:"chat.bsky.moderation.getMessageContext",ChatBskyModerationUpdateActorAccess:"chat.bsky.moderation.updateActorAccess",ComAtprotoAdminDefs:"com.atproto.admin.defs",ComAtprotoAdminDeleteAccount:"com.atproto.admin.deleteAccount",ComAtprotoAdminDisableAccountInvites:"com.atproto.admin.disableAccountInvites",ComAtprotoAdminDisableInviteCodes:"com.atproto.admin.disableInviteCodes",ComAtprotoAdminEnableAccountInvites:"com.atproto.admin.enableAccountInvites",ComAtprotoAdminGetAccountInfo:"com.atproto.admin.getAccountInfo",ComAtprotoAdminGetAccountInfos:"com.atproto.admin.getAccountInfos",ComAtprotoAdminGetInviteCodes:"com.atproto.admin.getInviteCodes",ComAtprotoAdminGetSubjectStatus:"com.atproto.admin.getSubjectStatus",ComAtprotoAdminSearchAccounts:"com.atproto.admin.searchAccounts",ComAtprotoAdminSendEmail:"com.atproto.admin.sendEmail",ComAtprotoAdminUpdateAccountEmail:"com.atproto.admin.updateAccountEmail",ComAtprotoAdminUpdateAccountHandle:"com.atproto.admin.updateAccountHandle",ComAtprotoAdminUpdateAccountPassword:"com.atproto.admin.updateAccountPassword",ComAtprotoAdminUpdateAccountSigningKey:"com.atproto.admin.updateAccountSigningKey",ComAtprotoAdminUpdateSubjectStatus:"com.atproto.admin.updateSubjectStatus",ComAtprotoIdentityDefs:"com.atproto.identity.defs",ComAtprotoIdentityGetRecommendedDidCredentials:"com.atproto.identity.getRecommendedDidCredentials",ComAtprotoIdentityRefreshIdentity:"com.atproto.identity.refreshIdentity",ComAtprotoIdentityRequestPlcOperationSignature:"com.atproto.identity.requestPlcOperationSignature",ComAtprotoIdentityResolveDid:"com.atproto.identity.resolveDid",ComAtprotoIdentityResolveHandle:"com.atproto.identity.resolveHandle",ComAtprotoIdentityResolveIdentity:"com.atproto.identity.resolveIdentity",ComAtprotoIdentitySignPlcOperation:"com.atproto.identity.signPlcOperation",ComAtprotoIdentitySubmitPlcOperation:"com.atproto.identity.submitPlcOperation",ComAtprotoIdentityUpdateHandle:"com.atproto.identity.updateHandle",ComAtprotoLabelDefs:"com.atproto.label.defs",ComAtprotoLabelQueryLabels:"com.atproto.label.queryLabels",ComAtprotoLabelSubscribeLabels:"com.atproto.label.subscribeLabels",ComAtprotoLexiconSchema:"com.atproto.lexicon.schema",ComAtprotoModerationCreateReport:"com.atproto.moderation.createReport",ComAtprotoModerationDefs:"com.atproto.moderation.defs",ComAtprotoRepoApplyWrites:"com.atproto.repo.applyWrites",ComAtprotoRepoCreateRecord:"com.atproto.repo.createRecord",ComAtprotoRepoDefs:"com.atproto.repo.defs",ComAtprotoRepoDeleteRecord:"com.atproto.repo.deleteRecord",ComAtprotoRepoDescribeRepo:"com.atproto.repo.describeRepo",ComAtprotoRepoGetRecord:"com.atproto.repo.getRecord",ComAtprotoRepoImportRepo:"com.atproto.repo.importRepo",ComAtprotoRepoListMissingBlobs:"com.atproto.repo.listMissingBlobs",ComAtprotoRepoListRecords:"com.atproto.repo.listRecords",ComAtprotoRepoPutRecord:"com.atproto.repo.putRecord",ComAtprotoRepoStrongRef:"com.atproto.repo.strongRef",ComAtprotoRepoUploadBlob:"com.atproto.repo.uploadBlob",ComAtprotoServerActivateAccount:"com.atproto.server.activateAccount",ComAtprotoServerCheckAccountStatus:"com.atproto.server.checkAccountStatus",ComAtprotoServerConfirmEmail:"com.atproto.server.confirmEmail",ComAtprotoServerCreateAccount:"com.atproto.server.createAccount",ComAtprotoServerCreateAppPassword:"com.atproto.server.createAppPassword",ComAtprotoServerCreateInviteCode:"com.atproto.server.createInviteCode",ComAtprotoServerCreateInviteCodes:"com.atproto.server.createInviteCodes",ComAtprotoServerCreateSession:"com.atproto.server.createSession",ComAtprotoServerDeactivateAccount:"com.atproto.server.deactivateAccount",ComAtprotoServerDefs:"com.atproto.server.defs",ComAtprotoServerDeleteAccount:"com.atproto.server.deleteAccount",ComAtprotoServerDeleteSession:"com.atproto.server.deleteSession",ComAtprotoServerDescribeServer:"com.atproto.server.describeServer",ComAtprotoServerGetAccountInviteCodes:"com.atproto.server.getAccountInviteCodes",ComAtprotoServerGetServiceAuth:"com.atproto.server.getServiceAuth",ComAtprotoServerGetSession:"com.atproto.server.getSession",ComAtprotoServerListAppPasswords:"com.atproto.server.listAppPasswords",ComAtprotoServerRefreshSession:"com.atproto.server.refreshSession",ComAtprotoServerRequestAccountDelete:"com.atproto.server.requestAccountDelete",ComAtprotoServerRequestEmailConfirmation:"com.atproto.server.requestEmailConfirmation",ComAtprotoServerRequestEmailUpdate:"com.atproto.server.requestEmailUpdate",ComAtprotoServerRequestPasswordReset:"com.atproto.server.requestPasswordReset",ComAtprotoServerReserveSigningKey:"com.atproto.server.reserveSigningKey",ComAtprotoServerResetPassword:"com.atproto.server.resetPassword",ComAtprotoServerRevokeAppPassword:"com.atproto.server.revokeAppPassword",ComAtprotoServerUpdateEmail:"com.atproto.server.updateEmail",ComAtprotoSyncDefs:"com.atproto.sync.defs",ComAtprotoSyncGetBlob:"com.atproto.sync.getBlob",ComAtprotoSyncGetBlocks:"com.atproto.sync.getBlocks",ComAtprotoSyncGetCheckout:"com.atproto.sync.getCheckout",ComAtprotoSyncGetHead:"com.atproto.sync.getHead",ComAtprotoSyncGetHostStatus:"com.atproto.sync.getHostStatus",ComAtprotoSyncGetLatestCommit:"com.atproto.sync.getLatestCommit",ComAtprotoSyncGetRecord:"com.atproto.sync.getRecord",ComAtprotoSyncGetRepo:"com.atproto.sync.getRepo",ComAtprotoSyncGetRepoStatus:"com.atproto.sync.getRepoStatus",ComAtprotoSyncListBlobs:"com.atproto.sync.listBlobs",ComAtprotoSyncListHosts:"com.atproto.sync.listHosts",ComAtprotoSyncListRepos:"com.atproto.sync.listRepos",ComAtprotoSyncListReposByCollection:"com.atproto.sync.listReposByCollection",ComAtprotoSyncNotifyOfUpdate:"com.atproto.sync.notifyOfUpdate",ComAtprotoSyncRequestCrawl:"com.atproto.sync.requestCrawl",ComAtprotoSyncSubscribeRepos:"com.atproto.sync.subscribeRepos",ComAtprotoTempAddReservedHandle:"com.atproto.temp.addReservedHandle",ComAtprotoTempCheckHandleAvailability:"com.atproto.temp.checkHandleAvailability",ComAtprotoTempCheckSignupQueue:"com.atproto.temp.checkSignupQueue",ComAtprotoTempDereferenceScope:"com.atproto.temp.dereferenceScope",ComAtprotoTempFetchLabels:"com.atproto.temp.fetchLabels",ComAtprotoTempRequestPhoneVerification:"com.atproto.temp.requestPhoneVerification",ComAtprotoTempRevokeAccountCredentials:"com.atproto.temp.revokeAccountCredentials",ToolsOzoneCommunicationCreateTemplate:"tools.ozone.communication.createTemplate",ToolsOzoneCommunicationDefs:"tools.ozone.communication.defs",ToolsOzoneCommunicationDeleteTemplate:"tools.ozone.communication.deleteTemplate",ToolsOzoneCommunicationListTemplates:"tools.ozone.communication.listTemplates",ToolsOzoneCommunicationUpdateTemplate:"tools.ozone.communication.updateTemplate",ToolsOzoneHostingGetAccountHistory:"tools.ozone.hosting.getAccountHistory",ToolsOzoneModerationCancelScheduledActions:"tools.ozone.moderation.cancelScheduledActions",ToolsOzoneModerationDefs:"tools.ozone.moderation.defs",ToolsOzoneModerationEmitEvent:"tools.ozone.moderation.emitEvent",ToolsOzoneModerationGetAccountTimeline:"tools.ozone.moderation.getAccountTimeline",ToolsOzoneModerationGetEvent:"tools.ozone.moderation.getEvent",ToolsOzoneModerationGetRecord:"tools.ozone.moderation.getRecord",ToolsOzoneModerationGetRecords:"tools.ozone.moderation.getRecords",ToolsOzoneModerationGetRepo:"tools.ozone.moderation.getRepo",ToolsOzoneModerationGetReporterStats:"tools.ozone.moderation.getReporterStats",ToolsOzoneModerationGetRepos:"tools.ozone.moderation.getRepos",ToolsOzoneModerationGetSubjects:"tools.ozone.moderation.getSubjects",ToolsOzoneModerationListScheduledActions:"tools.ozone.moderation.listScheduledActions",ToolsOzoneModerationQueryEvents:"tools.ozone.moderation.queryEvents",ToolsOzoneModerationQueryStatuses:"tools.ozone.moderation.queryStatuses",ToolsOzoneModerationScheduleAction:"tools.ozone.moderation.scheduleAction",ToolsOzoneModerationSearchRepos:"tools.ozone.moderation.searchRepos",ToolsOzoneReportDefs:"tools.ozone.report.defs",ToolsOzoneSafelinkAddRule:"tools.ozone.safelink.addRule",ToolsOzoneSafelinkDefs:"tools.ozone.safelink.defs",ToolsOzoneSafelinkQueryEvents:"tools.ozone.safelink.queryEvents",ToolsOzoneSafelinkQueryRules:"tools.ozone.safelink.queryRules",ToolsOzoneSafelinkRemoveRule:"tools.ozone.safelink.removeRule",ToolsOzoneSafelinkUpdateRule:"tools.ozone.safelink.updateRule",ToolsOzoneServerGetConfig:"tools.ozone.server.getConfig",ToolsOzoneSetAddValues:"tools.ozone.set.addValues",ToolsOzoneSetDefs:"tools.ozone.set.defs",ToolsOzoneSetDeleteSet:"tools.ozone.set.deleteSet",ToolsOzoneSetDeleteValues:"tools.ozone.set.deleteValues",ToolsOzoneSetGetValues:"tools.ozone.set.getValues",ToolsOzoneSetQuerySets:"tools.ozone.set.querySets",ToolsOzoneSetUpsertSet:"tools.ozone.set.upsertSet",ToolsOzoneSettingDefs:"tools.ozone.setting.defs",ToolsOzoneSettingListOptions:"tools.ozone.setting.listOptions",ToolsOzoneSettingRemoveOptions:"tools.ozone.setting.removeOptions",ToolsOzoneSettingUpsertOption:"tools.ozone.setting.upsertOption",ToolsOzoneSignatureDefs:"tools.ozone.signature.defs",ToolsOzoneSignatureFindCorrelation:"tools.ozone.signature.findCorrelation",ToolsOzoneSignatureFindRelatedAccounts:"tools.ozone.signature.findRelatedAccounts",ToolsOzoneSignatureSearchAccounts:"tools.ozone.signature.searchAccounts",ToolsOzoneTeamAddMember:"tools.ozone.team.addMember",ToolsOzoneTeamDefs:"tools.ozone.team.defs",ToolsOzoneTeamDeleteMember:"tools.ozone.team.deleteMember",ToolsOzoneTeamListMembers:"tools.ozone.team.listMembers",ToolsOzoneTeamUpdateMember:"tools.ozone.team.updateMember",ToolsOzoneVerificationDefs:"tools.ozone.verification.defs",ToolsOzoneVerificationGrantVerifications:"tools.ozone.verification.grantVerifications",ToolsOzoneVerificationListVerifications:"tools.ozone.verification.listVerifications",ToolsOzoneVerificationRevokeVerifications:"tools.ozone.verification.revokeVerifications"}})($0)),$0}var Ho={},zA;function rI(){if(zA)return Ho;zA=1,Object.defineProperty(Ho,"__esModule",{value:!0}),Ho.isAtprotoServiceType=i,Ho.isDid=n,Ho.assertDid=a,Ho.asDid=c,Ho.isAtprotoProxy=f,Ho.assertAtprotoProxy=y,Ho.asAtprotoProxy=e;function i(l){return!l.includes(" ")&&!l.includes("#")}function n(l){if(!l.startsWith("did:")||l.length<8||l.length>2048)return!1;const _=l.indexOf(":",4);return _>4&&_<l.length-1}function a(l){if(!n(l))throw new TypeError(`Invalid DID: ${l}`)}function c(l){return a(l),l}function f(l){const{length:_,[0]:w,[1]:R}=l.split("#");return _===2&&n(w)&&i(R)}function y(l){if(!f(l))throw new TypeError(`Invalid DID reference: ${l} (must be of the form did:example:alice#service)`)}function e(l){return y(l),l}return Ho}var fh={},OA;function iI(){return OA||(OA=1,Object.defineProperty(fh,"__esModule",{value:!0}),fh.BSKY_LABELER_DID=void 0,fh.BSKY_LABELER_DID="did:plc:ar7c4by46qjdydhdevvrndac"),fh}var Z0={},VA;function nI(){return VA||(VA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.nuxSchema=void 0,i.sanitizeMutedWordValue=c,i.savedFeedsToUriArrays=f,i.getSavedFeedType=y,i.validateSavedFeed=e,i.validateNux=l;const n=bc(),a=Hp();function c(_){return _.trim().replace(/^#(?!\ufe0f)/,"").replace(/[\r\n\u00AD\u2060\u200D\u200C\u200B]+/,"")}function f(_){const w=[],R=[];for(const C of _)C.pinned&&w.push(C.value),R.push(C.value);return{pinned:w,saved:R}}function y(_){switch(new a.AtUri(_).collection){case"app.bsky.feed.generator":return"feed";case"app.bsky.graph.list":return"list";default:return"unknown"}}function e(_){if(!_.id)throw new Error("Saved feed must have an `id` - use a TID");if(["feed","list"].includes(_.type)){const w=new a.AtUri(_.value),R=w.collection==="app.bsky.feed.generator",C=w.collection==="app.bsky.graph.list";if(_.type==="feed"&&!R)throw new Error(`Saved feed of type 'feed' must be a feed, got ${w.collection}`);if(_.type==="list"&&!C)throw new Error(`Saved feed of type 'list' must be a list, got ${w.collection}`)}}i.nuxSchema=n.z.object({id:n.z.string().max(64),completed:n.z.boolean(),data:n.z.string().max(300).optional(),expiresAt:n.z.string().datetime().optional()}).strict();function l(_){i.nuxSchema.parse(_)}})(Z0)),Z0}var z={},Fu={},qu={},bs={},H0={},UA;function i1(){return UA||(UA=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.XRPCInvalidResponseError=i.XRPCError=i.XRPCResponse=i.ResponseTypeStrings=i.ResponseType=i.errorResponseBody=void 0,i.httpResponseCodeToEnum=c,i.httpResponseCodeToName=f,i.httpResponseCodeToString=y;const n=bc();i.errorResponseBody=n.z.object({error:n.z.string().optional(),message:n.z.string().optional()});var a;(function(w){w[w.Unknown=1]="Unknown",w[w.InvalidResponse=2]="InvalidResponse",w[w.Success=200]="Success",w[w.InvalidRequest=400]="InvalidRequest",w[w.AuthenticationRequired=401]="AuthenticationRequired",w[w.Forbidden=403]="Forbidden",w[w.XRPCNotSupported=404]="XRPCNotSupported",w[w.NotAcceptable=406]="NotAcceptable",w[w.PayloadTooLarge=413]="PayloadTooLarge",w[w.UnsupportedMediaType=415]="UnsupportedMediaType",w[w.RateLimitExceeded=429]="RateLimitExceeded",w[w.InternalServerError=500]="InternalServerError",w[w.MethodNotImplemented=501]="MethodNotImplemented",w[w.UpstreamFailure=502]="UpstreamFailure",w[w.NotEnoughResources=503]="NotEnoughResources",w[w.UpstreamTimeout=504]="UpstreamTimeout"})(a||(i.ResponseType=a={}));function c(w){return w in a?w:w>=100&&w<200?a.XRPCNotSupported:w>=200&&w<300?a.Success:w>=300&&w<400?a.XRPCNotSupported:w>=400&&w<500?a.InvalidRequest:a.InternalServerError}function f(w){return a[c(w)]}i.ResponseTypeStrings={[a.Unknown]:"Unknown",[a.InvalidResponse]:"Invalid Response",[a.Success]:"Success",[a.InvalidRequest]:"Invalid Request",[a.AuthenticationRequired]:"Authentication Required",[a.Forbidden]:"Forbidden",[a.XRPCNotSupported]:"XRPC Not Supported",[a.NotAcceptable]:"Not Acceptable",[a.PayloadTooLarge]:"Payload Too Large",[a.UnsupportedMediaType]:"Unsupported Media Type",[a.RateLimitExceeded]:"Rate Limit Exceeded",[a.InternalServerError]:"Internal Server Error",[a.MethodNotImplemented]:"Method Not Implemented",[a.UpstreamFailure]:"Upstream Failure",[a.NotEnoughResources]:"Not Enough Resources",[a.UpstreamTimeout]:"Upstream Timeout"};function y(w){return i.ResponseTypeStrings[c(w)]}class e{constructor(R,C){Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:R}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:C}),Object.defineProperty(this,"success",{enumerable:!0,configurable:!0,writable:!0,value:!0})}}i.XRPCResponse=e;class l extends Error{constructor(R,C=f(R),I,L,O){super(I||C||y(R),O),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:C}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:L}),Object.defineProperty(this,"success",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.status=c(R);const q=O?.cause;this.cause===void 0&&q!==void 0&&(this.cause=q)}static from(R,C){if(R instanceof l)return R;const I=R instanceof Error?R:void 0,L=R instanceof Response?R:R?.response instanceof Response?R.response:void 0,O=I?.statusCode??I?.status??L?.status,q=typeof O=="number"?c(O):C??a.Unknown,G=I?.message??String(R),j=L?Object.fromEntries(L.headers.entries()):void 0;return new l(q,void 0,G,j,{cause:R})}}i.XRPCError=l;class _ extends l{constructor(R,C,I){super(a.InvalidResponse,i.ResponseTypeStrings[a.InvalidResponse],"The server gave an invalid response and may be out of date.",void 0,{cause:C}),Object.defineProperty(this,"lexiconNsid",{enumerable:!0,configurable:!0,writable:!0,value:R}),Object.defineProperty(this,"validationError",{enumerable:!0,configurable:!0,writable:!0,value:C}),Object.defineProperty(this,"responseBody",{enumerable:!0,configurable:!0,writable:!0,value:I})}}i.XRPCInvalidResponseError=_})(H0)),H0}var jA;function av(){if(jA)return bs;jA=1,Object.defineProperty(bs,"__esModule",{value:!0}),bs.isErrorResponseBody=c,bs.getMethodSchemaHTTPMethod=f,bs.constructMethodCallUri=y,bs.constructMethodCallUrl=e,bs.encodeQueryParam=l,bs.constructMethodCallHeaders=_,bs.combineHeaders=w,bs.isBodyInit=C,bs.isIterable=I,bs.encodeMethodCallBody=L,bs.httpResponseBodyParse=q;const i=Np(),n=i1(),a=globalThis.ReadableStream||class{constructor(){throw new Error("ReadableStream is not supported in this environment")}};function c(G){return n.errorResponseBody.safeParse(G).success}function f(G){return G.type==="procedure"?"post":"get"}function y(G,j,ne,he){return new URL(e(G,j,he),ne).toString()}function e(G,j,ne){const he=`/xrpc/${encodeURIComponent(G)}`;if(!ne)return he;const Q=[];for(const[Be,we]of Object.entries(ne)){const ze=j.parameters?.properties?.[Be];if(!ze)throw new Error(`Invalid query parameter: ${Be}`);if(we!==void 0)if(ze.type==="array"){const et=Array.isArray(we)?we:[we];for(const gt of et)Q.push([Be,l(ze.items.type,gt)])}else Q.push([Be,l(ze.type,we)])}return Q.length?`${he}?${new URLSearchParams(Q).toString()}`:he}function l(G,j){if(G==="string"||G==="unknown")return String(j);if(G==="float")return String(Number(j));if(G==="integer")return String(Number(j)|0);if(G==="boolean")return j?"true":"false";if(G==="datetime")return j instanceof Date?j.toISOString():String(j);throw new Error(`Unsupported query param type: ${G}`)}function _(G,j,ne){const he=new Headers;if(ne?.headers)for(const Q in ne.headers){if(he.has(Q))throw new TypeError(`Duplicate header: ${Q}`);const Be=ne.headers[Q];Be!=null&&he.set(Q,Be)}if(G.type==="procedure"){if(ne?.encoding)he.set("content-type",ne.encoding);else if(!he.has("content-type")&&typeof j<"u")if(j instanceof ArrayBuffer||j instanceof a||ArrayBuffer.isView(j))he.set("content-type","application/octet-stream");else if(j instanceof FormData)he.set("content-type","multipart/form-data");else if(j instanceof URLSearchParams)he.set("content-type","application/x-www-form-urlencoded;charset=UTF-8");else if(R(j))he.set("content-type",j.type||"application/octet-stream");else if(typeof j=="string")he.set("content-type","text/plain;charset=UTF-8");else if(I(j))he.set("content-type","application/octet-stream");else if(typeof j=="boolean"||typeof j=="number"||typeof j=="string"||typeof j=="object")he.set("content-type","application/json");else throw new n.XRPCError(n.ResponseType.InvalidRequest,`Unsupported data type: ${typeof j}`)}return he}function w(G,j){if(!j)return G;let ne;for(const[he,Q]of j){if(Q===void 0||(ne??(ne=new Headers(G)),ne.has(he)))continue;const Be=typeof Q=="function"?Q():Q;if(typeof Be=="string")ne.set(he,Be);else if(Be===null)ne.delete(he);else throw new TypeError(`Invalid "${he}" header value: ${typeof Be}`)}return ne??G}function R(G){if(G==null||typeof G!="object")return!1;if(typeof Blob=="function"&&G instanceof Blob)return!0;const j=G[Symbol.toStringTag];return j==="Blob"||j==="File"?"stream"in G&&typeof G.stream=="function":!1}function C(G){switch(typeof G){case"string":return!0;case"object":return G instanceof ArrayBuffer||G instanceof FormData||G instanceof URLSearchParams||G instanceof a||ArrayBuffer.isView(G)||R(G);default:return!1}}function I(G){return G!=null&&typeof G=="object"&&(Symbol.iterator in G||Symbol.asyncIterator in G)}function L(G,j){const ne=G.get("content-type");if(!ne)return;if(typeof j>"u")throw new n.XRPCError(n.ResponseType.InvalidRequest,"A request body is expected but none was provided");if(C(j))return j instanceof FormData&&ne==="multipart/form-data"&&G.delete("content-type"),j;if(I(j))return O(j);if(ne.startsWith("text/"))return new TextEncoder().encode(String(j));if(ne.startsWith("application/json")){const Q=(0,i.stringifyLex)(j);if(Q===void 0)throw new n.XRPCError(n.ResponseType.InvalidRequest,"Failed to encode request body as JSON");return new TextEncoder().encode(Q)}const he=!j||typeof j!="object"?typeof j:j.constructor!==Object&&typeof j.constructor=="function"&&typeof j.constructor?.name=="string"?j.constructor.name:"object";throw new n.XRPCError(n.ResponseType.InvalidRequest,`Unable to encode ${he} as ${ne} data`)}function O(G){if("from"in a&&typeof a.from=="function")return a.from(G);throw new TypeError("ReadableStream.from() is not supported in this environment. It is required to support using iterables as the request body. Consider using a polyfill or re-write your code to use a different body type.")}function q(G,j){try{if(G){if(G.includes("application/json")){const ne=new TextDecoder().decode(j);return(0,i.jsonStringToLex)(ne)}if(G.startsWith("text/"))return new TextDecoder().decode(j)}return j instanceof ArrayBuffer?new Uint8Array(j):j}catch(ne){throw new n.XRPCError(n.ResponseType.InvalidResponse,void 0,`Failed to parse response body: ${String(ne)}`,void 0,{cause:ne})}}return bs}var hh={},My={},NA;function sI(){if(NA)return My;NA=1,Object.defineProperty(My,"__esModule",{value:!0}),My.buildFetchHandler=n;const i=av();function n(a){if(typeof a=="function")return a;if(typeof a=="object"&&"fetchHandler"in a)return a.fetchHandler.bind(a);const{service:c,headers:f=void 0,fetch:y=globalThis.fetch}=typeof a=="string"||a instanceof URL?{service:a}:a;if(typeof y!="function")throw new TypeError("XrpcDispatcher requires fetch() to be available in your environment.");const e=f!=null?Object.entries(f):void 0;return async function(l,_){const w=typeof c=="function"?c():c,R=new URL(l,w),C=(0,i.combineHeaders)(_.headers,e);return y(R,{..._,headers:C})}}return My}var FA;function oI(){if(FA)return hh;FA=1,Object.defineProperty(hh,"__esModule",{value:!0}),hh.XrpcClient=void 0;const i=Np(),n=sI(),a=i1(),c=av();class f{constructor(e,l){Object.defineProperty(this,"fetchHandler",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"lex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.fetchHandler=(0,n.buildFetchHandler)(e),this.lex=l instanceof i.Lexicons?l:new i.Lexicons(l)}setHeader(e,l){this.headers.set(e.toLowerCase(),l)}unsetHeader(e){this.headers.delete(e.toLowerCase())}clearHeaders(){this.headers.clear()}async call(e,l,_,w){const R=this.lex.getDefOrThrow(e);if(!R||R.type!=="query"&&R.type!=="procedure")throw new TypeError(`Invalid lexicon: ${e}. Must be a query or procedure.`);const C=(0,c.constructMethodCallUrl)(e,R,l),I=(0,c.getMethodSchemaHTTPMethod)(R),L=(0,c.constructMethodCallHeaders)(R,_,w),O=(0,c.encodeMethodCallBody)(L,_),q={method:I,headers:(0,c.combineHeaders)(L,this.headers),body:O,duplex:"half",redirect:"follow",signal:w?.signal};try{const G=await this.fetchHandler.call(void 0,C,q),j=G.status,ne=Object.fromEntries(G.headers.entries()),he=await G.arrayBuffer(),Q=(0,c.httpResponseBodyParse)(G.headers.get("content-type"),he),Be=(0,a.httpResponseCodeToEnum)(j);if(Be!==a.ResponseType.Success){const{error:we=void 0,message:ze=void 0}=Q&&(0,c.isErrorResponseBody)(Q)?Q:{};throw new a.XRPCError(Be,we,ze,ne)}try{this.lex.assertValidXrpcOutput(e,Q)}catch(we){throw we instanceof i.ValidationError?new a.XRPCInvalidResponseError(e,we,Q):we}return new a.XRPCResponse(Q,ne)}catch(G){throw a.XRPCError.from(G)}}}return hh.XrpcClient=f,hh}var qA;function KA(){if(qA)return qu;qA=1,Object.defineProperty(qu,"__esModule",{value:!0}),qu.ServiceClient=qu.Client=void 0;const i=Np(),n=av(),a=oI();class c{constructor(){Object.defineProperty(this,"lex",{enumerable:!0,configurable:!0,writable:!0,value:new i.Lexicons})}get fetch(){throw new Error("Client.fetch is no longer supported. Use an XrpcClient instead.")}set fetch(e){throw new Error("Client.fetch is no longer supported. Use an XrpcClient instead.")}async call(e,l,_,w,R){return this.service(e).call(l,_,w,R)}service(e){return new f(this,e)}addLexicon(e){this.lex.add(e)}addLexicons(e){for(const l of e)this.addLexicon(l)}removeLexicon(e){this.lex.remove(e)}}qu.Client=c;class f extends a.XrpcClient{constructor(e,l){super(async(_,w)=>{const R=(0,n.combineHeaders)(w.headers,Object.entries(this.headers));return fetch(new URL(_,this.uri),{...w,headers:R})},e.lex),Object.defineProperty(this,"baseClient",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"uri",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.uri=typeof l=="string"?new URL(l):l}}return qu.ServiceClient=f,qu}var GA;function Xt(){return GA||(GA=1,(function(i){var n=Fu&&Fu.__createBinding||(Object.create?(function(y,e,l,_){_===void 0&&(_=l);var w=Object.getOwnPropertyDescriptor(e,l);(!w||("get"in w?!e.__esModule:w.writable||w.configurable))&&(w={enumerable:!0,get:function(){return e[l]}}),Object.defineProperty(y,_,w)}):(function(y,e,l,_){_===void 0&&(_=l),y[_]=e[l]})),a=Fu&&Fu.__exportStar||function(y,e){for(var l in y)l!=="default"&&!Object.prototype.hasOwnProperty.call(e,l)&&n(e,y,l)};Object.defineProperty(i,"__esModule",{value:!0}),a(KA(),i),a(sI(),i),a(i1(),i),a(av(),i),a(oI(),i);const c=KA(),f=new c.Client;i.default=f})(Fu)),Fu}var Dd={},$A;function ZA(){if($A)return Dd;$A=1,Object.defineProperty(Dd,"__esModule",{value:!0}),Dd.UnsupportedCollectionError=void 0,Dd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Dd.UnsupportedCollectionError=c;function f(y){return y instanceof i.XRPCError&&y.error==="UnsupportedCollection"?new c(y):y}return Dd}var Id={},HA;function XA(){if(HA)return Id;HA=1,Object.defineProperty(Id,"__esModule",{value:!0}),Id.UnsupportedCollectionError=void 0,Id.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Id.UnsupportedCollectionError=c;function f(y){return y instanceof i.XRPCError&&y.error==="UnsupportedCollection"?new c(y):y}return Id}var wl={},WA;function YA(){if(WA)return wl;WA=1,Object.defineProperty(wl,"__esModule",{value:!0}),wl.BlockedByActorError=wl.BlockedActorError=void 0,wl.toKnownErr=y;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}wl.BlockedActorError=c;class f extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}wl.BlockedByActorError=f;function y(e){if(e instanceof i.XRPCError){if(e.error==="BlockedActor")return new c(e);if(e.error==="BlockedByActor")return new f(e)}return e}return wl}var El={},JA;function QA(){if(JA)return El;JA=1,Object.defineProperty(El,"__esModule",{value:!0}),El.BlockedByActorError=El.BlockedActorError=void 0,El.toKnownErr=y;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}El.BlockedActorError=c;class f extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}El.BlockedByActorError=f;function y(e){if(e instanceof i.XRPCError){if(e.error==="BlockedActor")return new c(e);if(e.error==="BlockedByActor")return new f(e)}return e}return El}var Bd={},eR;function tR(){if(eR)return Bd;eR=1,Object.defineProperty(Bd,"__esModule",{value:!0}),Bd.UnknownFeedError=void 0,Bd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Bd.UnknownFeedError=c;function f(y){return y instanceof i.XRPCError&&y.error==="UnknownFeed"?new c(y):y}return Bd}var Md={},rR;function iR(){if(rR)return Md;rR=1,Object.defineProperty(Md,"__esModule",{value:!0}),Md.UnknownFeedError=void 0,Md.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Md.UnknownFeedError=c;function f(y){return y instanceof i.XRPCError&&y.error==="UnknownFeed"?new c(y):y}return Md}var zd={},nR;function sR(){if(nR)return zd;nR=1,Object.defineProperty(zd,"__esModule",{value:!0}),zd.UnknownListError=void 0,zd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}zd.UnknownListError=c;function f(y){return y instanceof i.XRPCError&&y.error==="UnknownList"?new c(y):y}return zd}var Od={},oR;function aR(){if(oR)return Od;oR=1,Object.defineProperty(Od,"__esModule",{value:!0}),Od.NotFoundError=void 0,Od.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Od.NotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="NotFound"?new c(y):y}return Od}var Vd={},lR;function uR(){if(lR)return Vd;lR=1,Object.defineProperty(Vd,"__esModule",{value:!0}),Vd.BadQueryStringError=void 0,Vd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Vd.BadQueryStringError=c;function f(y){return y instanceof i.XRPCError&&y.error==="BadQueryString"?new c(y):y}return Vd}var Ud={},cR;function dR(){if(cR)return Ud;cR=1,Object.defineProperty(Ud,"__esModule",{value:!0}),Ud.ActorNotFoundError=void 0,Ud.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Ud.ActorNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="ActorNotFound"?new c(y):y}return Ud}var Xo={},pR;function fR(){if(pR)return Xo;pR=1,Object.defineProperty(Xo,"__esModule",{value:!0}),Xo.InvalidInitiationError=Xo.DidTooLongError=Xo.InvalidEmailError=void 0,Xo.toKnownErr=e;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Xo.InvalidEmailError=c;class f extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Xo.DidTooLongError=f;class y extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Xo.InvalidInitiationError=y;function e(l){if(l instanceof i.XRPCError){if(l.error==="InvalidEmail")return new c(l);if(l.error==="DidTooLong")return new f(l);if(l.error==="InvalidInitiation")return new y(l)}return l}return Xo}var jd={},hR;function mR(){if(hR)return jd;hR=1,Object.defineProperty(jd,"__esModule",{value:!0}),jd.BadQueryStringError=void 0,jd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}jd.BadQueryStringError=c;function f(y){return y instanceof i.XRPCError&&y.error==="BadQueryString"?new c(y):y}return jd}var Nd={},yR;function gR(){if(yR)return Nd;yR=1,Object.defineProperty(Nd,"__esModule",{value:!0}),Nd.BadQueryStringError=void 0,Nd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Nd.BadQueryStringError=c;function f(y){return y instanceof i.XRPCError&&y.error==="BadQueryString"?new c(y):y}return Nd}var Fd={},_R;function bR(){if(_R)return Fd;_R=1,Object.defineProperty(Fd,"__esModule",{value:!0}),Fd.BadQueryStringError=void 0,Fd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Fd.BadQueryStringError=c;function f(y){return y instanceof i.XRPCError&&y.error==="BadQueryString"?new c(y):y}return Fd}var Wo={},vR;function xR(){if(vR)return Wo;vR=1,Object.defineProperty(Wo,"__esModule",{value:!0}),Wo.ReactionInvalidValueError=Wo.ReactionLimitReachedError=Wo.ReactionMessageDeletedError=void 0,Wo.toKnownErr=e;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Wo.ReactionMessageDeletedError=c;class f extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Wo.ReactionLimitReachedError=f;class y extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Wo.ReactionInvalidValueError=y;function e(l){if(l instanceof i.XRPCError){if(l.error==="ReactionMessageDeleted")return new c(l);if(l.error==="ReactionLimitReached")return new f(l);if(l.error==="ReactionInvalidValue")return new y(l)}return l}return Wo}var Al={},wR;function ER(){if(wR)return Al;wR=1,Object.defineProperty(Al,"__esModule",{value:!0}),Al.ReactionInvalidValueError=Al.ReactionMessageDeletedError=void 0,Al.toKnownErr=y;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Al.ReactionMessageDeletedError=c;class f extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Al.ReactionInvalidValueError=f;function y(e){if(e instanceof i.XRPCError){if(e.error==="ReactionMessageDeleted")return new c(e);if(e.error==="ReactionInvalidValue")return new f(e)}return e}return Al}var Yo={},AR;function RR(){if(AR)return Yo;AR=1,Object.defineProperty(Yo,"__esModule",{value:!0}),Yo.DidDeactivatedError=Yo.DidNotFoundError=Yo.HandleNotFoundError=void 0,Yo.toKnownErr=e;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Yo.HandleNotFoundError=c;class f extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Yo.DidNotFoundError=f;class y extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Yo.DidDeactivatedError=y;function e(l){if(l instanceof i.XRPCError){if(l.error==="HandleNotFound")return new c(l);if(l.error==="DidNotFound")return new f(l);if(l.error==="DidDeactivated")return new y(l)}return l}return Yo}var Rl={},SR;function TR(){if(SR)return Rl;SR=1,Object.defineProperty(Rl,"__esModule",{value:!0}),Rl.DidDeactivatedError=Rl.DidNotFoundError=void 0,Rl.toKnownErr=y;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Rl.DidNotFoundError=c;class f extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Rl.DidDeactivatedError=f;function y(e){if(e instanceof i.XRPCError){if(e.error==="DidNotFound")return new c(e);if(e.error==="DidDeactivated")return new f(e)}return e}return Rl}var qd={},CR;function kR(){if(CR)return qd;CR=1,Object.defineProperty(qd,"__esModule",{value:!0}),qd.HandleNotFoundError=void 0,qd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}qd.HandleNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="HandleNotFound"?new c(y):y}return qd}var Jo={},PR;function LR(){if(PR)return Jo;PR=1,Object.defineProperty(Jo,"__esModule",{value:!0}),Jo.DidDeactivatedError=Jo.DidNotFoundError=Jo.HandleNotFoundError=void 0,Jo.toKnownErr=e;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Jo.HandleNotFoundError=c;class f extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Jo.DidNotFoundError=f;class y extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Jo.DidDeactivatedError=y;function e(l){if(l instanceof i.XRPCError){if(l.error==="HandleNotFound")return new c(l);if(l.error==="DidNotFound")return new f(l);if(l.error==="DidDeactivated")return new y(l)}return l}return Jo}var vn={},DR;function IR(){if(DR)return vn;DR=1,Object.defineProperty(vn,"__esModule",{value:!0}),vn.InvalidSwapError=void 0,vn.toKnownErr=l,vn.isCreate=w,vn.validateCreate=R,vn.isUpdate=I,vn.validateUpdate=L,vn.isDelete=q,vn.validateDelete=G,vn.isCreateResult=ne,vn.validateCreateResult=he,vn.isUpdateResult=Be,vn.validateUpdateResult=we,vn.isDeleteResult=et,vn.validateDeleteResult=gt;const i=Xt(),n=pe(),c=fe().is$typed,f=n.validate,y="com.atproto.repo.applyWrites";class e extends i.XRPCError{constructor(nt){super(nt.status,nt.error,nt.message,nt.headers,{cause:nt})}}vn.InvalidSwapError=e;function l(st){return st instanceof i.XRPCError&&st.error==="InvalidSwap"?new e(st):st}const _="create";function w(st){return c(st,y,_)}function R(st){return f(st,y,_)}const C="update";function I(st){return c(st,y,C)}function L(st){return f(st,y,C)}const O="delete";function q(st){return c(st,y,O)}function G(st){return f(st,y,O)}const j="createResult";function ne(st){return c(st,y,j)}function he(st){return f(st,y,j)}const Q="updateResult";function Be(st){return c(st,y,Q)}function we(st){return f(st,y,Q)}const ze="deleteResult";function et(st){return c(st,y,ze)}function gt(st){return f(st,y,ze)}return vn}var Kd={},BR;function MR(){if(BR)return Kd;BR=1,Object.defineProperty(Kd,"__esModule",{value:!0}),Kd.InvalidSwapError=void 0,Kd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Kd.InvalidSwapError=c;function f(y){return y instanceof i.XRPCError&&y.error==="InvalidSwap"?new c(y):y}return Kd}var Gd={},zR;function OR(){if(zR)return Gd;zR=1,Object.defineProperty(Gd,"__esModule",{value:!0}),Gd.InvalidSwapError=void 0,Gd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Gd.InvalidSwapError=c;function f(y){return y instanceof i.XRPCError&&y.error==="InvalidSwap"?new c(y):y}return Gd}var $d={},VR;function UR(){if(VR)return $d;VR=1,Object.defineProperty($d,"__esModule",{value:!0}),$d.RecordNotFoundError=void 0,$d.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}$d.RecordNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="RecordNotFound"?new c(y):y}return $d}var Zd={},jR;function NR(){if(jR)return Zd;jR=1,Object.defineProperty(Zd,"__esModule",{value:!0}),Zd.InvalidSwapError=void 0,Zd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Zd.InvalidSwapError=c;function f(y){return y instanceof i.XRPCError&&y.error==="InvalidSwap"?new c(y):y}return Zd}var Qs={},FR;function qR(){if(FR)return Qs;FR=1,Object.defineProperty(Qs,"__esModule",{value:!0}),Qs.InvalidEmailError=Qs.InvalidTokenError=Qs.ExpiredTokenError=Qs.AccountNotFoundError=void 0,Qs.toKnownErr=l;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}Qs.AccountNotFoundError=c;class f extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}Qs.ExpiredTokenError=f;class y extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}Qs.InvalidTokenError=y;class e extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}Qs.InvalidEmailError=e;function l(_){if(_ instanceof i.XRPCError){if(_.error==="AccountNotFound")return new c(_);if(_.error==="ExpiredToken")return new f(_);if(_.error==="InvalidToken")return new y(_);if(_.error==="InvalidEmail")return new e(_)}return _}return Qs}var xn={},KR;function GR(){if(KR)return xn;KR=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.IncompatibleDidDocError=xn.UnresolvableDidError=xn.UnsupportedDomainError=xn.HandleNotAvailableError=xn.InvalidInviteCodeError=xn.InvalidPasswordError=xn.InvalidHandleError=void 0,xn.toKnownErr=R;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(I){super(I.status,I.error,I.message,I.headers,{cause:I})}}xn.InvalidHandleError=c;class f extends i.XRPCError{constructor(I){super(I.status,I.error,I.message,I.headers,{cause:I})}}xn.InvalidPasswordError=f;class y extends i.XRPCError{constructor(I){super(I.status,I.error,I.message,I.headers,{cause:I})}}xn.InvalidInviteCodeError=y;class e extends i.XRPCError{constructor(I){super(I.status,I.error,I.message,I.headers,{cause:I})}}xn.HandleNotAvailableError=e;class l extends i.XRPCError{constructor(I){super(I.status,I.error,I.message,I.headers,{cause:I})}}xn.UnsupportedDomainError=l;class _ extends i.XRPCError{constructor(I){super(I.status,I.error,I.message,I.headers,{cause:I})}}xn.UnresolvableDidError=_;class w extends i.XRPCError{constructor(I){super(I.status,I.error,I.message,I.headers,{cause:I})}}xn.IncompatibleDidDocError=w;function R(C){if(C instanceof i.XRPCError){if(C.error==="InvalidHandle")return new c(C);if(C.error==="InvalidPassword")return new f(C);if(C.error==="InvalidInviteCode")return new y(C);if(C.error==="HandleNotAvailable")return new e(C);if(C.error==="UnsupportedDomain")return new l(C);if(C.error==="UnresolvableDid")return new _(C);if(C.error==="IncompatibleDidDoc")return new w(C)}return C}return xn}var Sl={},$R;function ZR(){if($R)return Sl;$R=1,Object.defineProperty(Sl,"__esModule",{value:!0}),Sl.AccountTakedownError=void 0,Sl.toKnownErr=l,Sl.isAppPassword=w,Sl.validateAppPassword=R;const i=Xt(),n=pe(),c=fe().is$typed,f=n.validate,y="com.atproto.server.createAppPassword";class e extends i.XRPCError{constructor(I){super(I.status,I.error,I.message,I.headers,{cause:I})}}Sl.AccountTakedownError=e;function l(C){return C instanceof i.XRPCError&&C.error==="AccountTakedown"?new e(C):C}const _="appPassword";function w(C){return c(C,y,_)}function R(C){return f(C,y,_)}return Sl}var Tl={},HR;function XR(){if(HR)return Tl;HR=1,Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.AuthFactorTokenRequiredError=Tl.AccountTakedownError=void 0,Tl.toKnownErr=y;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Tl.AccountTakedownError=c;class f extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Tl.AuthFactorTokenRequiredError=f;function y(e){if(e instanceof i.XRPCError){if(e.error==="AccountTakedown")return new c(e);if(e.error==="AuthFactorTokenRequired")return new f(e)}return e}return Tl}var Cl={},WR;function YR(){if(WR)return Cl;WR=1,Object.defineProperty(Cl,"__esModule",{value:!0}),Cl.InvalidTokenError=Cl.ExpiredTokenError=void 0,Cl.toKnownErr=y;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Cl.ExpiredTokenError=c;class f extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Cl.InvalidTokenError=f;function y(e){if(e instanceof i.XRPCError){if(e.error==="ExpiredToken")return new c(e);if(e.error==="InvalidToken")return new f(e)}return e}return Cl}var Hd={},JR;function QR(){if(JR)return Hd;JR=1,Object.defineProperty(Hd,"__esModule",{value:!0}),Hd.DuplicateCreateError=void 0,Hd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Hd.DuplicateCreateError=c;function f(y){return y instanceof i.XRPCError&&y.error==="DuplicateCreate"?new c(y):y}return Hd}var Xd={},eS;function tS(){if(eS)return Xd;eS=1,Object.defineProperty(Xd,"__esModule",{value:!0}),Xd.BadExpirationError=void 0,Xd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Xd.BadExpirationError=c;function f(y){return y instanceof i.XRPCError&&y.error==="BadExpiration"?new c(y):y}return Xd}var kl={},rS;function iS(){if(rS)return kl;rS=1,Object.defineProperty(kl,"__esModule",{value:!0}),kl.AccountTakedownError=void 0,kl.toKnownErr=l,kl.isAppPassword=w,kl.validateAppPassword=R;const i=Xt(),n=pe(),c=fe().is$typed,f=n.validate,y="com.atproto.server.listAppPasswords";class e extends i.XRPCError{constructor(I){super(I.status,I.error,I.message,I.headers,{cause:I})}}kl.AccountTakedownError=e;function l(C){return C instanceof i.XRPCError&&C.error==="AccountTakedown"?new e(C):C}const _="appPassword";function w(C){return c(C,y,_)}function R(C){return f(C,y,_)}return kl}var Wd={},nS;function sS(){if(nS)return Wd;nS=1,Object.defineProperty(Wd,"__esModule",{value:!0}),Wd.AccountTakedownError=void 0,Wd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Wd.AccountTakedownError=c;function f(y){return y instanceof i.XRPCError&&y.error==="AccountTakedown"?new c(y):y}return Wd}var Pl={},oS;function aS(){if(oS)return Pl;oS=1,Object.defineProperty(Pl,"__esModule",{value:!0}),Pl.InvalidTokenError=Pl.ExpiredTokenError=void 0,Pl.toKnownErr=y;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Pl.ExpiredTokenError=c;class f extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Pl.InvalidTokenError=f;function y(e){if(e instanceof i.XRPCError){if(e.error==="ExpiredToken")return new c(e);if(e.error==="InvalidToken")return new f(e)}return e}return Pl}var Qo={},lS;function uS(){if(lS)return Qo;lS=1,Object.defineProperty(Qo,"__esModule",{value:!0}),Qo.TokenRequiredError=Qo.InvalidTokenError=Qo.ExpiredTokenError=void 0,Qo.toKnownErr=e;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Qo.ExpiredTokenError=c;class f extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Qo.InvalidTokenError=f;class y extends i.XRPCError{constructor(_){super(_.status,_.error,_.message,_.headers,{cause:_})}}Qo.TokenRequiredError=y;function e(l){if(l instanceof i.XRPCError){if(l.error==="ExpiredToken")return new c(l);if(l.error==="InvalidToken")return new f(l);if(l.error==="TokenRequired")return new y(l)}return l}return Qo}var vs={},cS;function dS(){if(cS)return vs;cS=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.RepoDeactivatedError=vs.RepoSuspendedError=vs.RepoTakendownError=vs.RepoNotFoundError=vs.BlobNotFoundError=void 0,vs.toKnownErr=_;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}vs.BlobNotFoundError=c;class f extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}vs.RepoNotFoundError=f;class y extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}vs.RepoTakendownError=y;class e extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}vs.RepoSuspendedError=e;class l extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}vs.RepoDeactivatedError=l;function _(w){if(w instanceof i.XRPCError){if(w.error==="BlobNotFound")return new c(w);if(w.error==="RepoNotFound")return new f(w);if(w.error==="RepoTakendown")return new y(w);if(w.error==="RepoSuspended")return new e(w);if(w.error==="RepoDeactivated")return new l(w)}return w}return vs}var xs={},pS;function fS(){if(pS)return xs;pS=1,Object.defineProperty(xs,"__esModule",{value:!0}),xs.RepoDeactivatedError=xs.RepoSuspendedError=xs.RepoTakendownError=xs.RepoNotFoundError=xs.BlockNotFoundError=void 0,xs.toKnownErr=_;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}xs.BlockNotFoundError=c;class f extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}xs.RepoNotFoundError=f;class y extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}xs.RepoTakendownError=y;class e extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}xs.RepoSuspendedError=e;class l extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}xs.RepoDeactivatedError=l;function _(w){if(w instanceof i.XRPCError){if(w.error==="BlockNotFound")return new c(w);if(w.error==="RepoNotFound")return new f(w);if(w.error==="RepoTakendown")return new y(w);if(w.error==="RepoSuspended")return new e(w);if(w.error==="RepoDeactivated")return new l(w)}return w}return xs}var Yd={},hS;function mS(){if(hS)return Yd;hS=1,Object.defineProperty(Yd,"__esModule",{value:!0}),Yd.HeadNotFoundError=void 0,Yd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Yd.HeadNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="HeadNotFound"?new c(y):y}return Yd}var Jd={},yS;function gS(){if(yS)return Jd;yS=1,Object.defineProperty(Jd,"__esModule",{value:!0}),Jd.HostNotFoundError=void 0,Jd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Jd.HostNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="HostNotFound"?new c(y):y}return Jd}var eo={},_S;function bS(){if(_S)return eo;_S=1,Object.defineProperty(eo,"__esModule",{value:!0}),eo.RepoDeactivatedError=eo.RepoSuspendedError=eo.RepoTakendownError=eo.RepoNotFoundError=void 0,eo.toKnownErr=l;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}eo.RepoNotFoundError=c;class f extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}eo.RepoTakendownError=f;class y extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}eo.RepoSuspendedError=y;class e extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}eo.RepoDeactivatedError=e;function l(_){if(_ instanceof i.XRPCError){if(_.error==="RepoNotFound")return new c(_);if(_.error==="RepoTakendown")return new f(_);if(_.error==="RepoSuspended")return new y(_);if(_.error==="RepoDeactivated")return new e(_)}return _}return eo}var ws={},vS;function xS(){if(vS)return ws;vS=1,Object.defineProperty(ws,"__esModule",{value:!0}),ws.RepoDeactivatedError=ws.RepoSuspendedError=ws.RepoTakendownError=ws.RepoNotFoundError=ws.RecordNotFoundError=void 0,ws.toKnownErr=_;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}ws.RecordNotFoundError=c;class f extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}ws.RepoNotFoundError=f;class y extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}ws.RepoTakendownError=y;class e extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}ws.RepoSuspendedError=e;class l extends i.XRPCError{constructor(R){super(R.status,R.error,R.message,R.headers,{cause:R})}}ws.RepoDeactivatedError=l;function _(w){if(w instanceof i.XRPCError){if(w.error==="RecordNotFound")return new c(w);if(w.error==="RepoNotFound")return new f(w);if(w.error==="RepoTakendown")return new y(w);if(w.error==="RepoSuspended")return new e(w);if(w.error==="RepoDeactivated")return new l(w)}return w}return ws}var to={},wS;function ES(){if(wS)return to;wS=1,Object.defineProperty(to,"__esModule",{value:!0}),to.RepoDeactivatedError=to.RepoSuspendedError=to.RepoTakendownError=to.RepoNotFoundError=void 0,to.toKnownErr=l;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}to.RepoNotFoundError=c;class f extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}to.RepoTakendownError=f;class y extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}to.RepoSuspendedError=y;class e extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}to.RepoDeactivatedError=e;function l(_){if(_ instanceof i.XRPCError){if(_.error==="RepoNotFound")return new c(_);if(_.error==="RepoTakendown")return new f(_);if(_.error==="RepoSuspended")return new y(_);if(_.error==="RepoDeactivated")return new e(_)}return _}return to}var Qd={},AS;function RS(){if(AS)return Qd;AS=1,Object.defineProperty(Qd,"__esModule",{value:!0}),Qd.RepoNotFoundError=void 0,Qd.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}Qd.RepoNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="RepoNotFound"?new c(y):y}return Qd}var ro={},SS;function TS(){if(SS)return ro;SS=1,Object.defineProperty(ro,"__esModule",{value:!0}),ro.RepoDeactivatedError=ro.RepoSuspendedError=ro.RepoTakendownError=ro.RepoNotFoundError=void 0,ro.toKnownErr=l;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}ro.RepoNotFoundError=c;class f extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}ro.RepoTakendownError=f;class y extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}ro.RepoSuspendedError=y;class e extends i.XRPCError{constructor(w){super(w.status,w.error,w.message,w.headers,{cause:w})}}ro.RepoDeactivatedError=e;function l(_){if(_ instanceof i.XRPCError){if(_.error==="RepoNotFound")return new c(_);if(_.error==="RepoTakendown")return new f(_);if(_.error==="RepoSuspended")return new y(_);if(_.error==="RepoDeactivated")return new e(_)}return _}return ro}var ep={},CS;function kS(){if(CS)return ep;CS=1,Object.defineProperty(ep,"__esModule",{value:!0}),ep.HostBannedError=void 0,ep.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}ep.HostBannedError=c;function f(y){return y instanceof i.XRPCError&&y.error==="HostBanned"?new c(y):y}return ep}var io={},PS;function LS(){if(PS)return io;PS=1,Object.defineProperty(io,"__esModule",{value:!0}),io.InvalidEmailError=void 0,io.toKnownErr=l,io.isResultAvailable=w,io.validateResultAvailable=R,io.isResultUnavailable=I,io.validateResultUnavailable=L,io.isSuggestion=q,io.validateSuggestion=G;const i=Xt(),n=pe(),c=fe().is$typed,f=n.validate,y="com.atproto.temp.checkHandleAvailability";class e extends i.XRPCError{constructor(ne){super(ne.status,ne.error,ne.message,ne.headers,{cause:ne})}}io.InvalidEmailError=e;function l(j){return j instanceof i.XRPCError&&j.error==="InvalidEmail"?new e(j):j}const _="resultAvailable";function w(j){return c(j,y,_)}function R(j){return f(j,y,_)}const C="resultUnavailable";function I(j){return c(j,y,C)}function L(j){return f(j,y,C)}const O="suggestion";function q(j){return c(j,y,O)}function G(j){return f(j,y,O)}return io}var tp={},DS;function IS(){if(DS)return tp;DS=1,Object.defineProperty(tp,"__esModule",{value:!0}),tp.InvalidScopeReferenceError=void 0,tp.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}tp.InvalidScopeReferenceError=c;function f(y){return y instanceof i.XRPCError&&y.error==="InvalidScopeReference"?new c(y):y}return tp}var rp={},BS;function MS(){if(BS)return rp;BS=1,Object.defineProperty(rp,"__esModule",{value:!0}),rp.DuplicateTemplateNameError=void 0,rp.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}rp.DuplicateTemplateNameError=c;function f(y){return y instanceof i.XRPCError&&y.error==="DuplicateTemplateName"?new c(y):y}return rp}var ip={},zS;function OS(){if(zS)return ip;zS=1,Object.defineProperty(ip,"__esModule",{value:!0}),ip.DuplicateTemplateNameError=void 0,ip.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}ip.DuplicateTemplateNameError=c;function f(y){return y instanceof i.XRPCError&&y.error==="DuplicateTemplateName"?new c(y):y}return ip}var Ll={},VS;function US(){if(VS)return Ll;VS=1,Object.defineProperty(Ll,"__esModule",{value:!0}),Ll.DuplicateExternalIdError=Ll.SubjectHasActionError=void 0,Ll.toKnownErr=y;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Ll.SubjectHasActionError=c;class f extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Ll.DuplicateExternalIdError=f;function y(e){if(e instanceof i.XRPCError){if(e.error==="SubjectHasAction")return new c(e);if(e.error==="DuplicateExternalId")return new f(e)}return e}return Ll}var ea={},jS;function NS(){if(jS)return ea;jS=1,Object.defineProperty(ea,"__esModule",{value:!0}),ea.RepoNotFoundError=void 0,ea.toKnownErr=l,ea.isTimelineItem=w,ea.validateTimelineItem=R,ea.isTimelineItemSummary=I,ea.validateTimelineItemSummary=L;const i=Xt(),n=pe(),c=fe().is$typed,f=n.validate,y="tools.ozone.moderation.getAccountTimeline";class e extends i.XRPCError{constructor(q){super(q.status,q.error,q.message,q.headers,{cause:q})}}ea.RepoNotFoundError=e;function l(O){return O instanceof i.XRPCError&&O.error==="RepoNotFound"?new e(O):O}const _="timelineItem";function w(O){return c(O,y,_)}function R(O){return f(O,y,_)}const C="timelineItemSummary";function I(O){return c(O,y,C)}function L(O){return f(O,y,C)}return ea}var np={},FS;function qS(){if(FS)return np;FS=1,Object.defineProperty(np,"__esModule",{value:!0}),np.RecordNotFoundError=void 0,np.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}np.RecordNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="RecordNotFound"?new c(y):y}return np}var sp={},KS;function GS(){if(KS)return sp;KS=1,Object.defineProperty(sp,"__esModule",{value:!0}),sp.RepoNotFoundError=void 0,sp.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}sp.RepoNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="RepoNotFound"?new c(y):y}return sp}var Dl={},$S;function ZS(){if($S)return Dl;$S=1,Object.defineProperty(Dl,"__esModule",{value:!0}),Dl.RuleAlreadyExistsError=Dl.InvalidUrlError=void 0,Dl.toKnownErr=y;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Dl.InvalidUrlError=c;class f extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Dl.RuleAlreadyExistsError=f;function y(e){if(e instanceof i.XRPCError){if(e.error==="InvalidUrl")return new c(e);if(e.error==="RuleAlreadyExists")return new f(e)}return e}return Dl}var op={},HS;function XS(){if(HS)return op;HS=1,Object.defineProperty(op,"__esModule",{value:!0}),op.RuleNotFoundError=void 0,op.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}op.RuleNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="RuleNotFound"?new c(y):y}return op}var ap={},WS;function YS(){if(WS)return ap;WS=1,Object.defineProperty(ap,"__esModule",{value:!0}),ap.RuleNotFoundError=void 0,ap.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}ap.RuleNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="RuleNotFound"?new c(y):y}return ap}var lp={},JS;function QS(){if(JS)return lp;JS=1,Object.defineProperty(lp,"__esModule",{value:!0}),lp.SetNotFoundError=void 0,lp.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}lp.SetNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="SetNotFound"?new c(y):y}return lp}var up={},eT;function tT(){if(eT)return up;eT=1,Object.defineProperty(up,"__esModule",{value:!0}),up.SetNotFoundError=void 0,up.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}up.SetNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="SetNotFound"?new c(y):y}return up}var cp={},rT;function iT(){if(rT)return cp;rT=1,Object.defineProperty(cp,"__esModule",{value:!0}),cp.SetNotFoundError=void 0,cp.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}cp.SetNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="SetNotFound"?new c(y):y}return cp}var dp={},nT;function sT(){if(nT)return dp;nT=1,Object.defineProperty(dp,"__esModule",{value:!0}),dp.MemberAlreadyExistsError=void 0,dp.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}dp.MemberAlreadyExistsError=c;function f(y){return y instanceof i.XRPCError&&y.error==="MemberAlreadyExists"?new c(y):y}return dp}var Il={},oT;function aT(){if(oT)return Il;oT=1,Object.defineProperty(Il,"__esModule",{value:!0}),Il.CannotDeleteSelfError=Il.MemberNotFoundError=void 0,Il.toKnownErr=y;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Il.MemberNotFoundError=c;class f extends i.XRPCError{constructor(l){super(l.status,l.error,l.message,l.headers,{cause:l})}}Il.CannotDeleteSelfError=f;function y(e){if(e instanceof i.XRPCError){if(e.error==="MemberNotFound")return new c(e);if(e.error==="CannotDeleteSelf")return new f(e)}return e}return Il}var pp={},lT;function uT(){if(lT)return pp;lT=1,Object.defineProperty(pp,"__esModule",{value:!0}),pp.MemberNotFoundError=void 0,pp.toKnownErr=f;const i=Xt(),n=pe();fe().is$typed,n.validate;class c extends i.XRPCError{constructor(e){super(e.status,e.error,e.message,e.headers,{cause:e})}}pp.MemberNotFoundError=c;function f(y){return y instanceof i.XRPCError&&y.error==="MemberNotFound"?new c(y):y}return pp}var Jt={},cT;function W5(){if(cT)return Jt;cT=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.isProfileViewBasic=e,Jt.validateProfileViewBasic=l,Jt.isProfileView=w,Jt.validateProfileView=R,Jt.isProfileViewDetailed=I,Jt.validateProfileViewDetailed=L,Jt.isProfileAssociated=q,Jt.validateProfileAssociated=G,Jt.isProfileAssociatedChat=ne,Jt.validateProfileAssociatedChat=he,Jt.isProfileAssociatedActivitySubscription=Be,Jt.validateProfileAssociatedActivitySubscription=we,Jt.isViewerState=et,Jt.validateViewerState=gt,Jt.isKnownFollowers=nt,Jt.validateKnownFollowers=rt,Jt.isVerificationState=Le,Jt.validateVerificationState=de,Jt.isVerificationView=tt,Jt.validateVerificationView=yt,Jt.isAdultContentPref=ge,Jt.validateAdultContentPref=Gt,Jt.isContentLabelPref=Ce,Jt.validateContentLabelPref=ar,Jt.isSavedFeed=er,Jt.validateSavedFeed=Ur,Jt.isSavedFeedsPrefV2=Sr,Jt.validateSavedFeedsPrefV2=Ar,Jt.isSavedFeedsPref=rr,Jt.validateSavedFeedsPref=gr,Jt.isPersonalDetailsPref=qr,Jt.validatePersonalDetailsPref=Vt,Jt.isFeedViewPref=St,Jt.validateFeedViewPref=Qt,Jt.isThreadViewPref=Tr,Jt.validateThreadViewPref=$r,Jt.isInterestsPref=pi,Jt.validateInterestsPref=Ii,Jt.isMutedWord=vt,Jt.validateMutedWord=Nt,Jt.isMutedWordsPref=W,Jt.validateMutedWordsPref=J,Jt.isHiddenPostsPref=_e,Jt.validateHiddenPostsPref=Re,Jt.isLabelersPref=Ge,Jt.validateLabelersPref=Ne,Jt.isLabelerPrefItem=ht,Jt.validateLabelerPrefItem=Ze,Jt.isBskyAppStatePref=Ft,Jt.validateBskyAppStatePref=Ke,Jt.isBskyAppProgressGuide=Cr,Jt.validateBskyAppProgressGuide=Ot,Jt.isNux=ai,Jt.validateNux=li,Jt.isVerificationPrefs=fi,Jt.validateVerificationPrefs=jr,Jt.isPostInteractionSettingsPref=Lr,Jt.validatePostInteractionSettingsPref=dt,Jt.isStatusView=Ci,Jt.validateStatusView=ki;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.actor.defs",y="profileViewBasic";function e(at){return a(at,f,y)}function l(at){return c(at,f,y)}const _="profileView";function w(at){return a(at,f,_)}function R(at){return c(at,f,_)}const C="profileViewDetailed";function I(at){return a(at,f,C)}function L(at){return c(at,f,C)}const O="profileAssociated";function q(at){return a(at,f,O)}function G(at){return c(at,f,O)}const j="profileAssociatedChat";function ne(at){return a(at,f,j)}function he(at){return c(at,f,j)}const Q="profileAssociatedActivitySubscription";function Be(at){return a(at,f,Q)}function we(at){return c(at,f,Q)}const ze="viewerState";function et(at){return a(at,f,ze)}function gt(at){return c(at,f,ze)}const st="knownFollowers";function nt(at){return a(at,f,st)}function rt(at){return c(at,f,st)}const ee="verificationState";function Le(at){return a(at,f,ee)}function de(at){return c(at,f,ee)}const me="verificationView";function tt(at){return a(at,f,me)}function yt(at){return c(at,f,me)}const lt="adultContentPref";function ge(at){return a(at,f,lt)}function Gt(at){return c(at,f,lt)}const Ut="contentLabelPref";function Ce(at){return a(at,f,Ut)}function ar(at){return c(at,f,Ut)}const kt="savedFeed";function er(at){return a(at,f,kt)}function Ur(at){return c(at,f,kt)}const or="savedFeedsPrefV2";function Sr(at){return a(at,f,or)}function Ar(at){return c(at,f,or)}const Nr="savedFeedsPref";function rr(at){return a(at,f,Nr)}function gr(at){return c(at,f,Nr)}const ir="personalDetailsPref";function qr(at){return a(at,f,ir)}function Vt(at){return c(at,f,ir)}const Pr="feedViewPref";function St(at){return a(at,f,Pr)}function Qt(at){return c(at,f,Pr)}const nr="threadViewPref";function Tr(at){return a(at,f,nr)}function $r(at){return c(at,f,nr)}const bt="interestsPref";function pi(at){return a(at,f,bt)}function Ii(at){return c(at,f,bt)}const Oe="mutedWord";function vt(at){return a(at,f,Oe)}function Nt(at){return c(at,f,Oe)}const ve="mutedWordsPref";function W(at){return a(at,f,ve)}function J(at){return c(at,f,ve)}const se="hiddenPostsPref";function _e(at){return a(at,f,se)}function Re(at){return c(at,f,se)}const je="labelersPref";function Ge(at){return a(at,f,je)}function Ne(at){return c(at,f,je)}const Ye="labelerPrefItem";function ht(at){return a(at,f,Ye)}function Ze(at){return c(at,f,Ye)}const Mt="bskyAppStatePref";function Ft(at){return a(at,f,Mt)}function Ke(at){return c(at,f,Mt)}const hr="bskyAppProgressGuide";function Cr(at){return a(at,f,hr)}function Ot(at){return c(at,f,hr)}const mr="nux";function ai(at){return a(at,f,mr)}function li(at){return c(at,f,mr)}const Wr="verificationPrefs";function fi(at){return a(at,f,Wr)}function jr(at){return c(at,f,Wr)}const ei="postInteractionSettingsPref";function Lr(at){return a(at,f,ei)}function dt(at){return c(at,f,ei)}const Bi="statusView";function Ci(at){return a(at,f,Bi)}function ki(at){return c(at,f,Bi)}return Jt}var zy={},dT;function Y5(){if(dT)return zy;dT=1,Object.defineProperty(zy,"__esModule",{value:!0}),zy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return zy}var Oy={},pT;function J5(){if(pT)return Oy;pT=1,Object.defineProperty(Oy,"__esModule",{value:!0}),Oy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Oy}var Vy={},fT;function Q5(){if(fT)return Vy;fT=1,Object.defineProperty(Vy,"__esModule",{value:!0}),Vy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Vy}var Uy={},hT;function e4(){if(hT)return Uy;hT=1,Object.defineProperty(Uy,"__esModule",{value:!0}),Uy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Uy}var mh={},mT;function t4(){if(mT)return mh;mT=1,Object.defineProperty(mh,"__esModule",{value:!0}),mh.isRecord=e,mh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.actor.profile",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return mh}var jy={},yT;function r4(){if(yT)return jy;yT=1,Object.defineProperty(jy,"__esModule",{value:!0}),jy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return jy}var Ny={},gT;function i4(){if(gT)return Ny;gT=1,Object.defineProperty(Ny,"__esModule",{value:!0}),Ny.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Ny}var Fy={},_T;function n4(){if(_T)return Fy;_T=1,Object.defineProperty(Fy,"__esModule",{value:!0}),Fy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Fy}var Ku={},bT;function s4(){if(bT)return Ku;bT=1,Object.defineProperty(Ku,"__esModule",{value:!0}),Ku.LIVE=void 0,Ku.isRecord=e,Ku.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.actor.status",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return Ku.LIVE=`${f}#live`,Ku}var Gu={},vT;function o4(){if(vT)return Gu;vT=1,Object.defineProperty(Gu,"__esModule",{value:!0}),Gu.isBookmark=e,Gu.validateBookmark=l,Gu.isBookmarkView=w,Gu.validateBookmarkView=R;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.bookmark.defs",y="bookmark";function e(C){return a(C,f,y)}function l(C){return c(C,f,y)}const _="bookmarkView";function w(C){return a(C,f,_)}function R(C){return c(C,f,_)}return Gu}var qy={},xT;function a4(){if(xT)return qy;xT=1,Object.defineProperty(qy,"__esModule",{value:!0}),qy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return qy}var yh={},wT;function l4(){if(wT)return yh;wT=1,Object.defineProperty(yh,"__esModule",{value:!0}),yh.isAspectRatio=e,yh.validateAspectRatio=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.embed.defs",y="aspectRatio";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return yh}var xo={},ET;function u4(){if(ET)return xo;ET=1,Object.defineProperty(xo,"__esModule",{value:!0}),xo.isMain=e,xo.validateMain=l,xo.isExternal=w,xo.validateExternal=R,xo.isView=I,xo.validateView=L,xo.isViewExternal=q,xo.validateViewExternal=G;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.embed.external",y="main";function e(j){return a(j,f,y)}function l(j){return c(j,f,y)}const _="external";function w(j){return a(j,f,_)}function R(j){return c(j,f,_)}const C="view";function I(j){return a(j,f,C)}function L(j){return c(j,f,C)}const O="viewExternal";function q(j){return a(j,f,O)}function G(j){return c(j,f,O)}return xo}var wo={},AT;function c4(){if(AT)return wo;AT=1,Object.defineProperty(wo,"__esModule",{value:!0}),wo.isMain=e,wo.validateMain=l,wo.isImage=w,wo.validateImage=R,wo.isView=I,wo.validateView=L,wo.isViewImage=q,wo.validateViewImage=G;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.embed.images",y="main";function e(j){return a(j,f,y)}function l(j){return c(j,f,y)}const _="image";function w(j){return a(j,f,_)}function R(j){return c(j,f,_)}const C="view";function I(j){return a(j,f,C)}function L(j){return c(j,f,C)}const O="viewImage";function q(j){return a(j,f,O)}function G(j){return c(j,f,O)}return wo}var rs={},RT;function d4(){if(RT)return rs;RT=1,Object.defineProperty(rs,"__esModule",{value:!0}),rs.isMain=e,rs.validateMain=l,rs.isView=w,rs.validateView=R,rs.isViewRecord=I,rs.validateViewRecord=L,rs.isViewNotFound=q,rs.validateViewNotFound=G,rs.isViewBlocked=ne,rs.validateViewBlocked=he,rs.isViewDetached=Be,rs.validateViewDetached=we;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.embed.record",y="main";function e(ze){return a(ze,f,y)}function l(ze){return c(ze,f,y)}const _="view";function w(ze){return a(ze,f,_)}function R(ze){return c(ze,f,_)}const C="viewRecord";function I(ze){return a(ze,f,C)}function L(ze){return c(ze,f,C)}const O="viewNotFound";function q(ze){return a(ze,f,O)}function G(ze){return c(ze,f,O)}const j="viewBlocked";function ne(ze){return a(ze,f,j)}function he(ze){return c(ze,f,j)}const Q="viewDetached";function Be(ze){return a(ze,f,Q)}function we(ze){return c(ze,f,Q)}return rs}var $u={},ST;function p4(){if(ST)return $u;ST=1,Object.defineProperty($u,"__esModule",{value:!0}),$u.isMain=e,$u.validateMain=l,$u.isView=w,$u.validateView=R;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.embed.recordWithMedia",y="main";function e(C){return a(C,f,y)}function l(C){return c(C,f,y)}const _="view";function w(C){return a(C,f,_)}function R(C){return c(C,f,_)}return $u}var Ma={},TT;function f4(){if(TT)return Ma;TT=1,Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.isMain=e,Ma.validateMain=l,Ma.isCaption=w,Ma.validateCaption=R,Ma.isView=I,Ma.validateView=L;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.embed.video",y="main";function e(O){return a(O,f,y)}function l(O){return c(O,f,y)}const _="caption";function w(O){return a(O,f,_)}function R(O){return c(O,f,_)}const C="view";function I(O){return a(O,f,C)}function L(O){return c(O,f,C)}return Ma}var Ht={},CT;function h4(){if(CT)return Ht;CT=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.INTERACTIONSHARE=Ht.INTERACTIONQUOTE=Ht.INTERACTIONREPLY=Ht.INTERACTIONREPOST=Ht.INTERACTIONLIKE=Ht.INTERACTIONSEEN=Ht.CONTENTMODEVIDEO=Ht.CONTENTMODEUNSPECIFIED=Ht.CLICKTHROUGHEMBED=Ht.CLICKTHROUGHREPOSTER=Ht.CLICKTHROUGHAUTHOR=Ht.CLICKTHROUGHITEM=Ht.REQUESTMORE=Ht.REQUESTLESS=void 0,Ht.isPostView=e,Ht.validatePostView=l,Ht.isViewerState=w,Ht.validateViewerState=R,Ht.isThreadContext=I,Ht.validateThreadContext=L,Ht.isFeedViewPost=q,Ht.validateFeedViewPost=G,Ht.isReplyRef=ne,Ht.validateReplyRef=he,Ht.isReasonRepost=Be,Ht.validateReasonRepost=we,Ht.isReasonPin=et,Ht.validateReasonPin=gt,Ht.isThreadViewPost=nt,Ht.validateThreadViewPost=rt,Ht.isNotFoundPost=Le,Ht.validateNotFoundPost=de,Ht.isBlockedPost=tt,Ht.validateBlockedPost=yt,Ht.isBlockedAuthor=ge,Ht.validateBlockedAuthor=Gt,Ht.isGeneratorView=Ce,Ht.validateGeneratorView=ar,Ht.isGeneratorViewerState=er,Ht.validateGeneratorViewerState=Ur,Ht.isSkeletonFeedPost=Sr,Ht.validateSkeletonFeedPost=Ar,Ht.isSkeletonReasonRepost=rr,Ht.validateSkeletonReasonRepost=gr,Ht.isSkeletonReasonPin=qr,Ht.validateSkeletonReasonPin=Vt,Ht.isThreadgateView=St,Ht.validateThreadgateView=Qt,Ht.isInteraction=Tr,Ht.validateInteraction=$r;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.feed.defs",y="postView";function e(bt){return a(bt,f,y)}function l(bt){return c(bt,f,y)}const _="viewerState";function w(bt){return a(bt,f,_)}function R(bt){return c(bt,f,_)}const C="threadContext";function I(bt){return a(bt,f,C)}function L(bt){return c(bt,f,C)}const O="feedViewPost";function q(bt){return a(bt,f,O)}function G(bt){return c(bt,f,O)}const j="replyRef";function ne(bt){return a(bt,f,j)}function he(bt){return c(bt,f,j)}const Q="reasonRepost";function Be(bt){return a(bt,f,Q)}function we(bt){return c(bt,f,Q)}const ze="reasonPin";function et(bt){return a(bt,f,ze)}function gt(bt){return c(bt,f,ze)}const st="threadViewPost";function nt(bt){return a(bt,f,st)}function rt(bt){return c(bt,f,st)}const ee="notFoundPost";function Le(bt){return a(bt,f,ee)}function de(bt){return c(bt,f,ee)}const me="blockedPost";function tt(bt){return a(bt,f,me)}function yt(bt){return c(bt,f,me)}const lt="blockedAuthor";function ge(bt){return a(bt,f,lt)}function Gt(bt){return c(bt,f,lt)}const Ut="generatorView";function Ce(bt){return a(bt,f,Ut)}function ar(bt){return c(bt,f,Ut)}const kt="generatorViewerState";function er(bt){return a(bt,f,kt)}function Ur(bt){return c(bt,f,kt)}const or="skeletonFeedPost";function Sr(bt){return a(bt,f,or)}function Ar(bt){return c(bt,f,or)}const Nr="skeletonReasonRepost";function rr(bt){return a(bt,f,Nr)}function gr(bt){return c(bt,f,Nr)}const ir="skeletonReasonPin";function qr(bt){return a(bt,f,ir)}function Vt(bt){return c(bt,f,ir)}const Pr="threadgateView";function St(bt){return a(bt,f,Pr)}function Qt(bt){return c(bt,f,Pr)}const nr="interaction";function Tr(bt){return a(bt,f,nr)}function $r(bt){return c(bt,f,nr)}return Ht.REQUESTLESS=`${f}#requestLess`,Ht.REQUESTMORE=`${f}#requestMore`,Ht.CLICKTHROUGHITEM=`${f}#clickthroughItem`,Ht.CLICKTHROUGHAUTHOR=`${f}#clickthroughAuthor`,Ht.CLICKTHROUGHREPOSTER=`${f}#clickthroughReposter`,Ht.CLICKTHROUGHEMBED=`${f}#clickthroughEmbed`,Ht.CONTENTMODEUNSPECIFIED=`${f}#contentModeUnspecified`,Ht.CONTENTMODEVIDEO=`${f}#contentModeVideo`,Ht.INTERACTIONSEEN=`${f}#interactionSeen`,Ht.INTERACTIONLIKE=`${f}#interactionLike`,Ht.INTERACTIONREPOST=`${f}#interactionRepost`,Ht.INTERACTIONREPLY=`${f}#interactionReply`,Ht.INTERACTIONQUOTE=`${f}#interactionQuote`,Ht.INTERACTIONSHARE=`${f}#interactionShare`,Ht}var Bl={},kT;function m4(){if(kT)return Bl;kT=1,Object.defineProperty(Bl,"__esModule",{value:!0}),Bl.toKnownErr=y,Bl.isFeed=l,Bl.validateFeed=_,Bl.isLinks=R,Bl.validateLinks=C;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.feed.describeFeedGenerator";function y(I){return I}const e="feed";function l(I){return a(I,f,e)}function _(I){return c(I,f,e)}const w="links";function R(I){return a(I,f,w)}function C(I){return c(I,f,w)}return Bl}var gh={},PT;function y4(){if(PT)return gh;PT=1,Object.defineProperty(gh,"__esModule",{value:!0}),gh.isRecord=e,gh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.feed.generator",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return gh}var Ky={},LT;function g4(){if(LT)return Ky;LT=1,Object.defineProperty(Ky,"__esModule",{value:!0}),Ky.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Ky}var Gy={},DT;function _4(){if(DT)return Gy;DT=1,Object.defineProperty(Gy,"__esModule",{value:!0}),Gy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Gy}var $y={},IT;function b4(){if(IT)return $y;IT=1,Object.defineProperty($y,"__esModule",{value:!0}),$y.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return $y}var fp={},BT;function v4(){if(BT)return fp;BT=1,Object.defineProperty(fp,"__esModule",{value:!0}),fp.toKnownErr=y,fp.isLike=l,fp.validateLike=_;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.feed.getLikes";function y(w){return w}const e="like";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return fp}var Zy={},MT;function x4(){if(MT)return Zy;MT=1,Object.defineProperty(Zy,"__esModule",{value:!0}),Zy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Zy}var Hy={},zT;function w4(){if(zT)return Hy;zT=1,Object.defineProperty(Hy,"__esModule",{value:!0}),Hy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Hy}var Xy={},OT;function E4(){if(OT)return Xy;OT=1,Object.defineProperty(Xy,"__esModule",{value:!0}),Xy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Xy}var Wy={},VT;function A4(){if(VT)return Wy;VT=1,Object.defineProperty(Wy,"__esModule",{value:!0}),Wy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Wy}var Yy={},UT;function R4(){if(UT)return Yy;UT=1,Object.defineProperty(Yy,"__esModule",{value:!0}),Yy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Yy}var _h={},jT;function S4(){if(jT)return _h;jT=1,Object.defineProperty(_h,"__esModule",{value:!0}),_h.isRecord=e,_h.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.feed.like",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return _h}var Eo={},NT;function T4(){if(NT)return Eo;NT=1,Object.defineProperty(Eo,"__esModule",{value:!0}),Eo.isRecord=e,Eo.validateRecord=l,Eo.isReplyRef=w,Eo.validateReplyRef=R,Eo.isEntity=I,Eo.validateEntity=L,Eo.isTextSlice=q,Eo.validateTextSlice=G;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.feed.post",y="main";function e(j){return a(j,f,y)}function l(j){return c(j,f,y,!0)}const _="replyRef";function w(j){return a(j,f,_)}function R(j){return c(j,f,_)}const C="entity";function I(j){return a(j,f,C)}function L(j){return c(j,f,C)}const O="textSlice";function q(j){return a(j,f,O)}function G(j){return c(j,f,O)}return Eo}var Zu={},FT;function C4(){if(FT)return Zu;FT=1,Object.defineProperty(Zu,"__esModule",{value:!0}),Zu.isRecord=e,Zu.validateRecord=l,Zu.isDisableRule=w,Zu.validateDisableRule=R;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.feed.postgate",y="main";function e(C){return a(C,f,y)}function l(C){return c(C,f,y,!0)}const _="disableRule";function w(C){return a(C,f,_)}function R(C){return c(C,f,_)}return Zu}var bh={},qT;function k4(){if(qT)return bh;qT=1,Object.defineProperty(bh,"__esModule",{value:!0}),bh.isRecord=e,bh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.feed.repost",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return bh}var Jy={},KT;function P4(){if(KT)return Jy;KT=1,Object.defineProperty(Jy,"__esModule",{value:!0}),Jy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Jy}var Os={},GT;function L4(){if(GT)return Os;GT=1,Object.defineProperty(Os,"__esModule",{value:!0}),Os.isRecord=e,Os.validateRecord=l,Os.isMentionRule=w,Os.validateMentionRule=R,Os.isFollowerRule=I,Os.validateFollowerRule=L,Os.isFollowingRule=q,Os.validateFollowingRule=G,Os.isListRule=ne,Os.validateListRule=he;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.feed.threadgate",y="main";function e(Q){return a(Q,f,y)}function l(Q){return c(Q,f,y,!0)}const _="mentionRule";function w(Q){return a(Q,f,_)}function R(Q){return c(Q,f,_)}const C="followerRule";function I(Q){return a(Q,f,C)}function L(Q){return c(Q,f,C)}const O="followingRule";function q(Q){return a(Q,f,O)}function G(Q){return c(Q,f,O)}const j="listRule";function ne(Q){return a(Q,f,j)}function he(Q){return c(Q,f,j)}return Os}var vh={},$T;function D4(){if($T)return vh;$T=1,Object.defineProperty(vh,"__esModule",{value:!0}),vh.isRecord=e,vh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.graph.block",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return vh}var Ti={},ZT;function I4(){if(ZT)return Ti;ZT=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.REFERENCELIST=Ti.CURATELIST=Ti.MODLIST=void 0,Ti.isListViewBasic=e,Ti.validateListViewBasic=l,Ti.isListView=w,Ti.validateListView=R,Ti.isListItemView=I,Ti.validateListItemView=L,Ti.isStarterPackView=q,Ti.validateStarterPackView=G,Ti.isStarterPackViewBasic=ne,Ti.validateStarterPackViewBasic=he,Ti.isListViewerState=Be,Ti.validateListViewerState=we,Ti.isNotFoundActor=et,Ti.validateNotFoundActor=gt,Ti.isRelationship=nt,Ti.validateRelationship=rt;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.graph.defs",y="listViewBasic";function e(ee){return a(ee,f,y)}function l(ee){return c(ee,f,y)}const _="listView";function w(ee){return a(ee,f,_)}function R(ee){return c(ee,f,_)}const C="listItemView";function I(ee){return a(ee,f,C)}function L(ee){return c(ee,f,C)}const O="starterPackView";function q(ee){return a(ee,f,O)}function G(ee){return c(ee,f,O)}const j="starterPackViewBasic";function ne(ee){return a(ee,f,j)}function he(ee){return c(ee,f,j)}Ti.MODLIST=`${f}#modlist`,Ti.CURATELIST=`${f}#curatelist`,Ti.REFERENCELIST=`${f}#referencelist`;const Q="listViewerState";function Be(ee){return a(ee,f,Q)}function we(ee){return c(ee,f,Q)}const ze="notFoundActor";function et(ee){return a(ee,f,ze)}function gt(ee){return c(ee,f,ze)}const st="relationship";function nt(ee){return a(ee,f,st)}function rt(ee){return c(ee,f,st)}return Ti}var xh={},HT;function B4(){if(HT)return xh;HT=1,Object.defineProperty(xh,"__esModule",{value:!0}),xh.isRecord=e,xh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.graph.follow",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return xh}var Qy={},XT;function M4(){if(XT)return Qy;XT=1,Object.defineProperty(Qy,"__esModule",{value:!0}),Qy.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Qy}var eg={},WT;function z4(){if(WT)return eg;WT=1,Object.defineProperty(eg,"__esModule",{value:!0}),eg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return eg}var tg={},YT;function O4(){if(YT)return tg;YT=1,Object.defineProperty(tg,"__esModule",{value:!0}),tg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return tg}var rg={},JT;function V4(){if(JT)return rg;JT=1,Object.defineProperty(rg,"__esModule",{value:!0}),rg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return rg}var ig={},QT;function U4(){if(QT)return ig;QT=1,Object.defineProperty(ig,"__esModule",{value:!0}),ig.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return ig}var ng={},eC;function j4(){if(eC)return ng;eC=1,Object.defineProperty(ng,"__esModule",{value:!0}),ng.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return ng}var sg={},tC;function N4(){if(tC)return sg;tC=1,Object.defineProperty(sg,"__esModule",{value:!0}),sg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return sg}var og={},rC;function F4(){if(rC)return og;rC=1,Object.defineProperty(og,"__esModule",{value:!0}),og.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return og}var ag={},iC;function q4(){if(iC)return ag;iC=1,Object.defineProperty(ag,"__esModule",{value:!0}),ag.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return ag}var hp={},nC;function K4(){if(nC)return hp;nC=1,Object.defineProperty(hp,"__esModule",{value:!0}),hp.toKnownErr=y,hp.isListWithMembership=l,hp.validateListWithMembership=_;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.graph.getListsWithMembership";function y(w){return w}const e="listWithMembership";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return hp}var lg={},sC;function G4(){if(sC)return lg;sC=1,Object.defineProperty(lg,"__esModule",{value:!0}),lg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return lg}var ug={},oC;function $4(){if(oC)return ug;oC=1,Object.defineProperty(ug,"__esModule",{value:!0}),ug.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return ug}var cg={},aC;function Z4(){if(aC)return cg;aC=1,Object.defineProperty(cg,"__esModule",{value:!0}),cg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return cg}var mp={},lC;function H4(){if(lC)return mp;lC=1,Object.defineProperty(mp,"__esModule",{value:!0}),mp.toKnownErr=y,mp.isStarterPackWithMembership=l,mp.validateStarterPackWithMembership=_;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.graph.getStarterPacksWithMembership";function y(w){return w}const e="starterPackWithMembership";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return mp}var dg={},uC;function X4(){if(uC)return dg;uC=1,Object.defineProperty(dg,"__esModule",{value:!0}),dg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return dg}var wh={},cC;function W4(){if(cC)return wh;cC=1,Object.defineProperty(wh,"__esModule",{value:!0}),wh.isRecord=e,wh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.graph.list",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return wh}var Eh={},dC;function Y4(){if(dC)return Eh;dC=1,Object.defineProperty(Eh,"__esModule",{value:!0}),Eh.isRecord=e,Eh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.graph.listblock",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return Eh}var Ah={},pC;function J4(){if(pC)return Ah;pC=1,Object.defineProperty(Ah,"__esModule",{value:!0}),Ah.isRecord=e,Ah.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.graph.listitem",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return Ah}var pg={},fC;function Q4(){if(fC)return pg;fC=1,Object.defineProperty(pg,"__esModule",{value:!0}),pg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return pg}var fg={},hC;function eF(){if(hC)return fg;hC=1,Object.defineProperty(fg,"__esModule",{value:!0}),fg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return fg}var hg={},mC;function tF(){if(mC)return hg;mC=1,Object.defineProperty(hg,"__esModule",{value:!0}),hg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return hg}var mg={},yC;function rF(){if(yC)return mg;yC=1,Object.defineProperty(mg,"__esModule",{value:!0}),mg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return mg}var Hu={},gC;function iF(){if(gC)return Hu;gC=1,Object.defineProperty(Hu,"__esModule",{value:!0}),Hu.isRecord=e,Hu.validateRecord=l,Hu.isFeedItem=w,Hu.validateFeedItem=R;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.graph.starterpack",y="main";function e(C){return a(C,f,y)}function l(C){return c(C,f,y,!0)}const _="feedItem";function w(C){return a(C,f,_)}function R(C){return c(C,f,_)}return Hu}var yg={},_C;function nF(){if(_C)return yg;_C=1,Object.defineProperty(yg,"__esModule",{value:!0}),yg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return yg}var gg={},bC;function sF(){if(bC)return gg;bC=1,Object.defineProperty(gg,"__esModule",{value:!0}),gg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return gg}var _g={},vC;function oF(){if(vC)return _g;vC=1,Object.defineProperty(_g,"__esModule",{value:!0}),_g.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return _g}var Rh={},xC;function aF(){if(xC)return Rh;xC=1,Object.defineProperty(Rh,"__esModule",{value:!0}),Rh.isRecord=e,Rh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.graph.verification",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return Rh}var Ao={},wC;function lF(){if(wC)return Ao;wC=1,Object.defineProperty(Ao,"__esModule",{value:!0}),Ao.isLabelerView=e,Ao.validateLabelerView=l,Ao.isLabelerViewDetailed=w,Ao.validateLabelerViewDetailed=R,Ao.isLabelerViewerState=I,Ao.validateLabelerViewerState=L,Ao.isLabelerPolicies=q,Ao.validateLabelerPolicies=G;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.labeler.defs",y="labelerView";function e(j){return a(j,f,y)}function l(j){return c(j,f,y)}const _="labelerViewDetailed";function w(j){return a(j,f,_)}function R(j){return c(j,f,_)}const C="labelerViewerState";function I(j){return a(j,f,C)}function L(j){return c(j,f,C)}const O="labelerPolicies";function q(j){return a(j,f,O)}function G(j){return c(j,f,O)}return Ao}var bg={},EC;function uF(){if(EC)return bg;EC=1,Object.defineProperty(bg,"__esModule",{value:!0}),bg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return bg}var Sh={},AC;function cF(){if(AC)return Sh;AC=1,Object.defineProperty(Sh,"__esModule",{value:!0}),Sh.isRecord=e,Sh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.labeler.service",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return Sh}var Th={},RC;function dF(){if(RC)return Th;RC=1,Object.defineProperty(Th,"__esModule",{value:!0}),Th.isRecord=e,Th.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.notification.declaration",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return Th}var Pn={},SC;function pF(){if(SC)return Pn;SC=1,Object.defineProperty(Pn,"__esModule",{value:!0}),Pn.isRecordDeleted=e,Pn.validateRecordDeleted=l,Pn.isChatPreference=w,Pn.validateChatPreference=R,Pn.isFilterablePreference=I,Pn.validateFilterablePreference=L,Pn.isPreference=q,Pn.validatePreference=G,Pn.isPreferences=ne,Pn.validatePreferences=he,Pn.isActivitySubscription=Be,Pn.validateActivitySubscription=we,Pn.isSubjectActivitySubscription=et,Pn.validateSubjectActivitySubscription=gt;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.notification.defs",y="recordDeleted";function e(st){return a(st,f,y)}function l(st){return c(st,f,y)}const _="chatPreference";function w(st){return a(st,f,_)}function R(st){return c(st,f,_)}const C="filterablePreference";function I(st){return a(st,f,C)}function L(st){return c(st,f,C)}const O="preference";function q(st){return a(st,f,O)}function G(st){return c(st,f,O)}const j="preferences";function ne(st){return a(st,f,j)}function he(st){return c(st,f,j)}const Q="activitySubscription";function Be(st){return a(st,f,Q)}function we(st){return c(st,f,Q)}const ze="subjectActivitySubscription";function et(st){return a(st,f,ze)}function gt(st){return c(st,f,ze)}return Pn}var vg={},TC;function fF(){if(TC)return vg;TC=1,Object.defineProperty(vg,"__esModule",{value:!0}),vg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return vg}var xg={},CC;function hF(){if(CC)return xg;CC=1,Object.defineProperty(xg,"__esModule",{value:!0}),xg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return xg}var wg={},kC;function mF(){if(kC)return wg;kC=1,Object.defineProperty(wg,"__esModule",{value:!0}),wg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return wg}var yp={},PC;function yF(){if(PC)return yp;PC=1,Object.defineProperty(yp,"__esModule",{value:!0}),yp.toKnownErr=y,yp.isNotification=l,yp.validateNotification=_;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.notification.listNotifications";function y(w){return w}const e="notification";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return yp}var Eg={},LC;function gF(){if(LC)return Eg;LC=1,Object.defineProperty(Eg,"__esModule",{value:!0}),Eg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Eg}var Ag={},DC;function _F(){if(DC)return Ag;DC=1,Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Ag}var Rg={},IC;function bF(){if(IC)return Rg;IC=1,Object.defineProperty(Rg,"__esModule",{value:!0}),Rg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Rg}var Sg={},BC;function vF(){if(BC)return Sg;BC=1,Object.defineProperty(Sg,"__esModule",{value:!0}),Sg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Sg}var Tg={},MC;function xF(){if(MC)return Tg;MC=1,Object.defineProperty(Tg,"__esModule",{value:!0}),Tg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Tg}var Cg={},zC;function wF(){if(zC)return Cg;zC=1,Object.defineProperty(Cg,"__esModule",{value:!0}),Cg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Cg}var Vs={},OC;function EF(){if(OC)return Vs;OC=1,Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.isMain=e,Vs.validateMain=l,Vs.isMention=w,Vs.validateMention=R,Vs.isLink=I,Vs.validateLink=L,Vs.isTag=q,Vs.validateTag=G,Vs.isByteSlice=ne,Vs.validateByteSlice=he;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.richtext.facet",y="main";function e(Q){return a(Q,f,y)}function l(Q){return c(Q,f,y)}const _="mention";function w(Q){return a(Q,f,_)}function R(Q){return c(Q,f,_)}const C="link";function I(Q){return a(Q,f,C)}function L(Q){return c(Q,f,C)}const O="tag";function q(Q){return a(Q,f,O)}function G(Q){return c(Q,f,O)}const j="byteSlice";function ne(Q){return a(Q,f,j)}function he(Q){return c(Q,f,j)}return Vs}var _i={},VC;function AF(){if(VC)return _i;VC=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.isSkeletonSearchPost=e,_i.validateSkeletonSearchPost=l,_i.isSkeletonSearchActor=w,_i.validateSkeletonSearchActor=R,_i.isSkeletonSearchStarterPack=I,_i.validateSkeletonSearchStarterPack=L,_i.isTrendingTopic=q,_i.validateTrendingTopic=G,_i.isSkeletonTrend=ne,_i.validateSkeletonTrend=he,_i.isTrendView=Be,_i.validateTrendView=we,_i.isThreadItemPost=et,_i.validateThreadItemPost=gt,_i.isThreadItemNoUnauthenticated=nt,_i.validateThreadItemNoUnauthenticated=rt,_i.isThreadItemNotFound=Le,_i.validateThreadItemNotFound=de,_i.isThreadItemBlocked=tt,_i.validateThreadItemBlocked=yt,_i.isAgeAssuranceState=ge,_i.validateAgeAssuranceState=Gt,_i.isAgeAssuranceEvent=Ce,_i.validateAgeAssuranceEvent=ar;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.unspecced.defs",y="skeletonSearchPost";function e(kt){return a(kt,f,y)}function l(kt){return c(kt,f,y)}const _="skeletonSearchActor";function w(kt){return a(kt,f,_)}function R(kt){return c(kt,f,_)}const C="skeletonSearchStarterPack";function I(kt){return a(kt,f,C)}function L(kt){return c(kt,f,C)}const O="trendingTopic";function q(kt){return a(kt,f,O)}function G(kt){return c(kt,f,O)}const j="skeletonTrend";function ne(kt){return a(kt,f,j)}function he(kt){return c(kt,f,j)}const Q="trendView";function Be(kt){return a(kt,f,Q)}function we(kt){return c(kt,f,Q)}const ze="threadItemPost";function et(kt){return a(kt,f,ze)}function gt(kt){return c(kt,f,ze)}const st="threadItemNoUnauthenticated";function nt(kt){return a(kt,f,st)}function rt(kt){return c(kt,f,st)}const ee="threadItemNotFound";function Le(kt){return a(kt,f,ee)}function de(kt){return c(kt,f,ee)}const me="threadItemBlocked";function tt(kt){return a(kt,f,me)}function yt(kt){return c(kt,f,me)}const lt="ageAssuranceState";function ge(kt){return a(kt,f,lt)}function Gt(kt){return c(kt,f,lt)}const Ut="ageAssuranceEvent";function Ce(kt){return a(kt,f,Ut)}function ar(kt){return c(kt,f,Ut)}return _i}var kg={},UC;function RF(){if(UC)return kg;UC=1,Object.defineProperty(kg,"__esModule",{value:!0}),kg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return kg}var gp={},jC;function SF(){if(jC)return gp;jC=1,Object.defineProperty(gp,"__esModule",{value:!0}),gp.toKnownErr=y,gp.isLiveNowConfig=l,gp.validateLiveNowConfig=_;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.unspecced.getConfig";function y(w){return w}const e="liveNowConfig";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return gp}var Pg={},NC;function TF(){if(NC)return Pg;NC=1,Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Pg}var Lg={},FC;function CF(){if(FC)return Lg;FC=1,Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Lg}var Dg={},qC;function kF(){if(qC)return Dg;qC=1,Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Dg}var _p={},KC;function PF(){if(KC)return _p;KC=1,Object.defineProperty(_p,"__esModule",{value:!0}),_p.toKnownErr=y,_p.isThreadItem=l,_p.validateThreadItem=_;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.unspecced.getPostThreadOtherV2";function y(w){return w}const e="threadItem";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return _p}var bp={},GC;function LF(){if(GC)return bp;GC=1,Object.defineProperty(bp,"__esModule",{value:!0}),bp.toKnownErr=y,bp.isThreadItem=l,bp.validateThreadItem=_;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.unspecced.getPostThreadV2";function y(w){return w}const e="threadItem";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return bp}var Ig={},$C;function DF(){if($C)return Ig;$C=1,Object.defineProperty(Ig,"__esModule",{value:!0}),Ig.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Ig}var Bg={},ZC;function IF(){if(ZC)return Bg;ZC=1,Object.defineProperty(Bg,"__esModule",{value:!0}),Bg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Bg}var Mg={},HC;function BF(){if(HC)return Mg;HC=1,Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Mg}var zg={},XC;function MF(){if(XC)return zg;XC=1,Object.defineProperty(zg,"__esModule",{value:!0}),zg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return zg}var Og={},WC;function zF(){if(WC)return Og;WC=1,Object.defineProperty(Og,"__esModule",{value:!0}),Og.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Og}var Vg={},YC;function OF(){if(YC)return Vg;YC=1,Object.defineProperty(Vg,"__esModule",{value:!0}),Vg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Vg}var Ug={},JC;function VF(){if(JC)return Ug;JC=1,Object.defineProperty(Ug,"__esModule",{value:!0}),Ug.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Ug}var vp={},QC;function UF(){if(QC)return vp;QC=1,Object.defineProperty(vp,"__esModule",{value:!0}),vp.toKnownErr=y,vp.isSuggestion=l,vp.validateSuggestion=_;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.unspecced.getTaggedSuggestions";function y(w){return w}const e="suggestion";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return vp}var jg={},ek;function jF(){if(ek)return jg;ek=1,Object.defineProperty(jg,"__esModule",{value:!0}),jg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return jg}var Ng={},tk;function NF(){if(tk)return Ng;tk=1,Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Ng}var Fg={},rk;function FF(){if(rk)return Fg;rk=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Fg}var Ch={},ik;function qF(){if(ik)return Ch;ik=1,Object.defineProperty(Ch,"__esModule",{value:!0}),Ch.isJobStatus=e,Ch.validateJobStatus=l;const i=pe(),a=fe().is$typed,c=i.validate,f="app.bsky.video.defs",y="jobStatus";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return Ch}var qg={},nk;function KF(){if(nk)return qg;nk=1,Object.defineProperty(qg,"__esModule",{value:!0}),qg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return qg}var Kg={},sk;function GF(){if(sk)return Kg;sk=1,Object.defineProperty(Kg,"__esModule",{value:!0}),Kg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Kg}var Gg={},ok;function $F(){if(ok)return Gg;ok=1,Object.defineProperty(Gg,"__esModule",{value:!0}),Gg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Gg}var kh={},ak;function ZF(){if(ak)return kh;ak=1,Object.defineProperty(kh,"__esModule",{value:!0}),kh.isRecord=e,kh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="chat.bsky.actor.declaration",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return kh}var Ph={},lk;function HF(){if(lk)return Ph;lk=1,Object.defineProperty(Ph,"__esModule",{value:!0}),Ph.isProfileViewBasic=e,Ph.validateProfileViewBasic=l;const i=pe(),a=fe().is$typed,c=i.validate,f="chat.bsky.actor.defs",y="profileViewBasic";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return Ph}var $g={},uk;function XF(){if(uk)return $g;uk=1,Object.defineProperty($g,"__esModule",{value:!0}),$g.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return $g}var Zg={},ck;function WF(){if(ck)return Zg;ck=1,Object.defineProperty(Zg,"__esModule",{value:!0}),Zg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Zg}var Hg={},dk;function YF(){if(dk)return Hg;dk=1,Object.defineProperty(Hg,"__esModule",{value:!0}),Hg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Hg}var zr={},pk;function JF(){if(pk)return zr;pk=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.isMessageRef=e,zr.validateMessageRef=l,zr.isMessageInput=w,zr.validateMessageInput=R,zr.isMessageView=I,zr.validateMessageView=L,zr.isDeletedMessageView=q,zr.validateDeletedMessageView=G,zr.isMessageViewSender=ne,zr.validateMessageViewSender=he,zr.isReactionView=Be,zr.validateReactionView=we,zr.isReactionViewSender=et,zr.validateReactionViewSender=gt,zr.isMessageAndReactionView=nt,zr.validateMessageAndReactionView=rt,zr.isConvoView=Le,zr.validateConvoView=de,zr.isLogBeginConvo=tt,zr.validateLogBeginConvo=yt,zr.isLogAcceptConvo=ge,zr.validateLogAcceptConvo=Gt,zr.isLogLeaveConvo=Ce,zr.validateLogLeaveConvo=ar,zr.isLogMuteConvo=er,zr.validateLogMuteConvo=Ur,zr.isLogUnmuteConvo=Sr,zr.validateLogUnmuteConvo=Ar,zr.isLogCreateMessage=rr,zr.validateLogCreateMessage=gr,zr.isLogDeleteMessage=qr,zr.validateLogDeleteMessage=Vt,zr.isLogReadMessage=St,zr.validateLogReadMessage=Qt,zr.isLogAddReaction=Tr,zr.validateLogAddReaction=$r,zr.isLogRemoveReaction=pi,zr.validateLogRemoveReaction=Ii;const i=pe(),a=fe().is$typed,c=i.validate,f="chat.bsky.convo.defs",y="messageRef";function e(Oe){return a(Oe,f,y)}function l(Oe){return c(Oe,f,y)}const _="messageInput";function w(Oe){return a(Oe,f,_)}function R(Oe){return c(Oe,f,_)}const C="messageView";function I(Oe){return a(Oe,f,C)}function L(Oe){return c(Oe,f,C)}const O="deletedMessageView";function q(Oe){return a(Oe,f,O)}function G(Oe){return c(Oe,f,O)}const j="messageViewSender";function ne(Oe){return a(Oe,f,j)}function he(Oe){return c(Oe,f,j)}const Q="reactionView";function Be(Oe){return a(Oe,f,Q)}function we(Oe){return c(Oe,f,Q)}const ze="reactionViewSender";function et(Oe){return a(Oe,f,ze)}function gt(Oe){return c(Oe,f,ze)}const st="messageAndReactionView";function nt(Oe){return a(Oe,f,st)}function rt(Oe){return c(Oe,f,st)}const ee="convoView";function Le(Oe){return a(Oe,f,ee)}function de(Oe){return c(Oe,f,ee)}const me="logBeginConvo";function tt(Oe){return a(Oe,f,me)}function yt(Oe){return c(Oe,f,me)}const lt="logAcceptConvo";function ge(Oe){return a(Oe,f,lt)}function Gt(Oe){return c(Oe,f,lt)}const Ut="logLeaveConvo";function Ce(Oe){return a(Oe,f,Ut)}function ar(Oe){return c(Oe,f,Ut)}const kt="logMuteConvo";function er(Oe){return a(Oe,f,kt)}function Ur(Oe){return c(Oe,f,kt)}const or="logUnmuteConvo";function Sr(Oe){return a(Oe,f,or)}function Ar(Oe){return c(Oe,f,or)}const Nr="logCreateMessage";function rr(Oe){return a(Oe,f,Nr)}function gr(Oe){return c(Oe,f,Nr)}const ir="logDeleteMessage";function qr(Oe){return a(Oe,f,ir)}function Vt(Oe){return c(Oe,f,ir)}const Pr="logReadMessage";function St(Oe){return a(Oe,f,Pr)}function Qt(Oe){return c(Oe,f,Pr)}const nr="logAddReaction";function Tr(Oe){return a(Oe,f,nr)}function $r(Oe){return c(Oe,f,nr)}const bt="logRemoveReaction";function pi(Oe){return a(Oe,f,bt)}function Ii(Oe){return c(Oe,f,bt)}return zr}var Xg={},fk;function QF(){if(fk)return Xg;fk=1,Object.defineProperty(Xg,"__esModule",{value:!0}),Xg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Xg}var Wg={},hk;function eq(){if(hk)return Wg;hk=1,Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Wg}var Yg={},mk;function tq(){if(mk)return Yg;mk=1,Object.defineProperty(Yg,"__esModule",{value:!0}),Yg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Yg}var Jg={},yk;function rq(){if(yk)return Jg;yk=1,Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Jg}var Qg={},gk;function iq(){if(gk)return Qg;gk=1,Object.defineProperty(Qg,"__esModule",{value:!0}),Qg.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Qg}var e_={},_k;function nq(){if(_k)return e_;_k=1,Object.defineProperty(e_,"__esModule",{value:!0}),e_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return e_}var t_={},bk;function sq(){if(bk)return t_;bk=1,Object.defineProperty(t_,"__esModule",{value:!0}),t_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return t_}var r_={},vk;function oq(){if(vk)return r_;vk=1,Object.defineProperty(r_,"__esModule",{value:!0}),r_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return r_}var i_={},xk;function aq(){if(xk)return i_;xk=1,Object.defineProperty(i_,"__esModule",{value:!0}),i_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return i_}var n_={},wk;function lq(){if(wk)return n_;wk=1,Object.defineProperty(n_,"__esModule",{value:!0}),n_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return n_}var xp={},Ek;function uq(){if(Ek)return xp;Ek=1,Object.defineProperty(xp,"__esModule",{value:!0}),xp.toKnownErr=y,xp.isBatchItem=l,xp.validateBatchItem=_;const i=pe(),a=fe().is$typed,c=i.validate,f="chat.bsky.convo.sendMessageBatch";function y(w){return w}const e="batchItem";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return xp}var s_={},Ak;function cq(){if(Ak)return s_;Ak=1,Object.defineProperty(s_,"__esModule",{value:!0}),s_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return s_}var o_={},Rk;function dq(){if(Rk)return o_;Rk=1,Object.defineProperty(o_,"__esModule",{value:!0}),o_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return o_}var a_={},Sk;function pq(){if(Sk)return a_;Sk=1,Object.defineProperty(a_,"__esModule",{value:!0}),a_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return a_}var wp={},Tk;function fq(){if(Tk)return wp;Tk=1,Object.defineProperty(wp,"__esModule",{value:!0}),wp.toKnownErr=y,wp.isMetadata=l,wp.validateMetadata=_;const i=pe(),a=fe().is$typed,c=i.validate,f="chat.bsky.moderation.getActorMetadata";function y(w){return w}const e="metadata";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return wp}var l_={},Ck;function hq(){if(Ck)return l_;Ck=1,Object.defineProperty(l_,"__esModule",{value:!0}),l_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return l_}var u_={},kk;function mq(){if(kk)return u_;kk=1,Object.defineProperty(u_,"__esModule",{value:!0}),u_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return u_}var Us={},Pk;function yq(){if(Pk)return Us;Pk=1,Object.defineProperty(Us,"__esModule",{value:!0}),Us.isStatusAttr=e,Us.validateStatusAttr=l,Us.isAccountView=w,Us.validateAccountView=R,Us.isRepoRef=I,Us.validateRepoRef=L,Us.isRepoBlobRef=q,Us.validateRepoBlobRef=G,Us.isThreatSignature=ne,Us.validateThreatSignature=he;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.admin.defs",y="statusAttr";function e(Q){return a(Q,f,y)}function l(Q){return c(Q,f,y)}const _="accountView";function w(Q){return a(Q,f,_)}function R(Q){return c(Q,f,_)}const C="repoRef";function I(Q){return a(Q,f,C)}function L(Q){return c(Q,f,C)}const O="repoBlobRef";function q(Q){return a(Q,f,O)}function G(Q){return c(Q,f,O)}const j="threatSignature";function ne(Q){return a(Q,f,j)}function he(Q){return c(Q,f,j)}return Us}var c_={},Lk;function gq(){if(Lk)return c_;Lk=1,Object.defineProperty(c_,"__esModule",{value:!0}),c_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return c_}var d_={},Dk;function _q(){if(Dk)return d_;Dk=1,Object.defineProperty(d_,"__esModule",{value:!0}),d_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return d_}var p_={},Ik;function bq(){if(Ik)return p_;Ik=1,Object.defineProperty(p_,"__esModule",{value:!0}),p_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return p_}var f_={},Bk;function vq(){if(Bk)return f_;Bk=1,Object.defineProperty(f_,"__esModule",{value:!0}),f_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return f_}var h_={},Mk;function xq(){if(Mk)return h_;Mk=1,Object.defineProperty(h_,"__esModule",{value:!0}),h_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return h_}var m_={},zk;function wq(){if(zk)return m_;zk=1,Object.defineProperty(m_,"__esModule",{value:!0}),m_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return m_}var y_={},Ok;function Eq(){if(Ok)return y_;Ok=1,Object.defineProperty(y_,"__esModule",{value:!0}),y_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return y_}var g_={},Vk;function Aq(){if(Vk)return g_;Vk=1,Object.defineProperty(g_,"__esModule",{value:!0}),g_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return g_}var __={},Uk;function Rq(){if(Uk)return __;Uk=1,Object.defineProperty(__,"__esModule",{value:!0}),__.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return __}var b_={},jk;function Sq(){if(jk)return b_;jk=1,Object.defineProperty(b_,"__esModule",{value:!0}),b_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return b_}var v_={},Nk;function Tq(){if(Nk)return v_;Nk=1,Object.defineProperty(v_,"__esModule",{value:!0}),v_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return v_}var x_={},Fk;function Cq(){if(Fk)return x_;Fk=1,Object.defineProperty(x_,"__esModule",{value:!0}),x_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return x_}var w_={},qk;function kq(){if(qk)return w_;qk=1,Object.defineProperty(w_,"__esModule",{value:!0}),w_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return w_}var E_={},Kk;function Pq(){if(Kk)return E_;Kk=1,Object.defineProperty(E_,"__esModule",{value:!0}),E_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return E_}var A_={},Gk;function Lq(){if(Gk)return A_;Gk=1,Object.defineProperty(A_,"__esModule",{value:!0}),A_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return A_}var Lh={},$k;function Dq(){if($k)return Lh;$k=1,Object.defineProperty(Lh,"__esModule",{value:!0}),Lh.isIdentityInfo=e,Lh.validateIdentityInfo=l;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.identity.defs",y="identityInfo";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return Lh}var R_={},Zk;function Iq(){if(Zk)return R_;Zk=1,Object.defineProperty(R_,"__esModule",{value:!0}),R_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return R_}var S_={},Hk;function Bq(){if(Hk)return S_;Hk=1,Object.defineProperty(S_,"__esModule",{value:!0}),S_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return S_}var T_={},Xk;function Mq(){if(Xk)return T_;Xk=1,Object.defineProperty(T_,"__esModule",{value:!0}),T_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return T_}var C_={},Wk;function zq(){if(Wk)return C_;Wk=1,Object.defineProperty(C_,"__esModule",{value:!0}),C_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return C_}var k_={},Yk;function Oq(){if(Yk)return k_;Yk=1,Object.defineProperty(k_,"__esModule",{value:!0}),k_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return k_}var js={},Jk;function Vq(){if(Jk)return js;Jk=1,Object.defineProperty(js,"__esModule",{value:!0}),js.isLabel=e,js.validateLabel=l,js.isSelfLabels=w,js.validateSelfLabels=R,js.isSelfLabel=I,js.validateSelfLabel=L,js.isLabelValueDefinition=q,js.validateLabelValueDefinition=G,js.isLabelValueDefinitionStrings=ne,js.validateLabelValueDefinitionStrings=he;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.label.defs",y="label";function e(Q){return a(Q,f,y)}function l(Q){return c(Q,f,y)}const _="selfLabels";function w(Q){return a(Q,f,_)}function R(Q){return c(Q,f,_)}const C="selfLabel";function I(Q){return a(Q,f,C)}function L(Q){return c(Q,f,C)}const O="labelValueDefinition";function q(Q){return a(Q,f,O)}function G(Q){return c(Q,f,O)}const j="labelValueDefinitionStrings";function ne(Q){return a(Q,f,j)}function he(Q){return c(Q,f,j)}return js}var P_={},Qk;function Uq(){if(Qk)return P_;Qk=1,Object.defineProperty(P_,"__esModule",{value:!0}),P_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return P_}var Xu={},e2;function jq(){if(e2)return Xu;e2=1,Object.defineProperty(Xu,"__esModule",{value:!0}),Xu.isLabels=e,Xu.validateLabels=l,Xu.isInfo=w,Xu.validateInfo=R;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.label.subscribeLabels",y="labels";function e(C){return a(C,f,y)}function l(C){return c(C,f,y)}const _="info";function w(C){return a(C,f,_)}function R(C){return c(C,f,_)}return Xu}var Dh={},t2;function Nq(){if(t2)return Dh;t2=1,Object.defineProperty(Dh,"__esModule",{value:!0}),Dh.isRecord=e,Dh.validateRecord=l;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.lexicon.schema",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y,!0)}return Dh}var Ep={},r2;function Fq(){if(r2)return Ep;r2=1,Object.defineProperty(Ep,"__esModule",{value:!0}),Ep.toKnownErr=y,Ep.isModTool=l,Ep.validateModTool=_;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.moderation.createReport";function y(w){return w}const e="modTool";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return Ep}var Ln={},i2;function qq(){if(i2)return Ln;i2=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.REASONAPPEAL=Ln.REASONOTHER=Ln.REASONRUDE=Ln.REASONSEXUAL=Ln.REASONMISLEADING=Ln.REASONVIOLATION=Ln.REASONSPAM=void 0;const i=pe();fe().is$typed,i.validate;const a="com.atproto.moderation.defs";return Ln.REASONSPAM=`${a}#reasonSpam`,Ln.REASONVIOLATION=`${a}#reasonViolation`,Ln.REASONMISLEADING=`${a}#reasonMisleading`,Ln.REASONSEXUAL=`${a}#reasonSexual`,Ln.REASONRUDE=`${a}#reasonRude`,Ln.REASONOTHER=`${a}#reasonOther`,Ln.REASONAPPEAL=`${a}#reasonAppeal`,Ln}var Ih={},n2;function Kq(){if(n2)return Ih;n2=1,Object.defineProperty(Ih,"__esModule",{value:!0}),Ih.isCommitMeta=e,Ih.validateCommitMeta=l;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.repo.defs",y="commitMeta";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return Ih}var L_={},s2;function Gq(){if(s2)return L_;s2=1,Object.defineProperty(L_,"__esModule",{value:!0}),L_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return L_}var D_={},o2;function $q(){if(o2)return D_;o2=1,Object.defineProperty(D_,"__esModule",{value:!0}),D_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return D_}var Ap={},a2;function Zq(){if(a2)return Ap;a2=1,Object.defineProperty(Ap,"__esModule",{value:!0}),Ap.toKnownErr=y,Ap.isRecordBlob=l,Ap.validateRecordBlob=_;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.repo.listMissingBlobs";function y(w){return w}const e="recordBlob";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return Ap}var Rp={},l2;function Hq(){if(l2)return Rp;l2=1,Object.defineProperty(Rp,"__esModule",{value:!0}),Rp.toKnownErr=y,Rp.isRecord=l,Rp.validateRecord=_;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.repo.listRecords";function y(w){return w}const e="record";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return Rp}var Bh={},u2;function Xq(){if(u2)return Bh;u2=1,Object.defineProperty(Bh,"__esModule",{value:!0}),Bh.isMain=e,Bh.validateMain=l;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.repo.strongRef",y="main";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return Bh}var I_={},c2;function Wq(){if(c2)return I_;c2=1,Object.defineProperty(I_,"__esModule",{value:!0}),I_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return I_}var B_={},d2;function Yq(){if(d2)return B_;d2=1,Object.defineProperty(B_,"__esModule",{value:!0}),B_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return B_}var M_={},p2;function Jq(){if(p2)return M_;p2=1,Object.defineProperty(M_,"__esModule",{value:!0}),M_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return M_}var z_={},f2;function Qq(){if(f2)return z_;f2=1,Object.defineProperty(z_,"__esModule",{value:!0}),z_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return z_}var Sp={},h2;function e6(){if(h2)return Sp;h2=1,Object.defineProperty(Sp,"__esModule",{value:!0}),Sp.toKnownErr=y,Sp.isAccountCodes=l,Sp.validateAccountCodes=_;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.server.createInviteCodes";function y(w){return w}const e="accountCodes";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return Sp}var O_={},m2;function t6(){if(m2)return O_;m2=1,Object.defineProperty(O_,"__esModule",{value:!0}),O_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return O_}var Wu={},y2;function r6(){if(y2)return Wu;y2=1,Object.defineProperty(Wu,"__esModule",{value:!0}),Wu.isInviteCode=e,Wu.validateInviteCode=l,Wu.isInviteCodeUse=w,Wu.validateInviteCodeUse=R;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.server.defs",y="inviteCode";function e(C){return a(C,f,y)}function l(C){return c(C,f,y)}const _="inviteCodeUse";function w(C){return a(C,f,_)}function R(C){return c(C,f,_)}return Wu}var V_={},g2;function i6(){if(g2)return V_;g2=1,Object.defineProperty(V_,"__esModule",{value:!0}),V_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return V_}var Ml={},_2;function n6(){if(_2)return Ml;_2=1,Object.defineProperty(Ml,"__esModule",{value:!0}),Ml.toKnownErr=y,Ml.isLinks=l,Ml.validateLinks=_,Ml.isContact=R,Ml.validateContact=C;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.server.describeServer";function y(I){return I}const e="links";function l(I){return a(I,f,e)}function _(I){return c(I,f,e)}const w="contact";function R(I){return a(I,f,w)}function C(I){return c(I,f,w)}return Ml}var U_={},b2;function s6(){if(b2)return U_;b2=1,Object.defineProperty(U_,"__esModule",{value:!0}),U_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return U_}var j_={},v2;function o6(){if(v2)return j_;v2=1,Object.defineProperty(j_,"__esModule",{value:!0}),j_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return j_}var N_={},x2;function a6(){if(x2)return N_;x2=1,Object.defineProperty(N_,"__esModule",{value:!0}),N_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return N_}var F_={},w2;function l6(){if(w2)return F_;w2=1,Object.defineProperty(F_,"__esModule",{value:!0}),F_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return F_}var q_={},E2;function u6(){if(E2)return q_;E2=1,Object.defineProperty(q_,"__esModule",{value:!0}),q_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return q_}var K_={},A2;function c6(){if(A2)return K_;A2=1,Object.defineProperty(K_,"__esModule",{value:!0}),K_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return K_}var G_={},R2;function d6(){if(R2)return G_;R2=1,Object.defineProperty(G_,"__esModule",{value:!0}),G_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return G_}var X0={},S2;function p6(){if(S2)return X0;S2=1,Object.defineProperty(X0,"__esModule",{value:!0});const i=pe();return fe().is$typed,i.validate,X0}var $_={},T2;function f6(){if(T2)return $_;T2=1,Object.defineProperty($_,"__esModule",{value:!0}),$_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return $_}var Tp={},C2;function h6(){if(C2)return Tp;C2=1,Object.defineProperty(Tp,"__esModule",{value:!0}),Tp.toKnownErr=y,Tp.isHost=l,Tp.validateHost=_;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.sync.listHosts";function y(w){return w}const e="host";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return Tp}var Cp={},k2;function m6(){if(k2)return Cp;k2=1,Object.defineProperty(Cp,"__esModule",{value:!0}),Cp.toKnownErr=y,Cp.isRepo=l,Cp.validateRepo=_;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.sync.listRepos";function y(w){return w}const e="repo";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return Cp}var kp={},P2;function y6(){if(P2)return kp;P2=1,Object.defineProperty(kp,"__esModule",{value:!0}),kp.toKnownErr=y,kp.isRepo=l,kp.validateRepo=_;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.sync.listReposByCollection";function y(w){return w}const e="repo";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return kp}var Z_={},L2;function g6(){if(L2)return Z_;L2=1,Object.defineProperty(Z_,"__esModule",{value:!0}),Z_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Z_}var is={},D2;function _6(){if(D2)return is;D2=1,Object.defineProperty(is,"__esModule",{value:!0}),is.isCommit=e,is.validateCommit=l,is.isSync=w,is.validateSync=R,is.isIdentity=I,is.validateIdentity=L,is.isAccount=q,is.validateAccount=G,is.isInfo=ne,is.validateInfo=he,is.isRepoOp=Be,is.validateRepoOp=we;const i=pe(),a=fe().is$typed,c=i.validate,f="com.atproto.sync.subscribeRepos",y="commit";function e(ze){return a(ze,f,y)}function l(ze){return c(ze,f,y)}const _="sync";function w(ze){return a(ze,f,_)}function R(ze){return c(ze,f,_)}const C="identity";function I(ze){return a(ze,f,C)}function L(ze){return c(ze,f,C)}const O="account";function q(ze){return a(ze,f,O)}function G(ze){return c(ze,f,O)}const j="info";function ne(ze){return a(ze,f,j)}function he(ze){return c(ze,f,j)}const Q="repoOp";function Be(ze){return a(ze,f,Q)}function we(ze){return c(ze,f,Q)}return is}var H_={},I2;function b6(){if(I2)return H_;I2=1,Object.defineProperty(H_,"__esModule",{value:!0}),H_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return H_}var X_={},B2;function v6(){if(B2)return X_;B2=1,Object.defineProperty(X_,"__esModule",{value:!0}),X_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return X_}var W_={},M2;function x6(){if(M2)return W_;M2=1,Object.defineProperty(W_,"__esModule",{value:!0}),W_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return W_}var Y_={},z2;function w6(){if(z2)return Y_;z2=1,Object.defineProperty(Y_,"__esModule",{value:!0}),Y_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Y_}var J_={},O2;function E6(){if(O2)return J_;O2=1,Object.defineProperty(J_,"__esModule",{value:!0}),J_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return J_}var Mh={},V2;function A6(){if(V2)return Mh;V2=1,Object.defineProperty(Mh,"__esModule",{value:!0}),Mh.isTemplateView=e,Mh.validateTemplateView=l;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.communication.defs",y="templateView";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return Mh}var Q_={},U2;function R6(){if(U2)return Q_;U2=1,Object.defineProperty(Q_,"__esModule",{value:!0}),Q_.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return Q_}var eb={},j2;function S6(){if(j2)return eb;j2=1,Object.defineProperty(eb,"__esModule",{value:!0}),eb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return eb}var Nn={},N2;function T6(){if(N2)return Nn;N2=1,Object.defineProperty(Nn,"__esModule",{value:!0}),Nn.toKnownErr=y,Nn.isEvent=l,Nn.validateEvent=_,Nn.isAccountCreated=R,Nn.validateAccountCreated=C,Nn.isEmailUpdated=L,Nn.validateEmailUpdated=O,Nn.isEmailConfirmed=G,Nn.validateEmailConfirmed=j,Nn.isPasswordUpdated=he,Nn.validatePasswordUpdated=Q,Nn.isHandleUpdated=we,Nn.validateHandleUpdated=ze;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.hosting.getAccountHistory";function y(et){return et}const e="event";function l(et){return a(et,f,e)}function _(et){return c(et,f,e)}const w="accountCreated";function R(et){return a(et,f,w)}function C(et){return c(et,f,w)}const I="emailUpdated";function L(et){return a(et,f,I)}function O(et){return c(et,f,I)}const q="emailConfirmed";function G(et){return a(et,f,q)}function j(et){return c(et,f,q)}const ne="passwordUpdated";function he(et){return a(et,f,ne)}function Q(et){return c(et,f,ne)}const Be="handleUpdated";function we(et){return a(et,f,Be)}function ze(et){return c(et,f,Be)}return Nn}var zl={},F2;function C6(){if(F2)return zl;F2=1,Object.defineProperty(zl,"__esModule",{value:!0}),zl.toKnownErr=y,zl.isCancellationResults=l,zl.validateCancellationResults=_,zl.isFailedCancellation=R,zl.validateFailedCancellation=C;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.moderation.cancelScheduledActions";function y(I){return I}const e="cancellationResults";function l(I){return a(I,f,e)}function _(I){return c(I,f,e)}const w="failedCancellation";function R(I){return a(I,f,w)}function C(I){return c(I,f,w)}return zl}var _t={},q2;function k6(){if(q2)return _t;q2=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.TIMELINEEVENTPLCTOMBSTONE=_t.TIMELINEEVENTPLCOPERATION=_t.TIMELINEEVENTPLCCREATE=_t.REVIEWNONE=_t.REVIEWCLOSED=_t.REVIEWESCALATED=_t.REVIEWOPEN=void 0,_t.isModEventView=e,_t.validateModEventView=l,_t.isModEventViewDetail=w,_t.validateModEventViewDetail=R,_t.isSubjectStatusView=I,_t.validateSubjectStatusView=L,_t.isSubjectView=q,_t.validateSubjectView=G,_t.isAccountStats=ne,_t.validateAccountStats=he,_t.isRecordsStats=Be,_t.validateRecordsStats=we,_t.isModEventTakedown=et,_t.validateModEventTakedown=gt,_t.isModEventReverseTakedown=nt,_t.validateModEventReverseTakedown=rt,_t.isModEventResolveAppeal=Le,_t.validateModEventResolveAppeal=de,_t.isModEventComment=tt,_t.validateModEventComment=yt,_t.isModEventReport=ge,_t.validateModEventReport=Gt,_t.isModEventLabel=Ce,_t.validateModEventLabel=ar,_t.isModEventPriorityScore=er,_t.validateModEventPriorityScore=Ur,_t.isAgeAssuranceEvent=Sr,_t.validateAgeAssuranceEvent=Ar,_t.isAgeAssuranceOverrideEvent=rr,_t.validateAgeAssuranceOverrideEvent=gr,_t.isRevokeAccountCredentialsEvent=qr,_t.validateRevokeAccountCredentialsEvent=Vt,_t.isModEventAcknowledge=St,_t.validateModEventAcknowledge=Qt,_t.isModEventEscalate=Tr,_t.validateModEventEscalate=$r,_t.isModEventMute=pi,_t.validateModEventMute=Ii,_t.isModEventUnmute=vt,_t.validateModEventUnmute=Nt,_t.isModEventMuteReporter=W,_t.validateModEventMuteReporter=J,_t.isModEventUnmuteReporter=_e,_t.validateModEventUnmuteReporter=Re,_t.isModEventEmail=Ge,_t.validateModEventEmail=Ne,_t.isModEventDivert=ht,_t.validateModEventDivert=Ze,_t.isModEventTag=Ft,_t.validateModEventTag=Ke,_t.isAccountEvent=Cr,_t.validateAccountEvent=Ot,_t.isIdentityEvent=ai,_t.validateIdentityEvent=li,_t.isRecordEvent=fi,_t.validateRecordEvent=jr,_t.isScheduleTakedownEvent=Lr,_t.validateScheduleTakedownEvent=dt,_t.isCancelScheduledTakedownEvent=Ci,_t.validateCancelScheduledTakedownEvent=ki,_t.isRepoView=At,_t.validateRepoView=yr,_t.isRepoViewDetail=Ni,_t.validateRepoViewDetail=an,_t.isRepoViewNotFound=ur,_t.validateRepoViewNotFound=Zn,_t.isRecordView=Bn,_t.validateRecordView=ds,_t.isRecordViewDetail=Mn,_t.validateRecordViewDetail=ui,_t.isRecordViewNotFound=Zr,_t.validateRecordViewNotFound=ps,_t.isModeration=Zs,_t.validateModeration=Te,_t.isModerationDetail=te,_t.validateModerationDetail=oe,_t.isBlobView=De,_t.validateBlobView=Et,_t.isImageDetails=$t,_t.validateImageDetails=Wt,_t.isVideoDetails=zi,_t.validateVideoDetails=Rn,_t.isAccountHosting=P,_t.validateAccountHosting=B,_t.isRecordHosting=ut,_t.validateRecordHosting=_r,_t.isReporterStats=Ql,_t.validateReporterStats=ln,_t.isModTool=Io,_t.validateModTool=un,_t.isScheduledActionView=Rr,_t.validateScheduledActionView=ca;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.moderation.defs",y="modEventView";function e($e){return a($e,f,y)}function l($e){return c($e,f,y)}const _="modEventViewDetail";function w($e){return a($e,f,_)}function R($e){return c($e,f,_)}const C="subjectStatusView";function I($e){return a($e,f,C)}function L($e){return c($e,f,C)}const O="subjectView";function q($e){return a($e,f,O)}function G($e){return c($e,f,O)}const j="accountStats";function ne($e){return a($e,f,j)}function he($e){return c($e,f,j)}const Q="recordsStats";function Be($e){return a($e,f,Q)}function we($e){return c($e,f,Q)}_t.REVIEWOPEN=`${f}#reviewOpen`,_t.REVIEWESCALATED=`${f}#reviewEscalated`,_t.REVIEWCLOSED=`${f}#reviewClosed`,_t.REVIEWNONE=`${f}#reviewNone`;const ze="modEventTakedown";function et($e){return a($e,f,ze)}function gt($e){return c($e,f,ze)}const st="modEventReverseTakedown";function nt($e){return a($e,f,st)}function rt($e){return c($e,f,st)}const ee="modEventResolveAppeal";function Le($e){return a($e,f,ee)}function de($e){return c($e,f,ee)}const me="modEventComment";function tt($e){return a($e,f,me)}function yt($e){return c($e,f,me)}const lt="modEventReport";function ge($e){return a($e,f,lt)}function Gt($e){return c($e,f,lt)}const Ut="modEventLabel";function Ce($e){return a($e,f,Ut)}function ar($e){return c($e,f,Ut)}const kt="modEventPriorityScore";function er($e){return a($e,f,kt)}function Ur($e){return c($e,f,kt)}const or="ageAssuranceEvent";function Sr($e){return a($e,f,or)}function Ar($e){return c($e,f,or)}const Nr="ageAssuranceOverrideEvent";function rr($e){return a($e,f,Nr)}function gr($e){return c($e,f,Nr)}const ir="revokeAccountCredentialsEvent";function qr($e){return a($e,f,ir)}function Vt($e){return c($e,f,ir)}const Pr="modEventAcknowledge";function St($e){return a($e,f,Pr)}function Qt($e){return c($e,f,Pr)}const nr="modEventEscalate";function Tr($e){return a($e,f,nr)}function $r($e){return c($e,f,nr)}const bt="modEventMute";function pi($e){return a($e,f,bt)}function Ii($e){return c($e,f,bt)}const Oe="modEventUnmute";function vt($e){return a($e,f,Oe)}function Nt($e){return c($e,f,Oe)}const ve="modEventMuteReporter";function W($e){return a($e,f,ve)}function J($e){return c($e,f,ve)}const se="modEventUnmuteReporter";function _e($e){return a($e,f,se)}function Re($e){return c($e,f,se)}const je="modEventEmail";function Ge($e){return a($e,f,je)}function Ne($e){return c($e,f,je)}const Ye="modEventDivert";function ht($e){return a($e,f,Ye)}function Ze($e){return c($e,f,Ye)}const Mt="modEventTag";function Ft($e){return a($e,f,Mt)}function Ke($e){return c($e,f,Mt)}const hr="accountEvent";function Cr($e){return a($e,f,hr)}function Ot($e){return c($e,f,hr)}const mr="identityEvent";function ai($e){return a($e,f,mr)}function li($e){return c($e,f,mr)}const Wr="recordEvent";function fi($e){return a($e,f,Wr)}function jr($e){return c($e,f,Wr)}const ei="scheduleTakedownEvent";function Lr($e){return a($e,f,ei)}function dt($e){return c($e,f,ei)}const Bi="cancelScheduledTakedownEvent";function Ci($e){return a($e,f,Bi)}function ki($e){return c($e,f,Bi)}const at="repoView";function At($e){return a($e,f,at)}function yr($e){return c($e,f,at)}const lr="repoViewDetail";function Ni($e){return a($e,f,lr)}function an($e){return c($e,f,lr)}const Hi="repoViewNotFound";function ur($e){return a($e,f,Hi)}function Zn($e){return c($e,f,Hi)}const Hn="recordView";function Bn($e){return a($e,f,Hn)}function ds($e){return c($e,f,Hn)}const Xi="recordViewDetail";function Mn($e){return a($e,f,Xi)}function ui($e){return c($e,f,Xi)}const Mi="recordViewNotFound";function Zr($e){return a($e,f,Mi)}function ps($e){return c($e,f,Mi)}const zn="moderation";function Zs($e){return a($e,f,zn)}function Te($e){return c($e,f,zn)}const U="moderationDetail";function te($e){return a($e,f,U)}function oe($e){return c($e,f,U)}const ke="blobView";function De($e){return a($e,f,ke)}function Et($e){return c($e,f,ke)}const ft="imageDetails";function $t($e){return a($e,f,ft)}function Wt($e){return c($e,f,ft)}const vr="videoDetails";function zi($e){return a($e,f,vr)}function Rn($e){return c($e,f,vr)}const Bt="accountHosting";function P($e){return a($e,f,Bt)}function B($e){return c($e,f,Bt)}const Ve="recordHosting";function ut($e){return a($e,f,Ve)}function _r($e){return c($e,f,Ve)}const Do="reporterStats";function Ql($e){return a($e,f,Do)}function ln($e){return c($e,f,Do)}const kr="modTool";function Io($e){return a($e,f,kr)}function un($e){return c($e,f,kr)}_t.TIMELINEEVENTPLCCREATE=`${f}#timelineEventPlcCreate`,_t.TIMELINEEVENTPLCOPERATION=`${f}#timelineEventPlcOperation`,_t.TIMELINEEVENTPLCTOMBSTONE=`${f}#timelineEventPlcTombstone`;const Hs="scheduledActionView";function Rr($e){return a($e,f,Hs)}function ca($e){return c($e,f,Hs)}return _t}var tb={},K2;function P6(){if(K2)return tb;K2=1,Object.defineProperty(tb,"__esModule",{value:!0}),tb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return tb}var rb={},G2;function L6(){if(G2)return rb;G2=1,Object.defineProperty(rb,"__esModule",{value:!0}),rb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return rb}var ib={},$2;function D6(){if($2)return ib;$2=1,Object.defineProperty(ib,"__esModule",{value:!0}),ib.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return ib}var nb={},Z2;function I6(){if(Z2)return nb;Z2=1,Object.defineProperty(nb,"__esModule",{value:!0}),nb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return nb}var sb={},H2;function B6(){if(H2)return sb;H2=1,Object.defineProperty(sb,"__esModule",{value:!0}),sb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return sb}var ob={},X2;function M6(){if(X2)return ob;X2=1,Object.defineProperty(ob,"__esModule",{value:!0}),ob.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return ob}var ab={},W2;function z6(){if(W2)return ab;W2=1,Object.defineProperty(ab,"__esModule",{value:!0}),ab.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return ab}var lb={},Y2;function O6(){if(Y2)return lb;Y2=1,Object.defineProperty(lb,"__esModule",{value:!0}),lb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return lb}var no={},J2;function V6(){if(J2)return no;J2=1,Object.defineProperty(no,"__esModule",{value:!0}),no.toKnownErr=y,no.isTakedown=l,no.validateTakedown=_,no.isSchedulingConfig=R,no.validateSchedulingConfig=C,no.isScheduledActionResults=L,no.validateScheduledActionResults=O,no.isFailedScheduling=G,no.validateFailedScheduling=j;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.moderation.scheduleAction";function y(ne){return ne}const e="takedown";function l(ne){return a(ne,f,e)}function _(ne){return c(ne,f,e)}const w="schedulingConfig";function R(ne){return a(ne,f,w)}function C(ne){return c(ne,f,w)}const I="scheduledActionResults";function L(ne){return a(ne,f,I)}function O(ne){return c(ne,f,I)}const q="failedScheduling";function G(ne){return a(ne,f,q)}function j(ne){return c(ne,f,q)}return no}var ub={},Q2;function U6(){if(Q2)return ub;Q2=1,Object.defineProperty(ub,"__esModule",{value:!0}),ub.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return ub}var zt={},eP;function j6(){if(eP)return zt;eP=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.REASONSELFHARMOTHER=zt.REASONSELFHARMSUBSTANCES=zt.REASONSELFHARMSTUNTS=zt.REASONSELFHARMED=zt.REASONSELFHARMCONTENT=zt.REASONRULEOTHER=zt.REASONRULEBANEVASION=zt.REASONRULEPROHIBITEDSALES=zt.REASONRULESITESECURITY=zt.REASONMISLEADINGOTHER=zt.REASONMISLEADINGELECTIONS=zt.REASONMISLEADINGSCAM=zt.REASONMISLEADINGSPAM=zt.REASONMISLEADINGIMPERSONATION=zt.REASONMISLEADINGBOT=zt.REASONHARASSMENTOTHER=zt.REASONHARASSMENTDOXXING=zt.REASONHARASSMENTHATESPEECH=zt.REASONHARASSMENTTARGETED=zt.REASONHARASSMENTTROLL=zt.REASONCHILDSAFETYOTHER=zt.REASONCHILDSAFETYHARASSMENT=zt.REASONCHILDSAFETYPRIVACY=zt.REASONCHILDSAFETYGROOM=zt.REASONCHILDSAFETYCSAM=zt.REASONSEXUALOTHER=zt.REASONSEXUALUNLABELED=zt.REASONSEXUALANIMAL=zt.REASONSEXUALDEEPFAKE=zt.REASONSEXUALNCII=zt.REASONSEXUALABUSECONTENT=zt.REASONVIOLENCEOTHER=zt.REASONVIOLENCETRAFFICKING=zt.REASONVIOLENCEEXTREMISTCONTENT=zt.REASONVIOLENCEGLORIFICATION=zt.REASONVIOLENCEGRAPHICCONTENT=zt.REASONVIOLENCETHREATS=zt.REASONVIOLENCEANIMAL=zt.REASONOTHER=zt.REASONAPPEAL=void 0;const i=pe();fe().is$typed,i.validate;const a="tools.ozone.report.defs";return zt.REASONAPPEAL=`${a}#reasonAppeal`,zt.REASONOTHER=`${a}#reasonOther`,zt.REASONVIOLENCEANIMAL=`${a}#reasonViolenceAnimal`,zt.REASONVIOLENCETHREATS=`${a}#reasonViolenceThreats`,zt.REASONVIOLENCEGRAPHICCONTENT=`${a}#reasonViolenceGraphicContent`,zt.REASONVIOLENCEGLORIFICATION=`${a}#reasonViolenceGlorification`,zt.REASONVIOLENCEEXTREMISTCONTENT=`${a}#reasonViolenceExtremistContent`,zt.REASONVIOLENCETRAFFICKING=`${a}#reasonViolenceTrafficking`,zt.REASONVIOLENCEOTHER=`${a}#reasonViolenceOther`,zt.REASONSEXUALABUSECONTENT=`${a}#reasonSexualAbuseContent`,zt.REASONSEXUALNCII=`${a}#reasonSexualNCII`,zt.REASONSEXUALDEEPFAKE=`${a}#reasonSexualDeepfake`,zt.REASONSEXUALANIMAL=`${a}#reasonSexualAnimal`,zt.REASONSEXUALUNLABELED=`${a}#reasonSexualUnlabeled`,zt.REASONSEXUALOTHER=`${a}#reasonSexualOther`,zt.REASONCHILDSAFETYCSAM=`${a}#reasonChildSafetyCSAM`,zt.REASONCHILDSAFETYGROOM=`${a}#reasonChildSafetyGroom`,zt.REASONCHILDSAFETYPRIVACY=`${a}#reasonChildSafetyPrivacy`,zt.REASONCHILDSAFETYHARASSMENT=`${a}#reasonChildSafetyHarassment`,zt.REASONCHILDSAFETYOTHER=`${a}#reasonChildSafetyOther`,zt.REASONHARASSMENTTROLL=`${a}#reasonHarassmentTroll`,zt.REASONHARASSMENTTARGETED=`${a}#reasonHarassmentTargeted`,zt.REASONHARASSMENTHATESPEECH=`${a}#reasonHarassmentHateSpeech`,zt.REASONHARASSMENTDOXXING=`${a}#reasonHarassmentDoxxing`,zt.REASONHARASSMENTOTHER=`${a}#reasonHarassmentOther`,zt.REASONMISLEADINGBOT=`${a}#reasonMisleadingBot`,zt.REASONMISLEADINGIMPERSONATION=`${a}#reasonMisleadingImpersonation`,zt.REASONMISLEADINGSPAM=`${a}#reasonMisleadingSpam`,zt.REASONMISLEADINGSCAM=`${a}#reasonMisleadingScam`,zt.REASONMISLEADINGELECTIONS=`${a}#reasonMisleadingElections`,zt.REASONMISLEADINGOTHER=`${a}#reasonMisleadingOther`,zt.REASONRULESITESECURITY=`${a}#reasonRuleSiteSecurity`,zt.REASONRULEPROHIBITEDSALES=`${a}#reasonRuleProhibitedSales`,zt.REASONRULEBANEVASION=`${a}#reasonRuleBanEvasion`,zt.REASONRULEOTHER=`${a}#reasonRuleOther`,zt.REASONSELFHARMCONTENT=`${a}#reasonSelfHarmContent`,zt.REASONSELFHARMED=`${a}#reasonSelfHarmED`,zt.REASONSELFHARMSTUNTS=`${a}#reasonSelfHarmStunts`,zt.REASONSELFHARMSUBSTANCES=`${a}#reasonSelfHarmSubstances`,zt.REASONSELFHARMOTHER=`${a}#reasonSelfHarmOther`,zt}var Yu={},tP;function N6(){if(tP)return Yu;tP=1,Object.defineProperty(Yu,"__esModule",{value:!0}),Yu.isEvent=e,Yu.validateEvent=l,Yu.isUrlRule=w,Yu.validateUrlRule=R;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.safelink.defs",y="event";function e(C){return a(C,f,y)}function l(C){return c(C,f,y)}const _="urlRule";function w(C){return a(C,f,_)}function R(C){return c(C,f,_)}return Yu}var cb={},rP;function F6(){if(rP)return cb;rP=1,Object.defineProperty(cb,"__esModule",{value:!0}),cb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return cb}var db={},iP;function q6(){if(iP)return db;iP=1,Object.defineProperty(db,"__esModule",{value:!0}),db.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return db}var Ol={},nP;function K6(){if(nP)return Ol;nP=1,Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.toKnownErr=y,Ol.isServiceConfig=l,Ol.validateServiceConfig=_,Ol.isViewerConfig=R,Ol.validateViewerConfig=C;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.server.getConfig";function y(I){return I}const e="serviceConfig";function l(I){return a(I,f,e)}function _(I){return c(I,f,e)}const w="viewerConfig";function R(I){return a(I,f,w)}function C(I){return c(I,f,w)}return Ol}var pb={},sP;function G6(){if(sP)return pb;sP=1,Object.defineProperty(pb,"__esModule",{value:!0}),pb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return pb}var Ju={},oP;function $6(){if(oP)return Ju;oP=1,Object.defineProperty(Ju,"__esModule",{value:!0}),Ju.isSet=e,Ju.validateSet=l,Ju.isSetView=w,Ju.validateSetView=R;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.set.defs",y="set";function e(C){return a(C,f,y)}function l(C){return c(C,f,y)}const _="setView";function w(C){return a(C,f,_)}function R(C){return c(C,f,_)}return Ju}var fb={},aP;function Z6(){if(aP)return fb;aP=1,Object.defineProperty(fb,"__esModule",{value:!0}),fb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return fb}var hb={},lP;function H6(){if(lP)return hb;lP=1,Object.defineProperty(hb,"__esModule",{value:!0}),hb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return hb}var zh={},uP;function X6(){if(uP)return zh;uP=1,Object.defineProperty(zh,"__esModule",{value:!0}),zh.isOption=e,zh.validateOption=l;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.setting.defs",y="option";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return zh}var mb={},cP;function W6(){if(cP)return mb;cP=1,Object.defineProperty(mb,"__esModule",{value:!0}),mb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return mb}var yb={},dP;function Y6(){if(dP)return yb;dP=1,Object.defineProperty(yb,"__esModule",{value:!0}),yb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return yb}var gb={},pP;function J6(){if(pP)return gb;pP=1,Object.defineProperty(gb,"__esModule",{value:!0}),gb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return gb}var Oh={},fP;function Q6(){if(fP)return Oh;fP=1,Object.defineProperty(Oh,"__esModule",{value:!0}),Oh.isSigDetail=e,Oh.validateSigDetail=l;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.signature.defs",y="sigDetail";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return Oh}var _b={},hP;function eK(){if(hP)return _b;hP=1,Object.defineProperty(_b,"__esModule",{value:!0}),_b.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return _b}var Pp={},mP;function tK(){if(mP)return Pp;mP=1,Object.defineProperty(Pp,"__esModule",{value:!0}),Pp.toKnownErr=y,Pp.isRelatedAccount=l,Pp.validateRelatedAccount=_;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.signature.findRelatedAccounts";function y(w){return w}const e="relatedAccount";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return Pp}var bb={},yP;function rK(){if(yP)return bb;yP=1,Object.defineProperty(bb,"__esModule",{value:!0}),bb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return bb}var Ns={},gP;function iK(){if(gP)return Ns;gP=1,Object.defineProperty(Ns,"__esModule",{value:!0}),Ns.ROLEVERIFIER=Ns.ROLETRIAGE=Ns.ROLEMODERATOR=Ns.ROLEADMIN=void 0,Ns.isMember=e,Ns.validateMember=l;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.team.defs",y="member";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return Ns.ROLEADMIN=`${f}#roleAdmin`,Ns.ROLEMODERATOR=`${f}#roleModerator`,Ns.ROLETRIAGE=`${f}#roleTriage`,Ns.ROLEVERIFIER=`${f}#roleVerifier`,Ns}var vb={},_P;function nK(){if(_P)return vb;_P=1,Object.defineProperty(vb,"__esModule",{value:!0}),vb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return vb}var Vh={},bP;function sK(){if(bP)return Vh;bP=1,Object.defineProperty(Vh,"__esModule",{value:!0}),Vh.isVerificationView=e,Vh.validateVerificationView=l;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.verification.defs",y="verificationView";function e(_){return a(_,f,y)}function l(_){return c(_,f,y)}return Vh}var Vl={},vP;function oK(){if(vP)return Vl;vP=1,Object.defineProperty(Vl,"__esModule",{value:!0}),Vl.toKnownErr=y,Vl.isVerificationInput=l,Vl.validateVerificationInput=_,Vl.isGrantError=R,Vl.validateGrantError=C;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.verification.grantVerifications";function y(I){return I}const e="verificationInput";function l(I){return a(I,f,e)}function _(I){return c(I,f,e)}const w="grantError";function R(I){return a(I,f,w)}function C(I){return c(I,f,w)}return Vl}var xb={},xP;function aK(){if(xP)return xb;xP=1,Object.defineProperty(xb,"__esModule",{value:!0}),xb.toKnownErr=a;const i=pe();fe().is$typed,i.validate;function a(c){return c}return xb}var Lp={},wP;function lK(){if(wP)return Lp;wP=1,Object.defineProperty(Lp,"__esModule",{value:!0}),Lp.toKnownErr=y,Lp.isRevokeError=l,Lp.validateRevokeError=_;const i=pe(),a=fe().is$typed,c=i.validate,f="tools.ozone.verification.revokeVerifications";function y(w){return w}const e="revokeError";function l(w){return a(w,f,e)}function _(w){return c(w,f,e)}return Lp}var EP;function Yl(){if(EP)return z;EP=1;var i=z&&z.__createBinding||(Object.create?(function(Bt,P,B,Ve){Ve===void 0&&(Ve=B);var ut=Object.getOwnPropertyDescriptor(P,B);(!ut||("get"in ut?!P.__esModule:ut.writable||ut.configurable))&&(ut={enumerable:!0,get:function(){return P[B]}}),Object.defineProperty(Bt,Ve,ut)}):(function(Bt,P,B,Ve){Ve===void 0&&(Ve=B),Bt[Ve]=P[B]})),n=z&&z.__setModuleDefault||(Object.create?(function(Bt,P){Object.defineProperty(Bt,"default",{enumerable:!0,value:P})}):function(Bt,P){Bt.default=P}),a=z&&z.__importStar||(function(){var Bt=function(P){return Bt=Object.getOwnPropertyNames||function(B){var Ve=[];for(var ut in B)Object.prototype.hasOwnProperty.call(B,ut)&&(Ve[Ve.length]=ut);return Ve},Bt(P)};return function(P){if(P&&P.__esModule)return P;var B={};if(P!=null)for(var Ve=Bt(P),ut=0;ut<Ve.length;ut++)Ve[ut]!=="default"&&i(B,P,Ve[ut]);return n(B,P),B}})();Object.defineProperty(z,"__esModule",{value:!0}),z.AppBskyGraphGetBlocks=z.AppBskyGraphGetActorStarterPacks=z.AppBskyGraphFollow=z.AppBskyGraphDefs=z.AppBskyGraphBlock=z.AppBskyFeedThreadgate=z.AppBskyFeedSendInteractions=z.AppBskyFeedSearchPosts=z.AppBskyFeedRepost=z.AppBskyFeedPostgate=z.AppBskyFeedPost=z.AppBskyFeedLike=z.AppBskyFeedGetTimeline=z.AppBskyFeedGetSuggestedFeeds=z.AppBskyFeedGetRepostedBy=z.AppBskyFeedGetQuotes=z.AppBskyFeedGetPosts=z.AppBskyFeedGetPostThread=z.AppBskyFeedGetListFeed=z.AppBskyFeedGetLikes=z.AppBskyFeedGetFeedSkeleton=z.AppBskyFeedGetFeedGenerators=z.AppBskyFeedGetFeedGenerator=z.AppBskyFeedGetFeed=z.AppBskyFeedGetAuthorFeed=z.AppBskyFeedGetActorLikes=z.AppBskyFeedGetActorFeeds=z.AppBskyFeedGenerator=z.AppBskyFeedDescribeFeedGenerator=z.AppBskyFeedDefs=z.AppBskyEmbedVideo=z.AppBskyEmbedRecordWithMedia=z.AppBskyEmbedRecord=z.AppBskyEmbedImages=z.AppBskyEmbedExternal=z.AppBskyEmbedDefs=z.AppBskyBookmarkGetBookmarks=z.AppBskyBookmarkDeleteBookmark=z.AppBskyBookmarkDefs=z.AppBskyBookmarkCreateBookmark=z.AppBskyActorStatus=z.AppBskyActorSearchActorsTypeahead=z.AppBskyActorSearchActors=z.AppBskyActorPutPreferences=z.AppBskyActorProfile=z.AppBskyActorGetSuggestions=z.AppBskyActorGetProfiles=z.AppBskyActorGetProfile=z.AppBskyActorGetPreferences=z.AppBskyActorDefs=void 0,z.AppBskyUnspeccedGetPostThreadV2=z.AppBskyUnspeccedGetPostThreadOtherV2=z.AppBskyUnspeccedGetPopularFeedGenerators=z.AppBskyUnspeccedGetOnboardingSuggestedStarterPacksSkeleton=z.AppBskyUnspeccedGetOnboardingSuggestedStarterPacks=z.AppBskyUnspeccedGetConfig=z.AppBskyUnspeccedGetAgeAssuranceState=z.AppBskyUnspeccedDefs=z.AppBskyRichtextFacet=z.AppBskyNotificationUpdateSeen=z.AppBskyNotificationUnregisterPush=z.AppBskyNotificationRegisterPush=z.AppBskyNotificationPutPreferencesV2=z.AppBskyNotificationPutPreferences=z.AppBskyNotificationPutActivitySubscription=z.AppBskyNotificationListNotifications=z.AppBskyNotificationListActivitySubscriptions=z.AppBskyNotificationGetUnreadCount=z.AppBskyNotificationGetPreferences=z.AppBskyNotificationDefs=z.AppBskyNotificationDeclaration=z.AppBskyLabelerService=z.AppBskyLabelerGetServices=z.AppBskyLabelerDefs=z.AppBskyGraphVerification=z.AppBskyGraphUnmuteThread=z.AppBskyGraphUnmuteActorList=z.AppBskyGraphUnmuteActor=z.AppBskyGraphStarterpack=z.AppBskyGraphSearchStarterPacks=z.AppBskyGraphMuteThread=z.AppBskyGraphMuteActorList=z.AppBskyGraphMuteActor=z.AppBskyGraphListitem=z.AppBskyGraphListblock=z.AppBskyGraphList=z.AppBskyGraphGetSuggestedFollowsByActor=z.AppBskyGraphGetStarterPacksWithMembership=z.AppBskyGraphGetStarterPacks=z.AppBskyGraphGetStarterPack=z.AppBskyGraphGetRelationships=z.AppBskyGraphGetMutes=z.AppBskyGraphGetListsWithMembership=z.AppBskyGraphGetLists=z.AppBskyGraphGetListMutes=z.AppBskyGraphGetListBlocks=z.AppBskyGraphGetList=z.AppBskyGraphGetKnownFollowers=z.AppBskyGraphGetFollows=z.AppBskyGraphGetFollowers=void 0,z.ComAtprotoAdminGetAccountInfo=z.ComAtprotoAdminEnableAccountInvites=z.ComAtprotoAdminDisableInviteCodes=z.ComAtprotoAdminDisableAccountInvites=z.ComAtprotoAdminDeleteAccount=z.ComAtprotoAdminDefs=z.ChatBskyModerationUpdateActorAccess=z.ChatBskyModerationGetMessageContext=z.ChatBskyModerationGetActorMetadata=z.ChatBskyConvoUpdateRead=z.ChatBskyConvoUpdateAllRead=z.ChatBskyConvoUnmuteConvo=z.ChatBskyConvoSendMessageBatch=z.ChatBskyConvoSendMessage=z.ChatBskyConvoRemoveReaction=z.ChatBskyConvoMuteConvo=z.ChatBskyConvoListConvos=z.ChatBskyConvoLeaveConvo=z.ChatBskyConvoGetMessages=z.ChatBskyConvoGetLog=z.ChatBskyConvoGetConvoForMembers=z.ChatBskyConvoGetConvoAvailability=z.ChatBskyConvoGetConvo=z.ChatBskyConvoDeleteMessageForSelf=z.ChatBskyConvoDefs=z.ChatBskyConvoAddReaction=z.ChatBskyConvoAcceptConvo=z.ChatBskyActorExportAccountData=z.ChatBskyActorDeleteAccount=z.ChatBskyActorDefs=z.ChatBskyActorDeclaration=z.AppBskyVideoUploadVideo=z.AppBskyVideoGetUploadLimits=z.AppBskyVideoGetJobStatus=z.AppBskyVideoDefs=z.AppBskyUnspeccedSearchStarterPacksSkeleton=z.AppBskyUnspeccedSearchPostsSkeleton=z.AppBskyUnspeccedSearchActorsSkeleton=z.AppBskyUnspeccedInitAgeAssurance=z.AppBskyUnspeccedGetTrendsSkeleton=z.AppBskyUnspeccedGetTrends=z.AppBskyUnspeccedGetTrendingTopics=z.AppBskyUnspeccedGetTaggedSuggestions=z.AppBskyUnspeccedGetSuggestionsSkeleton=z.AppBskyUnspeccedGetSuggestedUsersSkeleton=z.AppBskyUnspeccedGetSuggestedUsers=z.AppBskyUnspeccedGetSuggestedStarterPacksSkeleton=z.AppBskyUnspeccedGetSuggestedStarterPacks=z.AppBskyUnspeccedGetSuggestedFeedsSkeleton=z.AppBskyUnspeccedGetSuggestedFeeds=void 0,z.ComAtprotoServerDeleteSession=z.ComAtprotoServerDeleteAccount=z.ComAtprotoServerDefs=z.ComAtprotoServerDeactivateAccount=z.ComAtprotoServerCreateSession=z.ComAtprotoServerCreateInviteCodes=z.ComAtprotoServerCreateInviteCode=z.ComAtprotoServerCreateAppPassword=z.ComAtprotoServerCreateAccount=z.ComAtprotoServerConfirmEmail=z.ComAtprotoServerCheckAccountStatus=z.ComAtprotoServerActivateAccount=z.ComAtprotoRepoUploadBlob=z.ComAtprotoRepoStrongRef=z.ComAtprotoRepoPutRecord=z.ComAtprotoRepoListRecords=z.ComAtprotoRepoListMissingBlobs=z.ComAtprotoRepoImportRepo=z.ComAtprotoRepoGetRecord=z.ComAtprotoRepoDescribeRepo=z.ComAtprotoRepoDeleteRecord=z.ComAtprotoRepoDefs=z.ComAtprotoRepoCreateRecord=z.ComAtprotoRepoApplyWrites=z.ComAtprotoModerationDefs=z.ComAtprotoModerationCreateReport=z.ComAtprotoLexiconSchema=z.ComAtprotoLabelSubscribeLabels=z.ComAtprotoLabelQueryLabels=z.ComAtprotoLabelDefs=z.ComAtprotoIdentityUpdateHandle=z.ComAtprotoIdentitySubmitPlcOperation=z.ComAtprotoIdentitySignPlcOperation=z.ComAtprotoIdentityResolveIdentity=z.ComAtprotoIdentityResolveHandle=z.ComAtprotoIdentityResolveDid=z.ComAtprotoIdentityRequestPlcOperationSignature=z.ComAtprotoIdentityRefreshIdentity=z.ComAtprotoIdentityGetRecommendedDidCredentials=z.ComAtprotoIdentityDefs=z.ComAtprotoAdminUpdateSubjectStatus=z.ComAtprotoAdminUpdateAccountSigningKey=z.ComAtprotoAdminUpdateAccountPassword=z.ComAtprotoAdminUpdateAccountHandle=z.ComAtprotoAdminUpdateAccountEmail=z.ComAtprotoAdminSendEmail=z.ComAtprotoAdminSearchAccounts=z.ComAtprotoAdminGetSubjectStatus=z.ComAtprotoAdminGetInviteCodes=z.ComAtprotoAdminGetAccountInfos=void 0,z.ToolsOzoneModerationGetRecord=z.ToolsOzoneModerationGetEvent=z.ToolsOzoneModerationGetAccountTimeline=z.ToolsOzoneModerationEmitEvent=z.ToolsOzoneModerationDefs=z.ToolsOzoneModerationCancelScheduledActions=z.ToolsOzoneHostingGetAccountHistory=z.ToolsOzoneCommunicationUpdateTemplate=z.ToolsOzoneCommunicationListTemplates=z.ToolsOzoneCommunicationDeleteTemplate=z.ToolsOzoneCommunicationDefs=z.ToolsOzoneCommunicationCreateTemplate=z.ComAtprotoTempRevokeAccountCredentials=z.ComAtprotoTempRequestPhoneVerification=z.ComAtprotoTempFetchLabels=z.ComAtprotoTempDereferenceScope=z.ComAtprotoTempCheckSignupQueue=z.ComAtprotoTempCheckHandleAvailability=z.ComAtprotoTempAddReservedHandle=z.ComAtprotoSyncSubscribeRepos=z.ComAtprotoSyncRequestCrawl=z.ComAtprotoSyncNotifyOfUpdate=z.ComAtprotoSyncListReposByCollection=z.ComAtprotoSyncListRepos=z.ComAtprotoSyncListHosts=z.ComAtprotoSyncListBlobs=z.ComAtprotoSyncGetRepoStatus=z.ComAtprotoSyncGetRepo=z.ComAtprotoSyncGetRecord=z.ComAtprotoSyncGetLatestCommit=z.ComAtprotoSyncGetHostStatus=z.ComAtprotoSyncGetHead=z.ComAtprotoSyncGetCheckout=z.ComAtprotoSyncGetBlocks=z.ComAtprotoSyncGetBlob=z.ComAtprotoSyncDefs=z.ComAtprotoServerUpdateEmail=z.ComAtprotoServerRevokeAppPassword=z.ComAtprotoServerResetPassword=z.ComAtprotoServerReserveSigningKey=z.ComAtprotoServerRequestPasswordReset=z.ComAtprotoServerRequestEmailUpdate=z.ComAtprotoServerRequestEmailConfirmation=z.ComAtprotoServerRequestAccountDelete=z.ComAtprotoServerRefreshSession=z.ComAtprotoServerListAppPasswords=z.ComAtprotoServerGetSession=z.ComAtprotoServerGetServiceAuth=z.ComAtprotoServerGetAccountInviteCodes=z.ComAtprotoServerDescribeServer=void 0,z.AtpBaseClient=z.TOOLS_OZONE_TEAM=z.TOOLS_OZONE_REPORT=z.TOOLS_OZONE_MODERATION=z.COM_ATPROTO_MODERATION=z.APP_BSKY_GRAPH=z.APP_BSKY_FEED=z.APP_BSKY_ACTOR=z.ToolsOzoneVerificationRevokeVerifications=z.ToolsOzoneVerificationListVerifications=z.ToolsOzoneVerificationGrantVerifications=z.ToolsOzoneVerificationDefs=z.ToolsOzoneTeamUpdateMember=z.ToolsOzoneTeamListMembers=z.ToolsOzoneTeamDeleteMember=z.ToolsOzoneTeamDefs=z.ToolsOzoneTeamAddMember=z.ToolsOzoneSignatureSearchAccounts=z.ToolsOzoneSignatureFindRelatedAccounts=z.ToolsOzoneSignatureFindCorrelation=z.ToolsOzoneSignatureDefs=z.ToolsOzoneSettingUpsertOption=z.ToolsOzoneSettingRemoveOptions=z.ToolsOzoneSettingListOptions=z.ToolsOzoneSettingDefs=z.ToolsOzoneSetUpsertSet=z.ToolsOzoneSetQuerySets=z.ToolsOzoneSetGetValues=z.ToolsOzoneSetDeleteValues=z.ToolsOzoneSetDeleteSet=z.ToolsOzoneSetDefs=z.ToolsOzoneSetAddValues=z.ToolsOzoneServerGetConfig=z.ToolsOzoneSafelinkUpdateRule=z.ToolsOzoneSafelinkRemoveRule=z.ToolsOzoneSafelinkQueryRules=z.ToolsOzoneSafelinkQueryEvents=z.ToolsOzoneSafelinkDefs=z.ToolsOzoneSafelinkAddRule=z.ToolsOzoneReportDefs=z.ToolsOzoneModerationSearchRepos=z.ToolsOzoneModerationScheduleAction=z.ToolsOzoneModerationQueryStatuses=z.ToolsOzoneModerationQueryEvents=z.ToolsOzoneModerationListScheduledActions=z.ToolsOzoneModerationGetSubjects=z.ToolsOzoneModerationGetRepos=z.ToolsOzoneModerationGetReporterStats=z.ToolsOzoneModerationGetRepo=z.ToolsOzoneModerationGetRecords=void 0,z.ToolsOzoneCommunicationNS=z.ToolsOzoneNS=z.ToolsNS=z.ComAtprotoTempNS=z.ComAtprotoSyncNS=z.ComAtprotoServerNS=z.ComAtprotoRepoNS=z.ComAtprotoModerationNS=z.ComAtprotoLexiconSchemaRecord=z.ComAtprotoLexiconNS=z.ComAtprotoLabelNS=z.ComAtprotoIdentityNS=z.ComAtprotoAdminNS=z.ComAtprotoNS=z.ComNS=z.ChatBskyModerationNS=z.ChatBskyConvoNS=z.ChatBskyActorDeclarationRecord=z.ChatBskyActorNS=z.ChatBskyNS=z.ChatNS=z.AppBskyVideoNS=z.AppBskyUnspeccedNS=z.AppBskyRichtextNS=z.AppBskyNotificationDeclarationRecord=z.AppBskyNotificationNS=z.AppBskyLabelerServiceRecord=z.AppBskyLabelerNS=z.AppBskyGraphVerificationRecord=z.AppBskyGraphStarterpackRecord=z.AppBskyGraphListitemRecord=z.AppBskyGraphListblockRecord=z.AppBskyGraphListRecord=z.AppBskyGraphFollowRecord=z.AppBskyGraphBlockRecord=z.AppBskyGraphNS=z.AppBskyFeedThreadgateRecord=z.AppBskyFeedRepostRecord=z.AppBskyFeedPostgateRecord=z.AppBskyFeedPostRecord=z.AppBskyFeedLikeRecord=z.AppBskyFeedGeneratorRecord=z.AppBskyFeedNS=z.AppBskyEmbedNS=z.AppBskyBookmarkNS=z.AppBskyActorStatusRecord=z.AppBskyActorProfileRecord=z.AppBskyActorNS=z.AppBskyNS=z.AppNS=void 0,z.ToolsOzoneVerificationNS=z.ToolsOzoneTeamNS=z.ToolsOzoneSignatureNS=z.ToolsOzoneSettingNS=z.ToolsOzoneSetNS=z.ToolsOzoneServerNS=z.ToolsOzoneSafelinkNS=z.ToolsOzoneModerationNS=z.ToolsOzoneHostingNS=void 0;const c=Xt(),f=pe(),y=a(ZA()),e=a(XA()),l=a(YA()),_=a(QA()),w=a(tR()),R=a(iR()),C=a(sR()),I=a(aR()),L=a(uR()),O=a(dR()),q=a(fR()),G=a(mR()),j=a(gR()),ne=a(bR()),he=a(xR()),Q=a(ER()),Be=a(RR()),we=a(TR()),ze=a(kR()),et=a(LR()),gt=a(IR()),st=a(MR()),nt=a(OR()),rt=a(UR()),ee=a(NR()),Le=a(qR()),de=a(GR()),me=a(ZR()),tt=a(XR()),yt=a(YR()),lt=a(QR()),ge=a(tS()),Gt=a(iS()),Ut=a(sS()),Ce=a(aS()),ar=a(uS()),kt=a(dS()),er=a(fS()),Ur=a(mS()),or=a(gS()),Sr=a(bS()),Ar=a(xS()),Nr=a(ES()),rr=a(RS()),gr=a(TS()),ir=a(kS()),qr=a(LS()),Vt=a(IS()),Pr=a(MS()),St=a(OS()),Qt=a(US()),nr=a(NS()),Tr=a(qS()),$r=a(GS()),bt=a(ZS()),pi=a(XS()),Ii=a(YS()),Oe=a(QS()),vt=a(tT()),Nt=a(iT()),ve=a(sT()),W=a(aT()),J=a(uT());z.AppBskyActorDefs=a(W5()),z.AppBskyActorGetPreferences=a(Y5()),z.AppBskyActorGetProfile=a(J5()),z.AppBskyActorGetProfiles=a(Q5()),z.AppBskyActorGetSuggestions=a(e4()),z.AppBskyActorProfile=a(t4()),z.AppBskyActorPutPreferences=a(r4()),z.AppBskyActorSearchActors=a(i4()),z.AppBskyActorSearchActorsTypeahead=a(n4()),z.AppBskyActorStatus=a(s4()),z.AppBskyBookmarkCreateBookmark=a(ZA()),z.AppBskyBookmarkDefs=a(o4()),z.AppBskyBookmarkDeleteBookmark=a(XA()),z.AppBskyBookmarkGetBookmarks=a(a4()),z.AppBskyEmbedDefs=a(l4()),z.AppBskyEmbedExternal=a(u4()),z.AppBskyEmbedImages=a(c4()),z.AppBskyEmbedRecord=a(d4()),z.AppBskyEmbedRecordWithMedia=a(p4()),z.AppBskyEmbedVideo=a(f4()),z.AppBskyFeedDefs=a(h4()),z.AppBskyFeedDescribeFeedGenerator=a(m4()),z.AppBskyFeedGenerator=a(y4()),z.AppBskyFeedGetActorFeeds=a(g4()),z.AppBskyFeedGetActorLikes=a(YA()),z.AppBskyFeedGetAuthorFeed=a(QA()),z.AppBskyFeedGetFeed=a(tR()),z.AppBskyFeedGetFeedGenerator=a(_4()),z.AppBskyFeedGetFeedGenerators=a(b4()),z.AppBskyFeedGetFeedSkeleton=a(iR()),z.AppBskyFeedGetLikes=a(v4()),z.AppBskyFeedGetListFeed=a(sR()),z.AppBskyFeedGetPostThread=a(aR()),z.AppBskyFeedGetPosts=a(x4()),z.AppBskyFeedGetQuotes=a(w4()),z.AppBskyFeedGetRepostedBy=a(E4()),z.AppBskyFeedGetSuggestedFeeds=a(A4()),z.AppBskyFeedGetTimeline=a(R4()),z.AppBskyFeedLike=a(S4()),z.AppBskyFeedPost=a(T4()),z.AppBskyFeedPostgate=a(C4()),z.AppBskyFeedRepost=a(k4()),z.AppBskyFeedSearchPosts=a(uR()),z.AppBskyFeedSendInteractions=a(P4()),z.AppBskyFeedThreadgate=a(L4()),z.AppBskyGraphBlock=a(D4()),z.AppBskyGraphDefs=a(I4()),z.AppBskyGraphFollow=a(B4()),z.AppBskyGraphGetActorStarterPacks=a(M4()),z.AppBskyGraphGetBlocks=a(z4()),z.AppBskyGraphGetFollowers=a(O4()),z.AppBskyGraphGetFollows=a(V4()),z.AppBskyGraphGetKnownFollowers=a(U4()),z.AppBskyGraphGetList=a(j4()),z.AppBskyGraphGetListBlocks=a(N4()),z.AppBskyGraphGetListMutes=a(F4()),z.AppBskyGraphGetLists=a(q4()),z.AppBskyGraphGetListsWithMembership=a(K4()),z.AppBskyGraphGetMutes=a(G4()),z.AppBskyGraphGetRelationships=a(dR()),z.AppBskyGraphGetStarterPack=a($4()),z.AppBskyGraphGetStarterPacks=a(Z4()),z.AppBskyGraphGetStarterPacksWithMembership=a(H4()),z.AppBskyGraphGetSuggestedFollowsByActor=a(X4()),z.AppBskyGraphList=a(W4()),z.AppBskyGraphListblock=a(Y4()),z.AppBskyGraphListitem=a(J4()),z.AppBskyGraphMuteActor=a(Q4()),z.AppBskyGraphMuteActorList=a(eF()),z.AppBskyGraphMuteThread=a(tF()),z.AppBskyGraphSearchStarterPacks=a(rF()),z.AppBskyGraphStarterpack=a(iF()),z.AppBskyGraphUnmuteActor=a(nF()),z.AppBskyGraphUnmuteActorList=a(sF()),z.AppBskyGraphUnmuteThread=a(oF()),z.AppBskyGraphVerification=a(aF()),z.AppBskyLabelerDefs=a(lF()),z.AppBskyLabelerGetServices=a(uF()),z.AppBskyLabelerService=a(cF()),z.AppBskyNotificationDeclaration=a(dF()),z.AppBskyNotificationDefs=a(pF()),z.AppBskyNotificationGetPreferences=a(fF()),z.AppBskyNotificationGetUnreadCount=a(hF()),z.AppBskyNotificationListActivitySubscriptions=a(mF()),z.AppBskyNotificationListNotifications=a(yF()),z.AppBskyNotificationPutActivitySubscription=a(gF()),z.AppBskyNotificationPutPreferences=a(_F()),z.AppBskyNotificationPutPreferencesV2=a(bF()),z.AppBskyNotificationRegisterPush=a(vF()),z.AppBskyNotificationUnregisterPush=a(xF()),z.AppBskyNotificationUpdateSeen=a(wF()),z.AppBskyRichtextFacet=a(EF()),z.AppBskyUnspeccedDefs=a(AF()),z.AppBskyUnspeccedGetAgeAssuranceState=a(RF()),z.AppBskyUnspeccedGetConfig=a(SF()),z.AppBskyUnspeccedGetOnboardingSuggestedStarterPacks=a(TF()),z.AppBskyUnspeccedGetOnboardingSuggestedStarterPacksSkeleton=a(CF()),z.AppBskyUnspeccedGetPopularFeedGenerators=a(kF()),z.AppBskyUnspeccedGetPostThreadOtherV2=a(PF()),z.AppBskyUnspeccedGetPostThreadV2=a(LF()),z.AppBskyUnspeccedGetSuggestedFeeds=a(DF()),z.AppBskyUnspeccedGetSuggestedFeedsSkeleton=a(IF()),z.AppBskyUnspeccedGetSuggestedStarterPacks=a(BF()),z.AppBskyUnspeccedGetSuggestedStarterPacksSkeleton=a(MF()),z.AppBskyUnspeccedGetSuggestedUsers=a(zF()),z.AppBskyUnspeccedGetSuggestedUsersSkeleton=a(OF()),z.AppBskyUnspeccedGetSuggestionsSkeleton=a(VF()),z.AppBskyUnspeccedGetTaggedSuggestions=a(UF()),z.AppBskyUnspeccedGetTrendingTopics=a(jF()),z.AppBskyUnspeccedGetTrends=a(NF()),z.AppBskyUnspeccedGetTrendsSkeleton=a(FF()),z.AppBskyUnspeccedInitAgeAssurance=a(fR()),z.AppBskyUnspeccedSearchActorsSkeleton=a(mR()),z.AppBskyUnspeccedSearchPostsSkeleton=a(gR()),z.AppBskyUnspeccedSearchStarterPacksSkeleton=a(bR()),z.AppBskyVideoDefs=a(qF()),z.AppBskyVideoGetJobStatus=a(KF()),z.AppBskyVideoGetUploadLimits=a(GF()),z.AppBskyVideoUploadVideo=a($F()),z.ChatBskyActorDeclaration=a(ZF()),z.ChatBskyActorDefs=a(HF()),z.ChatBskyActorDeleteAccount=a(XF()),z.ChatBskyActorExportAccountData=a(WF()),z.ChatBskyConvoAcceptConvo=a(YF()),z.ChatBskyConvoAddReaction=a(xR()),z.ChatBskyConvoDefs=a(JF()),z.ChatBskyConvoDeleteMessageForSelf=a(QF()),z.ChatBskyConvoGetConvo=a(eq()),z.ChatBskyConvoGetConvoAvailability=a(tq()),z.ChatBskyConvoGetConvoForMembers=a(rq()),z.ChatBskyConvoGetLog=a(iq()),z.ChatBskyConvoGetMessages=a(nq()),z.ChatBskyConvoLeaveConvo=a(sq()),z.ChatBskyConvoListConvos=a(oq()),z.ChatBskyConvoMuteConvo=a(aq()),z.ChatBskyConvoRemoveReaction=a(ER()),z.ChatBskyConvoSendMessage=a(lq()),z.ChatBskyConvoSendMessageBatch=a(uq()),z.ChatBskyConvoUnmuteConvo=a(cq()),z.ChatBskyConvoUpdateAllRead=a(dq()),z.ChatBskyConvoUpdateRead=a(pq()),z.ChatBskyModerationGetActorMetadata=a(fq()),z.ChatBskyModerationGetMessageContext=a(hq()),z.ChatBskyModerationUpdateActorAccess=a(mq()),z.ComAtprotoAdminDefs=a(yq()),z.ComAtprotoAdminDeleteAccount=a(gq()),z.ComAtprotoAdminDisableAccountInvites=a(_q()),z.ComAtprotoAdminDisableInviteCodes=a(bq()),z.ComAtprotoAdminEnableAccountInvites=a(vq()),z.ComAtprotoAdminGetAccountInfo=a(xq()),z.ComAtprotoAdminGetAccountInfos=a(wq()),z.ComAtprotoAdminGetInviteCodes=a(Eq()),z.ComAtprotoAdminGetSubjectStatus=a(Aq()),z.ComAtprotoAdminSearchAccounts=a(Rq()),z.ComAtprotoAdminSendEmail=a(Sq()),z.ComAtprotoAdminUpdateAccountEmail=a(Tq()),z.ComAtprotoAdminUpdateAccountHandle=a(Cq()),z.ComAtprotoAdminUpdateAccountPassword=a(kq()),z.ComAtprotoAdminUpdateAccountSigningKey=a(Pq()),z.ComAtprotoAdminUpdateSubjectStatus=a(Lq()),z.ComAtprotoIdentityDefs=a(Dq()),z.ComAtprotoIdentityGetRecommendedDidCredentials=a(Iq()),z.ComAtprotoIdentityRefreshIdentity=a(RR()),z.ComAtprotoIdentityRequestPlcOperationSignature=a(Bq()),z.ComAtprotoIdentityResolveDid=a(TR()),z.ComAtprotoIdentityResolveHandle=a(kR()),z.ComAtprotoIdentityResolveIdentity=a(LR()),z.ComAtprotoIdentitySignPlcOperation=a(Mq()),z.ComAtprotoIdentitySubmitPlcOperation=a(zq()),z.ComAtprotoIdentityUpdateHandle=a(Oq()),z.ComAtprotoLabelDefs=a(Vq()),z.ComAtprotoLabelQueryLabels=a(Uq()),z.ComAtprotoLabelSubscribeLabels=a(jq()),z.ComAtprotoLexiconSchema=a(Nq()),z.ComAtprotoModerationCreateReport=a(Fq()),z.ComAtprotoModerationDefs=a(qq()),z.ComAtprotoRepoApplyWrites=a(IR()),z.ComAtprotoRepoCreateRecord=a(MR()),z.ComAtprotoRepoDefs=a(Kq()),z.ComAtprotoRepoDeleteRecord=a(OR()),z.ComAtprotoRepoDescribeRepo=a(Gq()),z.ComAtprotoRepoGetRecord=a(UR()),z.ComAtprotoRepoImportRepo=a($q()),z.ComAtprotoRepoListMissingBlobs=a(Zq()),z.ComAtprotoRepoListRecords=a(Hq()),z.ComAtprotoRepoPutRecord=a(NR()),z.ComAtprotoRepoStrongRef=a(Xq()),z.ComAtprotoRepoUploadBlob=a(Wq()),z.ComAtprotoServerActivateAccount=a(Yq()),z.ComAtprotoServerCheckAccountStatus=a(Jq()),z.ComAtprotoServerConfirmEmail=a(qR()),z.ComAtprotoServerCreateAccount=a(GR()),z.ComAtprotoServerCreateAppPassword=a(ZR()),z.ComAtprotoServerCreateInviteCode=a(Qq()),z.ComAtprotoServerCreateInviteCodes=a(e6()),z.ComAtprotoServerCreateSession=a(XR()),z.ComAtprotoServerDeactivateAccount=a(t6()),z.ComAtprotoServerDefs=a(r6()),z.ComAtprotoServerDeleteAccount=a(YR()),z.ComAtprotoServerDeleteSession=a(i6()),z.ComAtprotoServerDescribeServer=a(n6()),z.ComAtprotoServerGetAccountInviteCodes=a(QR()),z.ComAtprotoServerGetServiceAuth=a(tS()),z.ComAtprotoServerGetSession=a(s6()),z.ComAtprotoServerListAppPasswords=a(iS()),z.ComAtprotoServerRefreshSession=a(sS()),z.ComAtprotoServerRequestAccountDelete=a(o6()),z.ComAtprotoServerRequestEmailConfirmation=a(a6()),z.ComAtprotoServerRequestEmailUpdate=a(l6()),z.ComAtprotoServerRequestPasswordReset=a(u6()),z.ComAtprotoServerReserveSigningKey=a(c6()),z.ComAtprotoServerResetPassword=a(aS()),z.ComAtprotoServerRevokeAppPassword=a(d6()),z.ComAtprotoServerUpdateEmail=a(uS()),z.ComAtprotoSyncDefs=a(p6()),z.ComAtprotoSyncGetBlob=a(dS()),z.ComAtprotoSyncGetBlocks=a(fS()),z.ComAtprotoSyncGetCheckout=a(f6()),z.ComAtprotoSyncGetHead=a(mS()),z.ComAtprotoSyncGetHostStatus=a(gS()),z.ComAtprotoSyncGetLatestCommit=a(bS()),z.ComAtprotoSyncGetRecord=a(xS()),z.ComAtprotoSyncGetRepo=a(ES()),z.ComAtprotoSyncGetRepoStatus=a(RS()),z.ComAtprotoSyncListBlobs=a(TS()),z.ComAtprotoSyncListHosts=a(h6()),z.ComAtprotoSyncListRepos=a(m6()),z.ComAtprotoSyncListReposByCollection=a(y6()),z.ComAtprotoSyncNotifyOfUpdate=a(g6()),z.ComAtprotoSyncRequestCrawl=a(kS()),z.ComAtprotoSyncSubscribeRepos=a(_6()),z.ComAtprotoTempAddReservedHandle=a(b6()),z.ComAtprotoTempCheckHandleAvailability=a(LS()),z.ComAtprotoTempCheckSignupQueue=a(v6()),z.ComAtprotoTempDereferenceScope=a(IS()),z.ComAtprotoTempFetchLabels=a(x6()),z.ComAtprotoTempRequestPhoneVerification=a(w6()),z.ComAtprotoTempRevokeAccountCredentials=a(E6()),z.ToolsOzoneCommunicationCreateTemplate=a(MS()),z.ToolsOzoneCommunicationDefs=a(A6()),z.ToolsOzoneCommunicationDeleteTemplate=a(R6()),z.ToolsOzoneCommunicationListTemplates=a(S6()),z.ToolsOzoneCommunicationUpdateTemplate=a(OS()),z.ToolsOzoneHostingGetAccountHistory=a(T6()),z.ToolsOzoneModerationCancelScheduledActions=a(C6()),z.ToolsOzoneModerationDefs=a(k6()),z.ToolsOzoneModerationEmitEvent=a(US()),z.ToolsOzoneModerationGetAccountTimeline=a(NS()),z.ToolsOzoneModerationGetEvent=a(P6()),z.ToolsOzoneModerationGetRecord=a(qS()),z.ToolsOzoneModerationGetRecords=a(L6()),z.ToolsOzoneModerationGetRepo=a(GS()),z.ToolsOzoneModerationGetReporterStats=a(D6()),z.ToolsOzoneModerationGetRepos=a(I6()),z.ToolsOzoneModerationGetSubjects=a(B6()),z.ToolsOzoneModerationListScheduledActions=a(M6()),z.ToolsOzoneModerationQueryEvents=a(z6()),z.ToolsOzoneModerationQueryStatuses=a(O6()),z.ToolsOzoneModerationScheduleAction=a(V6()),z.ToolsOzoneModerationSearchRepos=a(U6()),z.ToolsOzoneReportDefs=a(j6()),z.ToolsOzoneSafelinkAddRule=a(ZS()),z.ToolsOzoneSafelinkDefs=a(N6()),z.ToolsOzoneSafelinkQueryEvents=a(F6()),z.ToolsOzoneSafelinkQueryRules=a(q6()),z.ToolsOzoneSafelinkRemoveRule=a(XS()),z.ToolsOzoneSafelinkUpdateRule=a(YS()),z.ToolsOzoneServerGetConfig=a(K6()),z.ToolsOzoneSetAddValues=a(G6()),z.ToolsOzoneSetDefs=a($6()),z.ToolsOzoneSetDeleteSet=a(QS()),z.ToolsOzoneSetDeleteValues=a(tT()),z.ToolsOzoneSetGetValues=a(iT()),z.ToolsOzoneSetQuerySets=a(Z6()),z.ToolsOzoneSetUpsertSet=a(H6()),z.ToolsOzoneSettingDefs=a(X6()),z.ToolsOzoneSettingListOptions=a(W6()),z.ToolsOzoneSettingRemoveOptions=a(Y6()),z.ToolsOzoneSettingUpsertOption=a(J6()),z.ToolsOzoneSignatureDefs=a(Q6()),z.ToolsOzoneSignatureFindCorrelation=a(eK()),z.ToolsOzoneSignatureFindRelatedAccounts=a(tK()),z.ToolsOzoneSignatureSearchAccounts=a(rK()),z.ToolsOzoneTeamAddMember=a(sT()),z.ToolsOzoneTeamDefs=a(iK()),z.ToolsOzoneTeamDeleteMember=a(aT()),z.ToolsOzoneTeamListMembers=a(nK()),z.ToolsOzoneTeamUpdateMember=a(uT()),z.ToolsOzoneVerificationDefs=a(sK()),z.ToolsOzoneVerificationGrantVerifications=a(oK()),z.ToolsOzoneVerificationListVerifications=a(aK()),z.ToolsOzoneVerificationRevokeVerifications=a(lK()),z.APP_BSKY_ACTOR={StatusLive:"app.bsky.actor.status#live"},z.APP_BSKY_FEED={DefsRequestLess:"app.bsky.feed.defs#requestLess",DefsRequestMore:"app.bsky.feed.defs#requestMore",DefsClickthroughItem:"app.bsky.feed.defs#clickthroughItem",DefsClickthroughAuthor:"app.bsky.feed.defs#clickthroughAuthor",DefsClickthroughReposter:"app.bsky.feed.defs#clickthroughReposter",DefsClickthroughEmbed:"app.bsky.feed.defs#clickthroughEmbed",DefsContentModeUnspecified:"app.bsky.feed.defs#contentModeUnspecified",DefsContentModeVideo:"app.bsky.feed.defs#contentModeVideo",DefsInteractionSeen:"app.bsky.feed.defs#interactionSeen",DefsInteractionLike:"app.bsky.feed.defs#interactionLike",DefsInteractionRepost:"app.bsky.feed.defs#interactionRepost",DefsInteractionReply:"app.bsky.feed.defs#interactionReply",DefsInteractionQuote:"app.bsky.feed.defs#interactionQuote",DefsInteractionShare:"app.bsky.feed.defs#interactionShare"},z.APP_BSKY_GRAPH={DefsModlist:"app.bsky.graph.defs#modlist",DefsCuratelist:"app.bsky.graph.defs#curatelist",DefsReferencelist:"app.bsky.graph.defs#referencelist"},z.COM_ATPROTO_MODERATION={DefsReasonSpam:"com.atproto.moderation.defs#reasonSpam",DefsReasonViolation:"com.atproto.moderation.defs#reasonViolation",DefsReasonMisleading:"com.atproto.moderation.defs#reasonMisleading",DefsReasonSexual:"com.atproto.moderation.defs#reasonSexual",DefsReasonRude:"com.atproto.moderation.defs#reasonRude",DefsReasonOther:"com.atproto.moderation.defs#reasonOther",DefsReasonAppeal:"com.atproto.moderation.defs#reasonAppeal"},z.TOOLS_OZONE_MODERATION={DefsReviewOpen:"tools.ozone.moderation.defs#reviewOpen",DefsReviewEscalated:"tools.ozone.moderation.defs#reviewEscalated",DefsReviewClosed:"tools.ozone.moderation.defs#reviewClosed",DefsReviewNone:"tools.ozone.moderation.defs#reviewNone",DefsTimelineEventPlcCreate:"tools.ozone.moderation.defs#timelineEventPlcCreate",DefsTimelineEventPlcOperation:"tools.ozone.moderation.defs#timelineEventPlcOperation",DefsTimelineEventPlcTombstone:"tools.ozone.moderation.defs#timelineEventPlcTombstone"},z.TOOLS_OZONE_REPORT={DefsReasonAppeal:"tools.ozone.report.defs#reasonAppeal",DefsReasonOther:"tools.ozone.report.defs#reasonOther",DefsReasonViolenceAnimal:"tools.ozone.report.defs#reasonViolenceAnimal",DefsReasonViolenceThreats:"tools.ozone.report.defs#reasonViolenceThreats",DefsReasonViolenceGraphicContent:"tools.ozone.report.defs#reasonViolenceGraphicContent",DefsReasonViolenceGlorification:"tools.ozone.report.defs#reasonViolenceGlorification",DefsReasonViolenceExtremistContent:"tools.ozone.report.defs#reasonViolenceExtremistContent",DefsReasonViolenceTrafficking:"tools.ozone.report.defs#reasonViolenceTrafficking",DefsReasonViolenceOther:"tools.ozone.report.defs#reasonViolenceOther",DefsReasonSexualAbuseContent:"tools.ozone.report.defs#reasonSexualAbuseContent",DefsReasonSexualNCII:"tools.ozone.report.defs#reasonSexualNCII",DefsReasonSexualDeepfake:"tools.ozone.report.defs#reasonSexualDeepfake",DefsReasonSexualAnimal:"tools.ozone.report.defs#reasonSexualAnimal",DefsReasonSexualUnlabeled:"tools.ozone.report.defs#reasonSexualUnlabeled",DefsReasonSexualOther:"tools.ozone.report.defs#reasonSexualOther",DefsReasonChildSafetyCSAM:"tools.ozone.report.defs#reasonChildSafetyCSAM",DefsReasonChildSafetyGroom:"tools.ozone.report.defs#reasonChildSafetyGroom",DefsReasonChildSafetyPrivacy:"tools.ozone.report.defs#reasonChildSafetyPrivacy",DefsReasonChildSafetyHarassment:"tools.ozone.report.defs#reasonChildSafetyHarassment",DefsReasonChildSafetyOther:"tools.ozone.report.defs#reasonChildSafetyOther",DefsReasonHarassmentTroll:"tools.ozone.report.defs#reasonHarassmentTroll",DefsReasonHarassmentTargeted:"tools.ozone.report.defs#reasonHarassmentTargeted",DefsReasonHarassmentHateSpeech:"tools.ozone.report.defs#reasonHarassmentHateSpeech",DefsReasonHarassmentDoxxing:"tools.ozone.report.defs#reasonHarassmentDoxxing",DefsReasonHarassmentOther:"tools.ozone.report.defs#reasonHarassmentOther",DefsReasonMisleadingBot:"tools.ozone.report.defs#reasonMisleadingBot",DefsReasonMisleadingImpersonation:"tools.ozone.report.defs#reasonMisleadingImpersonation",DefsReasonMisleadingSpam:"tools.ozone.report.defs#reasonMisleadingSpam",DefsReasonMisleadingScam:"tools.ozone.report.defs#reasonMisleadingScam",DefsReasonMisleadingElections:"tools.ozone.report.defs#reasonMisleadingElections",DefsReasonMisleadingOther:"tools.ozone.report.defs#reasonMisleadingOther",DefsReasonRuleSiteSecurity:"tools.ozone.report.defs#reasonRuleSiteSecurity",DefsReasonRuleProhibitedSales:"tools.ozone.report.defs#reasonRuleProhibitedSales",DefsReasonRuleBanEvasion:"tools.ozone.report.defs#reasonRuleBanEvasion",DefsReasonRuleOther:"tools.ozone.report.defs#reasonRuleOther",DefsReasonSelfHarmContent:"tools.ozone.report.defs#reasonSelfHarmContent",DefsReasonSelfHarmED:"tools.ozone.report.defs#reasonSelfHarmED",DefsReasonSelfHarmStunts:"tools.ozone.report.defs#reasonSelfHarmStunts",DefsReasonSelfHarmSubstances:"tools.ozone.report.defs#reasonSelfHarmSubstances",DefsReasonSelfHarmOther:"tools.ozone.report.defs#reasonSelfHarmOther"},z.TOOLS_OZONE_TEAM={DefsRoleAdmin:"tools.ozone.team.defs#roleAdmin",DefsRoleModerator:"tools.ozone.team.defs#roleModerator",DefsRoleTriage:"tools.ozone.team.defs#roleTriage",DefsRoleVerifier:"tools.ozone.team.defs#roleVerifier"};class se extends c.XrpcClient{constructor(P){super(P,f.schemas),Object.defineProperty(this,"app",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"com",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.app=new _e(this),this.chat=new lr(this),this.com=new Hn(this),this.tools=new U(this)}get xrpc(){return this}}z.AtpBaseClient=se;class _e{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bsky",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.bsky=new Re(P)}}z.AppNS=_e;class Re{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"actor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bookmark",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"embed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"feed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"graph",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"labeler",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"notification",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"richtext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"unspecced",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"video",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.actor=new je(P),this.bookmark=new Ye(P),this.embed=new ht(P),this.feed=new Ze(P),this.graph=new mr(P),this.labeler=new dt(P),this.notification=new Ci(P),this.richtext=new at(P),this.unspecced=new At(P),this.video=new yr(P)}}z.AppBskyNS=Re;class je{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"profile",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.profile=new Ge(P),this.status=new Ne(P)}getPreferences(P,B){return this._client.call("app.bsky.actor.getPreferences",P,void 0,B)}getProfile(P,B){return this._client.call("app.bsky.actor.getProfile",P,void 0,B)}getProfiles(P,B){return this._client.call("app.bsky.actor.getProfiles",P,void 0,B)}getSuggestions(P,B){return this._client.call("app.bsky.actor.getSuggestions",P,void 0,B)}putPreferences(P,B){return this._client.call("app.bsky.actor.putPreferences",B?.qp,P,B)}searchActors(P,B){return this._client.call("app.bsky.actor.searchActors",P,void 0,B)}searchActorsTypeahead(P,B){return this._client.call("app.bsky.actor.searchActorsTypeahead",P,void 0,B)}}z.AppBskyActorNS=je;class Ge{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.actor.profile",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.actor.profile",...P})).data}async create(P,B,Ve){const ut="app.bsky.actor.profile";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,rkey:"self",...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.actor.profile";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.actor.profile",...P},{headers:B})}}z.AppBskyActorProfileRecord=Ge;class Ne{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.actor.status",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.actor.status",...P})).data}async create(P,B,Ve){const ut="app.bsky.actor.status";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,rkey:"self",...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.actor.status";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.actor.status",...P},{headers:B})}}z.AppBskyActorStatusRecord=Ne;class Ye{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}createBookmark(P,B){return this._client.call("app.bsky.bookmark.createBookmark",B?.qp,P,B).catch(Ve=>{throw y.toKnownErr(Ve)})}deleteBookmark(P,B){return this._client.call("app.bsky.bookmark.deleteBookmark",B?.qp,P,B).catch(Ve=>{throw e.toKnownErr(Ve)})}getBookmarks(P,B){return this._client.call("app.bsky.bookmark.getBookmarks",P,void 0,B)}}z.AppBskyBookmarkNS=Ye;class ht{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}}z.AppBskyEmbedNS=ht;class Ze{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"like",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"post",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"postgate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repost",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"threadgate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.generator=new Mt(P),this.like=new Ft(P),this.post=new Ke(P),this.postgate=new hr(P),this.repost=new Cr(P),this.threadgate=new Ot(P)}describeFeedGenerator(P,B){return this._client.call("app.bsky.feed.describeFeedGenerator",P,void 0,B)}getActorFeeds(P,B){return this._client.call("app.bsky.feed.getActorFeeds",P,void 0,B)}getActorLikes(P,B){return this._client.call("app.bsky.feed.getActorLikes",P,void 0,B).catch(Ve=>{throw l.toKnownErr(Ve)})}getAuthorFeed(P,B){return this._client.call("app.bsky.feed.getAuthorFeed",P,void 0,B).catch(Ve=>{throw _.toKnownErr(Ve)})}getFeed(P,B){return this._client.call("app.bsky.feed.getFeed",P,void 0,B).catch(Ve=>{throw w.toKnownErr(Ve)})}getFeedGenerator(P,B){return this._client.call("app.bsky.feed.getFeedGenerator",P,void 0,B)}getFeedGenerators(P,B){return this._client.call("app.bsky.feed.getFeedGenerators",P,void 0,B)}getFeedSkeleton(P,B){return this._client.call("app.bsky.feed.getFeedSkeleton",P,void 0,B).catch(Ve=>{throw R.toKnownErr(Ve)})}getLikes(P,B){return this._client.call("app.bsky.feed.getLikes",P,void 0,B)}getListFeed(P,B){return this._client.call("app.bsky.feed.getListFeed",P,void 0,B).catch(Ve=>{throw C.toKnownErr(Ve)})}getPostThread(P,B){return this._client.call("app.bsky.feed.getPostThread",P,void 0,B).catch(Ve=>{throw I.toKnownErr(Ve)})}getPosts(P,B){return this._client.call("app.bsky.feed.getPosts",P,void 0,B)}getQuotes(P,B){return this._client.call("app.bsky.feed.getQuotes",P,void 0,B)}getRepostedBy(P,B){return this._client.call("app.bsky.feed.getRepostedBy",P,void 0,B)}getSuggestedFeeds(P,B){return this._client.call("app.bsky.feed.getSuggestedFeeds",P,void 0,B)}getTimeline(P,B){return this._client.call("app.bsky.feed.getTimeline",P,void 0,B)}searchPosts(P,B){return this._client.call("app.bsky.feed.searchPosts",P,void 0,B).catch(Ve=>{throw L.toKnownErr(Ve)})}sendInteractions(P,B){return this._client.call("app.bsky.feed.sendInteractions",B?.qp,P,B)}}z.AppBskyFeedNS=Ze;class Mt{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.generator",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.generator",...P})).data}async create(P,B,Ve){const ut="app.bsky.feed.generator";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.feed.generator";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.generator",...P},{headers:B})}}z.AppBskyFeedGeneratorRecord=Mt;class Ft{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.like",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.like",...P})).data}async create(P,B,Ve){const ut="app.bsky.feed.like";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.feed.like";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.like",...P},{headers:B})}}z.AppBskyFeedLikeRecord=Ft;class Ke{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.post",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.post",...P})).data}async create(P,B,Ve){const ut="app.bsky.feed.post";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.feed.post";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.post",...P},{headers:B})}}z.AppBskyFeedPostRecord=Ke;class hr{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.postgate",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.postgate",...P})).data}async create(P,B,Ve){const ut="app.bsky.feed.postgate";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.feed.postgate";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.postgate",...P},{headers:B})}}z.AppBskyFeedPostgateRecord=hr;class Cr{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.repost",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.repost",...P})).data}async create(P,B,Ve){const ut="app.bsky.feed.repost";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.feed.repost";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.repost",...P},{headers:B})}}z.AppBskyFeedRepostRecord=Cr;class Ot{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.feed.threadgate",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.feed.threadgate",...P})).data}async create(P,B,Ve){const ut="app.bsky.feed.threadgate";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.feed.threadgate";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.feed.threadgate",...P},{headers:B})}}z.AppBskyFeedThreadgateRecord=Ot;class mr{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"block",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"follow",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"listblock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"listitem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"starterpack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verification",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.block=new ai(P),this.follow=new li(P),this.list=new Wr(P),this.listblock=new fi(P),this.listitem=new jr(P),this.starterpack=new ei(P),this.verification=new Lr(P)}getActorStarterPacks(P,B){return this._client.call("app.bsky.graph.getActorStarterPacks",P,void 0,B)}getBlocks(P,B){return this._client.call("app.bsky.graph.getBlocks",P,void 0,B)}getFollowers(P,B){return this._client.call("app.bsky.graph.getFollowers",P,void 0,B)}getFollows(P,B){return this._client.call("app.bsky.graph.getFollows",P,void 0,B)}getKnownFollowers(P,B){return this._client.call("app.bsky.graph.getKnownFollowers",P,void 0,B)}getList(P,B){return this._client.call("app.bsky.graph.getList",P,void 0,B)}getListBlocks(P,B){return this._client.call("app.bsky.graph.getListBlocks",P,void 0,B)}getListMutes(P,B){return this._client.call("app.bsky.graph.getListMutes",P,void 0,B)}getLists(P,B){return this._client.call("app.bsky.graph.getLists",P,void 0,B)}getListsWithMembership(P,B){return this._client.call("app.bsky.graph.getListsWithMembership",P,void 0,B)}getMutes(P,B){return this._client.call("app.bsky.graph.getMutes",P,void 0,B)}getRelationships(P,B){return this._client.call("app.bsky.graph.getRelationships",P,void 0,B).catch(Ve=>{throw O.toKnownErr(Ve)})}getStarterPack(P,B){return this._client.call("app.bsky.graph.getStarterPack",P,void 0,B)}getStarterPacks(P,B){return this._client.call("app.bsky.graph.getStarterPacks",P,void 0,B)}getStarterPacksWithMembership(P,B){return this._client.call("app.bsky.graph.getStarterPacksWithMembership",P,void 0,B)}getSuggestedFollowsByActor(P,B){return this._client.call("app.bsky.graph.getSuggestedFollowsByActor",P,void 0,B)}muteActor(P,B){return this._client.call("app.bsky.graph.muteActor",B?.qp,P,B)}muteActorList(P,B){return this._client.call("app.bsky.graph.muteActorList",B?.qp,P,B)}muteThread(P,B){return this._client.call("app.bsky.graph.muteThread",B?.qp,P,B)}searchStarterPacks(P,B){return this._client.call("app.bsky.graph.searchStarterPacks",P,void 0,B)}unmuteActor(P,B){return this._client.call("app.bsky.graph.unmuteActor",B?.qp,P,B)}unmuteActorList(P,B){return this._client.call("app.bsky.graph.unmuteActorList",B?.qp,P,B)}unmuteThread(P,B){return this._client.call("app.bsky.graph.unmuteThread",B?.qp,P,B)}}z.AppBskyGraphNS=mr;class ai{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.block",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.block",...P})).data}async create(P,B,Ve){const ut="app.bsky.graph.block";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.graph.block";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.block",...P},{headers:B})}}z.AppBskyGraphBlockRecord=ai;class li{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.follow",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.follow",...P})).data}async create(P,B,Ve){const ut="app.bsky.graph.follow";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.graph.follow";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.follow",...P},{headers:B})}}z.AppBskyGraphFollowRecord=li;class Wr{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.list",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.list",...P})).data}async create(P,B,Ve){const ut="app.bsky.graph.list";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.graph.list";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.list",...P},{headers:B})}}z.AppBskyGraphListRecord=Wr;class fi{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.listblock",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.listblock",...P})).data}async create(P,B,Ve){const ut="app.bsky.graph.listblock";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.graph.listblock";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.listblock",...P},{headers:B})}}z.AppBskyGraphListblockRecord=fi;class jr{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.listitem",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.listitem",...P})).data}async create(P,B,Ve){const ut="app.bsky.graph.listitem";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.graph.listitem";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.listitem",...P},{headers:B})}}z.AppBskyGraphListitemRecord=jr;class ei{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.starterpack",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.starterpack",...P})).data}async create(P,B,Ve){const ut="app.bsky.graph.starterpack";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.graph.starterpack";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.starterpack",...P},{headers:B})}}z.AppBskyGraphStarterpackRecord=ei;class Lr{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.graph.verification",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.graph.verification",...P})).data}async create(P,B,Ve){const ut="app.bsky.graph.verification";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.graph.verification";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.graph.verification",...P},{headers:B})}}z.AppBskyGraphVerificationRecord=Lr;class dt{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"service",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.service=new Bi(P)}getServices(P,B){return this._client.call("app.bsky.labeler.getServices",P,void 0,B)}}z.AppBskyLabelerNS=dt;class Bi{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.labeler.service",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.labeler.service",...P})).data}async create(P,B,Ve){const ut="app.bsky.labeler.service";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,rkey:"self",...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.labeler.service";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.labeler.service",...P},{headers:B})}}z.AppBskyLabelerServiceRecord=Bi;class Ci{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"declaration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.declaration=new ki(P)}getPreferences(P,B){return this._client.call("app.bsky.notification.getPreferences",P,void 0,B)}getUnreadCount(P,B){return this._client.call("app.bsky.notification.getUnreadCount",P,void 0,B)}listActivitySubscriptions(P,B){return this._client.call("app.bsky.notification.listActivitySubscriptions",P,void 0,B)}listNotifications(P,B){return this._client.call("app.bsky.notification.listNotifications",P,void 0,B)}putActivitySubscription(P,B){return this._client.call("app.bsky.notification.putActivitySubscription",B?.qp,P,B)}putPreferences(P,B){return this._client.call("app.bsky.notification.putPreferences",B?.qp,P,B)}putPreferencesV2(P,B){return this._client.call("app.bsky.notification.putPreferencesV2",B?.qp,P,B)}registerPush(P,B){return this._client.call("app.bsky.notification.registerPush",B?.qp,P,B)}unregisterPush(P,B){return this._client.call("app.bsky.notification.unregisterPush",B?.qp,P,B)}updateSeen(P,B){return this._client.call("app.bsky.notification.updateSeen",B?.qp,P,B)}}z.AppBskyNotificationNS=Ci;class ki{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"app.bsky.notification.declaration",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"app.bsky.notification.declaration",...P})).data}async create(P,B,Ve){const ut="app.bsky.notification.declaration";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,rkey:"self",...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="app.bsky.notification.declaration";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"app.bsky.notification.declaration",...P},{headers:B})}}z.AppBskyNotificationDeclarationRecord=ki;class at{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}}z.AppBskyRichtextNS=at;class At{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}getAgeAssuranceState(P,B){return this._client.call("app.bsky.unspecced.getAgeAssuranceState",P,void 0,B)}getConfig(P,B){return this._client.call("app.bsky.unspecced.getConfig",P,void 0,B)}getOnboardingSuggestedStarterPacks(P,B){return this._client.call("app.bsky.unspecced.getOnboardingSuggestedStarterPacks",P,void 0,B)}getOnboardingSuggestedStarterPacksSkeleton(P,B){return this._client.call("app.bsky.unspecced.getOnboardingSuggestedStarterPacksSkeleton",P,void 0,B)}getPopularFeedGenerators(P,B){return this._client.call("app.bsky.unspecced.getPopularFeedGenerators",P,void 0,B)}getPostThreadOtherV2(P,B){return this._client.call("app.bsky.unspecced.getPostThreadOtherV2",P,void 0,B)}getPostThreadV2(P,B){return this._client.call("app.bsky.unspecced.getPostThreadV2",P,void 0,B)}getSuggestedFeeds(P,B){return this._client.call("app.bsky.unspecced.getSuggestedFeeds",P,void 0,B)}getSuggestedFeedsSkeleton(P,B){return this._client.call("app.bsky.unspecced.getSuggestedFeedsSkeleton",P,void 0,B)}getSuggestedStarterPacks(P,B){return this._client.call("app.bsky.unspecced.getSuggestedStarterPacks",P,void 0,B)}getSuggestedStarterPacksSkeleton(P,B){return this._client.call("app.bsky.unspecced.getSuggestedStarterPacksSkeleton",P,void 0,B)}getSuggestedUsers(P,B){return this._client.call("app.bsky.unspecced.getSuggestedUsers",P,void 0,B)}getSuggestedUsersSkeleton(P,B){return this._client.call("app.bsky.unspecced.getSuggestedUsersSkeleton",P,void 0,B)}getSuggestionsSkeleton(P,B){return this._client.call("app.bsky.unspecced.getSuggestionsSkeleton",P,void 0,B)}getTaggedSuggestions(P,B){return this._client.call("app.bsky.unspecced.getTaggedSuggestions",P,void 0,B)}getTrendingTopics(P,B){return this._client.call("app.bsky.unspecced.getTrendingTopics",P,void 0,B)}getTrends(P,B){return this._client.call("app.bsky.unspecced.getTrends",P,void 0,B)}getTrendsSkeleton(P,B){return this._client.call("app.bsky.unspecced.getTrendsSkeleton",P,void 0,B)}initAgeAssurance(P,B){return this._client.call("app.bsky.unspecced.initAgeAssurance",B?.qp,P,B).catch(Ve=>{throw q.toKnownErr(Ve)})}searchActorsSkeleton(P,B){return this._client.call("app.bsky.unspecced.searchActorsSkeleton",P,void 0,B).catch(Ve=>{throw G.toKnownErr(Ve)})}searchPostsSkeleton(P,B){return this._client.call("app.bsky.unspecced.searchPostsSkeleton",P,void 0,B).catch(Ve=>{throw j.toKnownErr(Ve)})}searchStarterPacksSkeleton(P,B){return this._client.call("app.bsky.unspecced.searchStarterPacksSkeleton",P,void 0,B).catch(Ve=>{throw ne.toKnownErr(Ve)})}}z.AppBskyUnspeccedNS=At;class yr{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}getJobStatus(P,B){return this._client.call("app.bsky.video.getJobStatus",P,void 0,B)}getUploadLimits(P,B){return this._client.call("app.bsky.video.getUploadLimits",P,void 0,B)}uploadVideo(P,B){return this._client.call("app.bsky.video.uploadVideo",B?.qp,P,B)}}z.AppBskyVideoNS=yr;class lr{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bsky",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.bsky=new Ni(P)}}z.ChatNS=lr;class Ni{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"actor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"convo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moderation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.actor=new an(P),this.convo=new ur(P),this.moderation=new Zn(P)}}z.ChatBskyNS=Ni;class an{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"declaration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.declaration=new Hi(P)}deleteAccount(P,B){return this._client.call("chat.bsky.actor.deleteAccount",B?.qp,P,B)}exportAccountData(P,B){return this._client.call("chat.bsky.actor.exportAccountData",P,void 0,B)}}z.ChatBskyActorNS=an;class Hi{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"chat.bsky.actor.declaration",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"chat.bsky.actor.declaration",...P})).data}async create(P,B,Ve){const ut="chat.bsky.actor.declaration";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,rkey:"self",...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="chat.bsky.actor.declaration";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"chat.bsky.actor.declaration",...P},{headers:B})}}z.ChatBskyActorDeclarationRecord=Hi;class ur{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}acceptConvo(P,B){return this._client.call("chat.bsky.convo.acceptConvo",B?.qp,P,B)}addReaction(P,B){return this._client.call("chat.bsky.convo.addReaction",B?.qp,P,B).catch(Ve=>{throw he.toKnownErr(Ve)})}deleteMessageForSelf(P,B){return this._client.call("chat.bsky.convo.deleteMessageForSelf",B?.qp,P,B)}getConvo(P,B){return this._client.call("chat.bsky.convo.getConvo",P,void 0,B)}getConvoAvailability(P,B){return this._client.call("chat.bsky.convo.getConvoAvailability",P,void 0,B)}getConvoForMembers(P,B){return this._client.call("chat.bsky.convo.getConvoForMembers",P,void 0,B)}getLog(P,B){return this._client.call("chat.bsky.convo.getLog",P,void 0,B)}getMessages(P,B){return this._client.call("chat.bsky.convo.getMessages",P,void 0,B)}leaveConvo(P,B){return this._client.call("chat.bsky.convo.leaveConvo",B?.qp,P,B)}listConvos(P,B){return this._client.call("chat.bsky.convo.listConvos",P,void 0,B)}muteConvo(P,B){return this._client.call("chat.bsky.convo.muteConvo",B?.qp,P,B)}removeReaction(P,B){return this._client.call("chat.bsky.convo.removeReaction",B?.qp,P,B).catch(Ve=>{throw Q.toKnownErr(Ve)})}sendMessage(P,B){return this._client.call("chat.bsky.convo.sendMessage",B?.qp,P,B)}sendMessageBatch(P,B){return this._client.call("chat.bsky.convo.sendMessageBatch",B?.qp,P,B)}unmuteConvo(P,B){return this._client.call("chat.bsky.convo.unmuteConvo",B?.qp,P,B)}updateAllRead(P,B){return this._client.call("chat.bsky.convo.updateAllRead",B?.qp,P,B)}updateRead(P,B){return this._client.call("chat.bsky.convo.updateRead",B?.qp,P,B)}}z.ChatBskyConvoNS=ur;class Zn{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}getActorMetadata(P,B){return this._client.call("chat.bsky.moderation.getActorMetadata",P,void 0,B)}getMessageContext(P,B){return this._client.call("chat.bsky.moderation.getMessageContext",P,void 0,B)}updateActorAccess(P,B){return this._client.call("chat.bsky.moderation.updateActorAccess",B?.qp,P,B)}}z.ChatBskyModerationNS=Zn;class Hn{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"atproto",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.atproto=new Bn(P)}}z.ComNS=Hn;class Bn{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"admin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"identity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"label",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lexicon",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moderation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"server",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sync",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.admin=new ds(P),this.identity=new Xi(P),this.label=new Mn(P),this.lexicon=new ui(P),this.moderation=new Zr(P),this.repo=new ps(P),this.server=new zn(P),this.sync=new Zs(P),this.temp=new Te(P)}}z.ComAtprotoNS=Bn;class ds{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}deleteAccount(P,B){return this._client.call("com.atproto.admin.deleteAccount",B?.qp,P,B)}disableAccountInvites(P,B){return this._client.call("com.atproto.admin.disableAccountInvites",B?.qp,P,B)}disableInviteCodes(P,B){return this._client.call("com.atproto.admin.disableInviteCodes",B?.qp,P,B)}enableAccountInvites(P,B){return this._client.call("com.atproto.admin.enableAccountInvites",B?.qp,P,B)}getAccountInfo(P,B){return this._client.call("com.atproto.admin.getAccountInfo",P,void 0,B)}getAccountInfos(P,B){return this._client.call("com.atproto.admin.getAccountInfos",P,void 0,B)}getInviteCodes(P,B){return this._client.call("com.atproto.admin.getInviteCodes",P,void 0,B)}getSubjectStatus(P,B){return this._client.call("com.atproto.admin.getSubjectStatus",P,void 0,B)}searchAccounts(P,B){return this._client.call("com.atproto.admin.searchAccounts",P,void 0,B)}sendEmail(P,B){return this._client.call("com.atproto.admin.sendEmail",B?.qp,P,B)}updateAccountEmail(P,B){return this._client.call("com.atproto.admin.updateAccountEmail",B?.qp,P,B)}updateAccountHandle(P,B){return this._client.call("com.atproto.admin.updateAccountHandle",B?.qp,P,B)}updateAccountPassword(P,B){return this._client.call("com.atproto.admin.updateAccountPassword",B?.qp,P,B)}updateAccountSigningKey(P,B){return this._client.call("com.atproto.admin.updateAccountSigningKey",B?.qp,P,B)}updateSubjectStatus(P,B){return this._client.call("com.atproto.admin.updateSubjectStatus",B?.qp,P,B)}}z.ComAtprotoAdminNS=ds;class Xi{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}getRecommendedDidCredentials(P,B){return this._client.call("com.atproto.identity.getRecommendedDidCredentials",P,void 0,B)}refreshIdentity(P,B){return this._client.call("com.atproto.identity.refreshIdentity",B?.qp,P,B).catch(Ve=>{throw Be.toKnownErr(Ve)})}requestPlcOperationSignature(P,B){return this._client.call("com.atproto.identity.requestPlcOperationSignature",B?.qp,P,B)}resolveDid(P,B){return this._client.call("com.atproto.identity.resolveDid",P,void 0,B).catch(Ve=>{throw we.toKnownErr(Ve)})}resolveHandle(P,B){return this._client.call("com.atproto.identity.resolveHandle",P,void 0,B).catch(Ve=>{throw ze.toKnownErr(Ve)})}resolveIdentity(P,B){return this._client.call("com.atproto.identity.resolveIdentity",P,void 0,B).catch(Ve=>{throw et.toKnownErr(Ve)})}signPlcOperation(P,B){return this._client.call("com.atproto.identity.signPlcOperation",B?.qp,P,B)}submitPlcOperation(P,B){return this._client.call("com.atproto.identity.submitPlcOperation",B?.qp,P,B)}updateHandle(P,B){return this._client.call("com.atproto.identity.updateHandle",B?.qp,P,B)}}z.ComAtprotoIdentityNS=Xi;class Mn{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}queryLabels(P,B){return this._client.call("com.atproto.label.queryLabels",P,void 0,B)}}z.ComAtprotoLabelNS=Mn;class ui{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.schema=new Mi(P)}}z.ComAtprotoLexiconNS=ui;class Mi{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}async list(P){return(await this._client.call("com.atproto.repo.listRecords",{collection:"com.atproto.lexicon.schema",...P})).data}async get(P){return(await this._client.call("com.atproto.repo.getRecord",{collection:"com.atproto.lexicon.schema",...P})).data}async create(P,B,Ve){const ut="com.atproto.lexicon.schema";return(await this._client.call("com.atproto.repo.createRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async put(P,B,Ve){const ut="com.atproto.lexicon.schema";return(await this._client.call("com.atproto.repo.putRecord",void 0,{collection:ut,...P,record:{...B,$type:ut}},{encoding:"application/json",headers:Ve})).data}async delete(P,B){await this._client.call("com.atproto.repo.deleteRecord",void 0,{collection:"com.atproto.lexicon.schema",...P},{headers:B})}}z.ComAtprotoLexiconSchemaRecord=Mi;class Zr{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}createReport(P,B){return this._client.call("com.atproto.moderation.createReport",B?.qp,P,B)}}z.ComAtprotoModerationNS=Zr;class ps{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}applyWrites(P,B){return this._client.call("com.atproto.repo.applyWrites",B?.qp,P,B).catch(Ve=>{throw gt.toKnownErr(Ve)})}createRecord(P,B){return this._client.call("com.atproto.repo.createRecord",B?.qp,P,B).catch(Ve=>{throw st.toKnownErr(Ve)})}deleteRecord(P,B){return this._client.call("com.atproto.repo.deleteRecord",B?.qp,P,B).catch(Ve=>{throw nt.toKnownErr(Ve)})}describeRepo(P,B){return this._client.call("com.atproto.repo.describeRepo",P,void 0,B)}getRecord(P,B){return this._client.call("com.atproto.repo.getRecord",P,void 0,B).catch(Ve=>{throw rt.toKnownErr(Ve)})}importRepo(P,B){return this._client.call("com.atproto.repo.importRepo",B?.qp,P,B)}listMissingBlobs(P,B){return this._client.call("com.atproto.repo.listMissingBlobs",P,void 0,B)}listRecords(P,B){return this._client.call("com.atproto.repo.listRecords",P,void 0,B)}putRecord(P,B){return this._client.call("com.atproto.repo.putRecord",B?.qp,P,B).catch(Ve=>{throw ee.toKnownErr(Ve)})}uploadBlob(P,B){return this._client.call("com.atproto.repo.uploadBlob",B?.qp,P,B)}}z.ComAtprotoRepoNS=ps;class zn{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}activateAccount(P,B){return this._client.call("com.atproto.server.activateAccount",B?.qp,P,B)}checkAccountStatus(P,B){return this._client.call("com.atproto.server.checkAccountStatus",P,void 0,B)}confirmEmail(P,B){return this._client.call("com.atproto.server.confirmEmail",B?.qp,P,B).catch(Ve=>{throw Le.toKnownErr(Ve)})}createAccount(P,B){return this._client.call("com.atproto.server.createAccount",B?.qp,P,B).catch(Ve=>{throw de.toKnownErr(Ve)})}createAppPassword(P,B){return this._client.call("com.atproto.server.createAppPassword",B?.qp,P,B).catch(Ve=>{throw me.toKnownErr(Ve)})}createInviteCode(P,B){return this._client.call("com.atproto.server.createInviteCode",B?.qp,P,B)}createInviteCodes(P,B){return this._client.call("com.atproto.server.createInviteCodes",B?.qp,P,B)}createSession(P,B){return this._client.call("com.atproto.server.createSession",B?.qp,P,B).catch(Ve=>{throw tt.toKnownErr(Ve)})}deactivateAccount(P,B){return this._client.call("com.atproto.server.deactivateAccount",B?.qp,P,B)}deleteAccount(P,B){return this._client.call("com.atproto.server.deleteAccount",B?.qp,P,B).catch(Ve=>{throw yt.toKnownErr(Ve)})}deleteSession(P,B){return this._client.call("com.atproto.server.deleteSession",B?.qp,P,B)}describeServer(P,B){return this._client.call("com.atproto.server.describeServer",P,void 0,B)}getAccountInviteCodes(P,B){return this._client.call("com.atproto.server.getAccountInviteCodes",P,void 0,B).catch(Ve=>{throw lt.toKnownErr(Ve)})}getServiceAuth(P,B){return this._client.call("com.atproto.server.getServiceAuth",P,void 0,B).catch(Ve=>{throw ge.toKnownErr(Ve)})}getSession(P,B){return this._client.call("com.atproto.server.getSession",P,void 0,B)}listAppPasswords(P,B){return this._client.call("com.atproto.server.listAppPasswords",P,void 0,B).catch(Ve=>{throw Gt.toKnownErr(Ve)})}refreshSession(P,B){return this._client.call("com.atproto.server.refreshSession",B?.qp,P,B).catch(Ve=>{throw Ut.toKnownErr(Ve)})}requestAccountDelete(P,B){return this._client.call("com.atproto.server.requestAccountDelete",B?.qp,P,B)}requestEmailConfirmation(P,B){return this._client.call("com.atproto.server.requestEmailConfirmation",B?.qp,P,B)}requestEmailUpdate(P,B){return this._client.call("com.atproto.server.requestEmailUpdate",B?.qp,P,B)}requestPasswordReset(P,B){return this._client.call("com.atproto.server.requestPasswordReset",B?.qp,P,B)}reserveSigningKey(P,B){return this._client.call("com.atproto.server.reserveSigningKey",B?.qp,P,B)}resetPassword(P,B){return this._client.call("com.atproto.server.resetPassword",B?.qp,P,B).catch(Ve=>{throw Ce.toKnownErr(Ve)})}revokeAppPassword(P,B){return this._client.call("com.atproto.server.revokeAppPassword",B?.qp,P,B)}updateEmail(P,B){return this._client.call("com.atproto.server.updateEmail",B?.qp,P,B).catch(Ve=>{throw ar.toKnownErr(Ve)})}}z.ComAtprotoServerNS=zn;class Zs{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}getBlob(P,B){return this._client.call("com.atproto.sync.getBlob",P,void 0,B).catch(Ve=>{throw kt.toKnownErr(Ve)})}getBlocks(P,B){return this._client.call("com.atproto.sync.getBlocks",P,void 0,B).catch(Ve=>{throw er.toKnownErr(Ve)})}getCheckout(P,B){return this._client.call("com.atproto.sync.getCheckout",P,void 0,B)}getHead(P,B){return this._client.call("com.atproto.sync.getHead",P,void 0,B).catch(Ve=>{throw Ur.toKnownErr(Ve)})}getHostStatus(P,B){return this._client.call("com.atproto.sync.getHostStatus",P,void 0,B).catch(Ve=>{throw or.toKnownErr(Ve)})}getLatestCommit(P,B){return this._client.call("com.atproto.sync.getLatestCommit",P,void 0,B).catch(Ve=>{throw Sr.toKnownErr(Ve)})}getRecord(P,B){return this._client.call("com.atproto.sync.getRecord",P,void 0,B).catch(Ve=>{throw Ar.toKnownErr(Ve)})}getRepo(P,B){return this._client.call("com.atproto.sync.getRepo",P,void 0,B).catch(Ve=>{throw Nr.toKnownErr(Ve)})}getRepoStatus(P,B){return this._client.call("com.atproto.sync.getRepoStatus",P,void 0,B).catch(Ve=>{throw rr.toKnownErr(Ve)})}listBlobs(P,B){return this._client.call("com.atproto.sync.listBlobs",P,void 0,B).catch(Ve=>{throw gr.toKnownErr(Ve)})}listHosts(P,B){return this._client.call("com.atproto.sync.listHosts",P,void 0,B)}listRepos(P,B){return this._client.call("com.atproto.sync.listRepos",P,void 0,B)}listReposByCollection(P,B){return this._client.call("com.atproto.sync.listReposByCollection",P,void 0,B)}notifyOfUpdate(P,B){return this._client.call("com.atproto.sync.notifyOfUpdate",B?.qp,P,B)}requestCrawl(P,B){return this._client.call("com.atproto.sync.requestCrawl",B?.qp,P,B).catch(Ve=>{throw ir.toKnownErr(Ve)})}}z.ComAtprotoSyncNS=Zs;class Te{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}addReservedHandle(P,B){return this._client.call("com.atproto.temp.addReservedHandle",B?.qp,P,B)}checkHandleAvailability(P,B){return this._client.call("com.atproto.temp.checkHandleAvailability",P,void 0,B).catch(Ve=>{throw qr.toKnownErr(Ve)})}checkSignupQueue(P,B){return this._client.call("com.atproto.temp.checkSignupQueue",P,void 0,B)}dereferenceScope(P,B){return this._client.call("com.atproto.temp.dereferenceScope",P,void 0,B).catch(Ve=>{throw Vt.toKnownErr(Ve)})}fetchLabels(P,B){return this._client.call("com.atproto.temp.fetchLabels",P,void 0,B)}requestPhoneVerification(P,B){return this._client.call("com.atproto.temp.requestPhoneVerification",B?.qp,P,B)}revokeAccountCredentials(P,B){return this._client.call("com.atproto.temp.revokeAccountCredentials",B?.qp,P,B)}}z.ComAtprotoTempNS=Te;class U{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ozone",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.ozone=new te(P)}}z.ToolsNS=U;class te{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"communication",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hosting",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moderation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"safelink",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"server",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"set",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setting",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"team",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verification",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P,this.communication=new oe(P),this.hosting=new ke(P),this.moderation=new De(P),this.safelink=new Et(P),this.server=new ft(P),this.set=new $t(P),this.setting=new Wt(P),this.signature=new vr(P),this.team=new zi(P),this.verification=new Rn(P)}}z.ToolsOzoneNS=te;class oe{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}createTemplate(P,B){return this._client.call("tools.ozone.communication.createTemplate",B?.qp,P,B).catch(Ve=>{throw Pr.toKnownErr(Ve)})}deleteTemplate(P,B){return this._client.call("tools.ozone.communication.deleteTemplate",B?.qp,P,B)}listTemplates(P,B){return this._client.call("tools.ozone.communication.listTemplates",P,void 0,B)}updateTemplate(P,B){return this._client.call("tools.ozone.communication.updateTemplate",B?.qp,P,B).catch(Ve=>{throw St.toKnownErr(Ve)})}}z.ToolsOzoneCommunicationNS=oe;class ke{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}getAccountHistory(P,B){return this._client.call("tools.ozone.hosting.getAccountHistory",P,void 0,B)}}z.ToolsOzoneHostingNS=ke;class De{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}cancelScheduledActions(P,B){return this._client.call("tools.ozone.moderation.cancelScheduledActions",B?.qp,P,B)}emitEvent(P,B){return this._client.call("tools.ozone.moderation.emitEvent",B?.qp,P,B).catch(Ve=>{throw Qt.toKnownErr(Ve)})}getAccountTimeline(P,B){return this._client.call("tools.ozone.moderation.getAccountTimeline",P,void 0,B).catch(Ve=>{throw nr.toKnownErr(Ve)})}getEvent(P,B){return this._client.call("tools.ozone.moderation.getEvent",P,void 0,B)}getRecord(P,B){return this._client.call("tools.ozone.moderation.getRecord",P,void 0,B).catch(Ve=>{throw Tr.toKnownErr(Ve)})}getRecords(P,B){return this._client.call("tools.ozone.moderation.getRecords",P,void 0,B)}getRepo(P,B){return this._client.call("tools.ozone.moderation.getRepo",P,void 0,B).catch(Ve=>{throw $r.toKnownErr(Ve)})}getReporterStats(P,B){return this._client.call("tools.ozone.moderation.getReporterStats",P,void 0,B)}getRepos(P,B){return this._client.call("tools.ozone.moderation.getRepos",P,void 0,B)}getSubjects(P,B){return this._client.call("tools.ozone.moderation.getSubjects",P,void 0,B)}listScheduledActions(P,B){return this._client.call("tools.ozone.moderation.listScheduledActions",B?.qp,P,B)}queryEvents(P,B){return this._client.call("tools.ozone.moderation.queryEvents",P,void 0,B)}queryStatuses(P,B){return this._client.call("tools.ozone.moderation.queryStatuses",P,void 0,B)}scheduleAction(P,B){return this._client.call("tools.ozone.moderation.scheduleAction",B?.qp,P,B)}searchRepos(P,B){return this._client.call("tools.ozone.moderation.searchRepos",P,void 0,B)}}z.ToolsOzoneModerationNS=De;class Et{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}addRule(P,B){return this._client.call("tools.ozone.safelink.addRule",B?.qp,P,B).catch(Ve=>{throw bt.toKnownErr(Ve)})}queryEvents(P,B){return this._client.call("tools.ozone.safelink.queryEvents",B?.qp,P,B)}queryRules(P,B){return this._client.call("tools.ozone.safelink.queryRules",B?.qp,P,B)}removeRule(P,B){return this._client.call("tools.ozone.safelink.removeRule",B?.qp,P,B).catch(Ve=>{throw pi.toKnownErr(Ve)})}updateRule(P,B){return this._client.call("tools.ozone.safelink.updateRule",B?.qp,P,B).catch(Ve=>{throw Ii.toKnownErr(Ve)})}}z.ToolsOzoneSafelinkNS=Et;class ft{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}getConfig(P,B){return this._client.call("tools.ozone.server.getConfig",P,void 0,B)}}z.ToolsOzoneServerNS=ft;class $t{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}addValues(P,B){return this._client.call("tools.ozone.set.addValues",B?.qp,P,B)}deleteSet(P,B){return this._client.call("tools.ozone.set.deleteSet",B?.qp,P,B).catch(Ve=>{throw Oe.toKnownErr(Ve)})}deleteValues(P,B){return this._client.call("tools.ozone.set.deleteValues",B?.qp,P,B).catch(Ve=>{throw vt.toKnownErr(Ve)})}getValues(P,B){return this._client.call("tools.ozone.set.getValues",P,void 0,B).catch(Ve=>{throw Nt.toKnownErr(Ve)})}querySets(P,B){return this._client.call("tools.ozone.set.querySets",P,void 0,B)}upsertSet(P,B){return this._client.call("tools.ozone.set.upsertSet",B?.qp,P,B)}}z.ToolsOzoneSetNS=$t;class Wt{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}listOptions(P,B){return this._client.call("tools.ozone.setting.listOptions",P,void 0,B)}removeOptions(P,B){return this._client.call("tools.ozone.setting.removeOptions",B?.qp,P,B)}upsertOption(P,B){return this._client.call("tools.ozone.setting.upsertOption",B?.qp,P,B)}}z.ToolsOzoneSettingNS=Wt;class vr{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}findCorrelation(P,B){return this._client.call("tools.ozone.signature.findCorrelation",P,void 0,B)}findRelatedAccounts(P,B){return this._client.call("tools.ozone.signature.findRelatedAccounts",P,void 0,B)}searchAccounts(P,B){return this._client.call("tools.ozone.signature.searchAccounts",P,void 0,B)}}z.ToolsOzoneSignatureNS=vr;class zi{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}addMember(P,B){return this._client.call("tools.ozone.team.addMember",B?.qp,P,B).catch(Ve=>{throw ve.toKnownErr(Ve)})}deleteMember(P,B){return this._client.call("tools.ozone.team.deleteMember",B?.qp,P,B).catch(Ve=>{throw W.toKnownErr(Ve)})}listMembers(P,B){return this._client.call("tools.ozone.team.listMembers",P,void 0,B)}updateMember(P,B){return this._client.call("tools.ozone.team.updateMember",B?.qp,P,B).catch(Ve=>{throw J.toKnownErr(Ve)})}}z.ToolsOzoneTeamNS=zi;class Rn{constructor(P){Object.defineProperty(this,"_client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._client=P}grantVerifications(P,B){return this._client.call("tools.ozone.verification.grantVerifications",B?.qp,P,B)}listVerifications(P,B){return this._client.call("tools.ozone.verification.listVerifications",P,void 0,B)}revokeVerifications(P,B){return this._client.call("tools.ozone.verification.revokeVerifications",B?.qp,P,B)}}return z.ToolsOzoneVerificationNS=Rn,z}var Qu={},Dp={};const uK=JSON.parse('["aaa","aarp","abb","abbott","abbvie","abc","able","abogado","abudhabi","ac","academy","accenture","accountant","accountants","aco","actor","ad","ads","adult","ae","aeg","aero","aetna","af","afl","africa","ag","agakhan","agency","ai","aig","airbus","airforce","airtel","akdn","al","alibaba","alipay","allfinanz","allstate","ally","alsace","alstom","am","amazon","americanexpress","americanfamily","amex","amfam","amica","amsterdam","analytics","android","anquan","anz","ao","aol","apartments","app","apple","aq","aquarelle","ar","arab","aramco","archi","army","arpa","art","arte","as","asda","asia","associates","at","athleta","attorney","au","auction","audi","audible","audio","auspost","author","auto","autos","aw","aws","ax","axa","az","azure","ba","baby","baidu","banamex","band","bank","bar","barcelona","barclaycard","barclays","barefoot","bargains","baseball","basketball","bauhaus","bayern","bb","bbc","bbt","bbva","bcg","bcn","bd","be","beats","beauty","beer","berlin","best","bestbuy","bet","bf","bg","bh","bharti","bi","bible","bid","bike","bing","bingo","bio","biz","bj","black","blackfriday","blockbuster","blog","bloomberg","blue","bm","bms","bmw","bn","bnpparibas","bo","boats","boehringer","bofa","bom","bond","boo","book","booking","bosch","bostik","boston","bot","boutique","box","br","bradesco","bridgestone","broadway","broker","brother","brussels","bs","bt","build","builders","business","buy","buzz","bv","bw","by","bz","bzh","ca","cab","cafe","cal","call","calvinklein","cam","camera","camp","canon","capetown","capital","capitalone","car","caravan","cards","care","career","careers","cars","casa","case","cash","casino","cat","catering","catholic","cba","cbn","cbre","cc","cd","center","ceo","cern","cf","cfa","cfd","cg","ch","chanel","channel","charity","chase","chat","cheap","chintai","christmas","chrome","church","ci","cipriani","circle","cisco","citadel","citi","citic","city","ck","cl","claims","cleaning","click","clinic","clinique","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","commbank","community","company","compare","computer","comsec","condos","construction","consulting","contact","contractors","cooking","cool","coop","corsica","country","coupon","coupons","courses","cpa","cr","credit","creditcard","creditunion","cricket","crown","crs","cruise","cruises","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dad","dance","data","date","dating","datsun","day","dclk","dds","de","deal","dealer","deals","degree","delivery","dell","deloitte","delta","democrat","dental","dentist","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","discover","dish","diy","dj","dk","dm","dnp","do","docs","doctor","dog","domains","dot","download","drive","dtv","dubai","dunlop","dupont","durban","dvag","dvr","dz","earth","eat","ec","eco","edeka","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","epson","equipment","er","ericsson","erni","es","esq","estate","et","eu","eurovision","eus","events","exchange","expert","exposed","express","extraspace","fage","fail","fairwinds","faith","family","fan","fans","farm","farmers","fashion","fast","fedex","feedback","ferrari","ferrero","fi","fidelity","fido","film","final","finance","financial","fire","firestone","firmdale","fish","fishing","fit","fitness","fj","fk","flickr","flights","flir","florist","flowers","fly","fm","fo","foo","food","football","ford","forex","forsale","forum","foundation","fox","fr","free","fresenius","frl","frogans","frontier","ftr","fujitsu","fun","fund","furniture","futbol","fyi","ga","gal","gallery","gallo","gallup","game","games","gap","garden","gay","gb","gbiz","gd","gdn","ge","gea","gent","genting","george","gf","gg","ggee","gh","gi","gift","gifts","gives","giving","gl","glass","gle","global","globo","gm","gmail","gmbh","gmo","gmx","gn","godaddy","gold","goldpoint","golf","goo","goodyear","goog","google","gop","got","gov","gp","gq","gr","grainger","graphics","gratis","green","gripe","grocery","group","gs","gt","gu","gucci","guge","guide","guitars","guru","gw","gy","hair","hamburg","hangout","haus","hbo","hdfc","hdfcbank","health","healthcare","help","helsinki","here","hermes","hiphop","hisamitsu","hitachi","hiv","hk","hkt","hm","hn","hockey","holdings","holiday","homedepot","homegoods","homes","homesense","honda","horse","hospital","host","hosting","hot","hotels","hotmail","house","how","hr","hsbc","ht","hu","hughes","hyatt","hyundai","ibm","icbc","ice","icu","id","ie","ieee","ifm","ikano","il","im","imamat","imdb","immo","immobilien","in","inc","industries","infiniti","info","ing","ink","institute","insurance","insure","int","international","intuit","investments","io","ipiranga","iq","ir","irish","is","ismaili","ist","istanbul","it","itau","itv","jaguar","java","jcb","je","jeep","jetzt","jewelry","jio","jll","jm","jmp","jnj","jo","jobs","joburg","jot","joy","jp","jpmorgan","jprs","juegos","juniper","kaufen","kddi","ke","kerryhotels","kerryproperties","kfh","kg","kh","ki","kia","kids","kim","kindle","kitchen","kiwi","km","kn","koeln","komatsu","kosher","kp","kpmg","kpn","kr","krd","kred","kuokgroup","kw","ky","kyoto","kz","la","lacaixa","lamborghini","lamer","land","landrover","lanxess","lasalle","lat","latino","latrobe","law","lawyer","lb","lc","lds","lease","leclerc","lefrak","legal","lego","lexus","lgbt","li","lidl","life","lifeinsurance","lifestyle","lighting","like","lilly","limited","limo","lincoln","link","live","living","lk","llc","llp","loan","loans","locker","locus","lol","london","lotte","lotto","love","lpl","lplfinancial","lr","ls","lt","ltd","ltda","lu","lundbeck","luxe","luxury","lv","ly","ma","madrid","maif","maison","makeup","man","management","mango","map","market","marketing","markets","marriott","marshalls","mattel","mba","mc","mckinsey","md","me","med","media","meet","melbourne","meme","memorial","men","menu","merckmsd","mg","mh","miami","microsoft","mil","mini","mint","mit","mitsubishi","mk","ml","mlb","mls","mm","mma","mn","mo","mobi","mobile","moda","moe","moi","mom","monash","money","monster","mormon","mortgage","moscow","moto","motorcycles","mov","movie","mp","mq","mr","ms","msd","mt","mtn","mtr","mu","museum","music","mv","mw","mx","my","mz","na","nab","nagoya","name","navy","nba","nc","ne","nec","net","netbank","netflix","network","neustar","new","news","next","nextdirect","nexus","nf","nfl","ng","ngo","nhk","ni","nico","nike","nikon","ninja","nissan","nissay","nl","no","nokia","norton","now","nowruz","nowtv","np","nr","nra","nrw","ntt","nu","nyc","nz","obi","observer","office","okinawa","olayan","olayangroup","ollo","om","omega","one","ong","onl","online","ooo","open","oracle","orange","org","organic","origins","osaka","otsuka","ott","ovh","pa","page","panasonic","paris","pars","partners","parts","party","pay","pccw","pe","pet","pf","pfizer","pg","ph","pharmacy","phd","philips","phone","photo","photography","photos","physio","pics","pictet","pictures","pid","pin","ping","pink","pioneer","pizza","pk","pl","place","play","playstation","plumbing","plus","pm","pn","pnc","pohl","poker","politie","porn","post","pr","praxi","press","prime","pro","prod","productions","prof","progressive","promo","properties","property","protection","pru","prudential","ps","pt","pub","pw","pwc","py","qa","qpon","quebec","quest","racing","radio","re","read","realestate","realtor","realty","recipes","red","redumbrella","rehab","reise","reisen","reit","reliance","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rexroth","rich","richardli","ricoh","ril","rio","rip","ro","rocks","rodeo","rogers","room","rs","rsvp","ru","rugby","ruhr","run","rw","rwe","ryukyu","sa","saarland","safe","safety","sakura","sale","salon","samsclub","samsung","sandvik","sandvikcoromant","sanofi","sap","sarl","sas","save","saxo","sb","sbi","sbs","sc","scb","schaeffler","schmidt","scholarships","school","schule","schwarz","science","scot","sd","se","search","seat","secure","security","seek","select","sener","services","seven","sew","sex","sexy","sfr","sg","sh","shangrila","sharp","shell","shia","shiksha","shoes","shop","shopping","shouji","show","si","silk","sina","singles","site","sj","sk","ski","skin","sky","skype","sl","sling","sm","smart","smile","sn","sncf","so","soccer","social","softbank","software","sohu","solar","solutions","song","sony","soy","spa","space","sport","spot","sr","srl","ss","st","stada","staples","star","statebank","statefarm","stc","stcgroup","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swatch","swiss","sx","sy","sydney","systems","sz","tab","taipei","talk","taobao","target","tatamotors","tatar","tattoo","tax","taxi","tc","tci","td","tdk","team","tech","technology","tel","temasek","tennis","teva","tf","tg","th","thd","theater","theatre","tiaa","tickets","tienda","tips","tires","tirol","tj","tjmaxx","tjx","tk","tkmaxx","tl","tm","tmall","tn","to","today","tokyo","tools","top","toray","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","travelers","travelersinsurance","trust","trv","tt","tube","tui","tunes","tushu","tv","tvs","tw","tz","ua","ubank","ubs","ug","uk","unicom","university","uno","uol","ups","us","uy","uz","va","vacations","vana","vanguard","vc","ve","vegas","ventures","verisign","vermögensberater","vermögensberatung","versicherung","vet","vg","vi","viajes","video","vig","viking","villas","vin","vip","virgin","visa","vision","viva","vivo","vlaanderen","vn","vodka","volvo","vote","voting","voto","voyage","vu","wales","walmart","walter","wang","wanggou","watch","watches","weather","weatherchannel","webcam","weber","website","wed","wedding","weibo","weir","wf","whoswho","wien","wiki","williamhill","win","windows","wine","winners","wme","wolterskluwer","woodside","work","works","world","wow","ws","wtc","wtf","xbox","xerox","xihuan","xin","xxx","xyz","yachts","yahoo","yamaxun","yandex","ye","yodobashi","yoga","yokohama","you","youtube","yt","yun","za","zappos","zara","zero","zip","zm","zone","zuerich","zw","ελ","ευ","бг","бел","дети","ею","католик","ком","мкд","мон","москва","онлайн","орг","рус","рф","сайт","срб","укр","қаз","հայ","ישראל","קום","ابوظبي","ارامكو","الاردن","البحرين","الجزائر","السعودية","العليان","المغرب","امارات","ایران","بارت","بازار","بيتك","بھارت","تونس","سودان","سورية","شبكة","عراق","عرب","عمان","فلسطين","قطر","كاثوليك","كوم","مصر","مليسيا","موريتانيا","موقع","همراه","پاکستان","ڀارت","कॉम","नेट","भारत","भारतम्","भारोत","संगठन","বাংলা","ভারত","ভাৰত","ਭਾਰਤ","ભારત","ଭାରତ","இந்தியா","இலங்கை","சிங்கப்பூர்","భారత్","ಭಾರತ","ഭാരതം","ලංකා","คอม","ไทย","ລາວ","გე","みんな","アマゾン","クラウド","グーグル","コム","ストア","セール","ファッション","ポイント","世界","中信","中国","中國","中文网","亚马逊","企业","佛山","信息","健康","八卦","公司","公益","台湾","台灣","商城","商店","商标","嘉里","嘉里大酒店","在线","大拿","天主教","娱乐","家電","广东","微博","慈善","我爱你","手机","招聘","政务","政府","新加坡","新闻","时尚","書籍","机构","淡马锡","游戏","澳門","点看","移动","组织机构","网址","网店","网站","网络","联通","谷歌","购物","通販","集团","電訊盈科","飞利浦","食品","餐厅","香格里拉","香港","닷넷","닷컴","삼성","한국"]');var Ro={},AP;function aI(){return AP||(AP=1,Object.defineProperty(Ro,"__esModule",{value:!0}),Ro.TAG_REGEX=Ro.TRAILING_PUNCTUATION_REGEX=Ro.URL_REGEX=Ro.MENTION_REGEX=void 0,Ro.MENTION_REGEX=/(^|\s|\()(@)([a-zA-Z0-9.-]+)(\b)/g,Ro.URL_REGEX=/(^|\s|\()((https?:\/\/[\S]+)|((?<domain>[a-z][a-z0-9]*(\.[a-z0-9]+)+)[\S]*))/gim,Ro.TRAILING_PUNCTUATION_REGEX=new RegExp("\\p{P}+$","gu"),Ro.TAG_REGEX=/(^|\s)[#＃]((?!\ufe0f)[^\s\u00AD\u2060\u200A\u200B\u200C\u200D\u20e2]*[^\d\s\p{P}\u00AD\u2060\u200A\u200B\u200C\u200D\u20e2]+[^\s\u00AD\u2060\u200A\u200B\u200C\u200D\u20e2]*)?/gu),Ro}var RP;function cK(){if(RP)return Dp;RP=1;var i=Dp&&Dp.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(Dp,"__esModule",{value:!0}),Dp.detectFacets=c;const n=i(uK),a=aI();function c(y){let e;const l=[];{const _=a.MENTION_REGEX;for(;e=_.exec(y.utf16);){if(!f(e[3])&&!e[3].endsWith(".test"))continue;const w=y.utf16.indexOf(e[3],e.index)-1;l.push({$type:"app.bsky.richtext.facet",index:{byteStart:y.utf16IndexToUtf8Index(w),byteEnd:y.utf16IndexToUtf8Index(w+e[3].length+1)},features:[{$type:"app.bsky.richtext.facet#mention",did:e[3]}]})}}{const _=a.URL_REGEX;for(;e=_.exec(y.utf16);){let w=e[2];if(!w.startsWith("http")){const I=e.groups?.domain;if(!I||!f(I))continue;w=`https://${w}`}const R=y.utf16.indexOf(e[2],e.index),C={start:R,end:R+e[2].length};/[.,;:!?]$/.test(w)&&(w=w.slice(0,-1),C.end--),/[)]$/.test(w)&&!w.includes("(")&&(w=w.slice(0,-1),C.end--),l.push({index:{byteStart:y.utf16IndexToUtf8Index(C.start),byteEnd:y.utf16IndexToUtf8Index(C.end)},features:[{$type:"app.bsky.richtext.facet#link",uri:w}]})}}{const _=a.TAG_REGEX;for(;e=_.exec(y.utf16);){const w=e[1];let R=e[2];if(!R||(R=R.trim().replace(a.TRAILING_PUNCTUATION_REGEX,""),R.length===0||R.length>64))continue;const C=e.index+w.length;l.push({index:{byteStart:y.utf16IndexToUtf8Index(C),byteEnd:y.utf16IndexToUtf8Index(C+1+R.length)},features:[{$type:"app.bsky.richtext.facet#tag",tag:R}]})}}return l.length>0?l:void 0}function f(y){return!!n.default.find(e=>{const l=y.lastIndexOf(e);return l===-1?!1:y.charAt(l-1)==="."&&l===y.length-e.length})}return Dp}var wb={},Uh={},SP;function n1(){if(SP)return Uh;SP=1,Object.defineProperty(Uh,"__esModule",{value:!0}),Uh.UnicodeString=void 0;const i=$a(),n=new TextEncoder,a=new TextDecoder;class c{constructor(y){Object.defineProperty(this,"utf16",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"utf8",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_graphemeLen",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.utf16=y,this.utf8=n.encode(y)}get length(){return this.utf8.byteLength}get graphemeLength(){return this._graphemeLen||(this._graphemeLen=(0,i.graphemeLen)(this.utf16)),this._graphemeLen}slice(y,e){return a.decode(this.utf8.slice(y,e))}utf16IndexToUtf8Index(y){return n.encode(this.utf16.slice(0,y)).byteLength}toString(){return this.utf16}}return Uh.UnicodeString=c,Uh}var TP;function lI(){if(TP)return wb;TP=1,Object.defineProperty(wb,"__esModule",{value:!0}),wb.sanitizeRichText=c;const i=n1(),n=/[\r\n]([\u00AD\u2060\u200D\u200C\u200B\s]*[\r\n]){2,}/,a=`

`;function c(y,e){return e.cleanNewlines&&(y=f(y,n,a)),y}function f(y,e,l){y=y.clone();let _=y.unicodeText.utf16.match(e);for(;_&&typeof _.index<"u";){const w=y.unicodeText,R=y.unicodeText.utf16IndexToUtf8Index(_.index),C=R+new i.UnicodeString(_[0]).length;if(y.delete(R,C),y.unicodeText.utf16===w.utf16)break;y.insert(R,l),_=y.unicodeText.utf16.match(e)}return y}return wb}var CP;function dK(){if(CP)return Qu;CP=1,Object.defineProperty(Qu,"__esModule",{value:!0}),Qu.RichText=Qu.RichTextSegment=void 0;const i=Yl(),n=cK(),a=lI(),c=n1();class f{constructor(C,I){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:C}),Object.defineProperty(this,"facet",{enumerable:!0,configurable:!0,writable:!0,value:I})}get link(){return this.facet?.features.find(i.AppBskyRichtextFacet.isLink)}isLink(){return!!this.link}get mention(){return this.facet?.features.find(i.AppBskyRichtextFacet.isMention)}isMention(){return!!this.mention}get tag(){return this.facet?.features.find(i.AppBskyRichtextFacet.isTag)}isTag(){return!!this.tag}}Qu.RichTextSegment=f;class y{constructor(C,I){Object.defineProperty(this,"unicodeText",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"facets",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.unicodeText=new c.UnicodeString(C.text),this.facets=C.facets,!this.facets?.length&&C.entities?.length&&(this.facets=_(this.unicodeText,C.entities)),this.facets&&(this.facets=this.facets.filter(l).sort(e)),I?.cleanNewlines&&(0,a.sanitizeRichText)(this,{cleanNewlines:!0}).copyInto(this)}get text(){return this.unicodeText.toString()}get length(){return this.unicodeText.length}get graphemeLength(){return this.unicodeText.graphemeLength}clone(){return new y({text:this.unicodeText.utf16,facets:w(this.facets)})}copyInto(C){C.unicodeText=this.unicodeText,C.facets=w(this.facets)}*segments(){const C=this.facets||[];if(!C.length){yield new f(this.unicodeText.utf16);return}let I=0,L=0;do{const O=C[L];if(I<O.index.byteStart)yield new f(this.unicodeText.slice(I,O.index.byteStart));else if(I>O.index.byteStart){L++;continue}if(O.index.byteStart<O.index.byteEnd){const q=this.unicodeText.slice(O.index.byteStart,O.index.byteEnd);q.trim()?yield new f(q,O):yield new f(q)}I=O.index.byteEnd,L++}while(L<C.length);I<this.unicodeText.length&&(yield new f(this.unicodeText.slice(I,this.unicodeText.length)))}insert(C,I){if(this.unicodeText=new c.UnicodeString(this.unicodeText.slice(0,C)+I+this.unicodeText.slice(C)),!this.facets?.length)return this;const L=I.length;for(const O of this.facets)C<=O.index.byteStart?(O.index.byteStart+=L,O.index.byteEnd+=L):C>=O.index.byteStart&&C<O.index.byteEnd&&(O.index.byteEnd+=L);return this}delete(C,I){if(this.unicodeText=new c.UnicodeString(this.unicodeText.slice(0,C)+this.unicodeText.slice(I)),!this.facets?.length)return this;const L=I-C;for(const O of this.facets)C<=O.index.byteStart&&I>=O.index.byteEnd?(O.index.byteStart=0,O.index.byteEnd=0):C>O.index.byteEnd||(C>O.index.byteStart&&C<=O.index.byteEnd&&I>O.index.byteEnd?O.index.byteEnd=C:C>=O.index.byteStart&&I<=O.index.byteEnd?O.index.byteEnd-=L:C<O.index.byteStart&&I>=O.index.byteStart&&I<=O.index.byteEnd?(O.index.byteStart=C,O.index.byteEnd-=L):I<O.index.byteStart&&(O.index.byteStart-=L,O.index.byteEnd-=L));return this.facets=this.facets.filter(O=>O.index.byteStart<O.index.byteEnd),this}async detectFacets(C){if(this.facets=(0,n.detectFacets)(this.unicodeText),this.facets){const I=[];for(const L of this.facets)for(const O of L.features)i.AppBskyRichtextFacet.isMention(O)&&I.push(C.com.atproto.identity.resolveHandle({handle:O.did}).then(q=>q?.data.did).catch(q=>{}).then(q=>{O.did=q||""}));await Promise.allSettled(I),this.facets.sort(e)}}detectFacetsWithoutResolution(){this.facets=(0,n.detectFacets)(this.unicodeText),this.facets&&this.facets.sort(e)}}Qu.RichText=y;const e=(R,C)=>R.index.byteStart-C.index.byteStart,l=R=>R.index.byteStart<=R.index.byteEnd;function _(R,C){const I=[];for(const L of C)L.type==="link"?I.push({$type:"app.bsky.richtext.facet",index:{byteStart:R.utf16IndexToUtf8Index(L.index.start),byteEnd:R.utf16IndexToUtf8Index(L.index.end)},features:[{$type:"app.bsky.richtext.facet#link",uri:L.value}]}):L.type==="mention"&&I.push({$type:"app.bsky.richtext.facet",index:{byteStart:R.utf16IndexToUtf8Index(L.index.start),byteEnd:R.utf16IndexToUtf8Index(L.index.end)},features:[{$type:"app.bsky.richtext.facet#mention",did:L.value}]});return I}function w(R){return typeof R>"u"?R:JSON.parse(JSON.stringify(R))}return Qu}var W0={},jh={},ec={},kP;function s1(){return kP||(kP=1,Object.defineProperty(ec,"__esModule",{value:!0}),ec.LABELS=ec.DEFAULT_LABEL_SETTINGS=void 0,ec.DEFAULT_LABEL_SETTINGS={porn:"hide",sexual:"warn",nudity:"ignore","graphic-media":"warn"},ec.LABELS={"!hide":{identifier:"!hide",configurable:!1,defaultSetting:"hide",flags:["no-override","no-self"],severity:"alert",blurs:"content",behaviors:{account:{profileList:"blur",profileView:"blur",avatar:"blur",banner:"blur",displayName:"blur",contentList:"blur",contentView:"blur"},profile:{avatar:"blur",banner:"blur",displayName:"blur"},content:{contentList:"blur",contentView:"blur"}},locales:[]},"!warn":{identifier:"!warn",configurable:!1,defaultSetting:"warn",flags:["no-self"],severity:"none",blurs:"content",behaviors:{account:{profileList:"blur",profileView:"blur",avatar:"blur",banner:"blur",contentList:"blur",contentView:"blur"},profile:{avatar:"blur",banner:"blur",displayName:"blur"},content:{contentList:"blur",contentView:"blur"}},locales:[]},"!no-unauthenticated":{identifier:"!no-unauthenticated",configurable:!1,defaultSetting:"hide",flags:["no-override","unauthed"],severity:"none",blurs:"content",behaviors:{account:{profileList:"blur",profileView:"blur",avatar:"blur",banner:"blur",displayName:"blur",contentList:"blur",contentView:"blur"},profile:{avatar:"blur",banner:"blur",displayName:"blur"},content:{contentList:"blur",contentView:"blur"}},locales:[]},porn:{identifier:"porn",configurable:!0,defaultSetting:"hide",flags:["adult"],severity:"none",blurs:"media",behaviors:{account:{avatar:"blur",banner:"blur"},profile:{avatar:"blur",banner:"blur"},content:{contentMedia:"blur"}},locales:[]},sexual:{identifier:"sexual",configurable:!0,defaultSetting:"warn",flags:["adult"],severity:"none",blurs:"media",behaviors:{account:{avatar:"blur",banner:"blur"},profile:{avatar:"blur",banner:"blur"},content:{contentMedia:"blur"}},locales:[]},nudity:{identifier:"nudity",configurable:!0,defaultSetting:"ignore",flags:[],severity:"none",blurs:"media",behaviors:{account:{avatar:"blur",banner:"blur"},profile:{avatar:"blur",banner:"blur"},content:{contentMedia:"blur"}},locales:[]},"graphic-media":{identifier:"graphic-media",flags:["adult"],configurable:!0,defaultSetting:"warn",severity:"none",blurs:"media",behaviors:{account:{avatar:"blur",banner:"blur"},profile:{avatar:"blur",banner:"blur"},content:{contentMedia:"blur"}},locales:[]},gore:{identifier:"gore",flags:["adult"],configurable:!0,defaultSetting:"warn",severity:"none",blurs:"media",behaviors:{account:{avatar:"blur",banner:"blur"},profile:{avatar:"blur",banner:"blur"},content:{contentMedia:"blur"}},locales:[]}}),ec}var ns={},PP;function uI(){return PP||(PP=1,Object.defineProperty(ns,"__esModule",{value:!0}),ns.NOOP_BEHAVIOR=ns.HIDE_BEHAVIOR=ns.MUTEWORD_BEHAVIOR=ns.MUTE_BEHAVIOR=ns.BLOCK_BEHAVIOR=ns.CUSTOM_LABEL_VALUE_RE=void 0,ns.CUSTOM_LABEL_VALUE_RE=/^[a-z-]+$/,ns.BLOCK_BEHAVIOR={profileList:"blur",profileView:"alert",avatar:"blur",banner:"blur",contentList:"blur",contentView:"blur"},ns.MUTE_BEHAVIOR={profileList:"inform",profileView:"alert",contentList:"blur",contentView:"inform"},ns.MUTEWORD_BEHAVIOR={contentList:"blur",contentView:"blur"},ns.HIDE_BEHAVIOR={contentList:"blur",contentView:"blur"},ns.NOOP_BEHAVIOR={}),ns}var Nh={},LP;function cI(){if(LP)return Nh;LP=1,Object.defineProperty(Nh,"__esModule",{value:!0}),Nh.ModerationUI=void 0;class i{constructor(){Object.defineProperty(this,"noOverride",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"filters",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"blurs",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"alerts",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"informs",{enumerable:!0,configurable:!0,writable:!0,value:[]})}get filter(){return this.filters.length!==0}get blur(){return this.blurs.length!==0}get alert(){return this.alerts.length!==0}get inform(){return this.informs.length!==0}}return Nh.ModerationUI=i,Nh}var DP;function Zl(){if(DP)return jh;DP=1,Object.defineProperty(jh,"__esModule",{value:!0}),jh.ModerationDecision=void 0;const i=s1(),n=uI(),a=cI();var c;(function(l){l[l.High=0]="High",l[l.Medium=1]="Medium",l[l.Low=2]="Low"})(c||(c={}));class f{constructor(){Object.defineProperty(this,"did",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"isMe",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"causes",{enumerable:!0,configurable:!0,writable:!0,value:[]})}static merge(..._){const w=_.filter(C=>C!=null),R=new f;return w[0]&&(R.did=w[0].did,R.isMe=w[0].isMe),R.causes=w.flatMap(C=>C.causes),R}downgrade(){for(const _ of this.causes)_.downgraded=!0;return this}get blocked(){return!!this.blockCause}get muted(){return!!this.muteCause}get blockCause(){return this.causes.find(_=>_.type==="blocking"||_.type==="blocked-by"||_.type==="block-other")}get muteCause(){return this.causes.find(_=>_.type==="muted")}get labelCauses(){return this.causes.filter(_=>_.type==="label")}ui(_){const w=new a.ModerationUI;for(const R of this.causes)if(R.type==="blocking"||R.type==="blocked-by"||R.type==="block-other"){if(this.isMe)continue;(_==="profileList"||_==="contentList")&&w.filters.push(R),R.downgraded||(n.BLOCK_BEHAVIOR[_]==="blur"?(w.noOverride=!0,w.blurs.push(R)):n.BLOCK_BEHAVIOR[_]==="alert"?w.alerts.push(R):n.BLOCK_BEHAVIOR[_]==="inform"&&w.informs.push(R))}else if(R.type==="muted"){if(this.isMe)continue;(_==="profileList"||_==="contentList")&&w.filters.push(R),R.downgraded||(n.MUTE_BEHAVIOR[_]==="blur"?w.blurs.push(R):n.MUTE_BEHAVIOR[_]==="alert"?w.alerts.push(R):n.MUTE_BEHAVIOR[_]==="inform"&&w.informs.push(R))}else if(R.type==="mute-word"){if(this.isMe)continue;_==="contentList"&&w.filters.push(R),R.downgraded||(n.MUTEWORD_BEHAVIOR[_]==="blur"?w.blurs.push(R):n.MUTEWORD_BEHAVIOR[_]==="alert"?w.alerts.push(R):n.MUTEWORD_BEHAVIOR[_]==="inform"&&w.informs.push(R))}else R.type==="hidden"?((_==="profileList"||_==="contentList")&&w.filters.push(R),R.downgraded||(n.HIDE_BEHAVIOR[_]==="blur"?w.blurs.push(R):n.HIDE_BEHAVIOR[_]==="alert"?w.alerts.push(R):n.HIDE_BEHAVIOR[_]==="inform"&&w.informs.push(R))):R.type==="label"&&(_==="profileList"&&R.target==="account"?R.setting==="hide"&&!this.isMe&&w.filters.push(R):_==="contentList"&&(R.target==="account"||R.target==="content")&&R.setting==="hide"&&!this.isMe&&w.filters.push(R),R.downgraded||(R.behavior[_]==="blur"?(w.blurs.push(R),R.noOverride&&!this.isMe&&(w.noOverride=!0)):R.behavior[_]==="alert"?w.alerts.push(R):R.behavior[_]==="inform"&&w.informs.push(R)));return w.filters.sort(e),w.blurs.sort(e),w}setDid(_){this.did=_}setIsMe(_){this.isMe=_}addHidden(_){_&&this.causes.push({type:"hidden",source:{type:"user"},priority:6})}addMutedWord(_){_?.length&&this.causes.push({type:"mute-word",source:{type:"user"},priority:6,matches:_})}addBlocking(_){_&&this.causes.push({type:"blocking",source:{type:"user"},priority:3})}addBlockingByList(_){_&&this.causes.push({type:"blocking",source:{type:"list",list:_},priority:3})}addBlockedBy(_){_&&this.causes.push({type:"blocked-by",source:{type:"user"},priority:4})}addBlockOther(_){_&&this.causes.push({type:"block-other",source:{type:"user"},priority:4})}addLabel(_,w,R){const C=n.CUSTOM_LABEL_VALUE_RE.test(w.val)&&R.labelDefs?.[w.src]?.find(ne=>ne.identifier===w.val)||i.LABELS[w.val];if(!C)return;const I=w.src===this.did,L=I?void 0:R.prefs.labelers.find(ne=>ne.did===w.src);if(!I&&!L||I&&C.flags.includes("no-self"))return;let O=C.defaultSetting||"ignore";if(C.configurable?C.flags.includes("adult")&&!R.prefs.adultContentEnabled?O="hide":L?.labels[C.identifier]?O=L?.labels[C.identifier]:R.prefs.labels[C.identifier]&&(O=R.prefs.labels[C.identifier]):O=C.defaultSetting||"hide",O==="ignore"||C.flags.includes("unauthed")&&R.userDid)return;let q;const G=y(C.behaviors[_]);C.flags.includes("no-override")||C.flags.includes("adult")&&!R.prefs.adultContentEnabled?q=1:O==="hide"?q=2:G===c.High?q=5:G===c.Medium?q=7:q=8;let j=!1;(C.flags.includes("no-override")||C.flags.includes("adult")&&!R.prefs.adultContentEnabled)&&(j=!0),this.causes.push({type:"label",source:I||!L?{type:"user"}:{type:"labeler",did:L.did},label:w,labelDef:C,target:_,setting:O,behavior:C.behaviors[_]||n.NOOP_BEHAVIOR,noOverride:j,priority:q})}addMuted(_){_&&this.causes.push({type:"muted",source:{type:"user"},priority:6})}addMutedByList(_){_&&this.causes.push({type:"muted",source:{type:"list",list:_},priority:6})}}jh.ModerationDecision=f;function y(l){return l?l.profileView==="blur"||l.contentView==="blur"?c.High:l.contentList==="blur"||l.contentMedia==="blur"?c.Medium:c.Low:c.Low}function e(l,_){return l.priority-_.priority}return jh}var Fh={},IP;function pm(){if(IP)return Fh;IP=1,Object.defineProperty(Fh,"__esModule",{value:!0}),Fh.decideAccount=n,Fh.filterAccountLabels=a;const i=Zl();function n(c,f){const y=new i.ModerationDecision;y.setDid(c.did),y.setIsMe(c.did===f.userDid),c.viewer?.muted&&(c.viewer?.mutedByList?y.addMutedByList(c.viewer?.mutedByList):y.addMuted(c.viewer?.muted)),c.viewer?.blocking&&(c.viewer?.blockingByList?y.addBlockingByList(c.viewer?.blockingByList):y.addBlocking(c.viewer?.blocking)),y.addBlockedBy(c.viewer?.blockedBy);for(const e of a(c.labels))y.addLabel("account",e,f);return y}function a(c){return c?c.filter(f=>!f.uri.endsWith("/app.bsky.actor.profile/self")||f.val==="!no-unauthenticated"):[]}return Fh}var Eb={},qh={},BP;function fm(){if(BP)return qh;BP=1,Object.defineProperty(qh,"__esModule",{value:!0}),qh.decideProfile=n,qh.filterProfileLabels=a;const i=Zl();function n(c,f){const y=new i.ModerationDecision;y.setDid(c.did),y.setIsMe(c.did===f.userDid);for(const e of a(c.labels))y.addLabel("profile",e,f);return y}function a(c){return c?c.filter(f=>f.uri.endsWith("/app.bsky.actor.profile/self")):[]}return qh}var MP;function pK(){if(MP)return Eb;MP=1,Object.defineProperty(Eb,"__esModule",{value:!0}),Eb.decideFeedGenerator=c;const i=Zl(),n=pm(),a=fm();function c(f,y){const e=new i.ModerationDecision;if(e.setDid(f.creator.did),e.setIsMe(f.creator.did===y.userDid),f.labels?.length)for(const l of f.labels)e.addLabel("content",l,y);return i.ModerationDecision.merge(e,(0,n.decideAccount)(f.creator,y),(0,a.decideProfile)(f.creator,y))}return Eb}var Ab={},zP;function fK(){if(zP)return Ab;zP=1,Object.defineProperty(Ab,"__esModule",{value:!0}),Ab.decideNotification=c;const i=Zl(),n=pm(),a=fm();function c(f,y){const e=new i.ModerationDecision;if(e.setDid(f.author.did),e.setIsMe(f.author.did===y.userDid),f.labels?.length)for(const l of f.labels)e.addLabel("content",l,y);return i.ModerationDecision.merge(e,(0,n.decideAccount)(f.author,y),(0,a.decideProfile)(f.author,y))}return Ab}var Rb={},Kh={},OP;function dI(){if(OP)return Kh;OP=1,Object.defineProperty(Kh,"__esModule",{value:!0}),Kh.matchMuteWords=c,Kh.hasMutedWord=f;const i=Yl(),n={LEADING_TRAILING_PUNCTUATION:new RegExp("(?:^\\p{P}+|\\p{P}+$)","gu"),WORD_BOUNDARY:/[\s\n\t\r\f\v]+?/g},a=["ja","zh","ko","th","vi"];function c({mutedWords:y,text:e,facets:l,outlineTags:_,languages:w,actor:R}){const C=a.includes(w?.[0]||""),I=[].concat(_||[]).concat((l||[]).flatMap(O=>O.features.filter(i.AppBskyRichtextFacet.isTag).map(q=>q.tag))).map(O=>O.toLowerCase()),L=[];e:for(const O of y){const q=O.value.toLowerCase(),G=e.toLowerCase();if(O.expiresAt&&O.expiresAt<new Date().toISOString()||O.actorTarget==="exclude-following"&&R?.viewer?.following)continue;if(I.includes(q)){L.push({word:O,predicate:O.value});continue}if(!O.targets.includes("content"))continue;if((q.length===1||C)&&G.includes(q)){L.push({word:O,predicate:O.value});continue}if(q.length>G.length)continue;if(q===G){L.push({word:O,predicate:O.value});continue}if(new RegExp("(?:\\s|\\p{P})+?","u").test(q)&&G.includes(q)){L.push({word:O,predicate:O.value});continue}const j=G.split(n.WORD_BOUNDARY);for(const ne of j){if(ne===q){L.push({word:O,predicate:ne});continue e}const he=ne.replace(n.LEADING_TRAILING_PUNCTUATION,"");if(q===he){L.push({word:O,predicate:ne});continue e}if(!(q.length>he.length)&&new RegExp("\\p{P}+","u").test(he)){if(/[/]+/.test(he))continue e;const Q=he.replace(new RegExp("\\p{P}+","gu")," ");if(Q===q){L.push({word:O,predicate:ne});continue e}if(Q.replace(/\s/gu,"")===q){L.push({word:O,predicate:ne});continue e}const we=he.split(new RegExp("\\p{P}+","u"));for(const ze of we)if(ze===q){L.push({word:O,predicate:ne});continue e}}}}return L.length?L:void 0}function f(y){return!!c(y)}return Kh}var VP;function hK(){if(VP)return Rb;VP=1,Object.defineProperty(Rb,"__esModule",{value:!0}),Rb.decidePost=y;const i=Yl(),n=Zl(),a=dI(),c=pm(),f=fm();function y(I,L){return n.ModerationDecision.merge(e(I,L),l(I.embed,L)?.downgrade(),(0,c.decideAccount)(I.author,L),(0,f.decideProfile)(I.author,L))}function e(I,L){const O=new n.ModerationDecision;if(O.setDid(I.author.did),O.setIsMe(I.author.did===L.userDid),I.labels?.length)for(const q of I.labels)O.addLabel("content",q,L);return O.addHidden(R(I,L.prefs.hiddenPosts)),O.isMe||O.addMutedWord(C(I,L.prefs.mutedWords)),O}function l(I,L){if(I){if((i.AppBskyEmbedRecord.isView(I)||i.AppBskyEmbedRecordWithMedia.isView(I))&&i.AppBskyEmbedRecord.isViewRecord(I.record))return _(I.record,L);if(i.AppBskyEmbedRecordWithMedia.isView(I)&&i.AppBskyEmbedRecord.isViewRecord(I.record.record))return _(I.record.record,L);if((i.AppBskyEmbedRecord.isView(I)||i.AppBskyEmbedRecordWithMedia.isView(I))&&i.AppBskyEmbedRecord.isViewBlocked(I.record))return w(I.record,L);if(i.AppBskyEmbedRecordWithMedia.isView(I)&&i.AppBskyEmbedRecord.isViewBlocked(I.record.record))return w(I.record.record,L)}}function _(I,L){const O=new n.ModerationDecision;if(O.setDid(I.author.did),O.setIsMe(I.author.did===L.userDid),I.labels?.length)for(const q of I.labels)O.addLabel("content",q,L);return n.ModerationDecision.merge(O,(0,c.decideAccount)(I.author,L),(0,f.decideProfile)(I.author,L))}function w(I,L){const O=new n.ModerationDecision;return O.setDid(I.author.did),O.setIsMe(I.author.did===L.userDid),I.author.viewer?.muted&&(I.author.viewer?.mutedByList?O.addMutedByList(I.author.viewer?.mutedByList):O.addMuted(I.author.viewer?.muted)),I.author.viewer?.blocking&&(I.author.viewer?.blockingByList?O.addBlockingByList(I.author.viewer?.blockingByList):O.addBlocking(I.author.viewer?.blocking)),O.addBlockedBy(I.author.viewer?.blockedBy),O}function R(I,L){return L?.length?!!(L.includes(I.uri)||I.embed&&(i.AppBskyEmbedRecord.isView(I.embed)&&i.AppBskyEmbedRecord.isViewRecord(I.embed.record)&&L.includes(I.embed.record.uri)||i.AppBskyEmbedRecordWithMedia.isView(I.embed)&&i.AppBskyEmbedRecord.isViewRecord(I.embed.record.record)&&L.includes(I.embed.record.record.uri))):!1}function C(I,L){if(!L?.length)return;const O=I.author;if(i.AppBskyFeedPost.isRecord(I.record)){const G=I.record,j=(0,a.matchMuteWords)({mutedWords:L,text:G.text,facets:G.facets,outlineTags:G.tags,languages:G.langs,actor:O});if(j)return j;if(G.embed&&i.AppBskyEmbedImages.isMain(G.embed))for(const ne of G.embed.images){const he=(0,a.matchMuteWords)({mutedWords:L,text:ne.alt,languages:G.langs,actor:O});if(he)return he}}const{embed:q}=I;if(q){if((i.AppBskyEmbedRecord.isView(q)||i.AppBskyEmbedRecordWithMedia.isView(q))&&i.AppBskyEmbedRecord.isViewRecord(q.record)){if(i.AppBskyFeedPost.isRecord(q.record.value)){const G=q.record.value,j=q.record.author,ne=(0,a.matchMuteWords)({mutedWords:L,text:G.text,facets:G.facets,outlineTags:G.tags,languages:G.langs,actor:j});if(ne)return ne;if(i.AppBskyEmbedImages.isMain(G.embed))for(const he of G.embed.images){const Q=(0,a.matchMuteWords)({mutedWords:L,text:he.alt,languages:G.langs,actor:j});if(Q)return Q}if(i.AppBskyEmbedExternal.isMain(G.embed)){const{external:he}=G.embed,Q=(0,a.matchMuteWords)({mutedWords:L,text:he.title+" "+he.description,languages:[],actor:j});if(Q)return Q}if(i.AppBskyEmbedRecordWithMedia.isMain(G.embed)){if(i.AppBskyEmbedExternal.isMain(G.embed.media)){const{external:he}=G.embed.media,Q=(0,a.matchMuteWords)({mutedWords:L,text:he.title+" "+he.description,languages:[],actor:j});if(Q)return Q}if(i.AppBskyEmbedImages.isMain(G.embed.media))for(const he of G.embed.media.images){const Q=(0,a.matchMuteWords)({mutedWords:L,text:he.alt,languages:i.AppBskyFeedPost.isRecord(G.record)?G.langs:[],actor:j});if(Q)return Q}}}}else if(i.AppBskyEmbedExternal.isView(q)){const{external:G}=q,j=(0,a.matchMuteWords)({mutedWords:L,text:G.title+" "+G.description,languages:[],actor:O});if(j)return j}else if(i.AppBskyEmbedRecordWithMedia.isView(q)&&i.AppBskyEmbedRecord.isViewRecord(q.record.record)){const G=q.record.record.author;if(i.AppBskyFeedPost.isRecord(q.record.record.value)){const j=q.record.record.value,ne=(0,a.matchMuteWords)({mutedWords:L,text:j.text,facets:j.facets,outlineTags:j.tags,languages:j.langs,actor:G});if(ne)return ne}if(i.AppBskyEmbedImages.isView(q.media))for(const j of q.media.images){const ne=(0,a.matchMuteWords)({mutedWords:L,text:j.alt,languages:i.AppBskyFeedPost.isRecord(I.record)?I.record.langs:[],actor:G});if(ne)return ne}if(i.AppBskyEmbedExternal.isView(q.media)){const{external:j}=q.media,ne=(0,a.matchMuteWords)({mutedWords:L,text:j.title+" "+j.description,languages:[],actor:G});if(ne)return ne}}}}return Rb}var Sb={},UP;function mK(){if(UP)return Sb;UP=1,Object.defineProperty(Sb,"__esModule",{value:!0}),Sb.decideUserList=f;const i=Hp(),n=Zl(),a=pm(),c=fm();function f(e,l){const _=new n.ModerationDecision,w="creator"in e&&y(e.creator)?e.creator:void 0;if(w){if(_.setDid(w.did),_.setIsMe(w.did===l.userDid),e.labels?.length)for(const C of e.labels)_.addLabel("content",C,l);return n.ModerationDecision.merge(_,(0,a.decideAccount)(w,l),(0,c.decideProfile)(w,l))}const R=new i.AtUri(e.uri).hostname;if(_.setDid(R),_.setIsMe(R===l.userDid),e.labels?.length)for(const C of e.labels)_.addLabel("content",C,l);return _}function y(e){return e&&typeof e=="object"&&"did"in e}return Sb}var tc={},jP;function yK(){if(jP)return tc;jP=1,Object.defineProperty(tc,"__esModule",{value:!0}),tc.isQuotedPost=a,tc.isQuotedPostWithMedia=c,tc.interpretLabelValueDefinition=f,tc.interpretLabelValueDefinitions=y;const i=Yl(),n=fe();function a(e){return!!(e&&i.AppBskyEmbedRecord.isView(e))}function c(e){return!!(e&&i.AppBskyEmbedRecordWithMedia.isView(e))}function f(e,l){const _={account:{},profile:{},content:{}},w=e.severity==="alert"?"alert":e.severity==="inform"?"inform":void 0;e.blurs==="content"?(_.account.profileList=w,_.account.profileView=w,_.account.contentList="blur",_.account.contentView=e.adultOnly?"blur":w,_.profile.profileList=w,_.profile.profileView=w,_.content.contentList="blur",_.content.contentView=e.adultOnly?"blur":w):e.blurs==="media"?(_.account.profileList=w,_.account.profileView=w,_.account.avatar="blur",_.account.banner="blur",_.profile.profileList=w,_.profile.profileView=w,_.profile.avatar="blur",_.profile.banner="blur",_.content.contentMedia="blur"):e.blurs==="none"&&(_.account.profileList=w,_.account.profileView=w,_.account.contentList=w,_.account.contentView=w,_.profile.profileList=w,_.profile.profileView=w,_.content.contentList=w,_.content.contentView=w);let R="warn";(e.defaultSetting==="hide"||e.defaultSetting==="ignore")&&(R=e.defaultSetting);const C=["no-self"];return e.adultOnly&&C.push("adult"),{...e,definedBy:l,configurable:!0,defaultSetting:R,flags:C,behaviors:_}}function y(e){return(e.policies?.labelValueDefinitions||[]).filter((0,n.asPredicate)(i.ComAtprotoLabelDefs.validateLabelValueDefinition)).map(l=>f(l,e.creator.did))}return tc}var NP;function pI(){return NP||(NP=1,(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.interpretLabelValueDefinitions=i.interpretLabelValueDefinition=i.matchMuteWords=i.hasMutedWord=i.ModerationDecision=i.ModerationUI=void 0,i.moderateProfile=I,i.moderatePost=L,i.moderateNotification=O,i.moderateFeedGenerator=q,i.moderateUserList=G;const n=Zl(),a=pm(),c=pK(),f=fK(),y=hK(),e=fm(),l=mK();var _=cI();Object.defineProperty(i,"ModerationUI",{enumerable:!0,get:function(){return _.ModerationUI}});var w=Zl();Object.defineProperty(i,"ModerationDecision",{enumerable:!0,get:function(){return w.ModerationDecision}});var R=dI();Object.defineProperty(i,"hasMutedWord",{enumerable:!0,get:function(){return R.hasMutedWord}}),Object.defineProperty(i,"matchMuteWords",{enumerable:!0,get:function(){return R.matchMuteWords}});var C=yK();Object.defineProperty(i,"interpretLabelValueDefinition",{enumerable:!0,get:function(){return C.interpretLabelValueDefinition}}),Object.defineProperty(i,"interpretLabelValueDefinitions",{enumerable:!0,get:function(){return C.interpretLabelValueDefinitions}});function I(j,ne){return n.ModerationDecision.merge((0,a.decideAccount)(j,ne),(0,e.decideProfile)(j,ne))}function L(j,ne){return(0,y.decidePost)(j,ne)}function O(j,ne){return(0,f.decideNotification)(j,ne)}function q(j,ne){return(0,c.decideFeedGenerator)(j,ne)}function G(j,ne){return(0,l.decideUserList)(j,ne)}})(W0)),W0}var Gh={},FP;function gK(){if(FP)return Gh;FP=1,Object.defineProperty(Gh,"__esModule",{value:!0}),Gh.mock=void 0;const i="bafyreiclp443lavogvhj3d2ob2cxbfuscni2k5jk7bebjzg7khl3esabwq";return Gh.mock={post({text:n,facets:a,reply:c,embed:f}){return{$type:"app.bsky.feed.post",text:n,facets:a,reply:c,embed:f,langs:["en"],createdAt:new Date().toISOString()}},postView({record:n,author:a,embed:c,replyCount:f,repostCount:y,likeCount:e,viewer:l,labels:_}){return{$type:"app.bsky.feed.defs#postView",uri:`at://${a.did}/app.bsky.feed.post/fake`,cid:i,author:a,record:n,embed:c,replyCount:f,repostCount:y,likeCount:e,indexedAt:new Date().toISOString(),viewer:l,labels:_}},embedRecordView({record:n,author:a,labels:c}){return{$type:"app.bsky.embed.record#view",record:{$type:"app.bsky.embed.record#viewRecord",uri:`at://${a.did}/app.bsky.feed.post/fake`,cid:i,author:a,value:n,labels:c,indexedAt:new Date().toISOString()}}},profileViewBasic({handle:n,displayName:a,description:c,viewer:f,labels:y}){return{did:`did:web:${n}`,handle:n,displayName:a,description:c,viewer:f,labels:y}},actorViewerState({muted:n,mutedByList:a,blockedBy:c,blocking:f,blockingByList:y,following:e,followedBy:l}){return{muted:n,mutedByList:a,blockedBy:c,blocking:f,blockingByList:y,following:e,followedBy:l}},listViewBasic({name:n}){return{uri:"at://did:plc:fake/app.bsky.graph.list/fake",cid:i,name:n,purpose:"app.bsky.graph.defs#modlist",indexedAt:new Date().toISOString()}},replyNotification({author:n,record:a,labels:c}){return{uri:`at://${n.did}/app.bsky.feed.post/fake`,cid:i,author:n,reason:"reply",reasonSubject:`at://${n.did}/app.bsky.feed.post/fake-parent`,record:a,isRead:!1,indexedAt:new Date().toISOString(),labels:c}},followNotification({author:n,subjectDid:a,labels:c}){return{uri:`at://${n.did}/app.bsky.graph.follow/fake`,cid:i,author:n,reason:"follow",record:{$type:"app.bsky.graph.follow",createdAt:new Date().toISOString(),subject:a},isRead:!1,indexedAt:new Date().toISOString(),labels:c}},label({val:n,uri:a,src:c}){return{src:c||"did:plc:fake-labeler",uri:a,val:n,cts:new Date().toISOString()}}},Gh}var ss={},Ul={},qP;function _K(){if(qP)return Ul;qP=1;var i=Ul&&Ul.__classPrivateFieldGet||function(y,e,l,_){if(l==="a"&&!_)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?y!==e||!_:!e.has(y))throw new TypeError("Cannot read private member from an object whose class did not declare it");return l==="m"?_:l==="a"?_.call(y):_?_.value:e.get(y)},n=Ul&&Ul.__classPrivateFieldSet||function(y,e,l,_,w){if(_==="m")throw new TypeError("Private method is not writable");if(_==="a"&&!w)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?y!==e||!w:!e.has(y))throw new TypeError("Cannot write private member to an object whose class did not declare it");return _==="a"?w.call(y,l):w?w.value=l:e.set(y,l),l},a,c;Object.defineProperty(Ul,"__esModule",{value:!0});let f=class{constructor(){a.set(this,!1),c.set(this,new Set)}get acquired(){return i(this,a,"f")}acquireAsync({timeout:e}={}){if(!i(this,a,"f"))return n(this,a,!0,"f"),Promise.resolve();if(e==null)return new Promise(w=>{i(this,c,"f").add(w)});let l,_;return Promise.race([new Promise(w=>{l=()=>{clearTimeout(_),w()},i(this,c,"f").add(l)}),new Promise((w,R)=>{_=setTimeout(()=>{i(this,c,"f").delete(l),R(new Error("Timed out waiting for lock"))},e)})])}tryAcquire(){return i(this,a,"f")?!1:(n(this,a,!0,"f"),!0)}release(){if(!i(this,a,"f"))throw new Error("Cannot release an unacquired lock");if(i(this,c,"f").size>0){const[e]=i(this,c,"f");i(this,c,"f").delete(e),e()}else n(this,a,!1,"f")}};return Ul.default=f,a=new WeakMap,c=new WeakMap,Ul}var Qr={},KP;function bK(){if(KP)return Qr;KP=1,Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.isValidVerificationPrefs=Qr.isValidThreadViewPref=Qr.isValidSavedFeedsPrefV2=Qr.isValidSavedFeedsPref=Qr.isValidPostInteractionSettingsPref=Qr.isValidPersonalDetailsPref=Qr.isValidMutedWordsPref=Qr.isValidLabelersPref=Qr.isValidInterestsPref=Qr.isValidHiddenPostsPref=Qr.isValidFeedViewPref=Qr.isValidContentLabelPref=Qr.isValidBskyAppStatePref=Qr.isValidAdultContentPref=Qr.isValidProfile=void 0;const i=Yl(),n=fe();return Qr.isValidProfile=(0,n.asPredicate)(i.AppBskyActorProfile.validateRecord),Qr.isValidAdultContentPref=(0,n.asPredicate)(i.AppBskyActorDefs.validateAdultContentPref),Qr.isValidBskyAppStatePref=(0,n.asPredicate)(i.AppBskyActorDefs.validateBskyAppStatePref),Qr.isValidContentLabelPref=(0,n.asPredicate)(i.AppBskyActorDefs.validateContentLabelPref),Qr.isValidFeedViewPref=(0,n.asPredicate)(i.AppBskyActorDefs.validateFeedViewPref),Qr.isValidHiddenPostsPref=(0,n.asPredicate)(i.AppBskyActorDefs.validateHiddenPostsPref),Qr.isValidInterestsPref=(0,n.asPredicate)(i.AppBskyActorDefs.validateInterestsPref),Qr.isValidLabelersPref=(0,n.asPredicate)(i.AppBskyActorDefs.validateLabelersPref),Qr.isValidMutedWordsPref=(0,n.asPredicate)(i.AppBskyActorDefs.validateMutedWordsPref),Qr.isValidPersonalDetailsPref=(0,n.asPredicate)(i.AppBskyActorDefs.validatePersonalDetailsPref),Qr.isValidPostInteractionSettingsPref=(0,n.asPredicate)(i.AppBskyActorDefs.validatePostInteractionSettingsPref),Qr.isValidSavedFeedsPref=(0,n.asPredicate)(i.AppBskyActorDefs.validateSavedFeedsPref),Qr.isValidSavedFeedsPrefV2=(0,n.asPredicate)(i.AppBskyActorDefs.validateSavedFeedsPrefV2),Qr.isValidThreadViewPref=(0,n.asPredicate)(i.AppBskyActorDefs.validateThreadViewPref),Qr.isValidVerificationPrefs=(0,n.asPredicate)(i.AppBskyActorDefs.validateVerificationPrefs),Qr}var GP;function fI(){if(GP)return ss;GP=1;var i=ss&&ss.__createBinding||(Object.create?(function(rt,ee,Le,de){de===void 0&&(de=Le);var me=Object.getOwnPropertyDescriptor(ee,Le);(!me||("get"in me?!ee.__esModule:me.writable||me.configurable))&&(me={enumerable:!0,get:function(){return ee[Le]}}),Object.defineProperty(rt,de,me)}):(function(rt,ee,Le,de){de===void 0&&(de=Le),rt[de]=ee[Le]})),n=ss&&ss.__setModuleDefault||(Object.create?(function(rt,ee){Object.defineProperty(rt,"default",{enumerable:!0,value:ee})}):function(rt,ee){rt.default=ee}),a=ss&&ss.__importStar||(function(){var rt=function(ee){return rt=Object.getOwnPropertyNames||function(Le){var de=[];for(var me in Le)Object.prototype.hasOwnProperty.call(Le,me)&&(de[de.length]=me);return de},rt(ee)};return function(ee){if(ee&&ee.__esModule)return ee;var Le={};if(ee!=null)for(var de=rt(ee),me=0;me<de.length;me++)de[me]!=="default"&&i(Le,ee,de[me]);return n(Le,ee),Le}})(),c=ss&&ss.__classPrivateFieldGet||function(rt,ee,Le,de){if(Le==="a"&&!de)throw new TypeError("Private accessor was defined without a getter");if(typeof ee=="function"?rt!==ee||!de:!ee.has(rt))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Le==="m"?de:Le==="a"?de.call(rt):de?de.value:ee.get(rt)},f=ss&&ss.__importDefault||function(rt){return rt&&rt.__esModule?rt:{default:rt}},y;Object.defineProperty(ss,"__esModule",{value:!0}),ss.Agent=void 0;const e=f(_K()),l=$a(),_=Hp(),w=Xt(),R=Yl(),C=pe(),I=iI(),L=pI(),O=s1(),q=a(bK()),G=rI(),j=nI(),ne={hideReplies:!1,hideRepliesByUnfollowed:!0,hideRepliesByLikeCount:0,hideReposts:!1,hideQuotePosts:!1},he={sort:"hotness",prioritizeFollowedUsers:!0};class Q extends w.XrpcClient{static configure(ee){ee.appLabelers&&(this.appLabelers=ee.appLabelers.map(G.asDid))}get xrpc(){return this}constructor(ee){const Le=typeof ee=="object"&&"fetchHandler"in ee?ee:{did:void 0,fetchHandler:(0,w.buildFetchHandler)(ee)};super((de,me)=>{const tt=new Headers(me?.headers);return this.proxy&&!tt.has("atproto-proxy")&&tt.set("atproto-proxy",this.proxy),tt.set("atproto-accept-labelers",[...this.appLabelers.map(yt=>`${yt};redact`),...this.labelers,tt.get("atproto-accept-labelers")?.trim()].filter(Boolean).join(", ")),this.sessionManager.fetchHandler(de,{...me,headers:tt})},C.schemas),Object.defineProperty(this,"com",{enumerable:!0,configurable:!0,writable:!0,value:new R.ComNS(this)}),Object.defineProperty(this,"app",{enumerable:!0,configurable:!0,writable:!0,value:new R.AppNS(this)}),Object.defineProperty(this,"chat",{enumerable:!0,configurable:!0,writable:!0,value:new R.ChatNS(this)}),Object.defineProperty(this,"tools",{enumerable:!0,configurable:!0,writable:!0,value:new R.ToolsNS(this)}),Object.defineProperty(this,"sessionManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"labelers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"proxy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"uploadBlob",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.com.atproto.repo.uploadBlob(de,me)}),Object.defineProperty(this,"resolveHandle",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.com.atproto.identity.resolveHandle(de,me)}),Object.defineProperty(this,"updateHandle",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.com.atproto.identity.updateHandle(de,me)}),Object.defineProperty(this,"createModerationReport",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.com.atproto.moderation.createReport(de,me)}),Object.defineProperty(this,"getTimeline",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.feed.getTimeline(de,me)}),Object.defineProperty(this,"getAuthorFeed",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.feed.getAuthorFeed(de,me)}),Object.defineProperty(this,"getActorLikes",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.feed.getActorLikes(de,me)}),Object.defineProperty(this,"getPostThread",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.feed.getPostThread(de,me)}),Object.defineProperty(this,"getPost",{enumerable:!0,configurable:!0,writable:!0,value:de=>this.app.bsky.feed.post.get(de)}),Object.defineProperty(this,"getPosts",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.feed.getPosts(de,me)}),Object.defineProperty(this,"getLikes",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.feed.getLikes(de,me)}),Object.defineProperty(this,"getRepostedBy",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.feed.getRepostedBy(de,me)}),Object.defineProperty(this,"getFollows",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.graph.getFollows(de,me)}),Object.defineProperty(this,"getFollowers",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.graph.getFollowers(de,me)}),Object.defineProperty(this,"getProfile",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.actor.getProfile(de,me)}),Object.defineProperty(this,"getProfiles",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.actor.getProfiles(de,me)}),Object.defineProperty(this,"getSuggestions",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.actor.getSuggestions(de,me)}),Object.defineProperty(this,"searchActors",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.actor.searchActors(de,me)}),Object.defineProperty(this,"searchActorsTypeahead",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.actor.searchActorsTypeahead(de,me)}),Object.defineProperty(this,"listNotifications",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.notification.listNotifications(de,me)}),Object.defineProperty(this,"countUnreadNotifications",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.notification.getUnreadCount(de,me)}),Object.defineProperty(this,"getLabelers",{enumerable:!0,configurable:!0,writable:!0,value:(de,me)=>this.app.bsky.labeler.getServices(de,me)}),y.set(this,new e.default),this.sessionManager=Le}clone(){return this.copyInto(new Q(this.sessionManager))}copyInto(ee){ee.configureLabelers(this.labelers),ee.configureProxy(this.proxy??null),ee.clearHeaders();for(const[Le,de]of this.headers)ee.setHeader(Le,de);return ee}withProxy(ee,Le){const de=this.clone();return de.configureProxy(`${(0,G.asDid)(Le)}#${ee}`),de}get appLabelers(){return this.constructor.appLabelers}configureLabelers(ee){this.labelers=ee.map(G.asDid)}configureLabelersHeader(ee){this.configureLabelers(ee.filter(G.isDid))}configureProxy(ee){ee===null?this.proxy=void 0:this.proxy=(0,G.asAtprotoProxy)(ee)}configureProxyHeader(ee,Le){(0,G.isDid)(Le)&&this.configureProxy(`${Le}#${ee}`)}get did(){return this.sessionManager.did}get accountDid(){return this.assertDid}get assertDid(){return this.assertAuthenticated(),this.did}assertAuthenticated(){if(!this.did)throw new Error("Not logged in")}get api(){return this}async getLabelDefinitions(ee){const Le=[...this.appLabelers];et(ee)?Le.push(...ee.moderationPrefs.labelers.map(tt=>tt.did)):gt(ee)?Le.push(...ee.labelers.map(tt=>tt.did)):Le.push(...ee);const de=await this.getLabelers({dids:Le,detailed:!0}),me={};if(de.data)for(const tt of de.data.views)me[tt.creator.did]=(0,L.interpretLabelValueDefinitions)(tt);return me}async post(ee){return ee.createdAt||(ee.createdAt=new Date().toISOString()),this.app.bsky.feed.post.create({repo:this.accountDid},ee)}async deletePost(ee){this.assertAuthenticated();const Le=new _.AtUri(ee);return this.app.bsky.feed.post.delete({repo:Le.hostname,rkey:Le.rkey})}async like(ee,Le,de){return this.app.bsky.feed.like.create({repo:this.accountDid},{subject:{uri:ee,cid:Le},createdAt:new Date().toISOString(),via:de})}async deleteLike(ee){this.assertAuthenticated();const Le=new _.AtUri(ee);return this.app.bsky.feed.like.delete({repo:Le.hostname,rkey:Le.rkey})}async repost(ee,Le,de){return this.app.bsky.feed.repost.create({repo:this.accountDid},{subject:{uri:ee,cid:Le},createdAt:new Date().toISOString(),via:de})}async deleteRepost(ee){this.assertAuthenticated();const Le=new _.AtUri(ee);return this.app.bsky.feed.repost.delete({repo:Le.hostname,rkey:Le.rkey})}async follow(ee){return this.app.bsky.graph.follow.create({repo:this.accountDid},{subject:ee,createdAt:new Date().toISOString()})}async deleteFollow(ee){this.assertAuthenticated();const Le=new _.AtUri(ee);return this.app.bsky.graph.follow.delete({repo:Le.hostname,rkey:Le.rkey})}async upsertProfile(ee){const Le=async()=>{const de=this.assertDid,me="app.bsky.actor.profile",tt=await this.com.atproto.repo.getRecord({repo:de,collection:me,rkey:"self"}).catch(Gt=>{}),yt=tt&&q.isValidProfile(tt.data.value)?tt.data.value:void 0,lt=await ee(yt),ge=R.AppBskyActorProfile.validateRecord({$type:me,...lt});if(!ge.success)throw ge.error;await this.com.atproto.repo.putRecord({repo:de,collection:me,rkey:"self",record:ge.value,swapRecord:tt?.data.cid||null})};return(0,l.retry)(Le,{maxRetries:5,retryable:de=>de instanceof R.ComAtprotoRepoPutRecord.InvalidSwapError})}async mute(ee){return this.app.bsky.graph.muteActor({actor:ee})}async unmute(ee){return this.app.bsky.graph.unmuteActor({actor:ee})}async muteModList(ee){return this.app.bsky.graph.muteActorList({list:ee})}async unmuteModList(ee){return this.app.bsky.graph.unmuteActorList({list:ee})}async blockModList(ee){return this.app.bsky.graph.listblock.create({repo:this.accountDid},{subject:ee,createdAt:new Date().toISOString()})}async unblockModList(ee){const Le=this.accountDid,me=(await this.app.bsky.graph.getList({list:ee,limit:1})).data.list.viewer?.blocked;if(me){const{rkey:tt}=new _.AtUri(me);return this.app.bsky.graph.listblock.delete({repo:Le,rkey:tt})}}async updateSeenNotifications(ee=new Date().toISOString()){return this.app.bsky.notification.updateSeen({seenAt:ee})}async getPreferences(){const ee={feeds:{saved:void 0,pinned:void 0},savedFeeds:void 0,feedViewPrefs:{home:{...ne}},threadViewPrefs:{...he},moderationPrefs:{adultContentEnabled:!1,labels:{...O.DEFAULT_LABEL_SETTINGS},labelers:this.appLabelers.map(me=>({did:me,labels:{}})),mutedWords:[],hiddenPosts:[]},birthDate:void 0,interests:{tags:[]},bskyAppState:{queuedNudges:[],activeProgressGuide:void 0,nuxs:[]},postInteractionSettings:{threadgateAllowRules:void 0,postgateEmbeddingRules:void 0},verificationPrefs:{hideBadges:!1}},Le=await this.app.bsky.actor.getPreferences({}),de=[];for(const me of Le.data.preferences)if(q.isValidAdultContentPref(me))ee.moderationPrefs.adultContentEnabled=me.enabled;else if(q.isValidContentLabelPref(me)){const tt=Be(me);de.push(tt)}else if(q.isValidLabelersPref(me))ee.moderationPrefs.labelers=this.appLabelers.map(tt=>({did:tt,labels:{}})).concat(me.labelers.map(tt=>({...tt,labels:{}})));else if(q.isValidSavedFeedsPrefV2(me))ee.savedFeeds=me.items;else if(q.isValidSavedFeedsPref(me))ee.feeds.saved=me.saved,ee.feeds.pinned=me.pinned;else if(q.isValidPersonalDetailsPref(me))me.birthDate&&(ee.birthDate=new Date(me.birthDate));else if(q.isValidFeedViewPref(me)){const{$type:tt,feed:yt,...lt}=me;ee.feedViewPrefs[yt]={...ne,...lt}}else if(q.isValidThreadViewPref(me)){const{$type:tt,...yt}=me;ee.threadViewPrefs={...ee.threadViewPrefs,...yt}}else if(q.isValidInterestsPref(me)){const{$type:tt,...yt}=me;ee.interests={...ee.interests,...yt}}else q.isValidMutedWordsPref(me)?(ee.moderationPrefs.mutedWords=me.items,ee.moderationPrefs.mutedWords.length&&(ee.moderationPrefs.mutedWords=ee.moderationPrefs.mutedWords.map(tt=>(tt.actorTarget=tt.actorTarget||"all",tt)))):q.isValidHiddenPostsPref(me)?ee.moderationPrefs.hiddenPosts=me.items:q.isValidBskyAppStatePref(me)?(ee.bskyAppState.queuedNudges=me.queuedNudges||[],ee.bskyAppState.activeProgressGuide=me.activeProgressGuide,ee.bskyAppState.nuxs=me.nuxs||[]):q.isValidPostInteractionSettingsPref(me)?(ee.postInteractionSettings.threadgateAllowRules=me.threadgateAllowRules,ee.postInteractionSettings.postgateEmbeddingRules=me.postgateEmbeddingRules):q.isValidVerificationPrefs(me)&&(ee.verificationPrefs={hideBadges:me.hideBadges});if(ee.savedFeeds==null){const{saved:me,pinned:tt}=ee.feeds;if(me&&tt){const yt=new Map;yt.set("timeline",{id:l.TID.nextStr(),type:"timeline",value:"following",pinned:!0});for(const lt of tt){const ge=(0,j.getSavedFeedType)(lt);ge!=="unknown"&&yt.set(lt,{id:l.TID.nextStr(),type:ge,value:lt,pinned:!0})}for(const lt of me)if(!yt.has(lt)){const ge=(0,j.getSavedFeedType)(lt);if(ge==="unknown")continue;yt.set(lt,{id:l.TID.nextStr(),type:ge,value:lt,pinned:!1})}ee.savedFeeds=Array.from(yt.values())}else ee.savedFeeds=[{id:l.TID.nextStr(),type:"timeline",value:"following",pinned:!0}];await this.overwriteSavedFeeds(ee.savedFeeds)}for(const me of de)if(me.labelerDid){const tt=ee.moderationPrefs.labelers.find(yt=>yt.did===me.labelerDid);if(!tt)continue;tt.labels[me.label]=me.visibility}else ee.moderationPrefs.labels[me.label]=me.visibility;return ee.moderationPrefs.labels=we(ee.moderationPrefs.labels),this.configureLabelers(ze(Le.data.preferences)),ee}async overwriteSavedFeeds(ee){ee.forEach(j.validateSavedFeed);const Le=new Map;return ee.forEach(de=>{Le.has(de.id)&&Le.delete(de.id),Le.set(de.id,de)}),this.updateSavedFeedsV2Preferences(()=>Array.from(Le.values()))}async updateSavedFeeds(ee){return ee.map(j.validateSavedFeed),this.updateSavedFeedsV2Preferences(Le=>Le.map(de=>{const me=ee.find(tt=>de.id===tt.id);return me?{...de,pinned:me.pinned}:de}))}async addSavedFeeds(ee){const Le=ee.map(de=>({...de,id:l.TID.nextStr()}));return Le.forEach(j.validateSavedFeed),this.updateSavedFeedsV2Preferences(de=>[...de,...Le])}async removeSavedFeeds(ee){return this.updateSavedFeedsV2Preferences(Le=>[...Le.filter(de=>!ee.find(me=>de.id===me))])}async setSavedFeeds(ee,Le){return this.updateFeedPreferences(()=>({saved:ee,pinned:Le}))}async addSavedFeed(ee){return this.updateFeedPreferences((Le,de)=>({saved:[...Le.filter(me=>me!==ee),ee],pinned:de}))}async removeSavedFeed(ee){return this.updateFeedPreferences((Le,de)=>({saved:Le.filter(me=>me!==ee),pinned:de.filter(me=>me!==ee)}))}async addPinnedFeed(ee){return this.updateFeedPreferences((Le,de)=>({saved:[...Le.filter(me=>me!==ee),ee],pinned:[...de.filter(me=>me!==ee),ee]}))}async removePinnedFeed(ee){return this.updateFeedPreferences((Le,de)=>({saved:Le,pinned:de.filter(me=>me!==ee)}))}async setAdultContentEnabled(ee){await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidAdultContentPref)||{$type:"app.bsky.actor.defs#adultContentPref",enabled:ee};return de.enabled=ee,Le.filter(me=>!R.AppBskyActorDefs.isAdultContentPref(me)).concat(de)})}async setContentLabelPref(ee,Le,de){de&&(0,_.ensureValidDid)(de),await this.updatePreferences(me=>{const tt=me.filter(q.isValidContentLabelPref).findLast(lt=>lt.label===ee&&lt.labelerDid===de)||{$type:"app.bsky.actor.defs#contentLabelPref",label:ee,labelerDid:de,visibility:Le};tt.visibility=Le;let yt;if(R.AppBskyActorDefs.isContentLabelPref(tt)&&!tt.labelerDid){const lt={"graphic-media":"gore",porn:"nsfw",sexual:"suggestive",__proto__:null}[tt.label];lt&&(yt=me.filter(q.isValidContentLabelPref).findLast(ge=>ge.label===lt&&ge.labelerDid===void 0)||{$type:"app.bsky.actor.defs#contentLabelPref",label:lt,labelerDid:void 0,visibility:Le},yt.visibility=Le)}return me.filter(lt=>!R.AppBskyActorDefs.isContentLabelPref(lt)||!(lt.label===ee&&lt.labelerDid===de)).concat(tt).filter(lt=>yt?!R.AppBskyActorDefs.isContentLabelPref(lt)||!(lt.label===yt.label&&lt.labelerDid===void 0):!0).concat(yt?[yt]:[])})}async addLabeler(ee){const Le=await this.updatePreferences(de=>{const me=de.findLast(q.isValidLabelersPref)||{$type:"app.bsky.actor.defs#labelersPref",labelers:[]};return me.labelers.some(tt=>tt.did===ee)||me.labelers.push({did:ee}),de.filter(tt=>!R.AppBskyActorDefs.isLabelersPref(tt)).concat(me)});this.configureLabelers(ze(Le))}async removeLabeler(ee){const Le=await this.updatePreferences(de=>{const me=de.findLast(q.isValidLabelersPref)||{$type:"app.bsky.actor.defs#labelersPref",labelers:[]};return me.labelers=me.labelers.filter(tt=>tt.did!==ee),de.filter(tt=>!R.AppBskyActorDefs.isLabelersPref(tt)).concat(me)});this.configureLabelers(ze(Le))}async setPersonalDetails({birthDate:ee}){await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidPersonalDetailsPref)||{$type:"app.bsky.actor.defs#personalDetailsPref"};return de.birthDate=ee instanceof Date?ee.toISOString():ee,Le.filter(me=>!R.AppBskyActorDefs.isPersonalDetailsPref(me)).concat(de)})}async setFeedViewPrefs(ee,Le){await this.updatePreferences(de=>{const me=de.filter(q.isValidFeedViewPref).findLast(tt=>tt.feed===ee);return de.filter(tt=>!R.AppBskyActorDefs.isFeedViewPref(tt)||tt.feed!==ee).concat({...me,...Le,$type:"app.bsky.actor.defs#feedViewPref",feed:ee})})}async setThreadViewPrefs(ee){await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidThreadViewPref);return Le.filter(me=>!R.AppBskyActorDefs.isThreadViewPref(me)).concat({...de,...ee,$type:"app.bsky.actor.defs#threadViewPref"})})}async setInterestsPref(ee){await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidInterestsPref);return Le.filter(me=>!R.AppBskyActorDefs.isInterestsPref(me)).concat({...de,...ee,$type:"app.bsky.actor.defs#interestsPref"})})}async addMutedWord(ee){const Le=(0,j.sanitizeMutedWordValue)(ee.value);Le&&await this.updatePreferences(de=>{let me=de.findLast(q.isValidMutedWordsPref);const tt={id:l.TID.nextStr(),value:Le,targets:ee.targets||[],actorTarget:ee.actorTarget||"all",expiresAt:ee.expiresAt||void 0};return me?(me.items.push(tt),me.items=st(me.items)):me={$type:"app.bsky.actor.defs#mutedWordsPref",items:[tt]},de.filter(yt=>!R.AppBskyActorDefs.isMutedWordsPref(yt)).concat(me)})}async addMutedWords(ee){await Promise.all(ee.map(Le=>this.addMutedWord(Le)))}async upsertMutedWords(ee){await this.addMutedWords(ee)}async updateMutedWord(ee){await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidMutedWordsPref);return de?(de.items=de.items.map(me=>{if(nt(me,ee)){const yt={...me,...ee};return{id:me.id||l.TID.nextStr(),value:(0,j.sanitizeMutedWordValue)(yt.value)||me.value,targets:yt.targets||[],actorTarget:yt.actorTarget||"all",expiresAt:yt.expiresAt||void 0}}else return me}),de.items=st(de.items),Le.filter(me=>!R.AppBskyActorDefs.isMutedWordsPref(me)).concat(de)):Le})}async removeMutedWord(ee){await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidMutedWordsPref);if(de){for(let me=0;me<de.items.length;me++)if(nt(de.items[me],ee)){de.items.splice(me,1);break}return de.items=st(de.items),Le.filter(me=>!R.AppBskyActorDefs.isMutedWordsPref(me)).concat(de)}return Le})}async removeMutedWords(ee){await Promise.all(ee.map(Le=>this.removeMutedWord(Le)))}async hidePost(ee){await this.updateHiddenPost(ee,"hide")}async unhidePost(ee){await this.updateHiddenPost(ee,"unhide")}async bskyAppQueueNudges(ee){await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidBskyAppStatePref)||{$type:"app.bsky.actor.defs#bskyAppStatePref"};return de.queuedNudges=(de.queuedNudges||[]).concat(ee),Le.filter(me=>!R.AppBskyActorDefs.isBskyAppStatePref(me)).concat(de)})}async bskyAppDismissNudges(ee){await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidBskyAppStatePref)||{$type:"app.bsky.actor.defs#bskyAppStatePref"};return ee=Array.isArray(ee)?ee:[ee],de.queuedNudges=(de.queuedNudges||[]).filter(me=>!ee.includes(me)),Le.filter(me=>!R.AppBskyActorDefs.isBskyAppStatePref(me)).concat(de)})}async bskyAppSetActiveProgressGuide(ee){if(ee){const Le=R.AppBskyActorDefs.validateBskyAppProgressGuide(ee);if(!Le.success)throw Le.error}await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidBskyAppStatePref)||{$type:"app.bsky.actor.defs#bskyAppStatePref"};return de.activeProgressGuide=ee,Le.filter(me=>!R.AppBskyActorDefs.isBskyAppStatePref(me)).concat(de)})}async bskyAppUpsertNux(ee){(0,j.validateNux)(ee),await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidBskyAppStatePref)||{$type:"app.bsky.actor.defs#bskyAppStatePref"};de.nuxs=de.nuxs||[];const me=de.nuxs?.find(yt=>yt.id===ee.id);let tt;return me?tt={id:me.id,completed:ee.completed,data:ee.data,expiresAt:ee.expiresAt}:tt=ee,de.nuxs=de.nuxs.filter(yt=>yt.id!==ee.id).concat(tt),Le.filter(yt=>!R.AppBskyActorDefs.isBskyAppStatePref(yt)).concat(de)})}async bskyAppRemoveNuxs(ee){await this.updatePreferences(Le=>{const de=Le.findLast(q.isValidBskyAppStatePref)||{$type:"app.bsky.actor.defs#bskyAppStatePref"};return de.nuxs=(de.nuxs||[]).filter(me=>!ee.includes(me.id)),Le.filter(me=>!R.AppBskyActorDefs.isBskyAppStatePref(me)).concat(de)})}async setPostInteractionSettings(ee){const Le=R.AppBskyActorDefs.validatePostInteractionSettingsPref(ee);if(!Le.success)throw Le.error;await this.updatePreferences(de=>{const me=de.findLast(q.isValidPostInteractionSettingsPref)||{$type:"app.bsky.actor.defs#postInteractionSettingsPref"};return me.threadgateAllowRules=ee.threadgateAllowRules,me.postgateEmbeddingRules=ee.postgateEmbeddingRules,de.filter(tt=>!R.AppBskyActorDefs.isPostInteractionSettingsPref(tt)).concat(me)})}async setVerificationPrefs(ee){const Le=R.AppBskyActorDefs.validateVerificationPrefs(ee);if(!Le.success)throw Le.error;await this.updatePreferences(de=>{const me=de.findLast(q.isValidVerificationPrefs)||{$type:"app.bsky.actor.defs#verificationPrefs",hideBadges:!1};return me.hideBadges=ee.hideBadges,de.filter(tt=>!R.AppBskyActorDefs.isVerificationPrefs(tt)).concat(me)})}async updatePreferences(ee){try{await c(this,y,"f").acquireAsync();const Le=await this.app.bsky.actor.getPreferences({}),de=ee(Le.data.preferences);return de===!1?Le.data.preferences:(await this.app.bsky.actor.putPreferences({preferences:de}),de)}finally{c(this,y,"f").release()}}async updateHiddenPost(ee,Le){await this.updatePreferences(de=>{const me=de.findLast(q.isValidHiddenPostsPref)||{$type:"app.bsky.actor.defs#hiddenPostsPref",items:[]},tt=new Set(me.items);return Le==="hide"?tt.add(ee):tt.delete(ee),me.items=[...tt],de.filter(yt=>!R.AppBskyActorDefs.isHiddenPostsPref(yt)).concat(me)})}async updateFeedPreferences(ee){let Le;return await this.updatePreferences(de=>{const me=de.findLast(q.isValidSavedFeedsPref)||{$type:"app.bsky.actor.defs#savedFeedsPref",saved:[],pinned:[]};return Le=ee(me.saved,me.pinned),me.saved=Le.saved,me.pinned=Le.pinned,de.filter(tt=>!R.AppBskyActorDefs.isSavedFeedsPref(tt)).concat(me)}),Le}async updateSavedFeedsV2Preferences(ee){let Le=[];return await this.updatePreferences(de=>{const me=de.findLast(q.isValidSavedFeedsPrefV2)||{$type:"app.bsky.actor.defs#savedFeedsPrefV2",items:[]},tt=ee(me.items);me.items=[...tt].sort((ge,Gt)=>ge.pinned===Gt.pinned?0:ge.pinned?-1:1),Le=tt;let yt=de.filter(ge=>!R.AppBskyActorDefs.isSavedFeedsPrefV2(ge)).concat(me),lt=de.findLast(q.isValidSavedFeedsPref);if(lt){const{saved:ge,pinned:Gt}=lt,Ut=(0,j.savedFeedsToUriArrays)(me.items.filter(Ce=>["feed","list"].includes(Ce.type)));lt={...lt,saved:Array.from(new Set([...ge,...Ut.saved])),pinned:Array.from(new Set([...Gt,...Ut.pinned]))},yt=yt.filter(Ce=>!R.AppBskyActorDefs.isSavedFeedsPref(Ce)).concat(lt)}return yt}),Le}}ss.Agent=Q,y=new WeakMap,Object.defineProperty(Q,"appLabelers",{enumerable:!0,configurable:!0,writable:!0,value:[I.BSKY_LABELER_DID]});function Be(rt){let ee=rt.visibility;return ee==="show"&&(ee="ignore"),{...rt,visibility:ee}}function we(rt){const ee={...rt},Le={gore:"graphic-media",nsfw:"porn",suggestive:"sexual"};for(const de in ee){const me=Le[de];me&&(ee[me]=ee[de])}return ee}function ze(rt){const ee=rt.findLast(q.isValidLabelersPref);let Le=[];return ee&&(Le=ee.labelers.map(de=>de.did)),Le}function et(rt){return rt&&typeof rt=="object"&&"moderationPrefs"in rt&&gt(rt.moderationPrefs)}function gt(rt){return rt&&typeof rt=="object"&&"labelers"in rt}function st(rt){return rt.map(ee=>({...ee,id:ee.id||l.TID.nextStr()}))}function nt(rt,ee){const Le=rt.id,de=Le&&Le===ee.id,me=!Le&&rt.value===ee.value;return de||me}return ss}var rc={},$P;function Ib(){if($P)return rc;$P=1,Object.defineProperty(rc,"__esModule",{value:!0}),rc.CredentialSession=rc.AtpAgent=void 0;const i=$a(),n=Xt(),a=fI(),c=Yl(),f=pe(),y=globalThis.ReadableStream;class e extends a.Agent{constructor(O){const q=O instanceof l?O:new l(new URL(O.service),O.fetch,O.persistSession);if(super(q),Object.defineProperty(this,"sessionManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.sessionManager=q,!(O instanceof l)&&O.headers)for(const[G,j]of O.headers)this.setHeader(G,j)}clone(){return this.copyInto(new e(this.sessionManager))}get session(){return this.sessionManager.session}get hasSession(){return this.sessionManager.hasSession}get did(){return this.sessionManager.did}get serviceUrl(){return this.sessionManager.serviceUrl}get pdsUrl(){return this.sessionManager.pdsUrl}get dispatchUrl(){return this.sessionManager.dispatchUrl}get service(){return this.serviceUrl}get persistSession(){throw new Error('Cannot set persistSession directly. "persistSession" is defined through the constructor and will be invoked automatically when session data changes.')}set persistSession(O){throw new Error('Cannot set persistSession directly. "persistSession" must be defined in the constructor and can no longer be changed.')}getServiceUrl(){return this.serviceUrl}async resumeSession(O){return this.sessionManager.resumeSession(O)}async createAccount(O,q){return this.sessionManager.createAccount(O,q)}async login(O){return this.sessionManager.login(O)}async logout(){return this.sessionManager.logout()}}rc.AtpAgent=e;class l{constructor(O,q=globalThis.fetch,G){Object.defineProperty(this,"serviceUrl",{enumerable:!0,configurable:!0,writable:!0,value:O}),Object.defineProperty(this,"fetch",{enumerable:!0,configurable:!0,writable:!0,value:q}),Object.defineProperty(this,"persistSession",{enumerable:!0,configurable:!0,writable:!0,value:G}),Object.defineProperty(this,"pdsUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"refreshSessionPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"server",{enumerable:!0,configurable:!0,writable:!0,value:new c.ComAtprotoServerNS(new n.XrpcClient((j,ne)=>(0,this.fetch)(new URL(j,this.serviceUrl),ne),f.schemas))})}get did(){return this.session?.did}get dispatchUrl(){return this.pdsUrl||this.serviceUrl}get hasSession(){return!!this.session}setFetch(O=globalThis.fetch){this.fetch=O}async fetchHandler(O,q){await this.refreshSessionPromise;const G=new URL(O,this.dispatchUrl),j=new Request(G,q),ne=this.session?.accessJwt;if(!ne||j.headers.has("authorization"))return(0,this.fetch)(j);j.headers.set("authorization",`Bearer ${ne}`);const he=await(0,this.fetch)(j);if(!this.session?.refreshJwt||!await w(he,[400],["ExpiredToken"]))return he;try{await this.refreshSession()}catch{return he}if(q?.signal?.aborted||y&&q?.body instanceof y)return he;const Be=this.session?.accessJwt;if(!Be||Be===ne)return he;await he.body?.cancel();const we=new URL(O,this.dispatchUrl),ze=new Request(we,q);return ze.headers.set("authorization",`Bearer ${Be}`),await(0,this.fetch)(ze)}async createAccount(O,q){try{const G=await this.server.createAccount(O,q);return this.session={accessJwt:G.data.accessJwt,refreshJwt:G.data.refreshJwt,handle:G.data.handle,did:G.data.did,email:O.email,emailConfirmed:!1,emailAuthFactor:!1,active:!0},this.persistSession?.("create",this.session),this._updateApiEndpoint(G.data.didDoc),G}catch(G){throw this.session=void 0,this.persistSession?.("create-failed",void 0),G}}async login(O){try{const q=await this.server.createSession({identifier:O.identifier,password:O.password,authFactorToken:O.authFactorToken,allowTakendown:O.allowTakendown});return this.session={accessJwt:q.data.accessJwt,refreshJwt:q.data.refreshJwt,handle:q.data.handle,did:q.data.did,email:q.data.email,emailConfirmed:q.data.emailConfirmed,emailAuthFactor:q.data.emailAuthFactor,active:q.data.active??!0,status:q.data.status},this._updateApiEndpoint(q.data.didDoc),this.persistSession?.("create",this.session),q}catch(q){throw this.session=void 0,this.persistSession?.("create-failed",void 0),q}}async logout(){if(this.session)try{await this.server.deleteSession(void 0,{headers:{authorization:`Bearer ${this.session.refreshJwt}`}})}catch{}finally{this.session=void 0,this.persistSession?.("expired",void 0)}}async resumeSession(O){this.session=O;try{const q=await this.server.getSession(void 0,{headers:{authorization:`Bearer ${O.accessJwt}`}}).catch(async G=>{if(G instanceof n.XRPCError&&["ExpiredToken","InvalidToken"].includes(G.error)&&O.refreshJwt)try{const j=await this.server.refreshSession(void 0,{headers:{authorization:`Bearer ${O.refreshJwt}`}});return O.accessJwt=j.data.accessJwt,O.refreshJwt=j.data.refreshJwt,this.server.getSession(void 0,{headers:{authorization:`Bearer ${O.accessJwt}`}})}catch{}throw G});if(q.data.did!==O.did)throw new n.XRPCError(n.ResponseType.InvalidRequest,"Invalid session","InvalidDID");return O.email=q.data.email,O.handle=q.data.handle,O.emailConfirmed=q.data.emailConfirmed,O.emailAuthFactor=q.data.emailAuthFactor,O.active=q.data.active??!0,O.status=q.data.status,this.session===O&&(this._updateApiEndpoint(q.data.didDoc),this.persistSession?.("update",O)),q}catch(q){throw this.session===O&&(q instanceof n.XRPCError&&["ExpiredToken","InvalidToken"].includes(q.error)?(this.session=void 0,this.persistSession?.("expired",void 0)):(this.session=O,this.persistSession?.("network-error",O))),q}}async refreshSession(){return this.refreshSessionPromise||(this.refreshSessionPromise=this._refreshSessionInner().finally(()=>{this.refreshSessionPromise=void 0}))}async _refreshSessionInner(){if(this.session?.refreshJwt)try{const O=await this.server.refreshSession(void 0,{headers:{authorization:`Bearer ${this.session.refreshJwt}`}});this.session={...this.session,accessJwt:O.data.accessJwt,refreshJwt:O.data.refreshJwt,handle:O.data.handle,did:O.data.did},this._updateApiEndpoint(O.data.didDoc),this.persistSession?.("update",this.session)}catch(O){O instanceof n.XRPCError&&O.error&&["ExpiredToken","InvalidToken"].includes(O.error)&&(this.session=void 0,this.persistSession?.("expired",void 0))}}_updateApiEndpoint(O){if((0,i.isValidDidDoc)(O)){const q=(0,i.getPdsEndpoint)(O);this.pdsUrl=q?new URL(q):void 0}else this.pdsUrl=void 0}}rc.CredentialSession=l;function _(L){return n.errorResponseBody.safeParse(L).success}async function w(L,O,q){if(!O.includes(L.status))return!1;try{const G=await R(L,10240);return _(G)&&q.includes(G.error)}catch{return!1}}async function R(L,O=1/0){if(I(L)!=="application/json")throw new Error("Not JSON");if(C(L)>O)throw new Error("Response too large");return L.clone().json()}function C({headers:L}){return L.get("Content-Length")?Number(L.get("Content-Length")):NaN}function I({headers:L}){return L.get("Content-Type")?.split(";")[0]?.trim()}return rc}var $h={},ZP;function vK(){if(ZP)return $h;ZP=1,Object.defineProperty($h,"__esModule",{value:!0}),$h.BskyAgent=void 0;const i=Ib();class n extends i.AtpAgent{clone(){if(this.constructor===n){const c=new n(this.sessionManager);return this.copyInto(c)}throw new TypeError("Cannot clone a subclass of BskyAgent")}}return $h.BskyAgent=n,$h}var HP;function xK(){return HP||(HP=1,(function(i){var n=Mu&&Mu.__createBinding||(Object.create?(function(G,j,ne,he){he===void 0&&(he=ne);var Q=Object.getOwnPropertyDescriptor(j,ne);(!Q||("get"in Q?!j.__esModule:Q.writable||Q.configurable))&&(Q={enumerable:!0,get:function(){return j[ne]}}),Object.defineProperty(G,he,Q)}):(function(G,j,ne,he){he===void 0&&(he=ne),G[he]=j[ne]})),a=Mu&&Mu.__exportStar||function(G,j){for(var ne in G)ne!=="default"&&!Object.prototype.hasOwnProperty.call(j,ne)&&n(j,G,ne)};Object.defineProperty(i,"__esModule",{value:!0}),i.lexicons=i.default=i.BskyAgent=i.CredentialSession=i.AtpAgent=i.Agent=i.LABELS=i.DEFAULT_LABEL_SETTINGS=i.asPredicate=i.schemas=i.parseLanguage=i.stringifyLex=i.lexToJson=i.jsonToLex=i.jsonStringToLex=i.BlobRef=i.AtUri=void 0;const c=Np(),f=pe();var y=Hp();Object.defineProperty(i,"AtUri",{enumerable:!0,get:function(){return y.AtUri}});var e=Np();Object.defineProperty(i,"BlobRef",{enumerable:!0,get:function(){return e.BlobRef}}),Object.defineProperty(i,"jsonStringToLex",{enumerable:!0,get:function(){return e.jsonStringToLex}}),Object.defineProperty(i,"jsonToLex",{enumerable:!0,get:function(){return e.jsonToLex}}),Object.defineProperty(i,"lexToJson",{enumerable:!0,get:function(){return e.lexToJson}}),Object.defineProperty(i,"stringifyLex",{enumerable:!0,get:function(){return e.stringifyLex}});var l=$a();Object.defineProperty(i,"parseLanguage",{enumerable:!0,get:function(){return l.parseLanguage}}),a(rI(),i),a(iI(),i),a(nI(),i),a(Yl(),i);var _=pe();Object.defineProperty(i,"schemas",{enumerable:!0,get:function(){return _.schemas}});var w=fe();Object.defineProperty(i,"asPredicate",{enumerable:!0,get:function(){return w.asPredicate}}),a(dK(),i),a(lI(),i),a(n1(),i),a(aI(),i),a(pI(),i),a(uI(),i),a(gK(),i);var R=s1();Object.defineProperty(i,"DEFAULT_LABEL_SETTINGS",{enumerable:!0,get:function(){return R.DEFAULT_LABEL_SETTINGS}}),Object.defineProperty(i,"LABELS",{enumerable:!0,get:function(){return R.LABELS}});var C=fI();Object.defineProperty(i,"Agent",{enumerable:!0,get:function(){return C.Agent}});var I=Ib();Object.defineProperty(i,"AtpAgent",{enumerable:!0,get:function(){return I.AtpAgent}});var L=Ib();Object.defineProperty(i,"CredentialSession",{enumerable:!0,get:function(){return L.CredentialSession}});var O=vK();Object.defineProperty(i,"BskyAgent",{enumerable:!0,get:function(){return O.BskyAgent}});var q=Ib();Object.defineProperty(i,"default",{enumerable:!0,get:function(){return q.AtpAgent}}),i.lexicons=new c.Lexicons(f.lexicons)})(Mu)),Mu}var wK=xK();const EK=sD(wK),AK=i=>typeof i=="object"?i.handle.bind(i):i,RK=({service:i,fetch:n=fetch})=>async(a,c)=>{const f=new URL(a,i);return n(f,c)},SK=(i,n)=>{let a;for(const c in n){const f=n[c];f!==null&&(a??=new Headers(i),a.has(c)||a.set(c,f))}return a??i};class Bb extends Error{constructor(n,{kind:a=`HTTP error ${n}`,description:c="Unspecified error description",headers:f,cause:y}={}){super(`${a} > ${c}`,{cause:y}),this.name="XRPCError",this.status=n,this.kind=a,this.description=c,this.headers=f||{}}}class TK{constructor({handler:n,proxy:a}){this.handle=AK(n),this.proxy=a}get(n,a){return this.request({type:"get",nsid:n,...a})}call(n,a){return this.request({type:"post",nsid:n,...a})}async request(n){const a=n.data,c=`/xrpc/${n.nsid}`+kK(n.params),f=PK(a),y=await this.handle(c,{method:n.type,signal:n.signal,body:f?JSON.stringify(a):a,headers:SK(n.headers,{"content-type":f?"application/json":null,"atproto-proxy":CK(this.proxy)})}),e=y.status,l=Object.fromEntries(y.headers),_=l["content-type"];let w,R;_&&(_.startsWith("application/json")?w=y.json():_.startsWith("text/")&&(w=y.text()));try{R=await(w||y.arrayBuffer().then(C=>new Uint8Array(C)))}catch(C){throw new Bb(2,{cause:C,kind:"InvalidResponse",description:"Failed to parse response body",headers:l})}if(e===200)return{data:R,headers:l};throw LK(R)?new Bb(e,{kind:R.error,description:R.message,headers:l}):new Bb(e,{headers:l})}}const CK=i=>i?`${i.service}#${i.type}`:null,kK=i=>{let n;for(const a in i){const c=i[a];if(c!==void 0)if(n??=new URLSearchParams,Array.isArray(c))for(let f=0,y=c.length;f<y;f++){const e=c[f];n.append(a,""+e)}else n.set(a,""+c)}return n?"?"+n.toString():""},PK=i=>{if(typeof i!="object"||i===null)return!1;if("toJSON"in i)return!0;const n=Object.getPrototypeOf(i);return n===null||n===Object.prototype},LK=i=>{if(typeof i!="object"||i===null)return!1;const n=typeof i.error,a=typeof i.message;return(n==="undefined"||n==="string")&&(a==="undefined"||a==="string")},Tb=(i,n)=>({text:i,features:i.length>0?n:void 0}),DK=(i,n)=>{if(n===void 0||n.length===0)return[Tb(i,void 0)];const a=[],c=i.length;let f=0,y=0;const e=(l,_)=>{let w=l;if(i.charCodeAt(w)<128)for(w+=1,y+=1;y+8<=_&&w+8<=c;){const C=i.charCodeAt(w),I=i.charCodeAt(w+1),L=i.charCodeAt(w+2),O=i.charCodeAt(w+3),q=i.charCodeAt(w+4),G=i.charCodeAt(w+5),j=i.charCodeAt(w+6),ne=i.charCodeAt(w+7);if((C|I|L|O|q|G|j|ne)<128){w+=8,y+=8;continue}break}for(;y<_&&w<c;){const C=i.charCodeAt(w);C<128?(w+=1,y+=1):C<2048?(w+=1,y+=2):C<55296||C>56319?(w+=1,y+=3):(w+=2,y+=4)}return w};for(let l=0,_=n.length;l<_;l++){const w=n[l],{byteStart:R,byteEnd:C}=w.index,I=w.features;if(!(R>C||I.length===0)){if(y<R){const L=e(f,R);L>f&&a.push(Tb(i.slice(f,L),void 0)),f=L}{const L=e(f,C);L>f&&a.push(Tb(i.slice(f,L),I)),f=L}}}return f<c&&a.push(Tb(i.slice(f),void 0)),a},IK=/[&"<]/g,BK=/[&<]/g;function Gr(i,n){const a=String(i??""),c=n?IK:BK;c.lastIndex=0;let f="",y=0;for(;c.test(a);){const e=c.lastIndex-1,l=a[e];f+=a.substring(y,e)+(l==="&"?"&amp;":l==='"'?"&quot;":"&lt;"),y=e+1}return f+a.substring(y)}function Er(i,n,a=!1){if(n==null||!n&&a||n===""&&i==="class")return"";const f=a?"":`="${Gr(n,!0)}"`;return` ${i}${f}`}function MK(i,n){const a={out:""};return i(a,n?.props??{}),{head:"",body:a.out}}function Fa(i){return typeof i=="string"?i:i==null?"":i+""}const zK="https://public.api.bsky.app",OK="!no-unauthenticated";function hI(i,n){const{children:a}=n;i.out+='<div class="bluesky-embed s-3olstj">',a(i),i.out+="</div>"}const nm=i=>`https://bsky.app/profile/${i}`,lv=(i,n)=>`https://bsky.app/profile/${i}/post/${n}`,VK=i=>`https://bsky.app/hashtag/${i}`,mI=(i,n)=>`https://bsky.app/profile/${i}/feed/${n}`,UK=(i,n)=>`https://bsky.app/starter-pack/${i}/${n}`,jK=(i,n)=>`https://ogcard.cdn.bsky.app/start/${i}/${n}`;let XP=0,Y0=0;const NK=new Intl.DateTimeFormat("en-US",{dateStyle:"long",timeStyle:"short"}),FK=new Intl.DateTimeFormat("en-US",{dateStyle:"medium"}),qK=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}),yI=i=>{const n=new Date(i),a=n.getTime();if(isNaN(a))return"N/A";const c=Date.now();if(c>Y0){const f=new Date(c);f.setMonth(0,1),f.setHours(0,0,0),XP=f.getTime(),f.setFullYear(f.getFullYear()+1,0,0),f.setHours(23,59,59,999),Y0=f.getTime()}return a>=XP&&a<=Y0?qK.format(n):FK.format(n)},gI=i=>{const n=new Date(i);return isNaN(n.getTime())?"N/A":NK.format(n)},Cb=0,Ax=1,WP={"!hide":{name:"Hidden by moderators",flags:Ax},"!warn":{name:"Content warning",flags:Ax},porn:{name:"Adult content",flags:Cb},sexual:{name:"Sexually suggestive",flags:Cb},"graphic-media":{name:"Graphic media",flags:Cb},nudity:{name:"Nudity",flags:Cb}},uv=(i,n)=>{if(i?.length)for(let a=0,c=i.length;a<c;a++){const f=i[a],y=f.val;if(!(y in WP))continue;const e=WP[y];if(!(e.flags&Ax&&f.src===n))return e}},_I=new Intl.NumberFormat("en-US"),KK=new Intl.NumberFormat("en-US",{notation:"compact"}),kb=i=>i<1e3?""+i:i<1e5?_I.format(i):KK.format(i),Pb=i=>_I.format(i),GK=/^at:\/\/((?:did:[a-zA-Z0-9._:%-]+)|(?:[a-zA-Z0-9][a-zA-Z0-9-.]*))(?:\/([a-zA-Z0-9.-]+)(?:\/([a-zA-Z0-9_~.:-]{1,512}))?)?\/?(?:\?([^#\s]*))?(?:#([^\s]*))?$/,Jl=i=>{const n=GK.exec(i);if(!n)throw new $K(`invalid at-uri: ${i}`);return{repo:n[1],collection:n[2]??"",rkey:n[3]??"",query:n[4]??"",fragment:n[5]??""}};class $K extends Error{}function ZK(i,n){const{warning:a,children:c}=n;a?(i.out+=`<details class="content-hider s-q6x07m"><summary class="gate s-q6x07m"><svg class="icon s-q6x07m" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="square" stroke-width="2" d="M11 11h1v5m9-4a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path><path fill="currentColor" stroke="currentColor" stroke-width=".5" d="M11.5 7.25h-.25v1.5h1.5v-1.5H11.5Z"></path></svg> <span class="label s-q6x07m">${Gr(a.name)}</span> <span class="action s-q6x07m"></span></summary> `,c(i),i.out+="</details>"):c(i)}const HK=i=>{let n;if("parse"in URL)n=URL.parse(i);else try{n=new URL(i)}catch{}return n&&(n.protocol==="https:"||n.protocol==="http:")?n:null};function XK(i,n){const{embed:a}=n,c=a.external,f=HK(c.uri)?.host;i.out+=`<a target="_blank"${Er("href",f&&c.uri)} rel="noopener noreferrer nofollow" class="external-embed s-rtbqd8">`,c.thumb&&(i.out+=`<img loading="lazy"${Er("src",c.thumb)} alt="" class="thumbnail s-rtbqd8">`),i.out+=` <div class="meta s-rtbqd8"><p class="title s-rtbqd8">${Gr(c.title)}</p> <p class="description s-rtbqd8">${Gr(c.description)}</p> `,f&&(i.out+=`<div class="domain s-rtbqd8"><svg class="icon" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="m4.172 8.07 3.94 2.957.977-1.941 3.887-.978 1.15-4.6M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-6.078 4.865.973-1.946-2.869-1.928-1.89-.12-1.08 1.075 1.947 2.919h2.919Z"></path></svg> <span class="domain-name">${Gr(f)}</span></div>`),i.out+="</div></a>"}function WK(i,n){const{embed:a}=n,c=a.creator,f=mI(c.did,Jl(a.uri).rkey);i.out+=`<a target="_blank"${Er("href",f)} class="feed-embed s-156tlwp"><div class="main s-156tlwp"><div class="avatar-wrapper s-156tlwp">`,a.avatar?i.out+=`<img loading="lazy"${Er("src",a.avatar)} alt="" class="avatar s-156tlwp">`:i.out+='<svg viewBox="0 0 32 32" class="avatar s-156tlwp"><path fill="#0070FF" d="M0 0h32v32H0z"></path><path fill="#fff" d="M22.153 22.354a9.328 9.328 0 0 0 3.837-.491 3.076 3.076 0 0 0-4.802-2.79m.965 3.281a6.128 6.128 0 0 0-.965-3.28Zm-11.342-3.28a3.077 3.077 0 0 0-4.801 2.79 9.21 9.21 0 0 0 3.835.49m.966-3.28a6.127 6.127 0 0 0-.966 3.28Zm8.265-8.997a3.076 3.076 0 1 1-6.153 0 3.076 3.076 0 0 1 6.153 0Zm6.154 3.077a2.307 2.307 0 1 1-4.615 0 2.307 2.307 0 0 1 4.615 0Zm-13.847 0a2.307 2.307 0 1 1-4.614 0 2.307 2.307 0 0 1 4.614 0Z"></path><path fill="#fff" d="M22 22c0 3.314-2.686 3.5-6 3.5s-6-.186-6-3.5a6 6 0 0 1 12 0Z"></path></svg>',i.out+=`</div> <div class="info"><p class="name s-156tlwp">${Gr(a.displayName)}</p> <p class="creator s-156tlwp">Feed by @${Gr(c.handle)}</p></div></div> <p class="description s-156tlwp">${Gr(a.description)}</p></a>`}const YK={width:16,height:9};function Rx(i,n){const{embed:a,borderless:c,standalone:f,blur:y}=n,e=a.images,l=e.length;function _(w,R){const C=e[R];w.out+=`<img loading="lazy"${Er("src",C.thumb)}${Er("alt",C.alt)}${Er("class",`${Fa("image"+(y?" is-blurred":""))} s-t3k6fc`)}>`}if(i.out+=`<div${Er("class",`${Fa("image-embed"+(c?"":" is-bordered")+(f&&l===1?" is-aligned":""))} s-t3k6fc`)}>`,l===4)i.out+='<div class="grid s-t3k6fc"><div class="col s-t3k6fc"><div class="item wide tl s-t3k6fc">',_(i,0),i.out+='</div> <div class="item wide bl s-t3k6fc">',_(i,2),i.out+='</div></div> <div class="col s-t3k6fc"><div class="item wide tr s-t3k6fc">',_(i,1),i.out+='</div> <div class="item wide br s-t3k6fc">',_(i,3),i.out+="</div></div></div>";else if(l===3)i.out+='<div class="grid s-t3k6fc"><div class="col square s-t3k6fc"><div class="item tl bl s-t3k6fc">',_(i,0),i.out+='</div></div> <div class="col square s-t3k6fc"><div class="item tr s-t3k6fc">',_(i,1),i.out+='</div> <div class="item br s-t3k6fc">',_(i,2),i.out+="</div></div></div>";else if(l===2)i.out+='<div class="grid s-t3k6fc"><div class="col s-t3k6fc"><div class="item square tl bl s-t3k6fc">',_(i,0),i.out+='</div></div> <div class="col s-t3k6fc"><div class="item square tr br s-t3k6fc">',_(i,1),i.out+="</div></div></div>";else if(l===1){const w=f&&(e[0].aspectRatio||YK);i.out+=`<div${Er("class",`${Fa("single-item tl tr bl br"+(w?" is-standalone":""))} s-t3k6fc`)}${Er("style",w?`aspect-ratio: ${w.width}/${w.height}`:"")}>`,_(i,0),i.out+=" ",w&&(i.out+='<div class="placeholder s-t3k6fc"></div>'),i.out+="</div>"}i.out+="</div>"}const JK=i=>{switch(i){case"app.bsky.graph.defs#curatelist":return"User list";case"app.bsky.graph.defs#modlist":return"Moderation list"}return"Unknown list"};function QK(i,n){const{embed:a}=n,c=a.creator,f=mI(c.did,Jl(a.uri).rkey);i.out+=`<a target="_blank"${Er("href",f)} class="list-embed s-6uize5"><div class="main s-6uize5"><div class="avatar-wrapper s-6uize5">`,a.avatar?i.out+=`<img loading="lazy"${Er("src",a.avatar)} alt="" class="avatar s-6uize5">`:i.out+='<svg viewBox="0 0 32 32" class="avatar s-6uize5"><path fill="#0070FF" d="M0 0h32v32H0z"></path><path fill="#fff" d="M22.153 22.354a9.328 9.328 0 0 0 3.837-.491 3.076 3.076 0 0 0-4.802-2.79m.965 3.281a6.128 6.128 0 0 0-.965-3.28Zm-11.342-3.28a3.077 3.077 0 0 0-4.801 2.79 9.21 9.21 0 0 0 3.835.49m.966-3.28a6.127 6.127 0 0 0-.966 3.28Zm8.265-8.997a3.076 3.076 0 1 1-6.153 0 3.076 3.076 0 0 1 6.153 0Zm6.154 3.077a2.307 2.307 0 1 1-4.615 0 2.307 2.307 0 0 1 4.615 0Zm-13.847 0a2.307 2.307 0 1 1-4.614 0 2.307 2.307 0 0 1 4.614 0Z"></path><path fill="#fff" d="M22 22c0 3.314-2.686 3.5-6 3.5s-6-.186-6-3.5a6 6 0 0 1 12 0Z"></path></svg>',i.out+=`</div> <div class="info"><p class="name s-6uize5">${Gr(a.name)}</p> <p class="creator s-6uize5">${Gr(JK(a.purpose))} by @${Gr(c.handle)}</p></div></div> <p class="description s-6uize5">${Gr(a.description)}</p></a>`}function Sx(i,n){const{post:a,embed:c,borderless:f,standalone:y,blur:e}=n,l=y&&c.aspectRatio,_=a&&lv(a.author.did,Jl(a.uri).rkey);function w(R){R.out+=`<img loading="lazy"${Er("src",c.thumbnail)} alt=""${Er("class",`${Fa("thumbnail"+(e?" is-blurred":""))} s-1azk58e`)}> `,l&&(R.out+='<div class="placeholder s-1azk58e"></div>'),R.out+=' <div class="play s-1azk58e"><svg class="icon s-1azk58e" fill="none" viewBox="0 0 24 24"><path fill="currentColor" d="M22 12 5 2v20l17-10Z"></path></svg></div>'}y?(i.out+=`<a target="_blank"${Er("href",_)}${Er("class",`${Fa("video-embed"+(f?"":" is-bordered")+(y?" is-standalone":""))} s-1azk58e`)}><div class="constrainer s-1azk58e"${Er("style",l?`aspect-ratio: ${l.width}/${l.height}`:"")}>`,w(i),i.out+="</div></a>"):(i.out+=`<div${Er("class",`${Fa("video-embed"+(f?"":" is-bordered"))} s-1azk58e`)}${Er("style",l?`aspect-ratio: ${l.width}/${l.height}`:"")}>`,w(i),i.out+="</div>")}const bI=i=>{if(i){if(i.$type==="app.bsky.embed.images#view")return i;if(i.$type==="app.bsky.embed.recordWithMedia#view")return bI(i.media)}},vI=i=>{if(i){if(i.$type==="app.bsky.embed.video#view")return i;if(i.$type==="app.bsky.embed.recordWithMedia#view")return vI(i.media)}};function e8(i,n){const{embed:a,large:c=!1}=n,f=a.value,y=f.text.trim(),e=a.author,l=e.displayName?.trim(),_=a.embeds?.[0],w=bI(_),R=vI(_),C=lv(e.did,Jl(a.uri).rkey),I=!!uv(a.labels,e.did);i.out+=`<a target="_blank"${Er("href",C)} class="quote-embed s-za6fip"><div class="meta s-za6fip"><div class="avatar-wrapper s-za6fip">`,e.avatar&&(i.out+=`<img loading="lazy"${Er("src",e.avatar)} alt="" class="avatar s-za6fip">`),i.out+='</div> <span class="name-wrapper s-za6fip">',l&&(i.out+=`<bdi class="display-name-wrapper s-za6fip"><span class="display-name s-za6fip">${Gr(l)}</span></bdi>`),i.out+=` <span class="handle s-za6fip">@${Gr(e.handle)}</span></span> <span aria-hidden="true" class="dot s-za6fip">·</span> <time${Er("datetime",f.createdAt)} class="date s-za6fip">${Gr(yI(f.createdAt))}</time></div> `,y?(i.out+='<div class="body s-za6fip">',c||(w?(i.out+='<div class="aside s-za6fip">',Rx(i,{embed:w,blur:I}),i.out+="</div>"):R&&(i.out+='<div class="aside s-za6fip">',Sx(i,{embed:R,blur:I}),i.out+="</div>")),i.out+=` <p class="text s-za6fip">${Gr(y)}</p></div>`):i.out+='<div class="divide s-za6fip"></div>',i.out+=" ",(c||!y)&&(w?Rx(i,{embed:w,borderless:!0,blur:I}):R&&Sx(i,{embed:R,borderless:!0,blur:I})),i.out+="</a>"}function t8(i,n){const{embed:a,large:c=!1}=n,f=a.record,y=a.creator,e=y.did,l=Jl(a.uri).rkey,_=UK(e,l);if(i.out+=`<a target="_blank"${Er("href",_)} class="starterpack-embed s-15v965v">`,c){const w=jK(e,l);i.out+=`<img loading="lazy"${Er("src",w)} alt="" class="banner s-15v965v">`}i.out+=` <div class="meta s-15v965v"><div class="main s-15v965v"><svg fill="none" viewBox="0 0 24 24" class="avatar s-15v965v"><defs><linearGradient id="a" x1="0" x2="100%" y1="0" y2="0" gradientTransform="rotate(45)"><stop offset="0" stop-color="#0A7AFF"></stop><stop offset="1" stop-color="#59B9FF"></stop></linearGradient></defs><path fill="url(#a)" fill-rule="evenodd" d="M11.26 5.227 5.02 6.899c-.734.197-1.17.95-.973 1.685l1.672 6.24c.197.734.951 1.17 1.685.973l6.24-1.672a1.376 1.376 0 0 0 .973-1.685L12.945 6.2a1.375 1.375 0 0 0-1.685-.973Zm-6.566.459a2.632 2.632 0 0 0-1.86 3.223l1.672 6.24a2.632 2.632 0 0 0 3.223 1.861l6.24-1.672a2.631 2.631 0 0 0 1.861-3.223l-1.672-6.24a2.632 2.632 0 0 0-3.223-1.861l-6.24 1.672Z" clip-rule="evenodd"></path><path fill="url(#a)" fill-rule="evenodd" d="M15.138 18.411a4.606 4.606 0 1 0 0-9.211 4.606 4.606 0 0 0 0 9.211Zm0 1.257a5.862 5.862 0 1 0 0-11.724 5.862 5.862 0 0 0 0 11.724Z" clip-rule="evenodd"></path></svg> <div class="info"><p class="name s-15v965v">${Gr(f.name)}</p> <p class="creator s-15v965v">Starter pack by @${Gr(y.handle)}</p></div></div> <p class="description s-15v965v">${Gr(f.description)}</p></div></a>`}function YP(i,n){i.out+=`<div class="message s-azdpbr">${Gr(n)}</div>`}const r8=i=>{switch(i){case"app.bsky.feed.post":return"post";case"app.bsky.feed.generator":return"feed";case"app.bsky.graph.list":return"list";case"app.bsky.graph.starterpack":return"starter pack";case"app.bsky.labeler.service":return"labeler"}return null};function xI(i,n){const{post:a,embed:c,large:f=!1}=n;function y(l,_){const w=a&&uv(a.labels,a.author.did);ZK(l,{warning:w,children:R=>{_.$type==="app.bsky.embed.external#view"?XK(R,{embed:_}):_.$type==="app.bsky.embed.images#view"?Rx(R,{embed:_,standalone:!0}):_.$type==="app.bsky.embed.video#view"?Sx(R,{post:a,embed:_,standalone:!0}):YP(R,"Unsupported media embed")}})}function e(l,_){const w=_.record;if(w.$type==="app.bsky.embed.record#viewRecord")e8(l,{embed:w,large:f});else if(w.$type==="app.bsky.feed.defs#generatorView")WK(l,{embed:w});else if(w.$type==="app.bsky.graph.defs#listView")QK(l,{embed:w});else if(w.$type==="app.bsky.graph.defs#starterPackViewBasic")t8(l,{embed:w,large:f});else{const R=Jl(w.uri),C=r8(R.collection),I=C&&(w.$type==="app.bsky.embed.record#viewNotFound"||w.$type==="app.bsky.embed.record#viewBlocked"||w.$type==="app.bsky.embed.record#viewDetached");YP(l,I?`This ${C} is unavailable`:"Unsupported record embed")}}i.out+='<div class="embeds s-azdpbr">',c.$type==="app.bsky.embed.recordWithMedia#view"?(y(i,c.media),i.out+=" ",e(i,c.record)):c.$type==="app.bsky.embed.record#view"?e(i,c):y(i,c),i.out+="</div>"}const i8=i=>i?.find(n=>n.$type==="app.bsky.richtext.facet#link"||n.$type==="app.bsky.richtext.facet#mention"||n.$type==="app.bsky.richtext.facet#tag");function wI(i,n){const{text:a,facets:c,large:f}=n,y=DK(a,c);i.out+=`<p${Er("class",`${Fa("rich-text"+(f?" is-large":" is-small"))} s-1lecfnd`)}>`;for(let e=0,l=y.length;e<l;e++){let _=y[e];const w=i8(_.features);w?w.$type==="app.bsky.richtext.facet#link"?i.out+=`<a target="_blank"${Er("href",w.uri)} rel="noopener nofollow" class="link s-1lecfnd">${Gr(_.text)}</a>`:w.$type==="app.bsky.richtext.facet#mention"?i.out+=`<a target="_blank"${Er("href",nm(w.did))} class="mention s-1lecfnd">${Gr(_.text)}</a>`:w.$type==="app.bsky.richtext.facet#tag"&&(i.out+=`<a target="_blank"${Er("href",VK(w.tag))} class="hashtag s-1lecfnd">${Gr(_.text)}</a>`):i.out+=Gr(_.text)}i.out+="</p>"}function n8(i,n){const{post:a,parent:c,prev:f=!1}=n,y=a.author,e=nm(y.did),l=y.displayName?.trim(),_=a.record,w=lv(y.did,Jl(a.uri).rkey),R=a.replyCount||0,C=a.likeCount||0,I=(a.repostCount||0)+(a.quoteCount||0),L=!!uv(y.labels,y.did);if(i.out+=`<div class="highlighted-post s-hik11q"><div class="meta s-hik11q"><a${Er("href",e)} target="_blank" class="avatar-wrapper s-hik11q">`,y.avatar&&(i.out+=`<img loading="lazy"${Er("src",y.avatar)} alt=""${Er("class",`${Fa("avatar"+(L?" is-blurred":""))} s-hik11q`)}>`),i.out+=`</a> <a${Er("href",e)} target="_blank" class="name-wrapper s-hik11q">`,l&&(i.out+=`<bdi class="display-name-wrapper s-hik11q"><span class="display-name s-hik11q">${Gr(l)}</span></bdi>`),i.out+=` <span class="handle s-hik11q">@${Gr(y.handle)}</span></a> `,f||(i.out+='<svg class="logo s-hik11q" fill="none" viewBox="0 0 320 286"><path fill="#0A7AFF" d="M69.364 19.146c36.687 27.806 76.147 84.186 90.636 114.439 14.489-30.253 53.948-86.633 90.636-114.439C277.107-.917 320-16.44 320 32.957c0 9.865-5.603 82.875-8.889 94.729-11.423 41.208-53.045 51.719-90.071 45.357 64.719 11.12 81.182 47.953 45.627 84.785-80 82.874-106.667-44.333-106.667-44.333s-26.667 127.207-106.667 44.333c-35.555-36.832-19.092-73.665 45.627-84.785-37.026 6.362-78.648-4.149-90.071-45.357C5.603 115.832 0 42.822 0 32.957 0-16.44 42.893-.917 69.364 19.147Z"></path></svg>'),i.out+="</div> ",!f&&_.reply){if(i.out+='<p class="context s-hik11q">',c){const O=c.author;i.out+=`Replying to <a target="_blank"${Er("href",nm(O.did))} dir="auto" class="s-hik11q">${Gr(O.displayName?.trim()||`@${O.handle}`)}</a>`}else i.out+="Replying to an unknown post";i.out+="</p>"}i.out+=" ",wI(i,{text:_.text,facets:_.facets,large:!0}),i.out+=" ",a.embed&&xI(i,{post:a,embed:a.embed,large:!0}),i.out+=` <time${Er("datetime",_.createdAt)} class="date s-hik11q">${Gr(gI(_.createdAt))}</time> <div class="stats s-hik11q"><span class="stat s-hik11q"${Er("title",C===1?`${Pb(C)} like`:`${Pb(C)} likes`)}><svg class="icon" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-width="2" d="M12 5.768c6.162-6.25 16.725 5.358 0 14.732C-4.725 11.126 5.838-.482 12 5.768Z"></path></svg> <span>${Gr(kb(C))}</span></span> <span class="stat s-hik11q"${Er("title",I===1?`${Pb(I)} repost`:`${Pb(I)} reposts`)}><svg class="icon" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="square" stroke-width="2" d="m17 3 3 3-3 3M7 21l-3-3 3-3m-2 3h15v-5M4 11V6h15"></path></svg> <span>${Gr(kb(I))}</span></span> <div class="gap s-hik11q"></div> <a${Er("href",w)} target="_blank" class="permalink s-hik11q"><span>${Gr(R?R===1?`Read ${kb(R)} reply on Bluesky`:`Read ${kb(R)} replies on Bluesky`:"View on Bluesky")}</span></a></div></div>`}function s8(i,n){const{post:a,parent:c,prev:f}=n,y=a.author,e=nm(y.did),l=y.displayName?.trim(),_=a.record,w=lv(y.did,Jl(a.uri).rkey),R=!!uv(y.labels,y.did);if(i.out+='<div class="post s-12mzi62">',f||(i.out+='<svg class="logo s-12mzi62" fill="none" viewBox="0 0 320 286"><path fill="#0A7AFF" d="M69.364 19.146c36.687 27.806 76.147 84.186 90.636 114.439 14.489-30.253 53.948-86.633 90.636-114.439C277.107-.917 320-16.44 320 32.957c0 9.865-5.603 82.875-8.889 94.729-11.423 41.208-53.045 51.719-90.071 45.357 64.719 11.12 81.182 47.953 45.627 84.785-80 82.874-106.667-44.333-106.667-44.333s-26.667 127.207-106.667 44.333c-35.555-36.832-19.092-73.665 45.627-84.785-37.026 6.362-78.648-4.149-90.071-45.357C5.603 115.832 0 42.822 0 32.957 0-16.44 42.893-.917 69.364 19.147Z"></path></svg>'),i.out+=` <div class="aside s-12mzi62"><a target="_blank"${Er("href",e)} class="avatar-wrapper s-12mzi62">`,y.avatar&&(i.out+=`<img loading="lazy"${Er("src",y.avatar)} alt=""${Er("class",`${Fa("avatar"+(R?" is-blurred":""))} s-12mzi62`)}>`),i.out+=`</a> <div class="line s-12mzi62"></div></div> <div class="main s-12mzi62"><div class="meta s-12mzi62"><a${Er("href",e)} target="_blank" class="name-wrapper s-12mzi62">`,l&&(i.out+=`<bdi class="display-name-wrapper s-12mzi62"><span class="display-name s-12mzi62">${Gr(l)}</span></bdi>`),i.out+=` <span class="handle s-12mzi62">@${Gr(y.handle)}</span></a> <span aria-hidden="true" class="dot s-12mzi62">·</span> <a target="_blank"${Er("href",w)}${Er("title",gI(_.createdAt))} class="date s-12mzi62"><time${Er("datetime",_.createdAt)}>${Gr(yI(_.createdAt))}</time></a></div> `,!f&&_.reply){if(i.out+='<p class="context s-12mzi62">',c){const C=c.author;i.out+=`Replying to <a target="_blank"${Er("href",nm(C.did))} dir="auto" class="s-12mzi62">${Gr(C.displayName?.trim()||`@${C.handle}`)}</a>`}else i.out+="Replying to an unknown post";i.out+="</p>"}i.out+=" ",wI(i,{text:_.text,facets:_.facets}),i.out+=" ",a.embed&&xI(i,{post:a,embed:a.embed}),i.out+="</div></div>"}function JP(i,n){hI(i,{children:a=>{a.out+=`<div class="message s-1q9cbx0">${Gr(n)}</div>`}})}const o8=(i,n,a)=>{const c=[];let f=0,y=n?1:2,e=i;for(;e&&!(e.$type==="app.bsky.feed.defs#notFoundPost"||e.$type==="app.bsky.feed.defs#blockedPost");){const l=e.post;if(f!==0&&(c[f-1].parent=l),++f>y)break;const _=l.author;if(!a&&_.labels?.some(w=>w.val==="!no-unauthenticated"))break;c.push({post:l,parent:null}),e=e.parent}return c.reverse()};function a8(i,n){const{thread:a,contextless:c,allowUnauthenticated:f}=n,y=!f&&a!==null&&a.$type==="app.bsky.feed.defs#threadViewPost"&&a.post.author.labels?.some(e=>e.val===OK);if(a===null)JP(i,"The post can't be found, it may have been deleted.");else if(y)JP(i,"The author has requested for their posts to not be displayed on external sites.");else{const e=o8(a,c,f);hI(i,{children:l=>{const _=e;for(let w=0,R=_.length;w<R;w++){let{post:C,parent:I}=_[w];const L=w!==0;w===e.length-1?n8(l,{post:C,parent:I,prev:L}):s8(l,{post:C,parent:I,prev:L})}}})}}const l8=async i=>{const n=new TK({handler:RK({service:i.serviceUri??zK})}),a=i.contextless??!1,{data:c}=await n.get("app.bsky.feed.getPostThread",{signal:i.signal,params:{uri:i.uri,parentHeight:a?1:2,depth:0}}).catch(y=>y instanceof Bb&&y.kind==="NotFound"?{data:null}:Promise.reject(y));return{thread:c?.thread.$type==="app.bsky.feed.defs#threadViewPost"?c.thread:null,contextless:a,allowUnauthenticated:i.allowUnauthenticated??!1}},u8=i=>MK(a8,{props:i}).body;var c8=cs("<bluesky-post><!></bluesky-post>",2);function d8(i,n){Gn(n,!0);const a=!0,c=u8(n.data);var f={prerender:a},y=c8();ko(()=>Gz(y,"src",n.data.thread?.post.uri));var e=ni(y);return Uz(e,()=>c),wr(i,y),$n(f)}async function p8(i,n){const a=n.match(/^https:\/\/bsky\.app\/profile\/([^/]+)\/post\/([^/]+)/);if(!a)throw new Error("invalid Bsky URL");const[,c,f]=a;return`at://${(await i.api.com.atproto.identity.resolveHandle({handle:c})).data.did}/app.bsky.feed.post/${f}`}async function QP(i,n){const a=await p8(i,n);return await l8({uri:a})}var f8=cs("<img/>"),h8=cs('<div class="photo-grid gap-4 grid grid-cols-1 md:grid-cols-3"></div>');function m8(i,n){Gn(n,!1);const a=!0;let c=Ct(n,"agent",8),f=Ct(n,"photos",24,()=>[]);function y(_){return _.startsWith("https://bsky.app/")}var e={prerender:a};lm();var l=h8();return oc(l,5,f,sc,(_,w)=>{var R=yi(),C=Hr(R);{var I=O=>{var q=yi(),G=Hr(q);zz(G,()=>(qs(QP),qs(c()),Ie(w),us(()=>QP(c(),Ie(w)))),null,(j,ne)=>{d8(j,{get data(){return Ie(ne)}})},(j,ne)=>{}),wr(O,q)},L=O=>{var q=f8();ko(()=>$l(q,"src",Ie(w))),wr(O,q)};wn(C,O=>{Ie(w),us(()=>y(Ie(w)))?O(I):O(L,!1)})}wr(_,R)}),wr(i,l),ev(n,"prerender",a),$n(e)}var y8=cs('<div class="text-sm font-semibold text-gray-800"> </div> <li class="grid-row"><span class="grid-column-full"> </span> <div class="grid-column-full"><button class="block link">View ></button></div></li>',1);function g8(i,n){Gn(n,!1);const a=!0;let c=Ct(n,"cafe",8),f=Ct(n,"onClick",8,()=>{});var y={prerender:a};lm();var e=y8(),l=Hr(e),_=ni(l),w=yn(l,2),R=ni(w),C=ni(R),I=yn(R,2),L=ni(I);return ko(O=>{lc(_,(qs(c()),us(()=>c().name))),lc(C,O)},[()=>(qs(c()),us(()=>new Date(c().date).toDateString()))]),cc("click",L,Ob(O=>f()(c()))),wr(i,e),ev(n,"prerender",a),$n(y)}var _8=cs('<li class="summary-list__row"><span class="summary-list__value"> </span> <div class="summary-list__actions"><button href="#" class="block link">View ></button></div></li>');function b8(i,n){Gn(n,!1);const a=!0;let c=Ct(n,"cafe",8),f=Ct(n,"onClick",8,()=>{}),y=Ct(n,"isActive",8,!1),e=L=>(y()&&L.scrollIntoView({behavior:"smooth",block:"center"}),()=>{});var l={prerender:a};lm();var _=_8(),w=ni(_),R=ni(w),C=yn(w,2),I=ni(C);return KL(_,()=>e),ko(L=>lc(R,`${qs(c()),us(()=>c().name)??""} - ${L??""}`),[()=>(qs(c()),us(()=>new Date(c().date).toDateString()))]),cc("click",I,Ob(L=>f()(c()))),wr(i,_),ev(n,"prerender",a),$n(l)}const v8="/data/cafe-data.json";async function x8(){let i=await fetch(v8);if(!i.ok)throw new Error("failed to retrieve cafe data :(");return await i.json()}function w8(i){return[...i].sort((n,a)=>new Date(a.date).valueOf()-new Date(n.date).valueOf())}var E8=cs("<!> <!>",1),A8=cs('<li><h3 class="heading-s"><button class="block link"> </button></h3></li> <ul class="summary-list"></ul>',1),R8=cs('<span class="tag"><a class="link">GMaps ></a></span>'),S8=cs('<main class="body"><div class="outline-container"><h3 class="heading-m"> </h3> <span class="date"><time> </time></span> <span class="tag"><button class="block link">View ></button></span> <!> <div class="grid-row"><div class="grid-column-full"><div class="body"><!></div></div></div> <div class="grid-row"><div class="grid-column-full"><!></div></div></div></main>'),T8=cs(`<div class="body"><span class="caption-m">To all the cafes I've snacked at.</span> <h1 class="heading-l">Kiran's Cafe Hopping Adventures!</h1> One of my hobbies is going Cafe-hopping!  I just love cafe vibes for
doing work, getting stuff done etc. This is a little bit of fun, but I
thought I'd collate all of my cafe-related photos with a little map
view so we could track exactly which cafes I've gone to and like
thoughts or fun stories about each!

Have a look around, I hope you enjoy your stay!</div> <div class="grid-row"><div class="grid-column-one-half h-80 w-full"><!></div> <div class="grid-column-one-half body"><h2 class="heading-m">Cafe List</h2> <div class="overflow-y-scroll max-h-60"><ul></ul></div></div></div> <!>`,1);function C8(i,n){Gn(n,!1);const a=!0;let c=Nl(),f=Nl({}),y=Nl(null),e=Nl(null),l=Nl(null);function _(Q){dr(y,Q),dr(e,[Ie(y).location[1],Ie(y).location[0]]),dr(l,15)}function w(Q){dr(e,[Q.center[1],Q.center[0]]),dr(l,Q.zoom)}px(()=>{dr(c,new EK({service:"https://bsky.social"}))}),px(async()=>{dr(f,await x8());let Q=Object.keys(Ie(f))[0];w(Ie(f)[Q])});var R={prerender:a};lm();var C=T8(),I=yn(Hr(C),2),L=ni(I),O=ni(L);D3(O,{standardControls:!0,class:"relative h-full w-full inset-0 body",style:"https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json",get center(){return Ie(e)},get zoom(){return Ie(l)},children:(Q,Be)=>{var we=yi(),ze=Hr(we);oc(ze,1,()=>Object.keys(Ie(f)),sc,(et,gt)=>{var st=yi(),nt=Hr(st);oc(nt,1,()=>Ie(f)[Ie(gt)].cafes,sc,(rt,ee)=>{{let Le=Qh(()=>[Ie(ee).location[1],Ie(ee).location[0]]);U3(rt,{get lngLat(){return Ie(Le)},class:"group relative grid h-10 w-10 place-items-center rounded-full border border-gray-300 bg-black-200 shadow-lg transition hover:scale-110 hover:shadow-2xl",children:(de,me)=>{var tt=E8(),yt=Hr(tt);tO(yt,{class:"h-5 w-5"});var lt=yn(yt,2);N3(lt,{openOn:"hover",offset:[0,-12],children:(ge,Gt)=>{g8(ge,{onClick:_,get cafe(){return Ie(ee)}})},$$slots:{default:!0}}),wr(de,tt)},$$slots:{default:!0}})}}),wr(et,st)}),wr(Q,we)},$$slots:{default:!0}});var q=yn(L,2),G=yn(ni(q),2),j=ni(G);oc(j,5,()=>Object.keys(Ie(f)),sc,(Q,Be)=>{var we=A8(),ze=Hr(we),et=ni(ze),gt=ni(et),st=ni(gt),nt=yn(ze,2);oc(nt,5,()=>w8(Ie(f)[Ie(Be)].cafes),sc,(rt,ee)=>{const Le=Qh(()=>Ie(ee)===Ie(y));b8(rt,{get isActive(){return Ie(Le)},get cafe(){return Ie(ee)},onClick:_})}),ko(()=>lc(st,Ie(Be))),cc("click",gt,Ob(rt=>w(Ie(f)[Ie(Be)]))),wr(Q,we)});var ne=yn(I,2);{var he=Q=>{var Be=S8(),we=ni(Be),ze=ni(we),et=ni(ze),gt=yn(ze,2),st=ni(gt),nt=ni(st),rt=yn(gt,2),ee=ni(rt),Le=Xr(()=>_(Ie(y))),de=yn(rt,2);{var me=ar=>{var kt=R8(),er=ni(kt);ko(()=>$l(er,"href",Ie(y).mapsLink)),wr(ar,kt)};wn(de,ar=>{"mapsLink"in Ie(y)&&ar(me)})}var tt=yn(de,2),yt=ni(tt),lt=ni(yt),ge=ni(lt);$j(ge,{get md(){return Ie(y).notes}});var Gt=yn(tt,2),Ut=ni(Gt),Ce=ni(Ut);m8(Ce,{get agent(){return Ie(c)},get photos(){return Ie(y).photos}}),ko(ar=>{lc(et,Ie(y).name),$l(st,"datetime",Ie(y).date),lc(nt,ar)},[()=>new Date(Ie(y).date).toDateString()]),cc("click",ee,Ob(function(...ar){Ie(Le)?.apply(this,ar)})),wr(Q,Be)};wn(ne,Q=>{Ie(y)!==null&&Q(he)})}return wr(i,C),ev(n,"prerender",a),$n(R)}Iz(C8,{target:document.getElementById("app")});
